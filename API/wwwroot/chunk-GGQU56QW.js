import{a as ve}from"./chunk-V7YNUPX5.js";import{a as v,b as ft,l as fe}from"./chunk-ZTKUYOP3.js";import{b as me,c as ge}from"./chunk-COKVODYN.js";import{a as he}from"./chunk-K6JLHPZK.js";import{a as de}from"./chunk-SEAKSSGD.js";import{a as _e}from"./chunk-SBPQBTA5.js";import{f as pe}from"./chunk-5CMEBAZF.js";import{a as W}from"./chunk-ZRHV3LXB.js";import{a as ue}from"./chunk-SBTJKJNK.js";import{a as jt,e as Zt,f as Kt,g as Yt,j as Qt,k as qt,m as Xt,q as _t}from"./chunk-SPNNO5LP.js";import{$b as A,Ac as Gt,Bb as d,Dc as D,Ea as Tt,Ec as V,Fa as T,Fb as b,Fc as zt,Ga as F,Gb as bt,Gc as dt,H as at,Ha as x,Hb as et,Ib as l,Jd as q,Ke as oe,L as ct,La as Ft,Le as re,Me as se,Na as pt,Nb as B,Ne as ae,Oa as Pt,Pa as Z,Rb as M,Rc as mt,Td as Y,Ud as Jt,Vb as m,Wb as u,Xb as g,Yb as _,Zb as f,Zd as te,_b as it,_c as $t,_e as ce,a as yt,be as ee,bf as le,cc as O,dc as c,eb as Mt,ec as Dt,fc as At,gc as Et,gd as Ut,ge as ie,hc as nt,hd as ht,ic as Vt,id as R,jc as Rt,ka as St,la as kt,lb as a,lc as Lt,mb as tt,mc as Wt,md as Bt,nc as Q,nd as ut,o as vt,oc as S,od as gt,pa as xt,pc as G,qa as k,qc as K,sd as Ht,tb as Ot,ua as wt,ud as L,va as P,wa as It,xc as E,ya as lt,yc as Nt,ye as ne,z as Ct,zc as z}from"./chunk-2LHIXASS.js";var Ce=(()=>{let o=class o{transform(e){return e??[]}};o.\u0275fac=function(n){return new(n||o)},o.\u0275pipe=lt({name:"dynamicList",type:o,pure:!0,standalone:!0});let i=o;return i})();var xe=i=>({list:i});function Ae(i,o){i&1&&it(0)}function Ee(i,o){if(i&1){let t=A();_(0),m(1,"button",13),O("click",function(n){let r=T(t).$implicit,s=c(3).$implicit,p=c(4);return F(p.performDynamicClick(n,s,r))}),S(2),u(),f()}if(i&2){let t=o.$implicit;a(2),G(t.title)}}function Ve(i,o){if(i&1&&(_(0),d(1,Ee,3,1,"ng-container",11),f()),i&2){let t=o.ngIf;a(),l("ngForOf",t)}}function Re(i,o){if(i&1){let t=A();m(0,"button",15),O("click",function(n){T(t);let r=c(3).$implicit,s=c(4);return F(s.performAction(n,r))})("mouseover",function(){T(t);let n=c(7);return F(n.closeAllSubmenus())}),S(1),u()}if(i&2){let t=c(3).$implicit,e=c(3).$implicit;a(),G(e(t.title))}}function Le(i,o){if(i&1&&d(0,Re,2,1,"button",14),i&2){let t=c(2).$implicit,e=c(4);l("ngIf",e.willRenderAction(t))}}function We(i,o){if(i&1&&(_(0),d(1,Ve,2,1,"ng-container",12),D(2,"async"),D(3,"dynamicList"),d(4,Le,1,1,"ng-template",null,2,dt),f()),i&2){let t=Q(5),e=c().$implicit;a(),l("ngIf",e.dynamicList!==void 0&&V(3,4,V(2,2,e.dynamicList)))("ngIfElse",t)}}function Ne(i,o){if(i&1&&(m(0,"button",18),S(1),g(2,"i",19),u()),i&2){let t=c(3).$implicit,e=c(3).$implicit;nt("id","actions-",t.title,""),a(),K("",e(t.title)," ")}}function Ge(i,o){i&1&&it(0)}function ze(i,o){if(i&1){let t=A();_(0),m(1,"div",16,3),O("click",function(n){T(t);let r=Q(2),s=c(2).$implicit,p=c(4);return p.preventEvent(n),F(p.openSubmenu(s.title,r))})("mouseover",function(n){T(t);let r=Q(2),s=c(2).$implicit,p=c(4);return p.preventEvent(n),F(p.openSubmenu(s.title,r))})("mouseleave",function(n){T(t);let r=c(6);return F(r.preventEvent(n))}),d(3,Ne,3,3,"button",17),m(4,"div",9),d(5,Ge,1,0,"ng-container",10),u()(),f()}if(i&2){let t=c(2).$implicit;c(2);let e=Q(7),n=c(2);a(3),l("ngIf",n.willRenderAction(t)),a(),bt("aria-labelledby","actions-",t.title,""),a(),l("ngTemplateOutlet",e)("ngTemplateOutletContext",z(5,xe,t.children))}}function $e(i,o){if(i&1&&(d(0,ze,6,7,"ng-container",5),D(1,"async")),i&2){let t=c().$implicit,e=c(4);l("ngIf",e.shouldRenderSubMenu(t,V(1,1,t.children==null?null:t.children[0].dynamicList)))}}function Ue(i,o){if(i&1&&(_(0),d(1,We,6,6,"ng-container",12)(2,$e,2,3,"ng-template",null,1,dt),f()),i&2){let t=o.$implicit,e=Q(3);a(),l("ngIf",t.children===void 0||(t==null||t.children==null?null:t.children.length)===0||t.dynamicList!==void 0)("ngIfElse",e)}}function Be(i,o){if(i&1&&d(0,Ue,4,2,"ng-container",11),i&2){let t=o.list;l("ngForOf",t)}}function He(i,o){if(i&1){let t=A();_(0),m(1,"div",6)(2,"button",7),O("click",function(n){T(t);let r=c(2);return F(r.preventEvent(n))}),g(3,"i",8),u(),m(4,"div",9),d(5,Ae,1,0,"ng-container",10),u()(),d(6,Be,1,1,"ng-template",null,0,dt),f()}if(i&2){let t=Q(7),e=c(2);a(2),B("btn ",e.btnClass,""),nt("id","actions-",e.labelBy,""),l("disabled",e.disabled),a(),B("fa ",e.iconClass,""),a(),bt("aria-labelledby","actions-",e.labelBy,""),a(),l("ngTemplateOutlet",t)("ngTemplateOutletContext",z(13,xe,e.actions))}}function je(i,o){if(i&1&&(_(0),d(1,He,8,15,"ng-container",5),f()),i&2){let t=c();a(),l("ngIf",t.actions.length>0)}}var be=(()=>{let o=class o{constructor(){this.cdRef=k(mt),this.accountService=k(_t),this.destroyRef=k(pt),this.iconClass="fa-ellipsis-v",this.btnClass="",this.actions=[],this.labelBy="card",this.disabled=!1,this.actionHandler=new Z,this.isAdmin=!1,this.canDownload=!1,this.canPromote=!1,this.submenu={}}ngOnInit(){this.accountService.currentUser$.pipe(q(this.destroyRef)).subscribe(e=>{e&&(this.isAdmin=this.accountService.hasAdminRole(e),this.canDownload=this.accountService.hasDownloadRole(e),this.canPromote=this.accountService.hasPromoteRole(e),!this.isAdmin&&this.actions.filter(n=>!n.requiresAdmin).length===0&&(this.actions=[]),this.cdRef.markForCheck())})}preventEvent(e){e.stopPropagation(),e.preventDefault()}performAction(e,n){this.preventEvent(e),typeof n.callback=="function"&&this.actionHandler.emit(n)}willRenderAction(e){return e.requiresAdmin&&this.isAdmin||e.action===v.Download&&(this.canDownload||this.isAdmin)||!e.requiresAdmin&&e.action!==v.Download||e.action===v.Promote&&(this.canPromote||this.isAdmin)||e.action===v.UnPromote&&(this.canPromote||this.isAdmin)}shouldRenderSubMenu(e,n){return e.children[0].dynamicList===void 0||e.children[0].dynamicList===null||n!==null&&n.length>0}openSubmenu(e,n){Object.keys(this.submenu).length>0&&Object.keys(this.submenu).filter(s=>s!==e).forEach(s=>{this.submenu[s].close(),delete this.submenu[s]}),this.submenu[e]=n,n.open()}closeAllSubmenus(){Object.keys(this.submenu).forEach(e=>{this.submenu[e].close(),delete this.submenu[e]})}performDynamicClick(e,n,r){n._extra=r,this.performAction(e,n)}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=P({type:o,selectors:[["app-card-actionables"]],inputs:{iconClass:"iconClass",btnClass:"btnClass",actions:"actions",labelBy:"labelBy",disabled:"disabled"},outputs:{actionHandler:"actionHandler"},standalone:!0,features:[E],decls:1,vars:1,consts:[["submenu",""],["submenuDropdown",""],["justItem",""],["subMenuHover","ngbDropdown"],[4,"transloco","translocoRead"],[4,"ngIf"],["ngbDropdown","","container","body",1,"d-inline-block"],["ngbDropdownToggle","",3,"click","disabled","id"],["aria-hidden","true"],["ngbDropdownMenu",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["ngbDropdownItem","",3,"click"],["ngbDropdownItem","",3,"click","mouseover",4,"ngIf"],["ngbDropdownItem","",3,"click","mouseover"],["ngbDropdown","","placement","right left",3,"click","mouseover","mouseleave"],["class","submenu-toggle","ngbDropdownToggle","",3,"id",4,"ngIf"],["ngbDropdownToggle","",1,"submenu-toggle",3,"id"],[1,"fa-solid","fa-angle-right","submenu-icon"]],template:function(n,r){n&1&&d(0,je,2,1,"ng-container",4),n&2&&l("translocoRead","actionable")},dependencies:[L,ht,R,ut,gt,ae,se,re,oe,Ce,Y],styles:[`.dropdown-toggle[_ngcontent-%COMP%]:after{content:none!important}.submenu-toggle[_ngcontent-%COMP%]{display:block;width:100%;padding:var(--bs-dropdown-item-padding-y) var(--bs-dropdown-item-padding-x);font-weight:400;text-align:inherit;border:0;color:var(--dropdown-item-text-color);background-color:var(--dropdown-item-bg-color)}.submenu-toggle[_ngcontent-%COMP%]:hover{color:var(--dropdown-item-text-color);background-color:var(--dropdown-item-hover-bg-color);cursor:pointer}.submenu-toggle[_ngcontent-%COMP%]:focus-visible{color:var(--dropdown-item-text-color);background-color:var(--dropdown-item-hover-bg-color)}.submenu-icon[_ngcontent-%COMP%]{float:right;padding:var(--bs-dropdown-item-padding-y) 0}
/*# sourceMappingURL=card-actionables.component-LIRBAHNQ.css.map */`],changeDetection:0});let i=o;return i})();var ye=(()=>{let o=class o{constructor(e,n){this.actionFactory=n,this.debug=!1,this.prevIndex=0,this.selectedCards={},this.dataSourceMax={},this.isShiftDown=!1,this.actionsSource=new vt(1),this.actions$=this.actionsSource.asObservable(),this.selectionsSource=new vt(1),this.selections$=this.selectionsSource.asObservable(),e.events.pipe(ct(r=>r instanceof jt)).subscribe(()=>{this.deselectAll(),this.dataSourceMax={},this.prevIndex=0})}handleCardSelection(e,n,r,s){this.isShiftDown?e===this.prevDataSource?(this.debugLog("Selecting "+e+" cards from "+this.prevIndex+" to "+n+" as "+!s),this.selectCards(e,this.prevIndex,n,!s)):n>this.prevIndex?(this.debugLog("Selecting "+this.prevDataSource+" cards from "+this.prevIndex+" to "+this.dataSourceMax[this.prevDataSource]),this.selectCards(this.prevDataSource,this.prevIndex,this.dataSourceMax[this.prevDataSource],!s),this.debugLog("Selecting "+e+" cards from 0 to "+n),this.selectCards(e,0,n,!s)):(this.debugLog("Selecting "+this.prevDataSource+" cards from 0 to "+this.prevIndex),this.selectCards(this.prevDataSource,this.prevIndex,0,!s),this.debugLog("Selecting "+e+" cards from "+n+" to "+r),this.selectCards(e,n,r,!s)):(this.debugLog("Selecting "+e+" cards at "+n),this.selectCards(e,n,n,!s)),this.prevIndex=n,this.prevDataSource=e,this.dataSourceMax[e]=r,this.actionsSource.next(this.getActions(()=>{}))}isCardSelected(e,n){return this.selectedCards.hasOwnProperty(e)&&this.selectedCards[e].hasOwnProperty(n)?this.selectedCards[e][n]:!1}selectCards(e,n,r,s){if(this.selectedCards.hasOwnProperty(e)||(this.selectedCards[e]={}),n===r){this.selectedCards[e][r]=s,this.selectionsSource.next(this.totalSelections());return}if(n>r)for(let p=r;p<=n;p++)this.selectedCards[e][p]=s;for(let p=n;p<=r;p++)this.selectedCards[e][p]=s;this.selectionsSource.next(this.totalSelections())}deselectAll(){this.selectedCards={},this.selectionsSource.next(0)}hasSelections(){return Object.keys(this.selectedCards).filter(n=>Object.values(this.selectedCards[n]).filter(r=>r).length>0).length>0}totalSelections(){let e=0;return Object.keys(this.selectedCards).forEach(r=>{e+=Object.values(this.selectedCards[r]).filter(s=>s).length}),e}getSelectedCardsForSource(e){if(!this.selectedCards.hasOwnProperty(e))return[];let n=[];for(let r in this.selectedCards[e])this.selectedCards[e][r]&&n.push(r);return n}getActions(e){let n=[v.AddToReadingList,v.MarkAsRead,v.MarkAsUnread,v.AddToCollection,v.Delete,v.AddToWantToReadList,v.RemoveFromWantToReadList];return Object.keys(this.selectedCards).filter(r=>r==="series").length>0?this.applyFilterToList(this.actionFactory.getSeriesActions(e),n):Object.keys(this.selectedCards).filter(r=>r==="bookmark").length>0?this.actionFactory.getBookmarkActions(e):Object.keys(this.selectedCards).filter(r=>r==="sideNavStream").length>0?this.applyFilterToList(this.actionFactory.getSideNavStreamActions(e),[v.MarkAsInvisible,v.MarkAsVisible]):Object.keys(this.selectedCards).filter(r=>r==="collection").length>0?this.applyFilterToList(this.actionFactory.getCollectionTagActions(e),[v.Promote,v.UnPromote,v.Delete]):this.applyFilterToList(this.actionFactory.getVolumeActions(e),n)}debugLog(e,n){this.debug&&(n!==void 0?console.log(e,n):console.log(e))}applyFilter(e,n){let r=!1;return(e.action===v.Submenu||n.includes(e.action))&&(r=!0),e.children===null||e.children?.length===0||(e.children=e.children.filter(s=>this.applyFilter(s,n))),r}applyFilterToList(e,n){return e.map(s=>yt({},s)).filter(s=>this.applyFilter(s,n))}};o.\u0275fac=function(n){return new(n||o)(xt(Zt),xt(ft))},o.\u0275prov=St({token:o,factory:o.\u0275fac,providedIn:"root"});let i=o;return i})();function Ze(i,o){if(i&1&&(x(),m(0,"linearGradient"),g(1,"stop",5)(2,"stop",6),u()),i&2){let t=c(2);b("id",t.svg.outerLinearGradient.id),a(),b("stop-color",t.svg.outerLinearGradient.colorStop1)("stop-opacity",1),a(),b("stop-color",t.svg.outerLinearGradient.colorStop2)("stop-opacity",1)}}function Ke(i,o){if(i&1&&(x(),m(0,"radialGradient"),g(1,"stop",5)(2,"stop",6),u()),i&2){let t=c(2);b("id",t.svg.radialGradient.id),a(),b("stop-color",t.svg.radialGradient.colorStop1)("stop-opacity",1),a(),b("stop-color",t.svg.radialGradient.colorStop2)("stop-opacity",1)}}function Ye(i,o){if(i&1&&(x(),g(0,"circle")),i&2){let t=c(3);b("cx",t.svg.backgroundCircle.cx)("cy",t.svg.backgroundCircle.cy)("r",t.svg.backgroundCircle.r)("fill",t.svg.backgroundCircle.fill)("fill-opacity",t.svg.backgroundCircle.fillOpacity)("stroke",t.svg.backgroundCircle.stroke)("stroke-width",t.svg.backgroundCircle.strokeWidth)}}function Qe(i,o){if(i&1&&(x(),g(0,"circle")),i&2){let t=c(3);et("fill","url(",t.window.location.href,"#",t.svg.radialGradient.id,")"),b("cx",t.svg.backgroundCircle.cx)("cy",t.svg.backgroundCircle.cy)("r",t.svg.backgroundCircle.r)("fill-opacity",t.svg.backgroundCircle.fillOpacity)("stroke",t.svg.backgroundCircle.stroke)("stroke-width",t.svg.backgroundCircle.strokeWidth)}}function qe(i,o){if(i&1&&(x(),_(0),d(1,Ye,1,7,"circle",2)(2,Qe,1,9,"circle",2),f()),i&2){let t=c(2);a(),l("ngIf",!t.options.backgroundGradient),a(),l("ngIf",t.options.backgroundGradient)}}function Je(i,o){if(i&1&&(x(),g(0,"circle")),i&2){let t=c(2);b("cx",t.svg.circle.cx)("cy",t.svg.circle.cy)("r",t.svg.circle.r)("fill",t.svg.circle.fill)("stroke",t.svg.circle.stroke)("stroke-width",t.svg.circle.strokeWidth)}}function Xe(i,o){if(i&1&&(x(),g(0,"path")),i&2){let t=c(3);b("d",t.svg.path.d)("stroke",t.svg.path.stroke)("stroke-width",t.svg.path.strokeWidth)("stroke-linecap",t.svg.path.strokeLinecap)("fill",t.svg.path.fill)}}function ti(i,o){if(i&1&&(x(),g(0,"path")),i&2){let t=c(3);et("stroke","url(",t.window.location.href,"#",t.svg.outerLinearGradient.id,")"),b("d",t.svg.path.d)("stroke-width",t.svg.path.strokeWidth)("stroke-linecap",t.svg.path.strokeLinecap)("fill",t.svg.path.fill)}}function ei(i,o){if(i&1&&(x(),_(0),d(1,Xe,1,5,"path",2)(2,ti,1,7,"path",2),f()),i&2){let t=c(2);a(),l("ngIf",!t.options.outerStrokeGradient),a(),l("ngIf",t.options.outerStrokeGradient)}}function ii(i,o){if(i&1&&(x(),m(0,"tspan"),S(1),u()),i&2){let t=o.$implicit,e=c(4);b("x",e.svg.title.x)("y",e.svg.title.y)("dy",t.dy)("font-size",e.svg.title.fontSize)("font-weight",e.svg.title.fontWeight)("fill",e.svg.title.color),a(),G(t.span)}}function ni(i,o){if(i&1&&(x(),_(0),d(1,ii,2,7,"tspan",8),f()),i&2){let t=c(3);a(),l("ngForOf",t.svg.title.tspans)}}function oi(i,o){if(i&1&&(x(),m(0,"tspan"),S(1),u()),i&2){let t=c(3);b("font-size",t.svg.units.fontSize)("font-weight",t.svg.units.fontWeight)("fill",t.svg.units.color),a(),G(t.svg.units.text)}}function ri(i,o){if(i&1&&(x(),m(0,"tspan"),S(1),u()),i&2){let t=o.$implicit,e=c(4);b("x",e.svg.subtitle.x)("y",e.svg.subtitle.y)("dy",t.dy)("font-size",e.svg.subtitle.fontSize)("font-weight",e.svg.subtitle.fontWeight)("fill",e.svg.subtitle.color),a(),G(t.span)}}function si(i,o){if(i&1&&(x(),_(0),d(1,ri,2,7,"tspan",8),f()),i&2){let t=c(3);a(),l("ngForOf",t.svg.subtitle.tspans)}}function ai(i,o){if(i&1&&(x(),m(0,"text",7),d(1,ni,2,1,"ng-container",2)(2,oi,2,4,"tspan",2)(3,si,2,1,"ng-container",2),u()),i&2){let t=c(2);b("x",t.svg.circle.cx)("y",t.svg.circle.cy)("text-anchor",t.svg.title.textAnchor),a(),l("ngIf",t.options.showTitle),a(),l("ngIf",t.options.showUnits),a(),l("ngIf",t.options.showSubtitle)}}function ci(i,o){if(i&1&&(x(),g(0,"image",9)),i&2){let t=c(2);b("height",t.svg.image.height)("width",t.svg.image.width)("href",t.svg.image.src,null,"xlink")("x",t.svg.image.x)("y",t.svg.image.y)}}function li(i,o){if(i&1){let t=A();x(),m(0,"svg",1),O("click",function(n){T(t);let r=c();return F(r.emitClickEvent(n))}),m(1,"defs"),d(2,Ze,3,5,"linearGradient",2)(3,Ke,3,5,"radialGradient",2),u(),d(4,qe,3,2,"ng-container",2)(5,Je,1,6,"circle",2)(6,ei,3,2,"ng-container",2)(7,ai,4,6,"text",3)(8,ci,1,5,"image",4),u()}if(i&2){let t=c();b("viewBox",t.svg.viewBox)("height",t.svg.height)("width",t.svg.width)("class",t.options.class),a(2),l("ngIf",t.options.outerStrokeGradient),a(),l("ngIf",t.options.backgroundGradient),a(),l("ngIf",t.options.showBackground),a(),l("ngIf",t.options.showInnerStroke),a(),l("ngIf",+t.options.percent!=0||t.options.showZeroOuterStroke),a(),l("ngIf",!t.options.showImage&&(t.options.showTitle||t.options.showUnits||t.options.showSubtitle)),a(),l("ngIf",t.options.showImage)}}var J=class{constructor(){this.class="",this.backgroundGradient=!1,this.backgroundColor="transparent",this.backgroundGradientStopColor="transparent",this.backgroundOpacity=1,this.backgroundStroke="transparent",this.backgroundStrokeWidth=0,this.backgroundPadding=5,this.percent=0,this.radius=90,this.space=4,this.toFixed=0,this.maxPercent=1e3,this.renderOnClick=!0,this.units="%",this.unitsFontSize="10",this.unitsFontWeight="normal",this.unitsColor="#444444",this.outerStrokeGradient=!1,this.outerStrokeWidth=8,this.outerStrokeColor="#78C000",this.outerStrokeGradientStopColor="transparent",this.outerStrokeLinecap="round",this.innerStrokeColor="#C7E596",this.innerStrokeWidth=4,this.titleFormat=void 0,this.title="auto",this.titleColor="#444444",this.titleFontSize="20",this.titleFontWeight="normal",this.subtitleFormat=void 0,this.subtitle="progress",this.subtitleColor="#A9A9A9",this.subtitleFontSize="10",this.subtitleFontWeight="normal",this.imageSrc=void 0,this.imageHeight=0,this.imageWidth=0,this.animation=!0,this.animateTitle=!0,this.animateSubtitle=!1,this.animationDuration=500,this.showTitle=!0,this.showSubtitle=!0,this.showUnits=!0,this.showImage=!1,this.showBackground=!0,this.showInnerStroke=!0,this.clockwise=!0,this.responsive=!1,this.startFromZero=!0,this.showZeroOuterStroke=!0,this.lazy=!1}},Se=(()=>{class i{constructor(t,e,n,r){this.ngZone=e,this.elRef=n,this.onClick=new Z,this.svgElement=null,this.isInViewport=!1,this.onViewportChanged=new Z,this._viewportChangedSubscriber=null,this.options=new J,this.defaultOptions=new J,this._lastPercent=0,this._gradientUUID=null,this.render=()=>{this.applyOptions(),this.options.lazy?(this.svgElement===null&&this.draw(this._lastPercent),this.isInViewport&&(this.options.animation&&this.options.animationDuration>0?this.animate(this._lastPercent,this.options.percent):this.draw(this.options.percent),this._lastPercent=this.options.percent)):(this.options.animation&&this.options.animationDuration>0?this.animate(this._lastPercent,this.options.percent):this.draw(this.options.percent),this._lastPercent=this.options.percent)},this.polarToCartesian=(s,p,C,h)=>{let y=h*Math.PI/180,w=s+Math.sin(y)*C,I=p-Math.cos(y)*C;return{x:w,y:I}},this.draw=s=>{s=s===void 0?this.options.percent:Math.abs(s);let p=s>100?100:s,C=this.options.radius*2+this.options.outerStrokeWidth*2;this.options.showBackground&&(C+=this.options.backgroundStrokeWidth*2+this.max(0,this.options.backgroundPadding*2));let h={x:C/2,y:C/2},y={x:h.x,y:h.y-this.options.radius},w=this.polarToCartesian(h.x,h.y,this.options.radius,360*(this.options.clockwise?p:100-p)/100);p===100&&(w.x=w.x+(this.options.clockwise?-.01:.01));let I,X;p>50?[I,X]=this.options.clockwise?[1,1]:[1,0]:[I,X]=this.options.clockwise?[0,1]:[0,0];let $=this.options.animateTitle?s:this.options.percent,Me=$>this.options.maxPercent?`${this.options.maxPercent.toFixed(this.options.toFixed)}+`:$.toFixed(this.options.toFixed),Oe=this.options.animateSubtitle?s:this.options.percent,U={x:h.x,y:h.y,textAnchor:"middle",color:this.options.titleColor,fontSize:this.options.titleFontSize,fontWeight:this.options.titleFontWeight,texts:[],tspans:[]};if(this.options.titleFormat!==void 0&&this.options.titleFormat.constructor.name==="Function"){let N=this.options.titleFormat($);N instanceof Array?U.texts=[...N]:U.texts.push(N.toString())}else this.options.title==="auto"?U.texts.push(Me):this.options.title instanceof Array?U.texts=[...this.options.title]:U.texts.push(this.options.title.toString());let j={x:h.x,y:h.y,textAnchor:"middle",color:this.options.subtitleColor,fontSize:this.options.subtitleFontSize,fontWeight:this.options.subtitleFontWeight,texts:[],tspans:[]};if(this.options.subtitleFormat!==void 0&&this.options.subtitleFormat.constructor.name==="Function"){let N=this.options.subtitleFormat(Oe);N instanceof Array?j.texts=[...N]:j.texts.push(N.toString())}else this.options.subtitle instanceof Array?j.texts=[...this.options.subtitle]:j.texts.push(this.options.subtitle.toString());let De={text:`${this.options.units}`,fontSize:this.options.unitsFontSize,fontWeight:this.options.unitsFontWeight,color:this.options.unitsColor},rt=0,st=1;if(this.options.showTitle&&(rt+=U.texts.length),this.options.showSubtitle&&(rt+=j.texts.length),this.options.showTitle)for(let N of U.texts)U.tspans.push({span:N,dy:this.getRelativeY(st,rt)}),st++;if(this.options.showSubtitle)for(let N of j.texts)j.tspans.push({span:N,dy:this.getRelativeY(st,rt)}),st++;this._gradientUUID===null&&(this._gradientUUID=this.uuid()),this.svg={viewBox:`0 0 ${C} ${C}`,width:this.options.responsive?"100%":C,height:this.options.responsive?"100%":C,backgroundCircle:{cx:h.x,cy:h.y,r:this.options.radius+this.options.outerStrokeWidth/2+this.options.backgroundPadding,fill:this.options.backgroundColor,fillOpacity:this.options.backgroundOpacity,stroke:this.options.backgroundStroke,strokeWidth:this.options.backgroundStrokeWidth},path:{d:`M ${y.x} ${y.y}
        A ${this.options.radius} ${this.options.radius} 0 ${I} ${X} ${w.x} ${w.y}`,stroke:this.options.outerStrokeColor,strokeWidth:this.options.outerStrokeWidth,strokeLinecap:this.options.outerStrokeLinecap,fill:"none"},circle:{cx:h.x,cy:h.y,r:this.options.radius-this.options.space-this.options.outerStrokeWidth/2-this.options.innerStrokeWidth/2,fill:"none",stroke:this.options.innerStrokeColor,strokeWidth:this.options.innerStrokeWidth},title:U,units:De,subtitle:j,image:{x:h.x-this.options.imageWidth/2,y:h.y-this.options.imageHeight/2,src:this.options.imageSrc,width:this.options.imageWidth,height:this.options.imageHeight},outerLinearGradient:{id:"outer-linear-"+this._gradientUUID,colorStop1:this.options.outerStrokeColor,colorStop2:this.options.outerStrokeGradientStopColor==="transparent"?"#FFF":this.options.outerStrokeGradientStopColor},radialGradient:{id:"radial-"+this._gradientUUID,colorStop1:this.options.backgroundColor,colorStop2:this.options.backgroundGradientStopColor==="transparent"?"#FFF":this.options.backgroundGradientStopColor}}},this.getAnimationParameters=(s,p)=>{let h,y,w,I=this.options.startFromZero||s<0?0:s,X=p<0?0:this.min(p,this.options.maxPercent),$=Math.abs(Math.round(X-I));return $>=100?(h=100,!this.options.animateTitle&&!this.options.animateSubtitle?y=1:y=Math.round($/h)):(h=$,y=1),w=Math.round(this.options.animationDuration/h),w<10&&(w=10,h=this.options.animationDuration/w,!this.options.animateTitle&&!this.options.animateSubtitle&&$>100?y=Math.round(100/h):y=Math.round($/h)),y<1&&(y=1),{times:h,step:y,interval:w}},this.animate=(s,p)=>{this._timerSubscription&&!this._timerSubscription.closed&&this._timerSubscription.unsubscribe();let C=this.options.startFromZero?0:s,h=p,{step:y,interval:w}=this.getAnimationParameters(C,h),I=C;C<h?this._timerSubscription=at(0,w).subscribe(()=>{I+=y,I<=h?!this.options.animateTitle&&!this.options.animateSubtitle&&I>=100?(this.draw(h),this._timerSubscription.unsubscribe()):this.draw(I):(this.draw(h),this._timerSubscription.unsubscribe())}):this._timerSubscription=at(0,w).subscribe(()=>{I-=y,I>=h?!this.options.animateTitle&&!this.options.animateSubtitle&&h>=100?(this.draw(h),this._timerSubscription.unsubscribe()):this.draw(I):(this.draw(h),this._timerSubscription.unsubscribe())})},this.applyOptions=()=>{for(let s of Object.keys(this.options))this.hasOwnProperty(s)&&this[s]!==void 0?this.options[s]=this[s]:this.templateOptions&&this.templateOptions[s]!==void 0&&(this.options[s]=this.templateOptions[s]);this.options.radius=Math.abs(+this.options.radius),this.options.space=+this.options.space,this.options.percent=+this.options.percent>0?+this.options.percent:0,this.options.maxPercent=Math.abs(+this.options.maxPercent),this.options.animationDuration=Math.abs(this.options.animationDuration),this.options.outerStrokeWidth=Math.abs(+this.options.outerStrokeWidth),this.options.innerStrokeWidth=Math.abs(+this.options.innerStrokeWidth),this.options.backgroundPadding=+this.options.backgroundPadding},this.getRelativeY=(s,p)=>(-.18+1*(s-p/2)).toFixed(2)+"em",this.min=(s,p)=>s<p?s:p,this.max=(s,p)=>s>p?s:p,this.uuid=()=>{var s=new Date().getTime(),p="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(C){var h=(s+Math.random()*16)%16|0;return s=Math.floor(s/16),(C=="x"?h:h&3|8).toString(16)});return p},this.checkViewport=()=>{this.findSvgElement();let s=this.isInViewport;this.isInViewport=this.isElementInViewport(this.svgElement),s!==this.isInViewport&&this.onViewportChanged.observers.length>0&&this.ngZone.run(()=>{this.onViewportChanged.emit({oldValue:s,newValue:this.isInViewport})})},this.onScroll=s=>{this.checkViewport()},this.loadEventsForLazyMode=()=>{if(this.options.lazy){this.ngZone.runOutsideAngular(()=>{this.document.addEventListener("scroll",this.onScroll,!0),this.window.addEventListener("resize",this.onScroll,!0)}),this._viewportChangedSubscriber===null&&(this._viewportChangedSubscriber=this.onViewportChanged.subscribe(({oldValue:p,newValue:C})=>{C&&this.render()}));let s=at(0,50).subscribe(()=>{this.svgElement===null?this.checkViewport():s.unsubscribe()})}},this.unloadEventsForLazyMode=()=>{this.document.removeEventListener("scroll",this.onScroll,!0),this.window.removeEventListener("resize",this.onScroll,!0),this._viewportChangedSubscriber!==null&&(this._viewportChangedSubscriber.unsubscribe(),this._viewportChangedSubscriber=null)},this.document=r.get($t),this.window=this.document.defaultView,Object.assign(this.options,t),Object.assign(this.defaultOptions,t)}emitClickEvent(t){this.options.renderOnClick&&this.animate(0,this.options.percent),this.onClick.observers.length>0&&this.onClick.emit(t)}isDrawing(){return this._timerSubscription&&!this._timerSubscription.closed}findSvgElement(){if(this.svgElement===null){let t=this.elRef.nativeElement.getElementsByTagName("svg");t.length>0&&(this.svgElement=t[0])}}isElementInViewport(t){if(t==null)return!1;let e=t.getBoundingClientRect(),n=t.parentNode,r;do{if(r=n.getBoundingClientRect(),e.top>=r.bottom||e.bottom<=r.top||e.left>=r.right||e.right<=r.left)return!1;n=n.parentNode}while(n!=this.document.body);return!(e.top>=(this.window.innerHeight||this.document.documentElement.clientHeight)||e.bottom<=0||e.left>=(this.window.innerWidth||this.document.documentElement.clientWidth)||e.right<=0)}ngOnInit(){this.loadEventsForLazyMode()}ngOnDestroy(){this.unloadEventsForLazyMode()}ngOnChanges(t){this.render(),"lazy"in t&&(t.lazy.currentValue?this.loadEventsForLazyMode():this.unloadEventsForLazyMode())}}return i.\u0275fac=function(t){return new(t||i)(tt(J),tt(Ot),tt(Pt),tt(Ft))},i.\u0275cmp=P({type:i,selectors:[["circle-progress"]],inputs:{name:"name",class:"class",backgroundGradient:"backgroundGradient",backgroundColor:"backgroundColor",backgroundGradientStopColor:"backgroundGradientStopColor",backgroundOpacity:"backgroundOpacity",backgroundStroke:"backgroundStroke",backgroundStrokeWidth:"backgroundStrokeWidth",backgroundPadding:"backgroundPadding",radius:"radius",space:"space",percent:"percent",toFixed:"toFixed",maxPercent:"maxPercent",renderOnClick:"renderOnClick",units:"units",unitsFontSize:"unitsFontSize",unitsFontWeight:"unitsFontWeight",unitsColor:"unitsColor",outerStrokeGradient:"outerStrokeGradient",outerStrokeWidth:"outerStrokeWidth",outerStrokeColor:"outerStrokeColor",outerStrokeGradientStopColor:"outerStrokeGradientStopColor",outerStrokeLinecap:"outerStrokeLinecap",innerStrokeColor:"innerStrokeColor",innerStrokeWidth:"innerStrokeWidth",titleFormat:"titleFormat",title:"title",titleColor:"titleColor",titleFontSize:"titleFontSize",titleFontWeight:"titleFontWeight",subtitleFormat:"subtitleFormat",subtitle:"subtitle",subtitleColor:"subtitleColor",subtitleFontSize:"subtitleFontSize",subtitleFontWeight:"subtitleFontWeight",imageSrc:"imageSrc",imageHeight:"imageHeight",imageWidth:"imageWidth",animation:"animation",animateTitle:"animateTitle",animateSubtitle:"animateSubtitle",animationDuration:"animationDuration",showTitle:"showTitle",showSubtitle:"showSubtitle",showUnits:"showUnits",showImage:"showImage",showBackground:"showBackground",showInnerStroke:"showInnerStroke",clockwise:"clockwise",responsive:"responsive",startFromZero:"startFromZero",showZeroOuterStroke:"showZeroOuterStroke",lazy:"lazy",templateOptions:[wt.None,"options","templateOptions"]},outputs:{onClick:"onClick"},features:[Tt],decls:1,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","preserveAspectRatio","xMidYMid meet",3,"click",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","preserveAspectRatio","xMidYMid meet",3,"click"],[4,"ngIf"],["alignment-baseline","baseline",4,"ngIf"],["preserveAspectRatio","none",4,"ngIf"],["offset","5%"],["offset","95%"],["alignment-baseline","baseline"],[4,"ngFor","ngForOf"],["preserveAspectRatio","none"]],template:function(t,e){t&1&&d(0,li,9,11,"svg",0),t&2&&l("ngIf",e.svg)},dependencies:[ht,R],encapsulation:2}),i})(),ke=(()=>{class i{static forRoot(t={}){return{ngModule:i,providers:[{provide:J,useValue:t}]}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=It({type:i}),i.\u0275inj=kt({imports:[L]}),i})();var di=(i,o)=>({width:i,height:o}),mi=i=>({number:i}),hi=i=>({"font-size":i});function ui(i,o){if(i&1&&(m(0,"div",4),g(1,"i",5),u()),i&2){let t=c(2);l("ngClass",z(2,mi,t.center)),a(),l("ngStyle",z(4,hi,t.fontSize))}}function gi(i,o){if(i&1&&(_(0),d(1,ui,2,6,"div",1),m(2,"div",2),g(3,"circle-progress",3),u(),f()),i&2){let t=c();a(),l("ngIf",t.showIcon),a(),l("ngStyle",Gt(17,di,t.width,t.height)),a(),l("percent",t.currentValue)("radius",100)("outerStrokeWidth",15)("innerStrokeWidth",0)("space",0)("backgroundPadding",0)("outerStrokeColor",t.outerStrokeColor)("innerStrokeColor",t.innerStrokeColor)("showSubtitle",!1)("animation",t.animation)("animationDuration",300)("startFromZero",!1)("responsive",!0)("backgroundOpacity",.5)("backgroundColor",t.backgroundColor)}}var we=(()=>{let o=class o{constructor(){this.currentValue=0,this.animation=!0,this.innerStrokeColor="transparent",this.outerStrokeColor="#4ac694",this.backgroundColor="#000",this.fontSize="36px",this.showIcon=!0,this.width="100px",this.height="100px",this.center=!0}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=P({type:o,selectors:[["app-circular-loader"]],inputs:{currentValue:"currentValue",animation:"animation",innerStrokeColor:"innerStrokeColor",outerStrokeColor:"outerStrokeColor",backgroundColor:"backgroundColor",fontSize:"fontSize",showIcon:"showIcon",width:"width",height:"height",center:"center"},standalone:!0,features:[E],decls:1,vars:1,consts:[[4,"ngIf"],["class","indicator",3,"ngClass",4,"ngIf"],[3,"ngStyle"],["outerStrokeLinecap","butt","titleFontSize","24","unitsFontSize","24",3,"percent","radius","outerStrokeWidth","innerStrokeWidth","space","backgroundPadding","outerStrokeColor","innerStrokeColor","showSubtitle","animation","animationDuration","startFromZero","responsive","backgroundOpacity","backgroundColor"],[1,"indicator",3,"ngClass"],["aria-hidden","true",1,"fa","fa-angle-double-down",3,"ngStyle"]],template:function(n,r){n&1&&d(0,gi,4,20,"ng-container",0),n&2&&l("ngIf",r.currentValue>0)},dependencies:[L,Ut,R,Bt,ke,Se],styles:[`.number[_ngcontent-%COMP%]{position:absolute;top:50%;left:46%;font-size:18px}.indicator[_ngcontent-%COMP%]{font-weight:500;margin-left:2px;z-index:10;color:var(--primary-color);animation:MoveUpDown 1s linear infinite}
/*# sourceMappingURL=circular-loader.component-TBPLICJJ.css.map */`],changeDetection:0});let i=o;return i})();var _i=i=>({percentage:i});function fi(i,o){if(i&1&&(m(0,"span",2),g(1,"app-circular-loader",3),m(2,"span",4),S(3),u()()),i&2){let t=o.ngIf,e=c().$implicit;a(),l("currentValue",t.progress),a(2),K(" ",e("progress",z(2,_i,t.progress))," ")}}function vi(i,o){if(i&1&&(_(0),d(1,fi,4,4,"span",1),D(2,"async"),f()),i&2){let t=c();a(),l("ngIf",V(2,1,t.download$))}}var Ie=(()=>{let o=class o{};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=P({type:o,selectors:[["app-download-indicator"]],inputs:{download$:"download$"},standalone:!0,features:[E],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],["class","download",4,"ngIf"],[1,"download"],[3,"currentValue"],["role","status",1,"visually-hidden"]],template:function(n,r){n&1&&d(0,vi,3,3,"ng-container",0),n&2&&l("translocoRead","download-indicator")},dependencies:[L,R,gt,we,Y],styles:[`.download[_ngcontent-%COMP%]{width:80px;height:80px}
/*# sourceMappingURL=download-indicator.component-GDIHBOFV.css.map */`],changeDetection:0});let i=o;return i})();var Te=(()=>{let o=class o{transform(e){switch(e){case W.EPUB:return"fa fa-book";case W.ARCHIVE:return"fa-solid fa-file-zipper";case W.IMAGE:return"fa-solid fa-file-image";case W.PDF:return"fa-solid fa-file-pdf";case W.UNKNOWN:return"fa-solid fa-file-circle-question"}}};o.\u0275fac=function(n){return new(n||o)},o.\u0275pipe=lt({name:"mangaFormatIcon",type:o,pure:!0,standalone:!0});let i=o;return i})();function Ci(i,o){if(i&1&&(m(0,"span"),g(1,"i",1),m(2,"span",2),S(3),u()()),i&2){let t=c().$implicit;a(3),G(t("promoted"))}}function xi(i,o){if(i&1&&(_(0),d(1,Ci,4,1,"span"),f()),i&2){let t=c();a(),M(1,t.promoted?1:-1)}}var Fe=(()=>{let o=class o{constructor(){this.promoted=!1}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=P({type:o,selectors:[["app-promoted-icon"]],inputs:{promoted:"promoted"},standalone:!0,features:[E],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],["aria-hidden","true","title","Promoted",1,"fa","fa-angle-double-up","ms-1"],[1,"visually-hidden"]],template:function(n,r){n&1&&d(0,xi,2,1,"ng-container",0),n&2&&l("translocoRead","promoted-icon")},dependencies:[Y],styles:["/*# sourceMappingURL=promoted-icon.component-6K2HTRBK.css.map */"],changeDetection:0});let i=o;return i})();var bi=["*"];function yi(i,o){if(i&1&&(_(0),g(1,"i",1),D(2,"mangaFormatIcon"),D(3,"mangaFormat"),At(4),f()),i&2){let t=c();a(),B("",V(2,4,t.format)," me-1"),Et("title",V(3,6,t.format))}}var Pe=(()=>{let o=class o{constructor(){this.MangaFormat=W,this.format=W.UNKNOWN}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=P({type:o,selectors:[["app-series-format"]],inputs:{format:"format"},standalone:!0,features:[E],ngContentSelectors:bi,decls:1,vars:1,consts:[[4,"ngIf"],["aria-hidden","true",3,"title"]],template:function(n,r){n&1&&(Dt(),d(0,yi,5,8,"ng-container",0)),n&2&&l("ngIf",r.format!==r.MangaFormat.UNKNOWN)},dependencies:[L,R,Te,ge],styles:["/*# sourceMappingURL=series-format.component-V24BASKY.css.map */"],changeDetection:0});let i=o;return i})();var Si=["subtitle"],ki=()=>({standalone:!0}),wi=i=>({$implicit:i}),Ii=i=>["/library",i];function Ti(i,o){if(i&1&&g(0,"app-image",11),i&2){let t=c(2);l("imageUrl",t.imageUrl)}}function Fi(i,o){if(i&1&&g(0,"app-image",11),i&2){let t=c(2);l("imageUrl",t.imageService.errorImage)}}function Pi(i,o){if(i&1&&(m(0,"p",12),D(1,"number"),g(2,"ngb-progressbar",13),u()),i&2){let t=c(2);nt("ngbTooltip","",zt(1,4,t.read/t.total*100,"1.0-1"),"% Read"),a(2),l("value",t.read)("max",t.total)}}function Mi(i,o){if(i&1&&(m(0,"div",6),S(1),u()),i&2){let t=c().$implicit;a(),K(" ",t("cannot-read")," ")}}function Oi(i,o){i&1&&(m(0,"div",7),g(1,"div",14),u())}function Di(i,o){if(i&1){let t=A();m(0,"div",15),O("click",function(n){T(t);let r=c(2);return F(r.handleSelection(n))}),g(1,"input",16),u()}if(i&2){let t=c(2);B("bulk-mode ",t.bulkSelectionService.hasSelections()?"always-show":"",""),a(),et("aria-labelledby","",t.title,"_",t.entity.id,""),l("ngModel",t.selected)("ngModelOptions",Nt(8,ki))}}function Ai(i,o){if(i&1&&(m(0,"div",8)(1,"span",17),S(2),u()()),i&2){let t=c(2);a(2),G(t.count)}}function Ei(i,o){if(i&1&&(m(0,"div")(1,"div",18),g(2,"span",19),u()()),i&2){let t=c(),e=c(2);B("overlay-information ",e.centerOverlay?"overlay-information--centered":"",""),a(2),l("ngbTooltip",t)("innerHTML",t,Mt)}}function Vi(i,o){if(i&1&&d(0,Ei,3,5,"div"),i&2){let t=o;M(0,t!==""||t!==null?0:-1)}}function Ri(i,o){if(i&1){let t=A();m(0,"span",26)(1,"app-card-actionables",27),O("actionHandler",function(n){T(t);let r=c(3);return F(r.performAction(n))}),u()()}if(i&2){let t=c(3);a(),l("actions",t.actions)("labelBy",t.title)}}function Li(i,o){if(i&1&&(m(0,"div",24),it(1,28),u()),i&2){let t=c(3);a(),l("ngTemplateOutlet",t.subtitleTemplate)("ngTemplateOutletContext",z(2,wi,t.entity))}}function Wi(i,o){if(i&1&&(m(0,"a",29),S(1),D(2,"sentenceCase"),u()),i&2){let t=c(3);l("routerLink",z(4,Ii,t.libraryId)),a(),K(" ",V(2,2,t.libraryName)," ")}}function Ni(i,o){if(i&1){let t=A();m(0,"div",10)(1,"div")(2,"span",20),O("click",function(n){T(t);let r=c(2);return F(r.handleClick(n))}),g(3,"app-promoted-icon",21)(4,"app-series-format",22),S(5),u(),d(6,Ri,2,2,"span",23),u(),d(7,Li,2,4,"div",24)(8,Wi,3,6,"a",25),u()}if(i&2){let t=c(2);a(2),Vt("id","",t.title,"_",t.entity.id,""),l("ngbTooltip",t.tooltipTitle),a(),l("promoted",t.isPromoted()),a(),l("format",t.format),a(),K(" ",t.title," "),a(),l("ngIf",t.actions&&t.actions.length>0),a(),M(7,t.subtitleTemplate?7:-1),a(),M(8,!t.suppressLibraryLink&&t.libraryName?8:-1)}}function Gi(i,o){if(i&1){let t=A();_(0),m(1,"div")(2,"div",1),O("click",function(n){T(t);let r=c();return F(r.handleClick(n))}),d(3,Ti,1,1,"app-image",2)(4,Fi,1,1),m(5,"div",3),d(6,Pi,3,7,"p"),m(7,"span",4),g(8,"app-download-indicator",5),u()(),d(9,Mi,2,1,"div",6)(10,Oi,2,0,"div",7)(11,Di,2,9,"div")(12,Ai,3,1,"div",8),g(13,"div",9),d(14,Vi,1,1),D(15,"safeHtml"),u(),d(16,Ni,9,10,"div",10),u(),f()}if(i&2){let t,e=c();a(),B("card-item-container card ",e.selected?"selected-highlight":"",""),a(2),M(3,e.total>0||e.suppressArchiveWarning?3:e.total===0&&!e.suppressArchiveWarning?4:-1),a(3),M(6,e.read>0&&e.read<e.total&&e.total>0&&e.read!==e.total?6:-1),a(2),l("download$",e.download$),a(),M(9,e.total===0&&!e.suppressArchiveWarning?9:-1),a(),M(10,e.read===0&&e.total>0?10:-1),a(),M(11,e.allowSelection?11:-1),a(),M(12,e.count>1?12:-1),a(2),M(14,(t=V(15,12,e.overlayInformation))?14:-1,t),a(2),M(16,e.title.length>0||e.actions.length>0?16:-1)}}var vo=(()=>{let o=class o{constructor(){this.destroyRef=k(pt),this.imageService=k(de),this.bulkSelectionService=k(ye),this.libraryService=k(he),this.downloadService=k(fe),this.utilityService=k(pe),this.messageHub=k(qt),this.accountService=k(_t),this.scrollService=k(ve),this.cdRef=k(mt),this.actionFactoryService=k(ft),this.MangaFormat=W,this.imageUrl="",this.title="",this.actions=[],this.read=0,this.total=0,this.suppressLibraryLink=!1,this.selected=!1,this.allowSelection=!1,this.suppressArchiveWarning=!1,this.count=0,this.overlayInformation="",this.centerOverlay=!1,this.clicked=new Z,this.selection=new Z,this.libraryName=void 0,this.libraryId=void 0,this.format=W.UNKNOWN,this.tooltipTitle=this.title,this.download$=null,this.prevTouchTime=0,this.prevOffset=0,this.selectionInProgress=!1}ngOnInit(){if(this.entity.hasOwnProperty("promoted")&&this.entity.hasOwnProperty("title")&&(this.suppressArchiveWarning=!0,this.cdRef.markForCheck()),this.suppressLibraryLink||(this.entity!==void 0&&this.entity.hasOwnProperty("libraryId")&&(this.libraryId=this.entity.libraryId,this.cdRef.markForCheck()),this.libraryId!==void 0&&this.libraryId>0&&this.libraryService.getLibraryName(this.libraryId).pipe(q(this.destroyRef)).subscribe(e=>{this.libraryName=e,this.cdRef.markForCheck()})),this.format=this.entity.format,this.utilityService.isChapter(this.entity)){let e=this.utilityService.asChapter(this.entity),n=e.titleName;if(n===""||n===null||n===void 0){let r=e.volumeTitle;r===""||r===null||r===void 0?this.tooltipTitle=this.title.trim():this.tooltipTitle=(r+" "+this.title).trim()}else this.tooltipTitle=n}else if(this.utilityService.isVolume(this.entity)){let e=this.utilityService.asVolume(this.entity);e.chapters!==void 0&&e.chapters.length>0&&(this.tooltipTitle=e.chapters[0].titleName),this.tooltipTitle===""&&(this.tooltipTitle=e.name)}else if(this.utilityService.isSeries(this.entity))this.tooltipTitle=this.title||this.utilityService.asSeries(this.entity).name;else if(this.entity.hasOwnProperty("expectedDate")){this.suppressArchiveWarning=!0,this.imageUrl="";let e=this.entity,n=e.title.split(":");if(this.overlayInformation=`
              <i class="fa-regular fa-clock mb-2" style="font-size: 26px" aria-hidden="true"></i>
              <div>${n[0]}</div><div>${n[1]}</div>`,this.centerOverlay=!0,e.expectedDate){let r=new _e;this.title="~ "+r.transform(e.expectedDate,"shortDate")}this.cdRef.markForCheck()}this.filterSendTo(),this.accountService.currentUser$.pipe(q(this.destroyRef)).subscribe(e=>{this.user=e}),this.messageHub.messages$.pipe(ct(e=>e.event===Qt.UserProgressUpdate),Ct(e=>e.payload),q(this.destroyRef)).subscribe(e=>{if(!(this.user===void 0||this.user.username!==e.username)&&!(this.utilityService.isChapter(this.entity)&&e.chapterId!==this.entity.id)&&!(this.utilityService.isVolume(this.entity)&&e.volumeId!==this.entity.id)&&!(this.utilityService.isSeries(this.entity)&&e.seriesId!==this.entity.id)){if(this.utilityService.isChapter(this.entity)){let n=this.utilityService.asChapter(this.entity);n.pagesRead=e.pagesRead,this.read=e.pagesRead}if(this.utilityService.isVolume(this.entity)||this.utilityService.isSeries(this.entity))if(this.utilityService.isVolume(this.entity)){let n=this.utilityService.asVolume(this.entity),r=0;n.chapters.filter(p=>p.volumeId===e.volumeId).forEach(p=>{p.pagesRead=e.pagesRead,r+=p.pagesRead}),n.pagesRead=r,this.read=r}else return;this.cdRef.detectChanges()}}),this.download$=this.downloadService.activeDownloads$.pipe(q(this.destroyRef),Ct(e=>this.downloadService.mapToEntityType(e,this.entity)))}onTouchMove(e){this.allowSelection&&(this.selectionInProgress=!1,this.cdRef.markForCheck())}onTouchStart(e){this.allowSelection&&(this.prevTouchTime=e.timeStamp,this.prevOffset=this.scrollService.scrollPosition,this.selectionInProgress=!0)}onTouchEnd(e){if(!this.allowSelection)return;let n=e.timeStamp-this.prevTouchTime,r=this.scrollService.scrollPosition;n>=300&&n<=1e3&&r===this.prevOffset&&this.selectionInProgress&&(this.handleSelection(),e.stopPropagation(),e.preventDefault()),this.prevTouchTime=0,this.selectionInProgress=!1}handleClick(e){if(this.bulkSelectionService.hasSelections()){this.handleSelection();return}this.clicked.emit(this.title)}preventClick(e){e.stopPropagation(),e.preventDefault()}performAction(e){if(e.action==v.Download){if(this.utilityService.isVolume(this.entity)){let n=this.utilityService.asVolume(this.entity);this.downloadService.download("volume",n)}else if(this.utilityService.isChapter(this.entity)){let n=this.utilityService.asChapter(this.entity);this.downloadService.download("chapter",n)}else if(this.utilityService.isSeries(this.entity)){let n=this.utilityService.asSeries(this.entity);this.downloadService.download("series",n)}return}typeof e.callback=="function"&&e.callback(e,this.entity)}isPromoted(){let e=this.entity;return e.hasOwnProperty("promoted")&&e.promoted}handleSelection(e){e&&e.stopPropagation(),this.selection.emit(this.selected),this.cdRef.detectChanges()}filterSendTo(){if(!(!this.actions||this.actions.length===0)){if(this.utilityService.isChapter(this.entity))this.actions=this.actionFactoryService.filterSendToAction(this.actions,this.entity);else if(this.utilityService.isVolume(this.entity)){let e=this.utilityService.asVolume(this.entity);this.actions=this.actionFactoryService.filterSendToAction(this.actions,e.chapters[0])}else if(this.utilityService.isSeries(this.entity)){let e=this.entity}}}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=P({type:o,selectors:[["app-card-item"]],contentQueries:function(n,r,s){if(n&1&&Rt(s,Si,5),n&2){let p;Lt(p=Wt())&&(r.subtitleTemplate=p.first)}},hostBindings:function(n,r){n&1&&O("touchmove",function(p){return r.onTouchMove(p)})("touchstart",function(p){return r.onTouchStart(p)})("touchend",function(p){return r.onTouchEnd(p)})},inputs:{imageUrl:"imageUrl",title:"title",actions:"actions",read:"read",total:"total",suppressLibraryLink:"suppressLibraryLink",entity:"entity",selected:"selected",allowSelection:"allowSelection",suppressArchiveWarning:"suppressArchiveWarning",count:"count",overlayInformation:"overlayInformation",centerOverlay:"centerOverlay"},outputs:{clicked:"clicked",selection:"selection"},standalone:!0,features:[E],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"overlay",3,"click"],["borderRadius",".25rem .25rem 0 0","height","230px","width","158px"],[1,"progress-banner"],[1,"download"],[3,"download$"],[1,"error-banner"],[1,"badge-container"],[1,"count"],[1,"card-overlay"],[1,"card-body"],["borderRadius",".25rem .25rem 0 0","height","230px","width","158px",3,"imageUrl"],[3,"ngbTooltip"],["type","primary","height","5px",3,"value","max"],[1,"not-read-badge"],[3,"click"],["type","checkbox",1,"form-check-input",3,"ngModel","ngModelOptions"],[1,"badge","bg-primary"],[1,"position-relative"],["placement","top",1,"card-title","library","mx-auto",2,"width","auto",3,"ngbTooltip","innerHTML"],["placement","top","tabindex","0",1,"card-title",3,"click","id","ngbTooltip"],[3,"promoted"],[3,"format"],["class","card-actions float-end",4,"ngIf"],[2,"text-align","center"],["routerLinkActive","router-link-active",1,"card-title","library"],[1,"card-actions","float-end"],[3,"actionHandler","actions","labelBy"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["routerLinkActive","router-link-active",1,"card-title","library",3,"routerLink"]],template:function(n,r){n&1&&d(0,Gi,17,14,"ng-container",0),n&2&&l("translocoRead","card-item")},dependencies:[L,R,ut,Ht,me,ce,Ie,ne,te,ee,ie,le,be,ue,Kt,Jt,Y,Xt,Yt,Fe,Pe],styles:[`.error-banner[_ngcontent-%COMP%]{width:160px;height:18px;background-color:var(--toast-error-bg-color);font-size:12px;color:#fff;text-transform:uppercase;text-align:center;position:absolute;top:0;right:0}.selected-highlight[_ngcontent-%COMP%]{outline:2px solid var(--primary-color)}.progress-banner[_ngcontent-%COMP%]{width:160px;height:5px}.progress-banner[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{color:var(--card-progress-bar-color);background-color:transparent}.download[_ngcontent-%COMP%]{width:80px;height:80px;position:absolute;top:25%;right:30%}.badge-container[_ngcontent-%COMP%]{border-radius:4px;display:block;height:230px;left:0;overflow:hidden;pointer-events:none;position:absolute;top:0;width:158px}.not-read-badge[_ngcontent-%COMP%]{position:absolute;top:calc(-1 * var(--card-progress-triangle-size) / 2);right:-14px;z-index:1000;height:var(--card-progress-triangle-size);width:var(--card-progress-triangle-size);background-color:var(--primary-color);transform:rotate(45deg)}.bulk-mode[_ngcontent-%COMP%]{position:absolute;top:5px;left:5px;visibility:hidden}.bulk-mode.always-show[_ngcontent-%COMP%]{visibility:visible!important;width:160px;height:230px}.bulk-mode[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:20px;height:20px;color:var(--checkbox-bg-color)}.overlay[_ngcontent-%COMP%]:hover   .bulk-mode[_ngcontent-%COMP%]{visibility:visible;z-index:110}.overlay[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{top:5px;right:10px;position:absolute}.card-actions[_ngcontent-%COMP%]{position:absolute;top:228px;right:5px;width:20px}.library[_ngcontent-%COMP%]{font-size:13px;text-decoration:none;margin-top:0}
/*# sourceMappingURL=card-item.component-7FF72MYQ.css.map */`],changeDetection:0});let i=o;return i})();export{be as a,ye as b,ke as c,we as d,Ie as e,Te as f,Fe as g,Pe as h,vo as i};
//# sourceMappingURL=chunk-GGQU56QW.js.map
