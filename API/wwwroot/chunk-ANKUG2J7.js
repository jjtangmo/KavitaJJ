import{a as G}from"./chunk-M6Y4BTRD.js";import{a as z}from"./chunk-QL7PCTRN.js";import{a as q}from"./chunk-HOUHXGPA.js";import"./chunk-LAUBKCQL.js";import"./chunk-ZRHV3LXB.js";import{q as J}from"./chunk-SPNNO5LP.js";import{s as L}from"./chunk-E6ZKMAWP.js";import{$ as x,$b as b,Ae as $,Bb as u,Dc as w,Ec as y,Fa as m,Ga as p,Ib as g,Jd as S,Na as M,Pa as T,Rc as B,Rd as P,S as k,Td as W,Vb as c,Wb as a,Yb as _,Zb as h,cc as f,dc as s,id as N,lb as r,mb as R,oc as l,od as O,pc as C,qa as I,qc as v,tc as F,u as A,uc as D,va as E,vc as U,xc as j,z as V}from"./chunk-2LHIXASS.js";function H(n,o){if(n&1&&(_(0),c(1,"span",14),l(2,"+"),a(),l(3),h()),n&2){let t=s(2).$implicit;r(3),v(" ",t("unknowns")," ")}}function K(n,o){if(n&1&&(_(0),c(1,"div",12)(2,"span",13),l(3),w(4,"ageRating"),u(5,H,4,1,"ng-container",10),a()(),h()),n&2){let t=s(2);r(3),v("",y(4,2,t.user==null||t.user.ageRestriction==null?null:t.user.ageRestriction.ageRating)," "),r(2),g("ngIf",(t.user==null||t.user.ageRestriction==null?null:t.user.ageRestriction.ageRating)!==t.AgeRating.NotApplicable&&(t.user==null||t.user.ageRestriction==null?null:t.user.ageRestriction.includeUnknowns))}}function Q(n,o){if(n&1){let t=b();_(0),c(1,"app-restriction-selector",15),f("selected",function(i){m(t);let d=s(2);return p(d.updateRestrictionSelection(i))}),a(),c(2,"div",16)(3,"button",17),f("click",function(){m(t);let i=s(2);return p(i.resetForm())}),l(4),a(),c(5,"button",18),f("click",function(){m(t);let i=s(2);return p(i.saveForm())}),l(6),a()(),h()}if(n&2){let t=s().$implicit,e=s();r(),g("showContext",!1)("member",e.user)("reset",e.reset),r(3),C(t("reset")),r(2),C(t("save"))}}function X(n,o){if(n&1){let t=b();_(0),c(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"h4",7),l(7),a()(),c(8,"div",8)(9,"button",9),w(10,"async"),f("click",function(){m(t);let i=s();return p(i.toggleViewMode())}),l(11),a()()()(),u(12,K,6,4,"ng-container",10),c(13,"div",11,0),U("ngbCollapseChange",function(i){m(t);let d=s();return D(d.isViewMode,i)||(d.isViewMode=i),p(i)}),u(15,Q,7,5,"ng-container",10),a()()(),h()}if(n&2){let t=o.$implicit,e=s();r(7),C(t("age-restriction-label")),r(2),g("disabled",!y(10,6,e.hasChangeAgeRestrictionAbility)),r(2),C(e.isViewMode?t("edit"):t("cancel")),r(),g("ngIf",e.isViewMode),r(),F("ngbCollapse",e.isViewMode),r(2),g("ngIf",e.user)}}var me=(()=>{let o=class o{get AgeRating(){return q}constructor(e,i,d){this.accountService=e,this.toastr=i,this.cdRef=d,this.user=void 0,this.hasChangeAgeRestrictionAbility=A(!1),this.isViewMode=!0,this.reset=new T,this.destroyRef=I(M)}ngOnInit(){this.accountService.currentUser$.pipe(S(this.destroyRef),x(),k(1)).subscribe(e=>{e&&(this.user=e,this.originalRestriction=this.user.ageRestriction,this.cdRef.markForCheck())}),this.hasChangeAgeRestrictionAbility=this.accountService.currentUser$.pipe(S(this.destroyRef),x(),V(e=>e!==void 0&&!this.accountService.hasReadOnlyRole(e)&&!this.accountService.hasAdminRole(e)&&this.accountService.hasChangeAgeRestrictionRole(e))),this.cdRef.markForCheck()}updateRestrictionSelection(e){this.selectedRestriction=e}resetForm(){this.user&&(this.reset.emit(this.originalRestriction),this.cdRef.markForCheck())}saveForm(){this.user!==void 0&&this.accountService.updateAgeRestriction(this.selectedRestriction.ageRating,this.selectedRestriction.includeUnknowns).subscribe(()=>{this.toastr.success(P("toasts.age-restriction-updated")),this.originalRestriction=this.selectedRestriction,this.user&&(this.user.ageRestriction.ageRating=this.selectedRestriction.ageRating,this.user.ageRestriction.includeUnknowns=this.selectedRestriction.includeUnknowns),this.resetForm(),this.isViewMode=!0},e=>{})}toggleViewMode(){this.isViewMode=!this.isViewMode,this.resetForm()}};o.\u0275fac=function(i){return new(i||o)(R(J),R(L),R(B))},o.\u0275cmp=E({type:o,selectors:[["app-change-age-restriction"]],standalone:!0,features:[j],decls:1,vars:1,consts:[["collapse","ngbCollapse"],[4,"transloco","translocoRead"],[1,"card","mt-2"],[1,"card-body"],[1,"card-title"],[1,"container-fluid","row","mb-2"],[1,"col-10","col-sm-11"],["id","age-restriction"],[1,"col-1","text-end"],[1,"btn","btn-primary","btn-sm",3,"click","disabled"],[4,"ngIf"],[3,"ngbCollapseChange","ngbCollapse"],[1,"container-fluid","row"],[1,"col-12"],[1,"ms-1","me-1"],[3,"selected","showContext","member","reset"],[1,"col-auto","d-flex","d-md-block","justify-content-sm-center","text-md-end","mb-3"],["type","button","aria-describedby","age-restriction",1,"flex-fill","btn","btn-secondary","me-2",3,"click"],["type","submit","aria-describedby","age-restriction",1,"flex-fill","btn","btn-primary",3,"click"]],template:function(i,d){i&1&&u(0,X,16,8,"ng-container",1),i&2&&g("translocoRead","change-age-restriction")},dependencies:[N,$,z,O,G,W],styles:["/*# sourceMappingURL=change-age-restriction.component-BFOIV4TJ.css.map */"],changeDetection:0});let n=o;return n})();export{me as ChangeAgeRestrictionComponent};
//# sourceMappingURL=chunk-ANKUG2J7.js.map
