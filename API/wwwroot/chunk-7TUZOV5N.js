import{a as dn}from"./chunk-W3BILLRV.js";import{a as zt}from"./chunk-DCNCHGLE.js";import{a as cn}from"./chunk-FEVPSYU2.js";import{a as sn}from"./chunk-5JNCF2FD.js";import{a as Ui,b as Ai}from"./chunk-C2T36BOI.js";import{a as tn,b as nn,c as Ot,d as Bt,e as ye,f as Ut,g as ln}from"./chunk-CASH644A.js";import{a as Ge,b as Hi,e as Yi,f as Xi,g as Zi,i as en}from"./chunk-GGQU56QW.js";import{a as Ki}from"./chunk-V7YNUPX5.js";import{a as At,b as Ht}from"./chunk-3BSTNBRU.js";import{b as mn}from"./chunk-U42B4V5B.js";import{a as Ni,b as $i,c as Oi,e as Rt,g as Mt,h as W,l as Ji}from"./chunk-CIDLU7ZZ.js";import{a as se}from"./chunk-FVF23ION.js";import{a as R,b as Et,c as Vi,e as Ft,f as Pt,i as Nt,l as qe,m as an}from"./chunk-ZTKUYOP3.js";import"./chunk-2JQ3KAM5.js";import{c as ve}from"./chunk-5TIUG6K2.js";import{a as Li}from"./chunk-IYLIANWB.js";import{a as ji,b as Zt,c as Gi}from"./chunk-63UKDQJP.js";import{b as A,c as Wi}from"./chunk-COKVODYN.js";import{a as kt}from"./chunk-K6JLHPZK.js";import{a as xe}from"./chunk-SEAKSSGD.js";import"./chunk-KWNQHRPC.js";import{a as Lt,b as qi,c as Qi}from"./chunk-STVWBYRJ.js";import{a as Vt}from"./chunk-SBPQBTA5.js";import"./chunk-23B3ZJIN.js";import{a as ce}from"./chunk-YK7KIY5R.js";import{a as Pi}from"./chunk-WBO5KV4A.js";import{a as Wt}from"./chunk-M6Y4BTRD.js";import{a as pn}from"./chunk-HOUHXGPA.js";import{a as zi,b as Fe,h as Dt}from"./chunk-LAUBKCQL.js";import"./chunk-46CIW37K.js";import"./chunk-76TOP2FJ.js";import"./chunk-4XR5JJUF.js";import"./chunk-DBXQZVFZ.js";import"./chunk-5XQ66AVT.js";import{a as rn,b as on}from"./chunk-RLL2TM5C.js";import{a as $t}from"./chunk-CNATNHH2.js";import{c as O,d as Xt,e as le,f as z}from"./chunk-5CMEBAZF.js";import{a as Ce}from"./chunk-ZRHV3LXB.js";import{a as Bi}from"./chunk-SBTJKJNK.js";import{c as Ci,e as Ue,j as Ke,k as gt,m as ae,o as Di,p as Fi,q as ue}from"./chunk-SPNNO5LP.js";import{d as ui,s as he}from"./chunk-E6ZKMAWP.js";import{$ as Ne,$b as k,$d as pe,Ad as fe,Ae as Ii,Bb as m,Cc as Ve,Dc as I,Ea as it,Ec as E,F as ni,Fa as y,Fb as X,Fc as U,Ga as S,Gc as v,Ib as o,Jb as di,Jd as J,Kb as Le,Ke as wi,L as ai,Le as Ti,Me as Ei,Na as Y,Nb as we,Ne as ki,O as ri,Pa as de,Pe as Ct,Q as oi,Qe as xt,Rb as B,Rc as $,Rd as ee,S as li,Sb as _i,Sd as xi,Se as vt,Tb as nt,Td as V,Ub as at,Ud as ft,Ue as yt,Vb as s,Ve as St,Wb as c,We as bt,Xb as _,Xe as It,Yb as g,Zb as f,Ze as Ri,_b as j,_c as pt,_d as Ae,_e as wt,be as He,bf as oe,cc as w,ce as ze,dc as l,de as ht,eb as Ie,ec as rt,ef as Mi,fb as Q,fc as ot,fe as Ye,ff as Tt,g as et,gc as lt,gd as $e,hc as ie,hd as ne,he as ut,ib as Yt,ic as gi,id as L,ie as vi,jd as mt,je as yi,kc as Te,kd as dt,la as si,lb as r,lc as Ee,mb as D,mc as ke,md as _t,me as We,nc as b,nd as fi,ne as je,oc as d,od as ge,pc as u,qa as C,qc as x,qd as hi,rc as _e,rd as Oe,sc as st,sd as Be,tc as Re,u as tt,uc as Me,ud as P,ue as Si,va as M,vb as mi,vc as De,wa as ci,xc as F,xe as bi,ya as pi,yc as ct,z as te,zc as N,ze as re}from"./chunk-2LHIXASS.js";function $n(i,a){if(i&1&&(g(0),d(1),f()),i&2){let t=l(3);r(),x(" ",t.titleName," ")}}function On(i,a){if(i&1&&(g(0),d(1),f()),i&2){let t=l(4);r(),x(" ",t.Number!==t.LooseLeafOrSpecial&&t.isChapter&&t.includeVolume?t.volumeTitle:""," ")}}function Bn(i,a){if(i&1&&(d(0),m(1,On,2,1,"ng-container",6),d(2)),i&2){let t=l(2).$implicit,e=l();x(" ",e.seriesName.length>0?e.seriesName+" - ":""," "),r(),o("ngIf",e.includeVolume&&e.volumeTitle!==""),r(),x(" ",e.Number!==e.LooseLeafOrSpecial?e.isChapter?t("issue-num")+e.Number:e.volumeTitle:t("special")," ")}}function Un(i,a){if(i&1&&(g(0),m(1,$n,2,1,"ng-container",5)(2,Bn,3,3,"ng-template",null,0,v),f()),i&2){let t=b(3),e=l(2);r(),o("ngIf",e.titleName!==""&&e.prioritizeTitleName)("ngIfElse",t)}}function An(i,a){if(i&1&&(g(0),d(1),f()),i&2){let t=l(3);r(),x(" ",t.titleName," ")}}function Hn(i,a){if(i&1&&(g(0),d(1),f()),i&2){let t=l(4);r(),x(" ",t.Number!==t.LooseLeafOrSpecial&&t.isChapter&&t.includeVolume?t.volumeTitle:""," ")}}function zn(i,a){if(i&1&&(d(0),m(1,Hn,2,1,"ng-container",6),d(2)),i&2){let t=l(2).$implicit,e=l();x(" ",e.seriesName.length>0?e.seriesName+" - ":""," "),r(),o("ngIf",e.includeVolume&&e.volumeTitle!==""),r(),x(" ",e.Number!==e.LooseLeafOrSpecial?e.isChapter?t("issue-num")+e.Number:e.volumeTitle:t("special")," ")}}function Wn(i,a){if(i&1&&(g(0),m(1,An,2,1,"ng-container",5)(2,zn,3,3,"ng-template",null,0,v),f()),i&2){let t=b(3),e=l(2);r(),o("ngIf",e.titleName!==""&&e.prioritizeTitleName)("ngIfElse",t)}}function jn(i,a){if(i&1&&(g(0),d(1),f()),i&2){let t=l(3);r(),x(" ",t.titleName," ")}}function Gn(i,a){if(i&1&&(g(0),d(1),f()),i&2){let t=l(4);r(),x(" ",t.Number!==t.LooseLeafOrSpecial&&t.isChapter&&t.includeVolume?t.volumeTitle:""," ")}}function qn(i,a){if(i&1&&(d(0),m(1,Gn,2,1,"ng-container",6),d(2)),i&2){let t=l(2).$implicit,e=l();x(" ",e.seriesName.length>0?e.seriesName+" - ":""," "),r(),o("ngIf",e.includeVolume&&e.volumeTitle!==""),r(),x(" ",e.Number!==e.LooseLeafOrSpecial?e.isChapter?t("chapter")+" "+e.Number:e.volumeTitle:t("special")," ")}}function Qn(i,a){if(i&1&&(g(0),m(1,jn,2,1,"ng-container",5)(2,qn,3,3,"ng-template",null,1,v),f()),i&2){let t=b(3),e=l(2);r(),o("ngIf",e.titleName!==""&&e.prioritizeTitleName)("ngIfElse",t)}}function Jn(i,a){if(i&1&&(g(0),d(1),f()),i&2){let t=l(2);r(),x(" ",t.volumeTitle," ")}}function Kn(i,a){if(i&1&&(g(0),d(1),f()),i&2){let t=l(2);r(),x(" ",t.volumeTitle," ")}}function Yn(i,a){if(i&1&&(g(0),d(1),f()),i&2){let t=l().$implicit,e=l();r(),x(" ",e.Number!==e.LooseLeafOrSpecial?e.isChapter?t("chapter")+" "+e.Number:e.volumeTitle:t("special")," ")}}function Xn(i,a){if(i&1&&(g(0)(1,3),m(2,Un,4,2,"ng-container",4)(3,Wn,4,2,"ng-container",4)(4,Qn,4,2,"ng-container",4)(5,Jn,2,1,"ng-container",4)(6,Kn,2,1,"ng-container",4)(7,Yn,2,1,"ng-container",4),f()()),i&2){let t=l();r(),o("ngSwitch",t.libraryType),r(),o("ngSwitchCase",t.LibraryType.Comic),r(),o("ngSwitchCase",t.LibraryType.ComicVine),r(),o("ngSwitchCase",t.LibraryType.Manga),r(),o("ngSwitchCase",t.LibraryType.Book),r(),o("ngSwitchCase",t.LibraryType.LightNovel),r(),o("ngSwitchCase",t.LibraryType.Images)}}var jt=(()=>{let a=class a{get Number(){return this.isChapter?this.entity.range:this.entity.name}constructor(e,n){this.utilityService=e,this.cdRef=n,this.LooseLeafOrSpecialNumber=-1e5,this.LooseLeafOrSpecial=-1e5+"",this.LibraryType=O,this.libraryType=O.Manga,this.seriesName="",this.includeVolume=!1,this.prioritizeTitleName=!0,this.isChapter=!1,this.titleName="",this.volumeTitle=""}ngOnInit(){if(this.isChapter=this.utilityService.isChapter(this.entity),this.isChapter){let e=this.entity;this.volumeTitle=e.volumeTitle||"",this.titleName=e.titleName||""}else{let e=this.utilityService.asVolume(this.entity);this.volumeTitle=e.name||"",this.titleName=e.name||"",e.chapters[0].titleName&&(this.titleName+=" - "+e.chapters[0].titleName)}this.cdRef.markForCheck()}};a.\u0275fac=function(n){return new(n||a)(D(z),D($))},a.\u0275cmp=M({type:a,selectors:[["app-entity-title"]],inputs:{libraryType:"libraryType",seriesName:"seriesName",entity:"entity",includeVolume:"includeVolume",prioritizeTitleName:"prioritizeTitleName"},standalone:!0,features:[F],decls:1,vars:1,consts:[["fullComicTitle",""],["fullMangaTitle",""],[4,"transloco","translocoRead"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngIf","ngIfElse"],[4,"ngIf"]],template:function(n,p){n&1&&m(0,Xn,8,7,"ng-container",2),n&2&&o("translocoRead","entity-title")},dependencies:[P,L,mt,dt,ft,V],styles:["/*# sourceMappingURL=entity-title.component-DFJTX5SF.css.map */"],changeDetection:0});let i=a;return i})();var _n=i=>({num:i}),ea=()=>({dateStyle:"short",timeStyle:"short"});function ta(i,a){if(i&1&&d(0),i&2){let t=a.$implicit;u(t.title)}}function ia(i,a){if(i&1&&d(0),i&2){let t=a.$implicit;u(t.name)}}function na(i,a){if(i&1&&(s(0,"div",5)(1,"app-metadata-detail",7),m(2,ta,1,1,"ng-template",null,0,v),c(),s(4,"app-metadata-detail",8),m(5,ia,1,1,"ng-template",null,0,v),c()()),i&2){let t=l(2);r(),o("tags",t.chapterMetadata.tags)("libraryId",t.libraryId)("queryParam",t.FilterField.Tags),r(3),o("tags",t.chapterMetadata.characters)("libraryId",t.libraryId)("queryParam",t.FilterField.Characters)}}function aa(i,a){if(i&1&&(g(0),s(1,"div",9)(2,"app-icon-and-title",10),d(3),I(4,"date"),I(5,"defaultDate"),c()(),_(6,"div",11),f()),i&2){let t=l().$implicit,e=l();r(2),o("label",t("release-date-tooltip"))("clickable",!1)("title",t("release-date-title")),r(),x(" ",E(5,7,U(4,4,e.chapter.releaseDate,"shortDate"))," ")}}function ra(i,a){if(i&1&&(g(0),s(1,"div",9)(2,"app-icon-and-title",12),d(3),I(4,"ageRating"),c()(),_(5,"div",11),f()),i&2){let t=l().$implicit,e=l();r(2),o("label",t("age-rating-title"))("clickable",!1)("title",t("age-rating-title")),r(),x(" ",E(4,4,e.chapter.ageRating)," ")}}function oa(i,a){if(i&1&&(g(0),s(1,"div",9)(2,"app-icon-and-title",13),d(3),I(4,"compactNumber"),c()(),_(5,"div",11),f()),i&2){let t=l().$implicit,e=l();r(2),o("label",t("length-title"))("clickable",!1),r(),x(" ",t("pages-count",N(5,_n,E(4,3,e.totalPages)))," ")}}function la(i,a){if(i&1&&(g(0),s(1,"div",9)(2,"app-icon-and-title",14),d(3),I(4,"compactNumber"),c()(),_(5,"div",11),f()),i&2){let t=l().$implicit,e=l();r(2),o("label",t("length-title"))("clickable",!1),r(),x(" ",t("words-count",N(5,_n,E(4,3,e.totalWordCount)))," ")}}function sa(i,a){if(i&1&&(g(0),d(1),f()),i&2){let t=l(2).$implicit;r(),u(t("less-than-hour"))}}function ca(i,a){if(i&1&&d(0),i&2){let t=l(2).$implicit,e=l();st(" ",e.readingTime.minHours,"",e.readingTime.maxHours!==e.readingTime.minHours?"-"+e.readingTime.maxHours:""," ",e.readingTime.minHours>1?t("hours"):t("hour")," ")}}function pa(i,a){if(i&1&&(g(0),s(1,"div",9)(2,"app-icon-and-title",15),m(3,sa,2,1,"ng-container",16)(4,ca,1,3,"ng-template",null,1,v),c()(),f()),i&2){let t=b(5),e=l().$implicit,n=l();r(2),o("label",e("read-time-title"))("clickable",!1),r(),o("ngIf",n.readingTime.maxHours===0||n.readingTime.minHours===0)("ngIfElse",t)}}function ma(i,a){if(i&1&&(g(0),_(1,"div",11),s(2,"div",17)(3,"app-icon-and-title",18),d(4),I(5,"utcToLocalTime"),I(6,"translocoDate"),I(7,"defaultDate"),c()(),f()),i&2){let t=l().$implicit,e=l();r(3),o("label",t("date-added-title"))("clickable",!1)("title",t("date-added-title")),r(),x(" ",E(7,9,U(6,6,E(5,4,e.chapter.createdUtc),ct(11,ea)))," ")}}function da(i,a){if(i&1&&(g(0),_(1,"div",11),s(2,"div",17)(3,"app-icon-and-title",19),d(4),I(5,"bytes"),c()(),f()),i&2){let t=l().$implicit,e=l();r(3),o("label",t("size-title"))("clickable",!1)("title",t("size-title")),r(),x(" ",E(5,4,e.size)," ")}}function _a(i,a){if(i&1&&(s(0,"a",23),I(1,"safeHtml"),_(2,"app-image",24),c()),i&2){let t=a.$implicit,e=l(4);o("href",E(1,4,t),Q)("title",t),r(2),o("imageUrl",e.imageService.getWebLinkImage(t))("errorImage",e.imageService.errorWebLinkImage)}}function ga(i,a){if(i&1&&(g(0),_(1,"div",11),s(2,"div",17)(3,"app-icon-and-title",21),m(4,_a,3,6,"a",22),c()(),f()),i&2){let t=l(2).$implicit,e=l();r(3),o("label",t("links-title"))("clickable",!1)("title",t("links-title")),r(),o("ngForOf",e.WebLinks)}}function fa(i,a){if(i&1&&(g(0),_(1,"div",11),s(2,"div",17)(3,"app-icon-and-title",25),d(4),c()(),f()),i&2){let t=l(2).$implicit,e=l();r(3),o("label",t("isbn-title"))("clickable",!1)("title",t("isbn-title")),r(),x(" ",e.chapter.isbn," ")}}function ha(i,a){if(i&1&&(g(0),_(1,"div",11),s(2,"div",17)(3,"app-icon-and-title",26),I(4,"date"),d(5),I(6,"date"),c()(),f()),i&2){let t=l(2).$implicit,e=l();r(3),o("label",t("last-read-title"))("clickable",!1)("ngbTooltip",U(4,4,e.chapter.lastReadingProgress,"medium")),r(2),x(" ",U(6,7,e.chapter.lastReadingProgress,"shortDate")," ")}}function ua(i,a){if(i&1&&(g(0),_(1,"div",11),s(2,"div",17)(3,"app-icon-and-title",27),d(4),c()(),f()),i&2){let t=l(2).$implicit,e=l();r(3),o("label",t("sort-order-title"))("clickable",!1)("title",t("sort-order-title")),r(),x(" ",e.chapter.sortOrder," ")}}function Ca(i,a){if(i&1&&(g(0),_(1,"div",11),s(2,"div",17)(3,"app-icon-and-title",20),d(4),c()(),m(5,ga,5,4,"ng-container",6)(6,fa,5,4,"ng-container",6)(7,ha,7,10,"ng-container",6),I(8,"date"),m(9,ua,5,4,"ng-container",6),f()),i&2){let t=l().$implicit,e=l();r(3),o("label",t("id-title"))("clickable",!1)("title",t("id-title")),r(),x(" ",e.entity.id," "),r(),o("ngIf",e.WebLinks.length>0),r(),o("ngIf",e.chapter.isbn.length>0),r(),o("ngIf",U(8,8,e.chapter.lastReadingProgress,"shortDate")!=="1/1/01"),r(2),o("ngIf",e.isChapter)}}function xa(i,a){if(i&1&&(g(0),s(1,"div",3),m(2,na,7,6,"div",4),s(3,"div",5),m(4,aa,7,9,"ng-container",6),I(5,"date"),m(6,ra,6,6,"ng-container",6)(7,oa,6,7,"ng-container",6)(8,la,6,7,"ng-container",6)(9,pa,6,4,"ng-container",6)(10,ma,8,12,"ng-container",6),I(11,"date"),m(12,da,6,6,"ng-container",6)(13,Ca,10,11,"ng-container",6),c()(),f()),i&2){let t=l();r(2),o("ngIf",t.chapterMetadata),r(2),o("ngIf",t.chapter!==void 0&&t.chapter.releaseDate&&U(5,9,t.chapter.releaseDate,"shortDate")!=="1/1/01"),r(2),o("ngIf",t.chapter.ageRating!==t.AgeRating.Unknown),r(),o("ngIf",t.totalPages>0),r(),o("ngIf",t.chapter.files[0].format===t.MangaFormat.EPUB&&t.totalWordCount>0),r(),o("ngIf",t.chapter.files[0].format===t.MangaFormat.EPUB&&t.totalWordCount>0||t.chapter.files[0].format!==t.MangaFormat.EPUB),r(),o("ngIf",t.showExtendedProperties&&t.chapter.createdUtc&&t.chapter.createdUtc!==""&&U(11,12,t.chapter.createdUtc,"shortDate")!=="1/1/01"),r(2),o("ngIf",t.showExtendedProperties&&t.size>0),r(),o("ngIf",t.showExtendedProperties)}}var Gt=(()=>{let a=class a{get WebLinks(){return this.chapter.webLinks===""?[]:this.chapter.webLinks.split(",")}constructor(e,n,p){this.utilityService=e,this.seriesService=n,this.cdRef=p,this.AgeRating=pn,this.MangaFormat=Ce,this.FilterField=Fe,this.imageService=C(xe),this.includeMetadata=!1,this.showExtendedProperties=!0,this.isChapter=!1,this.totalPages=0,this.totalWordCount=0,this.readingTime={maxHours:1,minHours:1,avgHours:1},this.size=0}ngOnInit(){if(this.isChapter=this.utilityService.isChapter(this.entity),this.chapter=this.utilityService.isChapter(this.entity)?this.entity:this.entity.chapters[0],this.isChapter?this.size=this.utilityService.asChapter(this.entity).files.reduce((e,n)=>e+n.bytes,0):this.size=this.utilityService.asVolume(this.entity).chapters.reduce((e,n)=>e+n.files.reduce((p,h)=>p+h.bytes,0),0),this.includeMetadata&&this.seriesService.getChapterMetadata(this.chapter.id).subscribe(e=>{this.chapterMetadata=e,this.cdRef.markForCheck()}),this.totalPages=this.chapter.pages,this.isChapter||(this.totalPages=this.utilityService.asVolume(this.entity).pages),this.totalWordCount=this.chapter.wordCount,this.isChapter||(this.totalWordCount=this.utilityService.asVolume(this.entity).chapters.map(e=>e.wordCount).reduce((e,n)=>e+n)),this.isChapter)this.readingTime.minHours=this.chapter.minHoursToRead,this.readingTime.maxHours=this.chapter.maxHoursToRead,this.readingTime.avgHours=this.chapter.avgHoursToRead;else{let e=this.utilityService.asVolume(this.entity);this.readingTime.minHours=e.minHoursToRead,this.readingTime.maxHours=e.maxHoursToRead,this.readingTime.avgHours=e.avgHoursToRead}this.cdRef.markForCheck()}};a.\u0275fac=function(n){return new(n||a)(D(z),D(se),D($))},a.\u0275cmp=M({type:a,selectors:[["app-entity-info-cards"]],inputs:{entity:"entity",libraryId:"libraryId",includeMetadata:"includeMetadata",showExtendedProperties:"showExtendedProperties"},standalone:!0,features:[F],decls:1,vars:1,consts:[["titleTemplate",""],["normalReadTime",""],[4,"transloco","translocoRead"],[1,"mt-3","mb-3"],["class","row g-0",4,"ngIf"],[1,"row","g-0"],[4,"ngIf"],["heading","Tags",3,"tags","libraryId","queryParam"],["heading","Characters",3,"tags","libraryId","queryParam"],[1,"col-auto","mb-2"],["fontClasses","fa-regular fa-calendar",3,"label","clickable","title"],[1,"vr","d-none","d-lg-block","m-2"],["fontClasses","fas fa-eye",3,"label","clickable","title"],["fontClasses","fa-regular fa-file-lines",3,"label","clickable"],["fontClasses","fa-solid fa-book-open",3,"label","clickable"],["fontClasses","fa-regular fa-clock",3,"label","clickable"],[4,"ngIf","ngIfElse"],[1,"col-auto"],["fontClasses","fa-solid fa-file-import",3,"label","clickable","title"],["fontClasses","fa-solid fa-scale-unbalanced",3,"label","clickable","title"],["fontClasses","fa-solid fa-fingerprint",3,"label","clickable","title"],["fontClasses","fa-solid fa-link",3,"label","clickable","title"],["class","me-1","target","_blank","rel","noopener noreferrer",3,"href","title",4,"ngFor","ngForOf"],["target","_blank","rel","noopener noreferrer",1,"me-1",3,"href","title"],["height","24px","width","24px","aria-hidden","true",3,"imageUrl","errorImage"],["fontClasses","fa-solid fa-barcode",3,"label","clickable","title"],["fontClasses","fa-regular fa-clock",3,"label","clickable","ngbTooltip"],["fontClasses","fa-solid fa-arrow-down-1-9",3,"label","clickable","title"]],template:function(n,p){n&1&&m(0,xa,14,15,"ng-container",2),n&2&&o("translocoRead","entity-info-cards")},dependencies:[P,ne,L,Oe,Ht,ae,Rt,Nt,At,Wt,oe,Ot,ft,V,Qi,qi,Vt,A],styles:["/*# sourceMappingURL=entity-info-cards.component-C7O5HADN.css.map */"],changeDetection:0});let i=a;return i})();function va(i,a){if(i&1&&(s(0,"span"),d(1),c()),i&2){let t=l(2).$implicit;r(),x(" ",t("no-data")," ")}}function ya(i,a){if(i&1&&_(0,"app-person-badge",7),i&2){let t=a.$implicit;o("person",t)}}function Sa(i,a){if(i&1&&(s(0,"div",5)(1,"h6"),d(2),c(),s(3,"app-badge-expander",6),m(4,ya,1,1,"ng-template",null,0,v),c()()),i&2){let t=l(2).$implicit,e=l();r(2),u(t("writers-title")),r(),o("items",e.chapter.writers)}}function ba(i,a){if(i&1&&_(0,"app-person-badge",7),i&2){let t=a.$implicit;o("person",t)}}function Ia(i,a){if(i&1&&(s(0,"div",5)(1,"h6"),d(2),c(),s(3,"app-badge-expander",6),m(4,ba,1,1,"ng-template",null,0,v),c()()),i&2){let t=l(2).$implicit,e=l();r(2),u(t("cover-artists-title")),r(),o("items",e.chapter.coverArtists)}}function wa(i,a){if(i&1&&_(0,"app-person-badge",7),i&2){let t=a.$implicit;o("person",t)}}function Ta(i,a){if(i&1&&(s(0,"div",5)(1,"h6"),d(2),c(),s(3,"app-badge-expander",6),m(4,wa,1,1,"ng-template",null,0,v),c()()),i&2){let t=l(2).$implicit,e=l();r(2),u(t("pencillers-title")),r(),o("items",e.chapter.pencillers)}}function Ea(i,a){if(i&1&&_(0,"app-person-badge",7),i&2){let t=a.$implicit;o("person",t)}}function ka(i,a){if(i&1&&(s(0,"div",5)(1,"h6"),d(2),c(),s(3,"app-badge-expander",6),m(4,Ea,1,1,"ng-template",null,0,v),c()()),i&2){let t=l(2).$implicit,e=l();r(2),u(t("inkers-title")),r(),o("items",e.chapter.inkers)}}function Ra(i,a){if(i&1&&_(0,"app-person-badge",7),i&2){let t=a.$implicit;o("person",t)}}function Ma(i,a){if(i&1&&(s(0,"div",5)(1,"h6"),d(2),c(),s(3,"app-badge-expander",6),m(4,Ra,1,1,"ng-template",null,0,v),c()()),i&2){let t=l(2).$implicit,e=l();r(2),u(t("colorists-title")),r(),o("items",e.chapter.colorists)}}function Da(i,a){if(i&1&&_(0,"app-person-badge",7),i&2){let t=a.$implicit;o("person",t)}}function Fa(i,a){if(i&1&&(s(0,"div",5)(1,"h6"),d(2),c(),s(3,"app-badge-expander",6),m(4,Da,1,1,"ng-template",null,0,v),c()()),i&2){let t=l(2).$implicit,e=l();r(2),u(t("letterers-title")),r(),o("items",e.chapter.letterers)}}function Pa(i,a){if(i&1&&_(0,"app-person-badge",7),i&2){let t=a.$implicit;o("person",t)}}function Na(i,a){if(i&1&&(s(0,"div",5)(1,"h6"),d(2),c(),s(3,"app-badge-expander",6),m(4,Pa,1,1,"ng-template",null,0,v),c()()),i&2){let t=l(2).$implicit,e=l();r(2),u(t("editors-title")),r(),o("items",e.chapter.editors)}}function La(i,a){if(i&1&&_(0,"app-person-badge",7),i&2){let t=a.$implicit;o("person",t)}}function Va(i,a){if(i&1&&(s(0,"div",5)(1,"h6"),d(2),c(),s(3,"app-badge-expander",6),m(4,La,1,1,"ng-template",null,0,v),c()()),i&2){let t=l(2).$implicit,e=l();r(2),u(t("publishers-title")),r(),o("items",e.chapter.publishers)}}function $a(i,a){if(i&1&&_(0,"app-person-badge",7),i&2){let t=a.$implicit;o("person",t)}}function Oa(i,a){if(i&1&&(s(0,"div",5)(1,"h6"),d(2),c(),s(3,"app-badge-expander",6),m(4,$a,1,1,"ng-template",null,0,v),c()()),i&2){let t=l(2).$implicit,e=l();r(2),u(t("imprints-title")),r(),o("items",e.chapter.imprints)}}function Ba(i,a){if(i&1&&_(0,"app-person-badge",7),i&2){let t=a.$implicit;o("person",t)}}function Ua(i,a){if(i&1&&(s(0,"div",5)(1,"h6"),d(2),c(),s(3,"app-badge-expander",6),m(4,Ba,1,1,"ng-template",null,0,v),c()()),i&2){let t=l(2).$implicit,e=l();r(2),u(t("characters-title")),r(),o("items",e.chapter.characters)}}function Aa(i,a){if(i&1&&_(0,"app-person-badge",7),i&2){let t=a.$implicit;o("person",t)}}function Ha(i,a){if(i&1&&(s(0,"div",5)(1,"h6"),d(2),c(),s(3,"app-badge-expander",6),m(4,Aa,1,1,"ng-template",null,0,v),c()()),i&2){let t=l(2).$implicit,e=l();r(2),u(t("teams-title")),r(),o("items",e.chapter.teams)}}function za(i,a){if(i&1&&_(0,"app-person-badge",7),i&2){let t=a.$implicit;o("person",t)}}function Wa(i,a){if(i&1&&(s(0,"div",5)(1,"h6"),d(2),c(),s(3,"app-badge-expander",6),m(4,za,1,1,"ng-template",null,0,v),c()()),i&2){let t=l(2).$implicit,e=l();r(2),u(t("locations-title")),r(),o("items",e.chapter.locations)}}function ja(i,a){if(i&1&&_(0,"app-person-badge",7),i&2){let t=a.$implicit;o("person",t)}}function Ga(i,a){if(i&1&&(s(0,"div",5)(1,"h6"),d(2),c(),s(3,"app-badge-expander",6),m(4,ja,1,1,"ng-template",null,0,v),c()()),i&2){let t=l(2).$implicit,e=l();r(2),u(t("translators-title")),r(),o("items",e.chapter.translators)}}function qa(i,a){if(i&1&&(g(0),m(1,va,2,1,"span",2),s(2,"div",3),m(3,Sa,6,2,"div",4)(4,Ia,6,2,"div",4)(5,Ta,6,2,"div",4)(6,ka,6,2,"div",4)(7,Ma,6,2,"div",4)(8,Fa,6,2,"div",4)(9,Na,6,2,"div",4)(10,Va,6,2,"div",4)(11,Oa,6,2,"div",4)(12,Ua,6,2,"div",4)(13,Ha,6,2,"div",4)(14,Wa,6,2,"div",4)(15,Ga,6,2,"div",4),c(),f()),i&2){let t=l(2);r(),o("ngIf",t.chapter.writers.length===0&&t.chapter.coverArtists.length===0&&t.chapter.pencillers.length===0&&t.chapter.inkers.length===0&&t.chapter.colorists.length===0&&t.chapter.letterers.length===0&&t.chapter.editors.length===0&&t.chapter.publishers.length===0&&t.chapter.characters.length===0&&t.chapter.translators.length===0&&t.chapter.imprints.length===0&&t.chapter.locations.length===0&&t.chapter.teams.length===0),r(2),o("ngIf",t.chapter.writers&&t.chapter.writers.length>0),r(),o("ngIf",t.chapter.coverArtists&&t.chapter.coverArtists.length>0),r(),o("ngIf",t.chapter.pencillers&&t.chapter.pencillers.length>0),r(),o("ngIf",t.chapter.inkers&&t.chapter.inkers.length>0),r(),o("ngIf",t.chapter.colorists&&t.chapter.colorists.length>0),r(),o("ngIf",t.chapter.letterers&&t.chapter.letterers.length>0),r(),o("ngIf",t.chapter.editors&&t.chapter.editors.length>0),r(),o("ngIf",t.chapter.publishers&&t.chapter.publishers.length>0),r(),o("ngIf",t.chapter.imprints&&t.chapter.imprints.length>0),r(),o("ngIf",t.chapter.characters&&t.chapter.characters.length>0),r(),o("ngIf",t.chapter.teams&&t.chapter.teams.length>0),r(),o("ngIf",t.chapter.locations&&t.chapter.locations.length>0),r(),o("ngIf",t.chapter.translators&&t.chapter.translators.length>0)}}function Qa(i,a){if(i&1&&(g(0),m(1,qa,16,14,"ng-container",2),f()),i&2){let t=l();r(),o("ngIf",t.chapter!==void 0)}}var gn=(()=>{let a=class a{};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=M({type:a,selectors:[["app-chapter-metadata-detail"]],inputs:{chapter:"chapter"},standalone:!0,features:[F],decls:1,vars:1,consts:[["badgeExpanderItem",""],[4,"transloco","translocoRead"],[4,"ngIf"],[1,"container-flex","row","row-cols-auto","row-cols-lg-5","g-2","g-lg-3","me-0","mt-2"],["class","col-auto mt-2",4,"ngIf"],[1,"col-auto","mt-2"],[3,"items"],[3,"person"]],template:function(n,p){n&1&&m(0,Qa,2,1,"ng-container",1),n&2&&o("translocoRead","chapter-metadata-detail")},dependencies:[P,L,nn,Bt,V],styles:["/*# sourceMappingURL=chapter-metadata-detail.component-4WHBOJNG.css.map */"],changeDetection:0});let i=a;return i})();function Ja(i,a){i&1&&_(0,"input",4)}function Ka(i,a){if(i&1&&d(0),i&2){let t=l().$index,e=l(2);x(" ",e.progressEvents[t].pagesRead," ")}}function Ya(i,a){if(i&1&&(s(0,"tr")(1,"td",3),d(2),I(3,"sentenceCase"),c(),s(4,"td"),m(5,Ja,1,0,"input",4)(6,Ka,1,1),c(),s(7,"td"),d(8),c(),s(9,"td"),d(10),c()()),i&2){let t=a.$index,e=l(2);r(),ie("id","progress-event--",t,""),r(),x(" ",E(3,6,e.progressEvents[t].userName)," "),r(3),B(5,e.editMode[t]?5:6),r(3),x(" ",e.progressEvents[t].createdUtc," "),r(2),x(" ",e.progressEvents[t].lastModifiedUtc," ")}}function Xa(i,a){if(i&1&&(g(0),s(1,"table",1)(2,"thead")(3,"tr")(4,"th",2),d(5),c(),s(6,"th",2),d(7),c(),s(8,"th",2),d(9),c(),s(10,"th",2),d(11),c()()(),s(12,"tbody"),nt(13,Ya,11,8,"tr",null,_i),c()(),f()),i&2){let t=a.$implicit,e=l();r(),o("formGroup",e.formGroup),r(4),u(t("user-header")),r(2),u(t("page-read-header")),r(2),u(t("date-created-header")),r(2),u(t("date-updated-header")),r(2),at(e.items.controls)}}var hn=(()=>{let a=class a{constructor(){this.readerService=C(ve),this.cdRef=C($),this.fb=C(bi),this.progressEvents=[],this.editMode={},this.formGroup=this.fb.group({items:this.fb.array([])})}get items(){return this.formGroup.get("items")}ngOnInit(){this.readerService.getAllProgressForChapter(this.chapter.id).subscribe(e=>{this.progressEvents=e,this.progressEvents.forEach((n,p)=>{this.editMode[p]=!1,this.items.push(this.createRowForm(n))}),this.cdRef.markForCheck()})}createRowForm(e){return this.fb.group({pagesRead:[e.pagesRead,[pe.required,pe.min(0),pe.max(this.chapter.pages)]],created:[e.createdUtc,[pe.required]],lastModified:[e.lastModifiedUtc,[pe.required]]})}edit(e,n){this.editMode[n]=!this.editMode[n],this.cdRef.markForCheck()}save(e,n){this.editMode[n]=!this.editMode[n],this.cdRef.markForCheck()}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=M({type:a,selectors:[["app-edit-chapter-progress"]],inputs:{chapter:"chapter"},standalone:!0,features:[F],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"table","table-striped",3,"formGroup"],["scope","col"],[3,"id"],["type","number","formControlName","pagesRead",1,"form-control"]],template:function(n,p){n&1&&m(0,Xa,15,5,"ng-container",0),n&2&&o("translocoRead","edit-chapter-progress")},dependencies:[V,re,Ae,vi,He,ze,We,je,Bi],styles:["/*# sourceMappingURL=edit-chapter-progress.component-NJJJWHHW.css.map */"],changeDetection:0});let i=a;return i})();var ir=(i,a)=>a.id;function nr(i,a){if(i&1&&(g(0),_(1,"app-read-more",24),f()),i&2){let t=l(3);r(),o("text",t.summary)("maxLength",250)}}function ar(i,a){if(i&1&&d(0),i&2){let t=l(2).$implicit;x(" ",t("no-summary")," ")}}function rr(i,a){if(i&1&&(s(0,"div",17)(1,"div",18)(2,"div",19),_(3,"app-image",20),c(),s(4,"div",21),m(5,nr,2,2,"ng-container",22)(6,ar,1,1,"ng-template",null,1,v),c()(),_(8,"app-entity-info-cards",23),c()),i&2){let t=b(7),e=l(2);r(3),o("imageUrl",e.coverImageUrl),r(2),o("ngIf",e.summary.length>0)("ngIfElse",t),r(3),o("entity",e.data)("libraryId",e.libraryId)}}function or(i,a){if(i&1&&_(0,"app-chapter-metadata-detail",25),i&2){let t=l(2);o("chapter",t.chapterMetadata)}}function lr(i,a){if(i&1&&_(0,"app-edit-chapter-progress",25),i&2){let t=l(2);o("chapter",t.chapter)}}function sr(i,a){if(i&1){let t=k();s(0,"app-cover-image-chooser",26),De("imageUrlsChange",function(n){y(t);let p=l(2);return Me(p.imageUrls,n)||(p.imageUrls=n),S(n)}),w("imageSelected",function(n){y(t);let p=l(2);return S(p.updateCoverImageIndex(n))})("selectedBase64Url",function(n){y(t);let p=l(2);return S(p.applyCoverImage(n))})("resetClicked",function(){y(t);let n=l(2);return S(n.resetCoverImage())}),c()}if(i&2){let t=l(2);Re("imageUrls",t.imageUrls),o("showReset",t.chapter.coverImageLocked)}}function cr(i,a){if(i&1&&(s(0,"h4"),d(1),c()),i&2){let t=l(3);r(),u(t.utilityService.formatChapterName(t.libraryType)+"s")}}function pr(i,a){if(i&1&&(g(0),d(1),f()),i&2){let t=l().$implicit,e=l(3);r(),_e(" ",e.utilityService.formatChapterName(e.libraryType,!0,!1)," ",e.formatChapterNumber(t)," ")}}function mr(i,a){if(i&1&&(s(0,"span"),d(1),c()),i&2){let t=l().$implicit;r(),_e("",t.pagesRead," / ",t.pages,"")}}function dr(i,a){if(i&1&&(s(0,"span"),d(1),I(2,"uppercase"),c()),i&2){let t=l(3).$implicit;r(),u(E(2,1,t("unread")))}}function _r(i,a){if(i&1&&(s(0,"span"),d(1),I(2,"uppercase"),c()),i&2){let t=l(3).$implicit;r(),u(E(2,1,t("read")))}}function gr(i,a){if(i&1&&d(0),i&2){let t=l(3).$implicit;u(t("files"))}}function fr(i,a){if(i&1&&(s(0,"div",38),d(1),I(2,"date"),I(3,"defaultDate"),c()),i&2){let t=l().$implicit,e=l(3).$implicit;r(),_e(" ",e("added")," ",E(3,5,U(2,2,t.created,"short"))," ")}}function hr(i,a){if(i&1&&(s(0,"li",37)(1,"span"),d(2),c(),s(3,"div",18)(4,"div",38),d(5),I(6,"number"),c(),m(7,fr,4,7,"div",38),s(8,"div",38),d(9),I(10,"bytes"),c()()()),i&2){let t=a.$implicit,e=l(3).$implicit,n=l();r(2),u(t.filePath),r(3),_e(" ",e("pages")," ",U(6,6,t.pages,"")," "),r(2),B(7,n.data.hasOwnProperty("created")?7:-1),r(2),_e(" ",e("size")," ",E(10,9,t.bytes)," ")}}function ur(i,a){if(i&1){let t=k();s(0,"li",29)(1,"a",30),w("click",function(){let n=y(t).$implicit,p=l(3);return S(p.readChapter(n))}),_(2,"app-image",20),c(),s(3,"div",31)(4,"h5",32)(5,"span")(6,"span")(7,"app-card-actionables",33),w("actionHandler",function(n){let p=y(t).$implicit,h=l(3);return S(h.performAction(n,p))}),c(),m(8,pr,2,2,"ng-container",22),c(),s(9,"span",34),m(10,mr,2,2,"span",35)(11,dr,3,3,"span",35)(12,_r,3,3,"span",35),c()(),m(13,gr,1,1,"ng-template",null,2,v),c(),s(15,"ul",36),nt(16,hr,11,11,"li",37,ir),c()()()}if(i&2){let t=a.$implicit,e=b(14),n=l(2).$implicit,p=l();r(),o("title",n("read")),r(),o("imageUrl",p.imageService.getChapterCoverImage(t.id)),r(5),o("actions",p.chapterActions)("labelBy",p.utilityService.formatChapterName(p.libraryType,!0,!0)+p.formatChapterNumber(t)),r(),o("ngIf",t.minNumber!==p.LooseLeafOrSpecialNumber)("ngIfElse",e),r(2),o("ngIf",t.pagesRead>0&&t.pagesRead<t.pages),r(),o("ngIf",t.pagesRead===0),r(),o("ngIf",t.pagesRead===t.pages),r(4),at(t.files)}}function Cr(i,a){if(i&1&&(m(0,cr,2,1,"h4"),s(1,"ul",27),m(2,ur,18,9,"li",28),c()),i&2){let t=l(2);B(0,t.utilityService.isChapter(t.data)?-1:0),r(2),o("ngForOf",t.chapters)}}function xr(i,a){if(i&1){let t=k();g(0),s(1,"div",4)(2,"h5",5)(3,"span",6),_(4,"app-entity-title",7),c()(),s(5,"button",8),w("click",function(){y(t);let n=l();return S(n.activeOffcanvas.dismiss())}),c()(),s(6,"div",9)(7,"div",10)(8,"ul",11,0),De("activeIdChange",function(n){y(t);let p=l();return Me(p.active,n)||(p.active=n),S(n)}),s(10,"li",12)(11,"a",13),d(12),c(),m(13,rr,9,5,"ng-template",14),c(),s(14,"li",12)(15,"a",13),d(16),c(),m(17,or,1,1,"ng-template",14),c(),s(18,"li",12)(19,"a",13),d(20),c(),m(21,lr,1,1,"ng-template",14),c(),s(22,"li",15),I(23,"async"),s(24,"a",13),d(25),c(),m(26,sr,1,2,"ng-template",14),c(),s(27,"li",15),I(28,"async"),s(29,"a",13),d(30),c(),m(31,Cr,3,2,"ng-template",14),c()(),_(32,"div",16),c()(),f()}if(i&2){let t=a.$implicit,e=b(9),n=l();r(4),o("libraryType",n.libraryType)("entity",n.data)("seriesName",n.parentName),r(4),Re("activeId",n.active),r(2),o("ngbNavItem",n.tabs[n.TabID.General]),r(2),u(t(n.tabs[n.TabID.General].title)),r(2),o("ngbNavItem",n.tabs[n.TabID.Metadata]),r(2),u(t(n.tabs[n.TabID.Metadata].title)),r(2),o("ngbNavItem",n.tabs[n.TabID.Progress]),r(2),u(t(n.tabs[n.TabID.Progress].title)),r(2),o("ngbNavItem",n.tabs[n.TabID.Cover])("disabled",E(23,20,n.isAdmin$)===!1),r(3),u(t(n.tabs[n.TabID.Cover].title)),r(2),o("ngbNavItem",n.tabs[n.TabID.Files])("disabled",E(28,22,n.isAdmin$)===!1),r(3),u(t(n.tabs[n.TabID.Files].title)),r(2),we("tab-content ",n.utilityService.getActiveBreakpoint()===n.Breakpoint.Mobile?"mt-3":"ms-4 flex-fill",""),o("ngbNavOutlet",e)}}var un=function(i){return i[i.General=0]="General",i[i.Metadata=1]="Metadata",i[i.Cover=2]="Cover",i[i.Progress=3]="Progress",i[i.Files=4]="Files",i}(un||{}),Cn=(()=>{let a=class a{constructor(e,n,p,h,T,G,q,Ze,Qt,Jt,Qe,Kt,Je,Pe){this.utilityService=e,this.imageService=n,this.uploadService=p,this.toastr=h,this.accountService=T,this.actionFactoryService=G,this.actionService=q,this.router=Ze,this.libraryService=Qt,this.seriesService=Jt,this.readerService=Qe,this.activeOffcanvas=Kt,this.downloadService=Je,this.cdRef=Pe,this.destroyRef=C(Y),this.MangaFormat=Ce,this.Breakpoint=le,this.LibraryType=O,this.TabID=un,this.LooseLeafOrSpecialNumber=-1e5,this.parentName="",this.seriesId=0,this.libraryId=0,this.isChapter=!1,this.chapters=[],this.imageUrls=[],this.isAdmin$=tt(!1),this.actions=[],this.chapterActions=[],this.libraryType=O.Manga,this.tabs=[{title:"general-tab",disabled:!1},{title:"metadata-tab",disabled:!1},{title:"cover-tab",disabled:!1},{title:"progress-tab",disabled:!1},{title:"info-tab",disabled:!1}],this.active=this.tabs[0],this.summary="",this.downloadInProgress=!1,this.isAdmin$=this.accountService.currentUser$.pipe(J(this.destroyRef),te(me=>me&&this.accountService.hasAdminRole(me)||!1),Ne())}ngOnInit(){if(this.imageUrls=this.chapters.map(n=>this.imageService.getChapterCoverImage(n.id)),this.isChapter=this.utilityService.isChapter(this.data),this.chapter=this.utilityService.isChapter(this.data)?this.data:this.data.chapters[0],this.seriesService.getChapterMetadata(this.chapter.id).subscribe(n=>{this.chapterMetadata=n,this.cdRef.markForCheck()}),this.isChapter?(this.coverImageUrl=this.imageService.getChapterCoverImage(this.data.id),this.summary=this.utilityService.asChapter(this.data).summary||"",this.chapters.push(this.data)):(this.coverImageUrl=this.imageService.getVolumeCoverImage(this.data.id),this.summary=this.utilityService.asVolume(this.data).chapters[0].summary||"",this.chapters.push(...this.data.chapters)),this.chapterActions=this.actionFactoryService.getChapterActions(this.handleChapterActionCallback.bind(this)).filter(n=>n.action!==R.Edit),this.chapterActions.push({title:"read",action:R.Read,callback:this.handleChapterActionCallback.bind(this),requiresAdmin:!1,children:[]}),this.isChapter){let n=this.utilityService.asChapter(this.data);this.chapterActions=this.actionFactoryService.filterSendToAction(this.chapterActions,n)}else this.chapterActions=this.actionFactoryService.filterSendToAction(this.chapterActions,this.chapters[0]);this.libraryService.getLibraryType(this.libraryId).subscribe(n=>{this.libraryType=n,this.cdRef.markForCheck()});let e=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});this.chapters.forEach(n=>{n.files.sort((p,h)=>e.compare(p.filePath,h.filePath))}),this.imageUrls=this.chapters.map(n=>this.imageService.getChapterCoverImage(n.id)),this.cdRef.markForCheck()}close(){this.activeOffcanvas.close()}formatChapterNumber(e){return e.minNumber===-1e5?"1":e.range+""}performAction(e,n){typeof e.callback=="function"&&e.callback(e,n)}applyCoverImage(e){this.uploadService.updateChapterCoverImage(this.chapter.id,e).subscribe(()=>{})}updateCoverImageIndex(e){e<=0||this.applyCoverImage(this.imageUrls[e])}resetCoverImage(){this.uploadService.resetChapterCoverLock(this.chapter.id).subscribe(()=>{this.toastr.info(ee("toasts.regen-cover"))})}markChapterAsRead(e){this.seriesId!==0&&this.actionService.markChapterAsRead(this.libraryId,this.seriesId,e,()=>{this.cdRef.markForCheck()})}markChapterAsUnread(e){this.seriesId!==0&&this.actionService.markChapterAsUnread(this.libraryId,this.seriesId,e,()=>{this.cdRef.markForCheck()})}handleChapterActionCallback(e,n){switch(e.action){case R.MarkAsRead:this.markChapterAsRead(n);break;case R.MarkAsUnread:this.markChapterAsUnread(n);break;case R.AddToReadingList:this.actionService.addChapterToReadingList(n,this.seriesId);break;case R.IncognitoRead:this.readChapter(n,!0);break;case R.Download:this.download(n);break;case R.Read:this.readChapter(n,!1);break;case R.SendTo:{let p=e._extra.data;this.actionService.sendToDevice([n.id],p);break}default:break}}readChapter(e,n=!1){if(e.pages===0){this.toastr.error(ee("toasts.no-pages"));return}let p=this.readerService.getQueryParamsObject(n,!1);this.router.navigate(this.readerService.getNavigationArray(this.libraryId,this.seriesId,e.id,e.files[0].format),{queryParams:p}),this.close()}download(e){if(this.downloadInProgress){this.toastr.info(ee("toasts.download-in-progress"));return}this.downloadInProgress=!0,this.cdRef.markForCheck(),this.downloadService.download("chapter",e,n=>{n||(this.downloadInProgress=!1,this.cdRef.markForCheck())})}};a.\u0275fac=function(n){return new(n||a)(D(z),D(xe),D($i),D(he),D(ue),D(Et),D(Mt),D(Ue),D(kt),D(se),D(ve),D(Mi),D(qe),D($))},a.\u0275cmp=M({type:a,selectors:[["app-card-detail-drawer"]],inputs:{parentName:"parentName",seriesId:"seriesId",libraryId:"libraryId",data:"data"},standalone:!0,features:[F],decls:1,vars:1,consts:[["nav","ngbNav"],["noSummary",""],["specialHeader",""],[4,"transloco","translocoRead"],[1,"offcanvas-header"],[1,"offcanvas-title"],["id","modal-basic-title",1,"modal-title"],[3,"libraryType","entity","seriesName"],["type","button","aria-label","Close",1,"btn-close","text-reset",3,"click"],[1,"offcanvas-body","pb-3"],[1,"d-flex"],["ngbNav","","orientation","vertical",1,"nav-pills",2,"max-width","135px",3,"activeIdChange","activeId"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[3,"ngbNavItem","disabled"],[3,"ngbNavOutlet"],[1,"container-fluid",2,"overflow","auto"],[1,"row","g-0"],[1,"d-none","d-md-block","col-md-2","col-lg-1"],["width","74px",1,"me-2",3,"imageUrl"],[1,"col-md-10","col-lg-11"],[4,"ngIf","ngIfElse"],[3,"entity","libraryId"],[3,"text","maxLength"],[3,"chapter"],[3,"imageUrlsChange","imageSelected","selectedBase64Url","resetClicked","imageUrls","showReset"],[1,"list-unstyled"],["class","d-flex my-4",4,"ngFor","ngForOf"],[1,"d-flex","my-4"],["href","javascript:void(0);",3,"click","title"],[1,"flex-grow-1"],[1,"mt-0","mb-1"],[3,"actionHandler","actions","labelBy"],[1,"badge","bg-primary","rounded-pill","ms-1"],[4,"ngIf"],[1,"list-group"],[1,"list-group-item","no-hover"],[1,"col"]],template:function(n,p){n&1&&m(0,xr,33,24,"ng-container",3),n&2&&o("translocoRead","card-detail-drawer")},dependencies:[P,ne,L,ge,hi,Be,Oe,jt,St,yt,bt,vt,A,ce,Gt,Oi,gn,Ge,Rt,Nt,It,V,hn],styles:[`.hide-if-empty[_ngcontent-%COMP%]:empty{display:none!important}.offcanvas-body[_ngcontent-%COMP%]{overflow:auto}.offcanvas-header[_ngcontent-%COMP%]{padding:1rem 1rem 0}.tab-content[_ngcontent-%COMP%]{overflow:auto;height:calc(40vh - (46px + 1rem))}.h6[_ngcontent-%COMP%]{font-weight:600}
/*# sourceMappingURL=card-detail-drawer.component-UR7BRJNN.css.map */`],changeDetection:0});let i=a;return i})();var vr=i=>({count:i});function yr(i,a){if(i&1&&(s(0,"div"),d(1),c()),i&2){let t=l(2).$implicit;r(),u(t("required"))}}function Sr(i,a){if(i&1&&(s(0,"div"),d(1),c()),i&2){let t=l(2).$implicit,e=l();r(),u(t("min-length",N(1,vr,e.minLength)))}}function br(i,a){if(i&1&&(s(0,"div",14),m(1,yr,2,1,"div")(2,Sr,2,3,"div"),c()),i&2){let t,e,n=l(2);r(),B(1,!((t=n.reviewGroup.get("reviewBody"))==null||t.errors==null)&&t.errors.required?1:-1),r(),B(2,!((e=n.reviewGroup.get("reviewBody"))==null||e.errors==null)&&e.errors.minlength?2:-1)}}function Ir(i,a){if(i&1){let t=k();g(0),s(1,"div")(2,"div",1)(3,"h4",2),d(4),c(),s(5,"button",3),w("click",function(){y(t);let n=l();return S(n.close())}),c()(),s(6,"div",4)(7,"form",5)(8,"div",6)(9,"label",7),d(10),c(),_(11,"textarea",8),m(12,br,3,2,"div",9),c()()(),s(13,"div",10)(14,"button",11),w("click",function(){y(t);let n=l();return S(n.delete())}),d(15),c(),s(16,"button",12),w("click",function(){y(t);let n=l();return S(n.close())}),d(17),c(),s(18,"button",13),w("click",function(){y(t);let n=l();return S(n.save())}),d(19),c()()(),f()}if(i&2){let t,e=a.$implicit,n=l();r(4),u(e("title")),r(),X("aria-label",e("close")),r(2),o("formGroup",n.reviewGroup),r(3),u(e("review-label")),r(),Le("is-invalid",((t=n.reviewGroup.get("reviewBody"))==null?null:t.invalid)&&((t=n.reviewGroup.get("reviewBody"))==null?null:t.touched)),o("minlength",n.minLength),r(),o("ngIf",n.reviewGroup.dirty||n.reviewGroup.touched),r(3),u(e("delete")),r(2),u(e("close")),r(2),u(e("save"))}}var be=function(i){return i[i.Create=0]="Create",i[i.Edit=1]="Edit",i[i.Delete=2]="Delete",i[i.Close=3]="Close",i}(be||{}),qt=(()=>{let a=class a{constructor(){this.modal=C(Ct),this.seriesService=C(se),this.cdRef=C($),this.confirmService=C(Di),this.toastr=C(he),this.minLength=5}ngOnInit(){this.reviewGroup=new ht({reviewBody:new Ye(this.review.body,[pe.required,pe.minLength(this.minLength)])}),this.cdRef.markForCheck()}close(){this.modal.close({success:!1,review:this.review,action:be.Close})}delete(){return et(this,null,function*(){(yield this.confirmService.confirm(ee("toasts.delete-review")))&&this.seriesService.deleteReview(this.review.seriesId).subscribe(()=>{this.toastr.success(ee("toasts.review-deleted")),this.modal.close({success:!0,review:this.review,action:be.Delete})})})}save(){let e=this.reviewGroup.value;e.reviewBody.length<this.minLength||this.seriesService.updateReview(this.review.seriesId,e.reviewBody).subscribe(n=>{this.modal.close({success:!0,review:n,action:be.Edit})})}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=M({type:a,selectors:[["app-review-series-modal"]],inputs:{review:"review"},standalone:!0,features:[F],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],[1,"row","g-0","mt-2"],["for","review",1,"form-label"],["id","review","formControlName","reviewBody","rows","3","aria-describedby","body-validations",1,"form-control",3,"minlength"],["id","body-validations","class","invalid-feedback",4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"],["id","body-validations",1,"invalid-feedback"]],template:function(n,p){n&1&&m(0,Ir,20,11,"ng-container",0),n&2&&o("translocoRead","review-series-modal")},dependencies:[P,L,re,ut,Ae,He,ze,Si,We,je,V],styles:["/*# sourceMappingURL=review-series-modal.component-UEEP56DS.css.map */"],changeDetection:0});let i=a;return i})();var wr=[[["","title",""]]],Tr=["[title]"];function Er(i,a){if(i&1&&(g(0),s(1,"div",7),_(2,"app-read-more",8),c(),f()),i&2){let t=l();r(2),o("text",t.summary)("maxLength",250)}}var xn=(()=>{let a=class a{constructor(){this.imageUrl="",this.imageHeight="230px",this.imageWidth="158px",this.summary=""}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=M({type:a,selectors:[["app-external-list-item"]],inputs:{imageUrl:"imageUrl",imageHeight:"imageHeight",imageWidth:"imageWidth",summary:"summary"},standalone:!0,features:[F],ngContentSelectors:Tr,decls:8,vars:4,consts:[[1,"list-item-container","d-flex","flex-row","g-0","mb-2","p-2"],[1,"pe-2"],["maxHeight","200px",3,"imageUrl","height","width"],[1,"flex-grow-1"],[1,"g-0"],[1,"mb-0"],[4,"ngIf"],[1,"mt-2","ps-2"],[3,"text","maxLength"]],template:function(n,p){n&1&&(rt(wr),s(0,"div",0)(1,"div",1),_(2,"app-image",2),c(),s(3,"div",3)(4,"div",4)(5,"h5",5),ot(6),c(),m(7,Er,3,2,"ng-container",6),c()()()),n&2&&(r(2),o("imageUrl",p.imageUrl)("height",p.imageHeight)("width",p.imageWidth),r(5),o("ngIf",p.summary&&p.summary.length>0))},dependencies:[P,L,A,ce],styles:[`.list-item-container[_ngcontent-%COMP%]{background:var(--card-list-item-bg-color);border-radius:5px;position:relative}
/*# sourceMappingURL=external-list-item.component-A4FIHFNZ.css.map */`],changeDetection:0});let i=a;return i})();var kr=["link"];function Rr(i,a){if(i&1){let t=k();s(0,"div",9)(1,"div")(2,"span",10),w("click",function(){y(t);let n=l(3);return S(n.handleClick())}),_(3,"img",11),I(4,"providerImage"),d(5),c()(),s(6,"a",12,0),d(8),c()()}if(i&2){let t=l(2).$implicit,e=l();r(2),lt("id",e.data.name),o("ngbTooltip",e.data.name),r(),o("ngSrc",E(4,6,e.data.provider)),r(2),x(" ",e.data.name," "),r(),o("href",e.data.url,Q),r(2),u(t("open-external"))}}function Mr(i,a){if(i&1){let t=k();g(0),s(1,"div",3)(2,"div",4),w("click",function(){y(t);let n=l(2);return S(n.handleClick())}),g(3),_(4,"app-image",5),f(),g(5),s(6,"div",6),_(7,"div",7),c(),f(),_(8,"div",8),c(),m(9,Rr,9,8,"div",9),c(),f()}if(i&2){let t=l(2);r(4),o("imageUrl",t.data.coverUrl),r(5),B(9,t.data.name.length>0?9:-1)}}function Dr(i,a){if(i&1&&(g(0),m(1,Mr,10,2,"ng-container",2),f()),i&2){let t=l();r(),o("ngIf",t.data!==void 0)}}var vn=(()=>{let a=class a{constructor(){this.previewOnClick=!1,this.offcanvasService=C(Tt)}handleClick(){if(this.previewOnClick){let e=this.offcanvasService.open(Ut,{position:"end",panelClass:"navbar-offset"});e.componentInstance.isExternalSeries=!0,e.componentInstance.aniListId=this.data.aniListId,e.componentInstance.malId=this.data.malId,e.componentInstance.name=this.data.name;return}this.link&&this.link.nativeElement.click()}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=M({type:a,selectors:[["app-external-series-card"]],viewQuery:function(n,p){if(n&1&&Te(kr,5),n&2){let h;Ee(h=ke())&&(p.link=h.first)}},inputs:{data:"data",previewOnClick:"previewOnClick"},standalone:!0,features:[F],decls:1,vars:1,consts:[["link",""],[4,"transloco","translocoRead"],[4,"ngIf"],[1,"card-item-container","card","clickable"],[1,"overlay",3,"click"],["borderRadius",".25rem .25rem 0 0","height","230px","width","158px",3,"imageUrl"],[1,"badge-container"],[1,"not-read-badge"],[1,"card-overlay"],[1,"card-body"],["placement","top","tabindex","0",1,"card-title",3,"click","id","ngbTooltip"],["width","20","height","20","alt","",1,"me-1",3,"ngSrc"],["target","_blank","rel","noreferrer nofollow",1,"card-title","library",3,"href"]],template:function(n,p){n&1&&m(0,Dr,2,1,"ng-container",1),n&2&&o("translocoRead","external-series-card")},dependencies:[P,L,A,oe,re,V,fe,ye],styles:["/*# sourceMappingURL=external-series-card.component-455IUA5L.css.map */"],changeDetection:0});let i=a;return i})();var Fr=[[["","title",""]]],Pr=["[title]"],Nr=i=>({"subtitle-with-actionables":i});function Lr(i,a){i&1&&_(0,"div",19)}function Vr(i,a){if(i&1&&(s(0,"div",20),I(1,"number"),s(2,"p"),_(3,"ngb-progressbar",21),c()()),i&2){let t=l(2);ie("ngbTooltip","",U(1,4,t.pagesRead/t.totalPages,"1.0-1"),"% Read"),r(3),o("value",t.pagesRead)("max",t.totalPages)}}function $r(i,a){if(i&1&&(s(0,"h6",22),d(1),c()),i&2){let t=l(2);o("ngClass",N(2,Nr,t.actions.length>0)),r(),u(t.Title)}}function Or(i,a){if(i&1&&(g(0),s(1,"div",23),_(2,"app-read-more",24),c(),f()),i&2){let t=l(2);r(2),o("text",t.summary)("blur",t.pagesRead===0&&t.blur)("maxLength",250)}}function Br(i,a){if(i&1){let t=k();g(0),s(1,"div",1)(2,"div",2),_(3,"app-image",3),m(4,Lr,1,0,"div",4),s(5,"span",5),_(6,"app-download-indicator",6),c(),m(7,Vr,4,7,"div",7),c(),s(8,"div",8)(9,"div",9)(10,"h5",10)(11,"app-card-actionables",11),w("actionHandler",function(n){y(t);let p=l();return S(p.performAction(n))}),c(),ot(12),s(13,"button",12),w("click",function(){y(t);let n=l();return S(n.read.emit())}),s(14,"span"),_(15,"i",13),c(),s(16,"span",14),d(17),c()()(),m(18,$r,2,4,"h6",15)(19,Or,3,3,"ng-container",16),s(20,"div",17),_(21,"app-entity-info-cards",18),c()()()(),f()}if(i&2){let t=a.$implicit,e=l();r(3),o("imageUrl",e.imageUrl)("height",e.imageHeight)("width",e.imageWidth),r(),o("ngIf",e.pagesRead===0&&e.totalPages>0),r(2),o("download$",e.download$),r(),o("ngIf",e.pagesRead<e.totalPages&&e.totalPages>0&&e.pagesRead!==e.totalPages),r(4),o("disabled",e.actionInProgress)("actions",e.actions)("labelBy",e.seriesName),r(6),u(t("read")),r(),o("ngIf",e.Title!==""&&e.showTitle),r(),o("ngIf",e.summary.length>0),r(2),o("entity",e.entity)("libraryId",e.libraryId)("includeMetadata",e.ShowExtended)("showExtendedProperties",e.ShowExtended)}}var yn=(()=>{let a=class a{get Title(){return this.isChapter?this.entity.titleName:""}get ShowExtended(){return this.utilityService.getActiveBreakpoint()===le.Desktop}constructor(e,n,p,h){this.utilityService=e,this.downloadService=n,this.toastr=p,this.cdRef=h,this.imageUrl="",this.actions=[],this.libraryType=O.Manga,this.seriesName="",this.imageHeight="230px",this.imageWidth="158px",this.seriesLink="",this.pagesRead=0,this.totalPages=0,this.relation=void 0,this.includeVolume=!1,this.showTitle=!0,this.blur=!1,this.read=new de,this.destroyRef=C(Y),this.actionInProgress=!1,this.summary="",this.isChapter=!1,this.download$=null,this.downloadInProgress=!1,this.Breakpoint=le}ngOnInit(){this.isChapter=this.utilityService.isChapter(this.entity),this.isChapter?this.summary=this.utilityService.asChapter(this.entity).summary||"":this.summary=this.utilityService.asVolume(this.entity).chapters[0].summary||"",this.cdRef.markForCheck(),this.download$=this.downloadService.activeDownloads$.pipe(J(this.destroyRef),te(e=>this.utilityService.isVolume(this.entity)?e.find(n=>n.entityType==="volume"&&n.subTitle===this.downloadService.downloadSubtitle("volume",this.entity))||null:this.utilityService.isChapter(this.entity)&&e.find(n=>n.entityType==="chapter"&&n.subTitle===this.downloadService.downloadSubtitle("chapter",this.entity))||null))}performAction(e){if(e.action==R.Download){if(this.downloadInProgress){this.toastr.info(ee("toasts.download-in-progress"));return}let n=p=>{p||(this.downloadInProgress=!1)};if(this.utilityService.isVolume(this.entity)){let p=this.utilityService.asVolume(this.entity);this.downloadService.download("volume",p,n)}else if(this.utilityService.isChapter(this.entity)){let p=this.utilityService.asChapter(this.entity);this.downloadService.download("chapter",p,n)}return}typeof e.callback=="function"&&e.callback(e,this.entity)}};a.\u0275fac=function(n){return new(n||a)(D(z),D(qe),D(he),D($))},a.\u0275cmp=M({type:a,selectors:[["app-list-item"]],inputs:{entity:"entity",libraryId:"libraryId",imageUrl:"imageUrl",actions:"actions",libraryType:"libraryType",seriesName:"seriesName",imageHeight:"imageHeight",imageWidth:"imageWidth",seriesLink:"seriesLink",pagesRead:"pagesRead",totalPages:"totalPages",relation:"relation",includeVolume:"includeVolume",showTitle:"showTitle",blur:"blur"},outputs:{read:"read"},standalone:!0,features:[F],ngContentSelectors:Pr,decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"list-item-container","d-flex","flex-row","g-0","mb-2","p-2"],[1,"pe-2"],["maxHeight","200px",3,"imageUrl","height","width"],["class","not-read-badge",4,"ngIf"],[1,"download"],[3,"download$"],["class","progress-banner",3,"ngbTooltip",4,"ngIf"],[1,"flex-grow-1"],[1,"g-0"],[1,"mb-0"],["iconClass","fa-ellipsis-v",3,"actionHandler","disabled","actions","labelBy"],[1,"btn","btn-primary","float-end",3,"click"],["aria-hidden","true",1,"fa","fa-book","me-1"],[1,"d-none","d-sm-inline-block"],["class","text-muted",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"ps-2","d-none","d-md-inline-block",2,"width","100%"],[3,"entity","libraryId","includeMetadata","showExtendedProperties"],[1,"not-read-badge"],[1,"progress-banner",3,"ngbTooltip"],["type","primary","height","5px",3,"value","max"],[1,"text-muted",3,"ngClass"],[1,"mt-2","ps-2"],[3,"text","blur","maxLength"]],template:function(n,p){n&1&&(rt(Fr),m(0,Br,22,16,"ng-container",0)),n&2&&o("translocoRead","list-item")},dependencies:[P,$e,L,Be,ce,A,Yi,Gt,Ge,wt,oe,V],styles:[`.download[_ngcontent-%COMP%]{width:80px;height:80px;position:absolute;top:55px;left:20px}.progress-banner[_ngcontent-%COMP%]{height:5px}.progress-banner[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{color:var(--card-progress-bar-color);background-color:transparent}.list-item-container[_ngcontent-%COMP%]{background:var(--card-list-item-bg-color);border-radius:5px;position:relative}.not-read-badge[_ngcontent-%COMP%]{position:absolute;top:8px;left:110px;width:0;height:0;border-style:solid;border-width:0 var(--card-progress-triangle-size) var(--card-progress-triangle-size) 0;border-color:transparent var(--primary-color) transparent transparent}.subtitle-with-actionables[_ngcontent-%COMP%]{font-size:.75rem;word-break:break-all}
/*# sourceMappingURL=list-item.component-PAQD3LVA.css.map */`],changeDetection:0});let i=a;return i})();function Ur(i,a){if(i&1&&(s(0,"span"),d(1),c()),i&2){let t=l().$implicit;r(),u(t("click-to-show"))}}function Ar(i,a){if(i&1&&(_(0,"div",4),I(1,"safeHtml")),i&2){let t=l(2);o("innerHTML",E(1,1,t.html),Ie)}}function Hr(i,a){if(i&1){let t=k();g(0),s(1,"div",2),w("click",function(){y(t);let n=l();return S(n.toggle())}),m(2,Ur,2,1,"span",3)(3,Ar,2,3,"ng-template",null,0,v),c(),f()}if(i&2){let t=b(4),e=l();r(),X("aria-expanded",!e.isCollapsed),r(),o("ngIf",e.isCollapsed)("ngIfElse",t)}}var Sn=(()=>{let a=class a{constructor(){this.isCollapsed=!0,this.cdRef=C($),this.isCollapsed=!0,this.cdRef.markForCheck()}ngOnInit(){this.isCollapsed=!0,this.cdRef.markForCheck()}toggle(){this.isCollapsed=!this.isCollapsed,this.cdRef.markForCheck()}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=M({type:a,selectors:[["app-spoiler"]],inputs:{html:"html"},standalone:!0,features:[F],decls:1,vars:1,consts:[["show",""],[4,"transloco","translocoRead"],["tabindex","0",1,"btn","spoiler",3,"click"],[4,"ngIf","ngIfElse"],[3,"innerHTML"]],template:function(n,p){n&1&&m(0,Hr,5,3,"ng-container",1),n&2&&o("translocoRead","spoiler")},dependencies:[P,L,ae,V],styles:[`.spoiler{background-color:var(--review-spoiler-bg-color);color:var(--review-spoiler-text-color);cursor:pointer}
/*# sourceMappingURL=spoiler.component-AYFC3J2T.css.map */
`],encapsulation:2,changeDetection:0});let i=a;return i})();var zr=["container"],Wr=i=>({username:i});function jr(i,a){if(i&1&&(_(0,"img",11),I(1,"providerImage")),i&2){let t=l(2);o("ngSrc",E(1,1,t.review.provider))}}function Gr(i,a){if(i&1&&(_(0,"p",12),I(1,"safeHtml")),i&2){let t=l(2);o("innerHTML",E(1,1,t.review.tagline),Ie)}}function qr(i,a){if(i&1&&(s(0,"a",13),I(1,"safeHtml"),d(2),c()),i&2){let t=l().$implicit,e=l();o("href",E(1,3,e.review.siteUrl),Q)("title",e.review.siteUrl),r(2),x(" ",t("go-to-review")," ")}}function Qr(i,a){if(i&1){let t=k();g(0),s(1,"div")(2,"div",2)(3,"h4",3),d(4),m(5,jr,2,3,"img",4),c(),s(6,"button",5),w("click",function(){y(t);let n=l();return S(n.close())}),c()(),s(7,"div",6),m(8,Gr,2,3,"p"),_(9,"p",7,0),I(11,"safeHtml"),c(),s(12,"div",8),m(13,qr,3,5,"a",9),s(14,"button",10),w("click",function(){y(t);let n=l();return S(n.close())}),d(15),c()()(),f()}if(i&2){let t=a.$implicit,e=l();r(4),x(" ",t("user-review",N(9,Wr,e.review.username))," "),r(),B(5,e.review.isExternal?5:-1),r(),X("aria-label",t("close")),r(2),B(8,e.review.tagline?8:-1),r(),o("innerHTML",E(11,7,e.review.body),Ie),r(4),B(13,e.review.siteUrl?13:-1),r(2),u(t("close"))}}var bn=(()=>{let a=class a{constructor(e){this.document=e,this.modal=C(Ct)}close(){this.modal.close()}ngAfterViewInit(){let e=this.document.querySelectorAll("span.spoiler");for(let n=0;n<e.length;n++){let p=e[n],h=this.container.createComponent(Sn);h.instance.html=p.innerHTML,p.parentNode!=null&&p.parentNode.replaceChild(h.location.nativeElement,p),h.instance.cdRef.markForCheck()}}};a.\u0275fac=function(n){return new(n||a)(D(pt))},a.\u0275cmp=M({type:a,selectors:[["app-review-card-modal"]],viewQuery:function(n,p){if(n&1&&Te(zr,5,mi),n&2){let h;Ee(h=ke())&&(p.container=h.first)}},inputs:{review:"review"},standalone:!0,features:[F],decls:1,vars:1,consts:[["container",""],[4,"transloco","translocoRead"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["width","20","height","20","alt","",1,"me-1"],["type","button",1,"btn-close",3,"click"],[1,"modal-body","scrollable-modal"],[1,"img-max-width",3,"innerHTML"],[1,"modal-footer"],["target","_blank","rel","noopener noreferrer",1,"btn","btn-icon"],["type","submit",1,"btn","btn-primary",3,"click"],["width","20","height","20","alt","",1,"me-1",3,"ngSrc"],[3,"innerHTML"],["target","_blank","rel","noopener noreferrer",1,"btn","btn-icon",3,"href","title"]],template:function(n,p){n&1&&m(0,Qr,16,11,"ng-container",1),n&2&&o("translocoRead","review-card-modal")},dependencies:[P,re,ae,V,fe,ye],styles:[`.img-max-width hr{border:solid 2px rgba(var(--primary-color),.5)!important}.img-max-width img{max-width:100%;max-height:800px}.img-max-width h1{font-size:1.5rem}
/*# sourceMappingURL=review-card-modal.component-JS2GJQT6.css.map */
`],encapsulation:2,changeDetection:0});let i=a;return i})();var Jr=i=>({r:i});function Kr(i,a){if(i&1&&(s(0,"div",5),_(1,"i",13),s(2,"span",14),d(3),c()()),i&2){let t=l().$implicit;r(),o("title",t("your-review")),r(2),u(t("your-review"))}}function Yr(i,a){if(i&1&&(_(0,"i",15)(1,"img",16),I(2,"providerImage"),d(3)),i&2){let t=l().$implicit,e=l();o("title",t("your-review")),r(),o("ngSrc",E(2,3,e.ScrobbleProvider.Kavita)),r(2),x(" ",e.review.username," ")}}function Xr(i,a){if(i&1&&(_(0,"img",16),I(1,"providerImage")),i&2){let t=l(2);o("ngSrc",E(1,1,t.review.provider))}}function Zr(i,a){if(i&1&&(s(0,"span",12),d(1),c()),i&2){let t=l().$implicit,e=l();r(),u(t("rating-percentage",N(1,Jr,e.review.score)))}}function eo(i,a){if(i&1){let t=k();g(0),s(1,"div",1),w("click",function(){y(t);let n=l();return S(n.showModal())}),s(2,"div",2)(3,"div",3),_(4,"i",4),m(5,Kr,4,2,"div",5),c(),s(6,"div",6)(7,"div",7)(8,"h6",8),d(9),c(),s(10,"p",9),_(11,"app-read-more",10),c()()(),s(12,"div",11)(13,"div"),m(14,Yr,4,5)(15,Xr,2,3),d(16),I(17,"defaultValue"),c(),m(18,Zr,2,3,"span",12),c()()(),f()}if(i&2){let t=a.$implicit,e=l();r(5),B(5,e.isMyReview?5:-1),r(4),x(" ",e.review.isExternal?t("external-review"):t("local-review")," "),r(2),o("text",(e.review.isExternal?e.review.bodyJustText:e.review.body)||"")("maxLength",100)("showToggle",!1),r(3),B(14,e.isMyReview?14:15),r(2),x(" ",e.isMyReview?"":U(17,8,e.review.username,"")," "),r(2),B(18,e.review.isExternal?18:-1)}}var In=(()=>{let a=class a{constructor(e,n){this.modalService=e,this.cdRef=n,this.accountService=C(ue),this.ScrobbleProvider=rn,this.refresh=new de,this.isMyReview=!1}ngOnInit(){this.accountService.currentUser$.subscribe(e=>{e&&(this.isMyReview=this.review.username===e.username,this.cdRef.markForCheck())})}showModal(){let e;this.isMyReview?e=qt:e=bn;let n=this.modalService.open(e,{size:"lg",fullscreen:"md"});n.componentInstance.review=this.review,n.closed.subscribe(p=>{p&&this.refresh.emit(p)})}};a.\u0275fac=function(n){return new(n||a)(D(xt),D($))},a.\u0275cmp=M({type:a,selectors:[["app-review-card"]],inputs:{review:"review"},outputs:{refresh:"refresh"},standalone:!0,features:[F],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"card","clickable","mb-3",2,"max-width","320px","max-height","160px","height","160px",3,"click"],[1,"row","g-0"],[1,"col-md-2","d-none","d-md-block"],["aria-hidden","true",1,"img-fluid","rounded-start","fa-solid","fa-circle-user","profile-image"],[1,"my-review"],[1,"col-md-10"],[1,"card-body"],[1,"card-title"],[1,"card-text","no-images"],[3,"text","maxLength","showToggle"],[1,"card-footer","bg-transparent","text-muted"],[1,"review-score"],["aria-hidden","true",1,"fa-solid","fa-star",3,"title"],[1,"visually-hidden"],["aria-hidden","true",1,"d-md-none","fa-solid","fa-star","me-1",3,"title"],["width","20","height","20","alt","",1,"me-1",3,"ngSrc"]],template:function(n,p){n&1&&m(0,eo,19,11,"ng-container",0),n&2&&o("translocoRead","review-card")},dependencies:[ce,Lt,fe,ye,V],styles:[`.profile-image[_ngcontent-%COMP%]{font-size:2rem;padding:20px}.my-review[_ngcontent-%COMP%]{position:absolute;z-index:20;top:38px;left:38px}.fa-star[_ngcontent-%COMP%]{color:var(--review-card-star-color)}.card-text[_ngcontent-%COMP%]{font-size:14px}.card-title[_ngcontent-%COMP%]{overflow:hidden;width:235px;word-break:break-all;height:20px}.card-text.no-images[_ngcontent-%COMP%]{min-height:63px;max-height:63px;text-overflow:ellipsis;overflow:hidden}.no-images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:none}.card-footer[_ngcontent-%COMP%]{font-size:13px;display:flex;max-width:319px;justify-content:space-between;margin:0 auto}
/*# sourceMappingURL=review-card.component-34EUZ2UW.css.map */`],changeDetection:0});let i=a;return i})();function to(i,a){if(i&1){let t=k();s(0,"div",3),w("click",function(n){let p=y(t).$implicit,h=l();return S(h.readonly?h.noop():h.onStarClick(n,p))})("mousemove",function(n){let p=y(t).$implicit,h=l();return S(h.readonly?h.noop():h.onStarHover(n,p))}),_(1,"span",4),c()}if(i&2){let t=a.$implicit,e=l();o("ngStyle",e.starPadding()),r(),Le("star-rtl",e.rtl),o("ngClass",t.classname)("ngStyle",e.starColorAndSize())}}var wn=(()=>{class i{constructor(){this.maxStars=5,this.initialStars=0,this.animationSpeed=100,this.wholeStars=!1,this.rtl=!1,this.ratingOutput=new de,this.customClassIdentifier=Math.random().toString(36).substring(2),this.safeSize=()=>Number.isInteger(this.size)&&this.size>0&&this.size<6?this.size:1}ngOnInit(){this.setupStarImages(),this.editableStars=Array.from(new Array(this.maxStars)).map((t,e)=>new ti(e)),this.rtl&&(this.editableStars=this.editableStars.reverse()),this.setRating(this.initialStars),this.animation&&(this.animationInterval=setInterval(this.starAnimation.bind(this),this.animationSpeed))}ngOnDestroy(){this.customCssClasses&&this.customCssClasses.forEach(t=>{t&&t.parentNode&&t.parentNode.removeChild(t)})}setupStarImages(){this.customStarIcons&&(this.customCssClasses=[],Object.keys(this.customStarIcons).map(t=>t).forEach(t=>{let e=this.getStarClass(t);this.createCssClass(e,t)}))}createCssClass(t,e){let n=document.createElement("style");n.type="text/css",n.innerHTML=`.${t} {
      -webkit-mask-image: url(${this.customStarIcons[e]});
      mask-image: url(${this.customStarIcons[e]});
    }`,document.getElementsByTagName("head")[0].appendChild(n),this.customCssClasses.push(n)}starPadding(){return{"margin-right":this.customPadding||`calc(${this.starSize().width} / 10)`}}starColorAndSize(){return Object.assign({},this.starColor(),this.starSize())}starColor(){return{"background-color":this.color||"crimson"}}starSize(){return{height:this.customSize||`${15*this.safeSize()}px`,width:this.customSize||`${16*this.safeSize()}px`}}zeroStarLeft(){return this.rtl?`calc(${this.starSize().width} * ${this.maxStars})`:"-16px"}starAnimation(){this.animationRunning=!0,this.rating<this.maxStars?this.setRating(this.rating+=.5):this.setRating(0)}cancelStarAnimation(){this.animationRunning&&(clearInterval(this.animationInterval),this.rating=0,this.animationRunning=!1)}setRating(t){this.rating=Math.round(t*2)/2,this.onStarsUnhover()}onStarHover(t,e){this.cancelStarAnimation();let n=this.clickedInFirstHalf(t);e.classname=!this.wholeStars&&n?this.getStarClass("half"):this.getStarClass("full"),this.editableStars.forEach(p=>{p.position>e.position?p.classname=this.getStarClass("empty"):p.position<e.position&&(p.classname=this.getStarClass("full"))})}onStarClick(t,e){this.cancelStarAnimation();let n=this.clickedInFirstHalf(t);this.rating=e.position+(!this.wholeStars&&n?.5:1),this.ratingOutput.emit(this.rating)}onZeroStarClick(){this.setRating(0),this.ratingOutput.emit(this.rating)}onZeroStarHover(){this.editableStars.forEach(t=>t.classname=this.getStarClass("empty"))}onStarsUnhover(){this.editableStars.forEach(t=>{let e=t.position+1;this.rating>=e?t.classname=this.getStarClass("full"):this.rating>e-1&&this.rating<e?t.classname=this.getStarClass("half"):t.classname=this.getStarClass("empty")})}clickedInFirstHalf(t){let e=t.target;return this.rtl?t.pageX>e.getBoundingClientRect().right-e.offsetWidth/2:t.pageX<e.getBoundingClientRect().left+e.offsetWidth/2}noop(){}getStarClass(t){return this.customCssClasses?`ngx-stars-star-${t}-${this.customClassIdentifier}`:`star-${t}`}getAriaLabel(){return`Rating: ${this.rating} out of ${this.maxStars} stars ${this.readonly?"":". Can be edited."}`}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=M({type:i,selectors:[["ngx-stars"]],inputs:{maxStars:"maxStars",initialStars:"initialStars",readonly:"readonly",size:"size",customSize:"customSize",color:"color",animation:"animation",animationSpeed:"animationSpeed",customPadding:"customPadding",wholeStars:"wholeStars",customStarIcons:"customStarIcons",rtl:"rtl"},outputs:{ratingOutput:"ratingOutput"},decls:3,vars:5,consts:[["role","img",1,"stars-line",3,"mouseleave"],["aria-hidden","true",1,"star","zero-star",3,"click","mousemove","ngStyle"],["aria-hidden","true",3,"ngStyle","click","mousemove",4,"ngFor","ngForOf"],["aria-hidden","true",3,"click","mousemove","ngStyle"],["aria-hidden","true",1,"star",3,"ngClass","ngStyle"]],template:function(t,e){t&1&&(s(0,"div",0),w("mouseleave",function(){return e.readonly?e.noop():e.onStarsUnhover()}),s(1,"span",1),w("click",function(){return e.readonly?e.noop():e.onZeroStarClick()})("mousemove",function(){return e.readonly?e.noop():e.onZeroStarHover()}),c(),m(2,to,2,5,"div",2),c()),t&2&&(X("aria-label",e.getAriaLabel()),r(),di("left",e.zeroStarLeft()),o("ngStyle",e.starSize()),r(),o("ngForOf",e.editableStars))},dependencies:[$e,ne,_t],styles:[`.stars-line[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative}.stars-line[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{z-index:999}.zero-star[_ngcontent-%COMP%]{color:transparent;position:absolute}.star[_ngcontent-%COMP%]{display:inline-block;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat}.star-rtl[_ngcontent-%COMP%]{transform:scaleX(-1)}.star-empty[_ngcontent-%COMP%]{-webkit-mask-image:url("data:image/svg+xml,%3Csvg aria-hidden='true' focusable='false' data-prefix='far' data-icon='star' class='svg-inline--fa fa-star fa-w-18' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512'%3E%3Cpath fill='currentColor' d='M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z'%3E%3C/path%3E%3C/svg%3E%0A");mask-image:url("data:image/svg+xml,%3Csvg aria-hidden='true' focusable='false' data-prefix='far' data-icon='star' class='svg-inline--fa fa-star fa-w-18' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512'%3E%3Cpath fill='currentColor' d='M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z'%3E%3C/path%3E%3C/svg%3E%0A")}.star-half[_ngcontent-%COMP%]{-webkit-mask-image:url("data:image/svg+xml,%3C!-- had to hack this one's viewbox otherwise it didn't line up with the other two --%3E%3C!-- changed viewbox from '0 0 536 512' to '-20 0 576 512' --%3E%3Csvg aria-hidden='true' focusable='false' data-prefix='fas' data-icon='star-half-alt' class='svg-inline--fa fa-star-half-alt fa-w-17' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='-20 0 576 512'%3E%3Cpath fill='currentColor' d='M508.55 171.51L362.18 150.2 296.77 17.81C290.89 5.98 279.42 0 267.95 0c-11.4 0-22.79 5.9-28.69 17.81l-65.43 132.38-146.38 21.29c-26.25 3.8-36.77 36.09-17.74 54.59l105.89 103-25.06 145.48C86.98 495.33 103.57 512 122.15 512c4.93 0 10-1.17 14.87-3.75l130.95-68.68 130.94 68.7c4.86 2.55 9.92 3.71 14.83 3.71 18.6 0 35.22-16.61 31.66-37.4l-25.03-145.49 105.91-102.98c19.04-18.5 8.52-50.8-17.73-54.6zm-121.74 123.2l-18.12 17.62 4.28 24.88 19.52 113.45-102.13-53.59-22.38-11.74.03-317.19 51.03 103.29 11.18 22.63 25.01 3.64 114.23 16.63-82.65 80.38z'%3E%3C/path%3E%3C/svg%3E");mask-image:url("data:image/svg+xml,%3C!-- had to hack this one's viewbox otherwise it didn't line up with the other two --%3E%3C!-- changed viewbox from '0 0 536 512' to '-20 0 576 512' --%3E%3Csvg aria-hidden='true' focusable='false' data-prefix='fas' data-icon='star-half-alt' class='svg-inline--fa fa-star-half-alt fa-w-17' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='-20 0 576 512'%3E%3Cpath fill='currentColor' d='M508.55 171.51L362.18 150.2 296.77 17.81C290.89 5.98 279.42 0 267.95 0c-11.4 0-22.79 5.9-28.69 17.81l-65.43 132.38-146.38 21.29c-26.25 3.8-36.77 36.09-17.74 54.59l105.89 103-25.06 145.48C86.98 495.33 103.57 512 122.15 512c4.93 0 10-1.17 14.87-3.75l130.95-68.68 130.94 68.7c4.86 2.55 9.92 3.71 14.83 3.71 18.6 0 35.22-16.61 31.66-37.4l-25.03-145.49 105.91-102.98c19.04-18.5 8.52-50.8-17.73-54.6zm-121.74 123.2l-18.12 17.62 4.28 24.88 19.52 113.45-102.13-53.59-22.38-11.74.03-317.19 51.03 103.29 11.18 22.63 25.01 3.64 114.23 16.63-82.65 80.38z'%3E%3C/path%3E%3C/svg%3E")}.star-full[_ngcontent-%COMP%]{-webkit-mask-image:url("data:image/svg+xml,%3Csvg aria-hidden='true' focusable='false' data-prefix='fas' data-icon='star' class='svg-inline--fa fa-star fa-w-18' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512'%3E%3Cpath fill='currentColor' d='M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z'%3E%3C/path%3E%3C/svg%3E");mask-image:url("data:image/svg+xml,%3Csvg aria-hidden='true' focusable='false' data-prefix='fas' data-icon='star' class='svg-inline--fa fa-star fa-w-18' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512'%3E%3Cpath fill='currentColor' d='M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z'%3E%3C/path%3E%3C/svg%3E")}`]}),i})(),ti=class{constructor(a){this.position=a}},Tn=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ci({type:i}),i.\u0275inj=si({imports:[P]}),i})();var no=i=>({rating:i});function ao(i,a){if(i&1&&(g(0),d(1),f()),i&2){let t=l();r(),u(t.userRating*20)}}function ro(i,a){i&1&&d(0,"N/A")}function oo(i,a){if(i&1&&(g(0),d(1),f()),i&2){let t=l();r(),x(" + ",t.overallRating,"")}}function lo(i,a){i&1&&(g(0),d(1,"%"),f())}function so(i,a){if(i&1&&(s(0,"div",12),I(1,"providerName"),s(2,"span",13),_(3,"img",14),I(4,"providerImage"),d(5),c()()),i&2){let t=a.$implicit;l();let e=b(15);o("ngbPopover",e)("popoverContext",N(9,no,t))("popoverTitle",E(1,5,t.provider)),r(3),o("ngSrc",E(4,7,t.provider)),r(2),x(" ",t.averageScore,"% ")}}function co(i,a){if(i&1){let t=k();s(0,"ngx-stars",15),w("ratingOutput",function(n){y(t);let p=l();return S(p.updateRating(n))}),c(),d(1)}if(i&2){let t=l();o("initialStars",t.userRating)("size",t.utilityService.getActiveBreakpoint()>t.Breakpoint.Mobile?1:2)("maxStars",5)("color",t.starColor),r(),x(" ",t.userRating*20,`%
`)}}function po(i,a){if(i&1&&(s(0,"a",18),d(1,"Entry"),c()),i&2){let t=l().rating;o("href",t.providerUrl,Q)}}function mo(i,a){if(i&1&&(s(0,"div"),_(1,"i",16),d(2),c(),m(3,po,2,1,"a",17)),i&2){let t=a.rating;r(2),x(" ",t.favoriteCount,""),r(),o("ngIf",t.providerUrl)}}var En=(()=>{let a=class a{constructor(){this.cdRef=C($),this.seriesService=C(se),this.themeService=C(Fi),this.utilityService=C(z),this.destroyRef=C(Y),this.Breakpoint=le,this.ratings=[],this.isLoading=!1,this.overallRating=-1,this.starColor=this.themeService.getCssVariable("--rating-star-color")}ngOnInit(){this.seriesService.getOverallRating(this.seriesId).subscribe(e=>this.overallRating=e.averageScore)}updateRating(e){this.seriesService.updateRating(this.seriesId,e).subscribe(()=>{this.userRating=e,this.hasUserRated=!0,this.cdRef.markForCheck()})}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=M({type:a,selectors:[["app-external-rating"]],inputs:{seriesId:"seriesId",userRating:"userRating",hasUserRated:"hasUserRated",libraryType:"libraryType",ratings:"ratings"},standalone:!0,features:[F],decls:16,vars:8,consts:[["notYetRated",""],["popContent",""],["externalPopContent",""],[1,"row","g-0"],["popoverTitle","Your Rating + Overall",1,"col-auto","custom-col","clickable",3,"ngbPopover","popoverClass"],[1,"badge","rounded-pill","ps-0","me-1"],["classes","me-1","imageUrl","assets/images/logo-32.png","width","24px","height","24px"],[4,"ngIf","ngIfElse"],[4,"ngIf"],["class","col-auto custom-col clickable","popoverClass","sm-popover",3,"ngbPopover","popoverContext","popoverTitle",4,"ngFor","ngForOf"],[1,"col-auto",2,"padding-top","8px"],["size","spinner-border-sm",3,"loading"],["popoverClass","sm-popover",1,"col-auto","custom-col","clickable",3,"ngbPopover","popoverContext","popoverTitle"],[1,"badge","rounded-pill","me-1"],["width","24","height","24","alt","","aria-hidden","true",1,"me-1",3,"ngSrc"],[3,"ratingOutput","initialStars","size","maxStars","color"],["aria-hidden","true",1,"fa-solid","fa-heart"],["target","_blank","rel","noreferrer nofollow",3,"href",4,"ngIf"],["target","_blank","rel","noreferrer nofollow",3,"href"]],template:function(n,p){if(n&1&&(s(0,"div",3)(1,"div",4)(2,"span",5),_(3,"app-image",6),m(4,ao,2,1,"ng-container",7)(5,ro,1,0,"ng-template",null,0,v)(7,oo,2,1,"ng-container",8)(8,lo,2,0,"ng-container",8),c()(),m(9,so,6,11,"div",9),s(10,"div",10),_(11,"app-loading",11),c()(),m(12,co,2,5,"ng-template",null,1,v)(14,mo,4,2,"ng-template",null,2,v)),n&2){let h=b(6),T=b(13);r(),o("ngbPopover",T)("popoverClass",p.utilityService.getActiveBreakpoint()>p.Breakpoint.Mobile?"md-popover":"lg-popover"),r(3),o("ngIf",p.hasUserRated)("ngIfElse",h),r(3),o("ngIf",p.overallRating>0),r(),o("ngIf",p.hasUserRated||p.overallRating>0),r(),o("ngForOf",p.ratings),r(2),o("loading",p.isLoading)}},dependencies:[P,ne,L,ye,fe,Ri,$t,cn,Tn,wn,A],styles:[`.custom-col{padding-left:0;padding-right:0}.badge{color:var(--badge-text-color)}.sm-popover{width:150px}.sm-popover>.popover-body{padding-top:10px}.md-popover{width:214px}.md-popover>.popover-body{padding-top:10px}.lg-popover{width:320px}.lg-popover>.popover-body{padding-top:10px}.rating-star i{position:relative;display:inline-block;padding-right:.1rem;color:#d3d3d3}.rating-star .filled{color:var(--primary-color)}::ng-deep .star{background-color:var(--primary-color)}
/*# sourceMappingURL=external-rating.component-VUO7ZOU7.css.map */
`],encapsulation:2,changeDetection:0});let i=a;return i})();var kn=(()=>{let a=class a{constructor(e){this.metadataService=e}transform(e){return this.metadataService.getAllValidLanguages().pipe(te(n=>{let p=n.filter(h=>h.isoCode===e);return p.length>0?p[0].title:""}),Ne())}};a.\u0275fac=function(n){return new(n||a)(D(Dt,16))},a.\u0275pipe=pi({name:"languageName",type:a,pure:!0,standalone:!0});let i=a;return i})();var Rn=i=>({num:i});function _o(i,a){if(i&1&&(g(0),s(1,"div",6)(2,"app-icon-and-title",8),d(3),c()(),_(4,"div",9),f()),i&2){let t=l().$implicit,e=l();r(2),o("label",t("release-date-title"))("clickable",!1)("title",t("release-year-tooltip")),r(),x(" ",e.seriesMetadata.releaseYear," ")}}function go(i,a){if(i&1){let t=k();g(0),s(1,"div",6)(2,"app-icon-and-title",10),w("click",function(){y(t);let n=l(3);return S(n.handleGoTo(n.FilterField.AgeRating,n.seriesMetadata.ageRating))}),d(3),I(4,"ageRating"),c()(),_(5,"div",9),f()}if(i&2){let t=l(2).$implicit,e=l();r(2),o("label",t("age-rating-title"))("clickable",!0)("title",t("age-rating-title")),r(),x(" ",E(4,4,e.seriesMetadata.ageRating)," ")}}function fo(i,a){if(i&1){let t=k();g(0),s(1,"div",6)(2,"app-icon-and-title",11),w("click",function(){y(t);let n=l(3);return S(n.handleGoTo(n.FilterField.Languages,n.seriesMetadata.language))}),d(3),I(4,"defaultValue"),I(5,"languageName"),I(6,"async"),c()(),_(7,"div",9),f()}if(i&2){let t=l(2).$implicit,e=l();r(2),o("label",t("language-title"))("clickable",!0)("title",t("language-title")),r(),x(" ",E(6,9,E(5,7,U(4,4,e.seriesMetadata.language,"en")))," ")}}function ho(i,a){if(i&1&&(g(0),m(1,go,6,6,"ng-container",5)(2,fo,8,11,"ng-container",5),f()),i&2){let t=l(2);r(),o("ngIf",t.seriesMetadata.ageRating),r(),o("ngIf",t.seriesMetadata.language!==null&&t.seriesMetadata.language!=="")}}function uo(i,a){if(i&1){let t=k();g(0),s(1,"app-icon-and-title",12),w("click",function(){y(t);let n=l(2);return S(n.handleGoTo(n.FilterField.PublicationStatus,n.seriesMetadata.publicationStatus))}),d(2),c(),f()}if(i&2){let t=a.ngIf,e=l().$implicit,n=l();r(),ie("fontClasses","fa-solid fa-hourglass-",t===e("ongoing")?"empty":"end",""),o("label",e("publication-status-title"))("clickable",!0)("ngbTooltip",e("publication-status-tooltip")+" ("+n.seriesMetadata.maxCount+" / "+n.seriesMetadata.totalCount+")"),r(),x(" ",t," ")}}function Co(i,a){if(i&1&&(g(0),d(1),f()),i&2){let t=l(2).$implicit,e=l();r(),x(" ",e.isScrobbling?t("on"):t("off")," ")}}function xo(i,a){if(i&1&&d(0),i&2){let t=l(2).$implicit;x(" ",t("disabled")," ")}}function vo(i,a){if(i&1){let t=k();g(0),s(1,"div",6)(2,"app-icon-and-title",12),w("click",function(n){y(t);let p=l(2);return S(p.toggleScrobbling(n))}),m(3,Co,2,1,"ng-container",13)(4,xo,1,1,"ng-template",null,0,v),c()(),_(6,"div",9),f()}if(i&2){let t=b(5),e=l().$implicit,n=l();r(2),ie("fontClasses","fa-solid fa-tower-",n.isScrobbling&&n.libraryAllowsScrobbling?"broadcast":"observation",""),o("label",e("scrobbling-title"))("clickable",n.libraryAllowsScrobbling)("ngbTooltip",e("scrobbling-tooltip")),r(),o("ngIf",n.libraryAllowsScrobbling)("ngIfElse",t)}}function yo(i,a){if(i&1&&(g(0),s(1,"div",14)(2,"app-icon-and-title",16),d(3),I(4,"timeAgo"),c()(),_(5,"div",9),f()),i&2){let t=l(2).$implicit,e=l();r(2),o("label",t("last-read-title"))("clickable",!1)("title",t("last-read-title")),r(),x(" ",E(4,4,e.series.latestReadDate)," ")}}function So(i,a){if(i&1&&(g(0),s(1,"div",6)(2,"app-icon-and-title",17),d(3),I(4,"compactNumber"),c()(),_(5,"div",9),f()),i&2){let t=l(3).$implicit,e=l();r(2),o("label",t("length-title"))("clickable",!1),r(),x(" ",t("words-count",N(5,Rn,E(4,3,e.series.wordCount)))," ")}}function bo(i,a){if(i&1&&(g(0),m(1,So,6,7,"ng-container",5),f()),i&2){let t=l(3);r(),o("ngIf",t.series.wordCount>0)}}function Io(i,a){if(i&1&&(s(0,"div",14)(1,"app-icon-and-title",18),d(2),I(3,"compactNumber"),c()(),_(4,"div",9)),i&2){let t=l(2).$implicit,e=l();r(),o("label",t("length-title"))("clickable",!1),r(),x(" ",t("pages-count",N(5,Rn,E(3,3,e.series.pages)))," ")}}function wo(i,a){if(i&1&&(g(0),d(1),f()),i&2){let t=l(3).$implicit;r(),u(t("less-than-hour"))}}function To(i,a){if(i&1&&d(0),i&2){let t=l(3).$implicit,e=l();st(" ",e.readingTime.minHours,"",e.readingTime.maxHours!==e.readingTime.minHours?"-"+e.readingTime.maxHours:""," ",e.readingTime.minHours>1?t("hours"):t("hour")," ")}}function Eo(i,a){if(i&1&&(g(0),s(1,"div",6)(2,"app-icon-and-title",19),m(3,wo,2,1,"ng-container",13)(4,To,1,3,"ng-template",null,2,v),c()(),f()),i&2){let t=b(5),e=l(2).$implicit,n=l();r(2),o("label",e("read-time-title"))("clickable",!1),r(),o("ngIf",n.readingTime.maxHours===0||n.readingTime.minHours===0)("ngIfElse",t)}}function ko(i,a){if(i&1&&(g(0),_(1,"div",9),s(2,"div",6)(3,"app-icon-and-title",20),d(4),c()(),f()),i&2){let t=l(2).$implicit,e=l();r(3),o("clickable",!1),r(),_e(" ~",e.readingTimeLeft.avgHours," ",e.readingTimeLeft.avgHours>1?t("hours"):t("hour")," ")}}function Ro(i,a){if(i&1){let t=k();g(0)(1),s(2,"div",14)(3,"app-icon-and-title",15),I(4,"mangaFormatIcon"),w("click",function(){y(t);let n=l(2);return S(n.handleGoTo(n.FilterField.Formats,n.series.format))}),d(5),I(6,"mangaFormat"),c()(),_(7,"div",9),f(),m(8,yo,6,6,"ng-container",5),I(9,"date"),m(10,bo,2,1,"ng-container",13)(11,Io,5,7,"ng-template",null,1,v)(13,Eo,6,4,"ng-container",5)(14,ko,5,3,"ng-container",5),f()}if(i&2){let t=b(12),e=l().$implicit,n=l();r(3),o("label",e("format-title"))("clickable",!0)("fontClasses",E(4,10,n.series.format))("title",e("format-title")),r(2),x(" ",E(6,12,n.series.format)," "),r(3),o("ngIf",n.series.latestReadDate&&n.series.latestReadDate!==""&&U(9,14,n.series.latestReadDate,"shortDate")!=="1/1/01"),r(2),o("ngIf",n.series.format===n.MangaFormat.EPUB)("ngIfElse",t),r(3),o("ngIf",n.series.format===n.MangaFormat.EPUB&&n.series.wordCount>0||n.series.format!==n.MangaFormat.EPUB),r(),o("ngIf",n.hasReadingProgress&&n.showReadingTimeLeft&&n.readingTimeLeft&&n.readingTimeLeft.avgHours!==0)}}function Mo(i,a){if(i&1&&(g(0),s(1,"div",4),m(2,_o,5,4,"ng-container",5)(3,ho,3,2,"ng-container",5),g(4),s(5,"div",6),m(6,uo,3,6,"ng-container",5),I(7,"publicationStatus"),c(),_(8,"div",7),f(),m(9,vo,7,7,"ng-container",5),I(10,"async"),m(11,Ro,15,17,"ng-container",5),c(),f()),i&2){let t=l();r(2),o("ngIf",t.seriesMetadata.releaseYear>0),r(),o("ngIf",t.seriesMetadata),r(3),o("ngIf",E(7,5,t.seriesMetadata.publicationStatus)),r(3),o("ngIf",E(10,7,t.accountService.hasValidLicense$)),r(2),o("ngIf",t.series)}}var Mn=(()=>{let a=class a{constructor(){this.destroyRef=C(Y),this.utilityService=C(z),this.readerService=C(ve),this.cdRef=C($),this.messageHub=C(gt),this.accountService=C(ue),this.scrobbleService=C(on),this.hasReadingProgress=!1,this.showReadingTimeLeft=!0,this.goTo=new de,this.readingTime={avgHours:0,maxHours:0,minHours:0},this.isScrobbling=!0,this.libraryAllowsScrobbling=!0,this.MangaFormat=Ce,this.FilterField=Fe,this.messageHub.messages$.pipe(ai(e=>e.event===Ke.UserProgressUpdate),te(e=>e.payload),oi(500),J(this.destroyRef)).subscribe(e=>{this.accountService.currentUser$.pipe(J(this.destroyRef)).subscribe(n=>{n===void 0||n.username!==e.username||e.seriesId===this.series.id&&this.getReadingTimeLeft()})})}ngOnInit(){this.series!==null&&(this.getReadingTimeLeft(),this.readingTime.minHours=this.series.minHoursToRead,this.readingTime.maxHours=this.series.maxHoursToRead,this.readingTime.avgHours=this.series.avgHoursToRead,this.scrobbleService.hasHold(this.series.id).subscribe(e=>{this.isScrobbling=!e,this.cdRef.markForCheck()}),this.scrobbleService.libraryAllowsScrobbling(this.series.id).subscribe(e=>{this.libraryAllowsScrobbling=e,this.cdRef.markForCheck()}),this.cdRef.markForCheck())}ngOnChanges(){this.cdRef.markForCheck()}handleGoTo(e,n){n+""==""&&e===Fe.SeriesName||this.goTo.emit({queryParamName:e,filter:n})}getReadingTimeLeft(){this.showReadingTimeLeft&&this.readerService.getTimeLeft(this.series.id).subscribe(e=>{this.readingTimeLeft=e,this.cdRef.markForCheck()})}toggleScrobbling(e){e.stopPropagation(),this.isScrobbling?this.scrobbleService.addHold(this.series.id).subscribe(()=>{this.isScrobbling=!this.isScrobbling,this.cdRef.markForCheck()}):this.scrobbleService.removeHold(this.series.id).subscribe(()=>{this.isScrobbling=!this.isScrobbling,this.cdRef.markForCheck()})}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=M({type:a,selectors:[["app-series-info-cards"]],inputs:{series:"series",seriesMetadata:"seriesMetadata",hasReadingProgress:"hasReadingProgress",readingTimeLeft:"readingTimeLeft",showReadingTimeLeft:"showReadingTimeLeft"},outputs:{goTo:"goTo"},standalone:!0,features:[it,F],decls:1,vars:1,consts:[["noScrobble",""],["showPages",""],["normalReadTime",""],[4,"transloco","translocoRead"],[1,"row","g-0","mt-3"],[4,"ngIf"],[1,"col-lg-1","col-md-4","col-sm-4","col-4","mb-2"],[1,"vr","m-2","d-none","d-lg-block"],["fontClasses","fa-regular fa-calendar",3,"label","clickable","title"],[1,"vr","d-none","d-lg-block","m-2"],["fontClasses","fas fa-eye",3,"click","label","clickable","title"],["fontClasses","fas fa-language",3,"click","label","clickable","title"],[3,"click","label","clickable","fontClasses","ngbTooltip"],[4,"ngIf","ngIfElse"],[1,"d-none","d-md-block","col-lg-1","col-md-4","col-sm-4","col-4","mb-2"],[3,"click","label","clickable","fontClasses","title"],["fontClasses","fa-regular fa-clock",3,"label","clickable","title"],["fontClasses","fa-solid fa-book-open",3,"label","clickable"],["fontClasses","fa-regular fa-file-lines",3,"label","clickable"],["fontClasses","fa-regular fa-clock",3,"label","clickable"],["label","Time Left","fontClasses","fa-solid fa-clock",3,"clickable"]],template:function(n,p){n&1&&m(0,Mo,12,9,"ng-container",3),n&2&&o("translocoRead","series-info-cards")},dependencies:[P,L,ge,Oe,Ht,Wt,Lt,kn,Gi,Wi,ji,At,Xi,oe,V],styles:["/*# sourceMappingURL=series-info-cards.component-6N2DKVKB.css.map */"],changeDetection:0});let i=a;return i})();var Do=()=>[""];function Fo(i,a){if(i&1&&_(0,"app-external-rating",14),i&2){let t=l(2);o("seriesId",t.series.id)("ratings",t.ratings)("userRating",t.series.userRating)("hasUserRated",t.series.hasUserRated)("libraryType",t.libraryType)}}function Po(i,a){if(i&1&&(s(0,"a",15),I(1,"safeHtml"),_(2,"app-image",16),c()),i&2){let t=a.$implicit,e=l(3);o("href",E(1,4,t),Q)("title",t),r(2),o("imageUrl",e.imageService.getWebLinkImage(t))("errorImage",e.imageService.errorWebLinkImage)}}function No(i,a){if(i&1&&(g(0),s(1,"app-metadata-detail",6),m(2,Po,3,6,"ng-template",null,0,v),c(),f()),i&2){let t=a.ngIf,e=l().$implicit,n=l();r(),o("tags",t)("libraryId",n.series.libraryId)("heading",e("links-title"))}}function Lo(i,a){if(i&1&&d(0),i&2){let t=a.$implicit;u(t.title)}}function Vo(i,a){if(i&1&&d(0),i&2){let t=a.$implicit;u(t.title)}}function $o(i,a){if(i&1){let t=k();s(0,"app-tag-badge",17),w("click",function(){let n=y(t).$implicit,p=l(3);return S(p.navigate("collections",n.id))}),_(1,"app-promoted-icon",18),d(2),c()}if(i&2){let t=a.$implicit,e=l(3);o("selectionMode",e.TagBadgeCursor.Clickable),r(),o("promoted",t.promoted),r(),x(" ",t.title," ")}}function Oo(i,a){if(i&1&&(s(0,"app-metadata-detail",6),I(1,"async"),m(2,$o,3,3,"ng-template",null,0,v),c()),i&2){let t=l().$implicit,e=l();o("tags",E(1,3,e.collections$))("libraryId",e.series.libraryId)("heading",t("collections-title"))}}function Bo(i,a){if(i&1&&(s(0,"span"),_(1,"i",19),d(2,"\xA0 "),s(3,"span",20),d(4),c()()),i&2){let t=l(2).$implicit;r(4),x("(",t("promoted"),")")}}function Uo(i,a){if(i&1){let t=k();s(0,"app-tag-badge",17),w("click",function(){let n=y(t).$implicit,p=l(2);return S(p.navigate("lists",n.id))}),m(1,Bo,5,1,"span",7),d(2),c()}if(i&2){let t=a.$implicit,e=l(2);o("selectionMode",e.TagBadgeCursor.Clickable),r(),o("ngIf",t.promoted),r(),x(" ",t.title," ")}}function Ao(i,a){if(i&1&&_(0,"app-person-badge",21),i&2){let t=a.$implicit;o("person",t)}}function Ho(i,a){if(i&1&&_(0,"app-person-badge",21),i&2){let t=a.$implicit;o("person",t)}}function zo(i,a){if(i&1&&_(0,"app-person-badge",21),i&2){let t=a.$implicit;o("person",t)}}function Wo(i,a){if(i&1&&_(0,"app-person-badge",21),i&2){let t=a.$implicit;o("person",t)}}function jo(i,a){if(i&1&&_(0,"app-person-badge",21),i&2){let t=a.$implicit;o("person",t)}}function Go(i,a){if(i&1&&_(0,"app-person-badge",21),i&2){let t=a.$implicit;o("person",t)}}function qo(i,a){if(i&1&&_(0,"app-person-badge",21),i&2){let t=a.$implicit;o("person",t)}}function Qo(i,a){if(i&1&&_(0,"app-person-badge",21),i&2){let t=a.$implicit;o("person",t)}}function Jo(i,a){if(i&1&&_(0,"app-person-badge",21),i&2){let t=a.$implicit;o("person",t)}}function Ko(i,a){if(i&1&&_(0,"app-person-badge",21),i&2){let t=a.$implicit;o("person",t)}}function Yo(i,a){if(i&1&&_(0,"app-person-badge",21),i&2){let t=a.$implicit;o("person",t)}}function Xo(i,a){if(i&1&&_(0,"app-person-badge",21),i&2){let t=a.$implicit;o("person",t)}}function Zo(i,a){if(i&1&&_(0,"app-person-badge",21),i&2){let t=a.$implicit;o("person",t)}}function el(i,a){i&1&&_(0,"hr",22)}function tl(i,a){if(i&1){let t=k();s(0,"a",23),w("click",function(){y(t);let n=l(2);return S(n.toggleView())}),_(1,"i",24),d(2),c()}if(i&2){let t=l().$implicit,e=l();Le("hidden",e.hasExtendedProperties),r(),we("fa fa-caret-",e.isCollapsed?"down":"up"," me-1"),r(),x(" ",e.isCollapsed?t("see-more"):t("see-less")," ")}}function il(i,a){if(i&1){let t=k();g(0),s(1,"div",4),_(2,"app-read-more",5),c(),s(3,"app-metadata-detail",6),m(4,Fo,1,5,"ng-template",null,0,v),c(),m(6,No,4,3,"ng-container",7),s(7,"app-metadata-detail",8),m(8,Lo,1,1,"ng-template",null,1,v),c(),s(10,"app-metadata-detail",8),m(11,Vo,1,1,"ng-template",null,1,v),c(),m(13,Oo,4,5,"app-metadata-detail"),s(14,"app-metadata-detail",6),m(15,Uo,3,3,"ng-template",null,0,v),c(),s(17,"app-metadata-detail",8),m(18,Ao,1,1,"ng-template",null,0,v),c(),s(20,"div",9,2),De("ngbCollapseChange",function(n){y(t);let p=l();return Me(p.isCollapsed,n)||(p.isCollapsed=n),S(n)}),s(22,"app-metadata-detail",8),m(23,Ho,1,1,"ng-template",null,0,v),c(),s(25,"app-metadata-detail",8),m(26,zo,1,1,"ng-template",null,0,v),c(),s(28,"app-metadata-detail",8),m(29,Wo,1,1,"ng-template",null,0,v),c(),s(31,"app-metadata-detail",8),m(32,jo,1,1,"ng-template",null,0,v),c(),s(34,"app-metadata-detail",8),m(35,Go,1,1,"ng-template",null,0,v),c(),s(37,"app-metadata-detail",8),m(38,qo,1,1,"ng-template",null,0,v),c(),s(40,"app-metadata-detail",8),m(41,Qo,1,1,"ng-template",null,0,v),c(),s(43,"app-metadata-detail",8),m(44,Jo,1,1,"ng-template",null,0,v),c(),s(46,"app-metadata-detail",8),m(47,Ko,1,1,"ng-template",null,0,v),c(),s(49,"app-metadata-detail",8),m(50,Yo,1,1,"ng-template",null,0,v),c(),s(52,"app-metadata-detail",8),m(53,Xo,1,1,"ng-template",null,0,v),c(),s(55,"app-metadata-detail",8),m(56,Zo,1,1,"ng-template",null,0,v),c()(),s(58,"div",10),m(59,el,1,0,"hr",11)(60,tl,3,6,"a",12),c(),s(61,"app-series-info-cards",13),w("goTo",function(n){y(t);let p=l();return S(p.handleGoTo(n))}),c(),f()}if(i&2){let t=a.$implicit,e=l();r(2),o("text",e.seriesSummary)("maxLength",e.utilityService.getActiveBreakpoint()>=e.Breakpoint.Desktop?1e3:250),r(),o("tags",ct(76,Do))("libraryId",e.series.libraryId)("heading",t("rating-title")),r(3),o("ngIf",e.WebLinks),r(),o("tags",e.seriesMetadata.genres)("libraryId",e.series.libraryId)("queryParam",e.FilterField.Genres)("heading",t("genres-title")),r(3),o("tags",e.seriesMetadata.tags)("libraryId",e.series.libraryId)("queryParam",e.FilterField.Tags)("heading",t("tags-title")),r(3),B(13,e.collections$?13:-1),r(),o("tags",e.readingLists)("libraryId",e.series.libraryId)("heading",t("reading-lists-title")),r(3),o("tags",e.seriesMetadata.writers)("libraryId",e.series.libraryId)("queryParam",e.FilterField.Writers)("heading",t("writers-title")),r(3),Re("ngbCollapse",e.isCollapsed),r(2),o("tags",e.seriesMetadata.coverArtists)("libraryId",e.series.libraryId)("queryParam",e.FilterField.CoverArtist)("heading",t("cover-artists-title")),r(3),o("tags",e.seriesMetadata.colorists)("libraryId",e.series.libraryId)("queryParam",e.FilterField.Colorist)("heading",t("colorists-title")),r(3),o("tags",e.seriesMetadata.editors)("libraryId",e.series.libraryId)("queryParam",e.FilterField.Editor)("heading",t("editors-title")),r(3),o("tags",e.seriesMetadata.inkers)("libraryId",e.series.libraryId)("queryParam",e.FilterField.Inker)("heading",t("inkers-title")),r(3),o("tags",e.seriesMetadata.letterers)("libraryId",e.series.libraryId)("queryParam",e.FilterField.Letterer)("heading",t("letterers-title")),r(3),o("tags",e.seriesMetadata.pencillers)("libraryId",e.series.libraryId)("queryParam",e.FilterField.Penciller)("heading",t("pencillers-title")),r(3),o("tags",e.seriesMetadata.characters)("libraryId",e.series.libraryId)("queryParam",e.FilterField.Characters)("heading",t("characters-title")),r(3),o("tags",e.seriesMetadata.teams)("libraryId",e.series.libraryId)("queryParam",e.FilterField.Team)("heading",t("teams-title")),r(3),o("tags",e.seriesMetadata.locations)("libraryId",e.series.libraryId)("queryParam",e.FilterField.Location)("heading",t("locations-title")),r(3),o("tags",e.seriesMetadata.publishers)("libraryId",e.series.libraryId)("queryParam",e.FilterField.Publisher)("heading",t("publishers-title")),r(3),o("tags",e.seriesMetadata.imprints)("libraryId",e.series.libraryId)("queryParam",e.FilterField.Imprint)("heading",t("imprints-title")),r(3),o("tags",e.seriesMetadata.translators)("libraryId",e.series.libraryId)("queryParam",e.FilterField.Translators)("heading",t("translators-title")),r(4),o("ngIf",e.hasExtendedProperties),r(),o("ngIf",e.hasExtendedProperties),r(),o("series",e.series)("seriesMetadata",e.seriesMetadata)("hasReadingProgress",e.hasReadingProgress)}}var Dn=(()=>{let a=class a{constructor(){this.imageService=C(xe),this.utilityService=C(z),this.router=C(Ue),this.cdRef=C($),this.filterUtilityService=C(an),this.collectionTagService=C(Vi),this.destroyRef=C(Y),this.FilterField=Fe,this.LibraryType=O,this.MangaFormat=Ce,this.TagBadgeCursor=Ft,this.Breakpoint=le,this.hasReadingProgress=!1,this.readingLists=[],this.ratings=[],this.isCollapsed=!0,this.hasExtendedProperties=!1,this.seriesSummary=""}get WebLinks(){return this.seriesMetadata?.webLinks===""?[]:this.seriesMetadata?.webLinks.split(",")||[]}ngOnInit(){this.isCollapsed=this.utilityService.getActiveBreakpoint()<le.Desktop,(this.seriesMetadata.colorists.length+this.seriesMetadata.editors.length+this.seriesMetadata.coverArtists.length+this.seriesMetadata.inkers.length+this.seriesMetadata.letterers.length+this.seriesMetadata.pencillers.length+this.seriesMetadata.publishers.length+this.seriesMetadata.characters.length+this.seriesMetadata.imprints.length+this.seriesMetadata.translators.length+this.seriesMetadata.writers.length+this.seriesMetadata.teams.length+this.seriesMetadata.locations.length)/13>10&&(this.isCollapsed=!0),this.collections$=this.collectionTagService.allCollectionsForSeries(this.series.id).pipe(J(this.destroyRef),Ne({bufferSize:1,refCount:!0})),this.cdRef.markForCheck()}ngOnChanges(e){this.hasExtendedProperties=this.seriesMetadata.colorists.length>0||this.seriesMetadata.editors.length>0||this.seriesMetadata.coverArtists.length>0||this.seriesMetadata.inkers.length>0||this.seriesMetadata.letterers.length>0||this.seriesMetadata.pencillers.length>0||this.seriesMetadata.publishers.length>0||this.seriesMetadata.characters.length>0||this.seriesMetadata.imprints.length>0||this.seriesMetadata.teams.length>0||this.seriesMetadata.locations.length>0||this.seriesMetadata.translators.length>0,this.seriesSummary=(this.seriesMetadata?.summary===null?"":this.seriesMetadata.summary).replace(/\n/g,"<br>"),this.cdRef.markForCheck()}toggleView(){this.isCollapsed=!this.isCollapsed,this.cdRef.markForCheck()}handleGoTo(e){this.goTo(e.queryParamName,e.filter)}goTo(e,n){this.filterUtilityService.applyFilter(["library",this.series.libraryId],e,zi.Equal,n).subscribe()}navigate(e,n){this.router.navigate([e,n])}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=M({type:a,selectors:[["app-series-metadata-detail"]],inputs:{seriesMetadata:"seriesMetadata",libraryType:"libraryType",hasReadingProgress:"hasReadingProgress",readingLists:"readingLists",series:"series",ratings:"ratings"},standalone:!0,features:[it,F],decls:1,vars:1,consts:[["itemTemplate",""],["titleTemplate",""],["collapse","ngbCollapse"],[4,"transloco","translocoRead"],[1,"row","g-0","mt-2","mb-2"],[3,"text","maxLength"],[3,"tags","libraryId","heading"],[4,"ngIf"],[3,"tags","libraryId","queryParam","heading"],["id","extended-series-metadata",3,"ngbCollapseChange","ngbCollapse"],[1,"row","g-0"],["class","col mt-3",4,"ngIf"],["class","col col-md-auto align-self-end read-more-link",3,"hidden","click",4,"ngIf"],[3,"goTo","series","seriesMetadata","hasReadingProgress"],[3,"seriesId","ratings","userRating","hasUserRated","libraryType"],["target","_blank","rel","noopener noreferrer",1,"col","me-1",3,"href","title"],["classes","favicon","width","24px","height","24px",3,"imageUrl","errorImage"],["a11y-click","13,32",1,"col-auto",3,"click","selectionMode"],[3,"promoted"],["aria-hidden","true",1,"fa","fa-angle-double-up"],[1,"visually-hidden"],["a11y-click","13,32",1,"col-auto",3,"person"],[1,"col","mt-3"],[1,"col","col-md-auto","align-self-end","read-more-link",3,"click"],["aria-hidden","true","aria-controls","extended-series-metadata"]],template:function(n,p){n&1&&m(0,il,62,77,"ng-container",3),n&2&&o("translocoRead","series-metadata-detail")},dependencies:[P,L,ge,Pt,ae,En,ce,tn,Bt,Ii,Mn,Ot,V,A,Zi],styles:[`.favicon{border-radius:5px}
/*# sourceMappingURL=series-metadata-detail.component-XKP5XP5A.css.map */
`],encapsulation:2,changeDetection:0});let i=a;return i})();function nl(i,a){if(i&1&&(s(0,"div",8)(1,"div",9)(2,"span",10),_(3,"i",11),s(4,"div",12),d(5,"Upcoming"),c(),_(6,"span",13),c()()()),i&2){let t=l().ngIf;r(6),o("innerHTML",t,Ie)}}function al(i,a){if(i&1&&(g(0),m(1,nl,7,1,"div",7),f()),i&2){let t=a.ngIf;r(),o("ngIf",t!=="")}}var Fn=(()=>{let a=class a{constructor(){this.cdRef=C($),this.imageUrl="",this.title=""}ngOnInit(){if(this.entity.expectedDate){let e=new Vt;this.title=ee("next-expected-card.title",{date:e.transform(this.entity.expectedDate,"shortDate")})}this.cdRef.markForCheck()}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=M({type:a,selectors:[["app-next-expected-card"]],inputs:{imageUrl:"imageUrl",entity:"entity"},standalone:!0,features:[F],decls:9,vars:5,consts:[[1,"card-item-container","card"],[1,"overlay"],["borderRadius",".25rem .25rem 0 0","height","230px","width","158px","classes","extreme-blur",3,"imageUrl"],[1,"card-overlay"],[4,"ngIf"],[1,"card-body"],["tabindex","0",1,"card-title"],["class","overlay-information overlay-information--centered",4,"ngIf"],[1,"overlay-information","overlay-information--centered"],[1,"position-relative"],[1,"card-title","library","mx-auto",2,"width","auto"],["aria-hidden","true",1,"fa-regular","fa-clock","mb-2",2,"font-size","26px"],[1,"upcoming-header"],[3,"innerHTML"]],template:function(n,p){n&1&&(s(0,"div",0)(1,"div",1),_(2,"app-image",2)(3,"div",3),m(4,al,2,1,"ng-container",4),I(5,"safeHtml"),c(),s(6,"div",5)(7,"span",6),d(8),c()()()),n&2&&(r(2),o("imageUrl",p.imageUrl),r(2),o("ngIf",E(5,3,p.entity.title)),r(4),u(p.title))},dependencies:[P,L,A,ae],styles:[`.extreme-blur{filter:brightness(50%) blur(4px)}.overlay-information[_ngcontent-%COMP%]{background-color:transparent}.upcoming-header[_ngcontent-%COMP%]{font-size:16px}.card-title[_ngcontent-%COMP%]{width:146px}
/*# sourceMappingURL=next-expected-card.component-O4BXL64J.css.map */`],changeDetection:0});let i=a;return i})();var ol=["scrollingBlock"],ll=["companionBar"],sl=i=>({height:i}),cl=i=>({"pt-3":i}),pl=i=>({title:i}),ii=i=>({tabId:i}),ml=(i,a,t,e)=>({$implicit:i,scroll:a,idx:t,volumesLength:e}),Pn=(i,a,t,e)=>({$implicit:i,scroll:a,idx:t,chaptersLength:e}),Xe=i=>({$implicit:i}),Nn=(i,a,t,e)=>({$implicit:i,scroll:a,idx:t,totalLength:e});function dl(i,a){i&1&&(s(0,"div",29)(1,"span",31),d(2,"loading..."),c()())}function _l(i,a){if(i&1&&(g(0,32),s(1,"h6",33),d(2),c(),f()),i&2){let t=l(3);r(2),u(t.series.localizedName)}}function gl(i,a){if(i&1){let t=k();s(0,"div",34)(1,"div",35)(2,"h4",36),d(3),c(),s(4,"button",37),w("click",function(){let n=y(t).$implicit;return S(n.dismiss())}),c()(),s(5,"div",38)(6,"form",39)(7,"div",40)(8,"div",41)(9,"label",42),d(10),c(),_(11,"br"),s(12,"div",43),_(13,"input",44),s(14,"label",45),d(15),c(),_(16,"input",46),s(17,"label",47),d(18),c()()()()()()()}if(i&2){let t=l(2).$implicit,e=l();r(3),u(t("page-settings-title")),r(),X("aria-label",t("close")),r(2),o("formGroup",e.pageExtrasGroup),r(4),u(t("layout-mode-label")),r(2),X("aria-label",t("page-settings-title")),r(),o("value",e.PageLayoutMode.Cards),r(2),u(t("layout-mode-option-card")),r(),o("value",e.PageLayoutMode.List),r(2),u(t("layout-mode-option-list"))}}function fl(i,a){if(i&1){let t=k();s(0,"app-side-nav-companion-bar",25),g(1,26),s(2,"h2",27)(3,"app-card-actionables",28),w("actionHandler",function(n){y(t);let p=l(2);return S(p.performAction(n))}),c(),s(4,"span"),d(5),m(6,dl,3,0,"div",29),c()(),f(),m(7,_l,3,1,"ng-container",30)(8,gl,19,9,"ng-template",null,8,v),c()}if(i&2){let t=b(9),e=l(2);o("hasExtras",!0)("extraDrawer",t),r(3),o("actions",e.seriesActions)("labelBy",e.series.name),r(2),x("",e.series.name," "),r(),B(6,e.isLoadingExtra||e.isLoading?6:-1),r(),o("ngIf",e.series.localizedName!==e.series.name)}}function hl(i,a){if(i&1&&(s(0,"div",76)(1,"app-tag-badge",77),d(2),c()()),i&2){let t=l(3);r(),o("selectionMode",t.TagBadgeCursor.NotAllowed),r(),u(t.unreadCount)}}function ul(i,a){if(i&1&&(g(0),s(1,"div",78),I(2,"number"),_(3,"ngb-progressbar",79),c(),s(4,"div",80),d(5),c(),f()),i&2){let t=l(2).$implicit,e=l();r(),ie("ngbTooltip","",U(2,5,e.series.pagesRead/e.series.pages*100,"1.0-1"),"% Read"),r(2),o("value",e.series.pagesRead)("max",e.series.pages),r(2),x(" ",t("continue-from",N(8,pl,e.ContinuePointTitle))," ")}}function Cl(i,a){if(i&1){let t=k();s(0,"div",65)(1,"button",81),w("click",function(){y(t);let n=l(3);return S(n.openEditSeriesModal())}),s(2,"span"),_(3,"i",82),c()()()}if(i&2){let t=l(2).$implicit;r(),o("title",t("edit-series-alt"))}}function xl(i,a){if(i&1&&(g(0),_(1,"span",86),s(2,"span",31),d(3),c(),f()),i&2){let t=l(4).$implicit;r(3),u(t("downloading-status"))}}function vl(i,a){i&1&&_(0,"i",87)}function yl(i,a){if(i&1){let t=k();s(0,"button",84),w("click",function(){y(t);let n=l(4);return S(n.downloadSeries())}),m(1,xl,4,1,"ng-container",85)(2,vl,1,0,"ng-template",null,11,v),c()}if(i&2){let t=a,e=b(3),n=l(3).$implicit;o("title",n("download-series--tooltip"))("disabled",t!==null),r(),o("ngIf",t!==null)("ngIfElse",e)}}function Sl(i,a){if(i&1){let t=k();s(0,"button",66),w("click",function(){y(t);let n=l(4);return S(n.downloadSeries())}),_(1,"i",87),c()}if(i&2){let t=l(3).$implicit;o("title",t("download-series--tooltip"))}}function bl(i,a){if(i&1&&(s(0,"div",68),m(1,yl,4,4,"button",83),I(2,"async"),m(3,Sl,2,1),c()),i&2){let t,e=l(3);r(),B(1,(t=E(2,1,e.download$))?1:3,t)}}function Il(i,a){if(i&1&&(s(0,"div",72),_(1,"app-series-metadata-detail",88),c()),i&2){let t=l(3);r(),o("seriesMetadata",t.seriesMetadata)("readingLists",t.readingLists)("series",t.series)("libraryType",t.libraryType)("ratings",t.ratings)("hasReadingProgress",t.hasReadingProgress)}}function wl(i,a){if(i&1){let t=k();s(0,"app-review-card",89),w("refresh",function(n){y(t);let p=l(3);return S(p.updateOrDeleteReview(n))}),c()}if(i&2){let t=a.$implicit;o("review",t)}}function Tl(i,a){if(i&1&&j(0,99),i&2){let t=l(),e=t.$implicit,n=t.index;l(2);let p=b(1),h=l(5),T=b(4);o("ngTemplateOutlet",T)("ngTemplateOutletContext",Ve(2,ml,e.volume,p,n,h.volumes.length))}}function El(i,a){if(i&1&&j(0,99),i&2){let t=l(),e=t.$implicit,n=t.index;l(2);let p=b(1),h=l(5),T=b(2);o("ngTemplateOutlet",T)("ngTemplateOutletContext",Ve(2,Pn,e.chapter,p,n,h.storyChapters.length))}}function kl(i,a){if(i&1&&(g(0),d(1),g(2,100),m(3,Tl,1,7,"ng-container",101)(4,El,1,7,"ng-container",101),f()()),i&2){let t=a.$implicit;r(),x(" ",t.id," "),r(),o("ngSwitch",t.isChapter),r(),o("ngSwitchCase",!1),r(),o("ngSwitchCase",!0)}}function Rl(i,a){if(i&1&&(g(0),s(1,"div",97,15),m(3,kl,5,4,"ng-container",98),j(4,99),c(),f()),i&2){l();let t=b(1);l(4);let e=b(7),n=l();r(3),o("ngForOf",t.viewPortItems)("ngForTrackBy",n.trackByStoryLineIdentity),r(),o("ngTemplateOutlet",e)("ngTemplateOutletContext",N(4,ii,n.TabID.Storyline))}}function Ml(i,a){if(i&1&&j(0,99),i&2){let t=l().$implicit;l(7);let e=b(10);o("ngTemplateOutlet",e)("ngTemplateOutletContext",N(2,Xe,t.volume))}}function Dl(i,a){if(i&1&&j(0,99),i&2){let t=l().$implicit;l(7);let e=b(8);o("ngTemplateOutlet",e)("ngTemplateOutletContext",N(2,Xe,t.chapter))}}function Fl(i,a){if(i&1&&(g(0)(1,100),m(2,Ml,1,4,"ng-container",101)(3,Dl,1,4,"ng-container",101),f()()),i&2){let t=a.$implicit;r(),o("ngSwitch",t.isChapter),r(),o("ngSwitchCase",!1),r(),o("ngSwitchCase",!0)}}function Pl(i,a){if(i&1&&m(0,Fl,4,3,"ng-container",98),i&2){l();let t=b(1),e=l(5);o("ngForOf",t.viewPortItems)("ngForTrackBy",e.trackByStoryLineIdentity)}}function Nl(i,a){if(i&1&&(s(0,"virtual-scroller",96,13),m(2,Rl,5,6,"ng-container",85)(3,Pl,1,2,"ng-template",null,14,v),c()),i&2){let t=b(4);l(3);let e=b(1),n=l(2);o("items",n.storylineItems)("bufferAmount",1)("parentScroll",e)("childHeight",1),r(2),o("ngIf",n.renderMode===n.PageLayoutMode.Cards)("ngIfElse",t)}}function Ll(i,a){if(i&1&&(s(0,"li",93)(1,"a",94),d(2),c(),m(3,Nl,5,6,"ng-template",95),c()),i&2){let t=l(3).$implicit,e=l();o("ngbNavItem",e.TabID.Storyline),r(2),u(t("storyline-tab"))}}function Vl(i,a){if(i&1&&(g(0),j(1,99),f()),i&2){let t=a.$implicit,e=a.index;l(2);let n=b(1),p=l(5),h=b(4);r(),o("ngTemplateOutlet",h)("ngTemplateOutletContext",Ve(2,Nn,t,n,e,p.volumes.length))}}function $l(i,a){if(i&1&&(g(0),s(1,"div",97,15),m(3,Vl,2,7,"ng-container",98),j(4,99),c(),f()),i&2){l();let t=b(1);l(4);let e=b(7),n=l();r(3),o("ngForOf",t.viewPortItems)("ngForTrackBy",n.trackByVolumeIdentity),r(),o("ngTemplateOutlet",e)("ngTemplateOutletContext",N(4,ii,n.TabID.Volumes))}}function Ol(i,a){if(i&1&&(g(0),j(1,99),f()),i&2){let t=a.$implicit;l(7);let e=b(10);r(),o("ngTemplateOutlet",e)("ngTemplateOutletContext",N(2,Xe,t))}}function Bl(i,a){if(i&1&&m(0,Ol,2,4,"ng-container",98),i&2){l();let t=b(1),e=l(5);o("ngForOf",t.viewPortItems)("ngForTrackBy",e.trackByVolumeIdentity)}}function Ul(i,a){if(i&1&&(s(0,"virtual-scroller",102,13),m(2,$l,5,6,"ng-container",85)(3,Bl,1,2,"ng-template",null,16,v),c()),i&2){let t=b(4);l(3);let e=b(1),n=l(2);o("items",n.volumes)("parentScroll",e)("childHeight",1),r(2),o("ngIf",n.renderMode===n.PageLayoutMode.Cards)("ngIfElse",t)}}function Al(i,a){if(i&1&&(s(0,"li",93)(1,"a",94),d(2),c(),m(3,Ul,5,5,"ng-template",95),c()),i&2){let t=l(3).$implicit,e=l();o("ngbNavItem",e.TabID.Volumes),r(2),u(e.UseBookLogic?t("books-tab"):t("volumes-tab"))}}function Hl(i,a){if(i&1&&(s(0,"div"),j(1,99),c()),i&2){let t=a.$implicit,e=a.index;l(2);let n=b(1),p=l(5),h=b(2);r(),o("ngTemplateOutlet",h)("ngTemplateOutletContext",Ve(2,Nn,t,n,e,p.chapters.length))}}function zl(i,a){if(i&1&&(g(0),s(1,"div",97,15),m(3,Hl,2,7,"div",98),j(4,99),c(),f()),i&2){l();let t=b(1);l(4);let e=b(7),n=l();r(3),o("ngForOf",t.viewPortItems)("ngForTrackBy",n.trackByChapterIdentity),r(),o("ngTemplateOutlet",e)("ngTemplateOutletContext",N(4,ii,n.TabID.Chapters))}}function Wl(i,a){if(i&1&&(s(0,"div"),j(1,99),c()),i&2){let t=a.$implicit;l(7);let e=b(8);r(),o("ngTemplateOutlet",e)("ngTemplateOutletContext",N(2,Xe,t))}}function jl(i,a){if(i&1&&m(0,Wl,2,4,"div",98),i&2){l();let t=b(1),e=l(5);o("ngForOf",t.viewPortItems)("ngForTrackBy",e.trackByChapterIdentity)}}function Gl(i,a){if(i&1&&(s(0,"virtual-scroller",102,13),m(2,zl,5,6,"ng-container",85)(3,jl,1,2,"ng-template",null,17,v),c()),i&2){let t=b(4);l(3);let e=b(1),n=l(2);o("items",n.chapters)("parentScroll",e)("childHeight",1),r(2),o("ngIf",n.renderMode===n.PageLayoutMode.Cards)("ngIfElse",t)}}function ql(i,a){if(i&1&&(s(0,"li",93)(1,"a",94),d(2),c(),m(3,Gl,5,5,"ng-template",95),c()),i&2){let t=l(4);o("ngbNavItem",t.TabID.Chapters),r(2),u(t.utilityService.formatChapterName(t.libraryType)+"s")}}function Ql(i,a){if(i&1&&(g(0),j(1,99),f()),i&2){let t=a.$implicit,e=a.index;l(2);let n=b(1),p=l(5),h=b(6);r(),o("ngTemplateOutlet",h)("ngTemplateOutletContext",Ve(2,Pn,t,n,e,p.chapters.length))}}function Jl(i,a){if(i&1&&(g(0),s(1,"div",97,15),m(3,Ql,2,7,"ng-container",98),c(),f()),i&2){l();let t=b(1),e=l(5);r(3),o("ngForOf",t.viewPortItems)("ngForTrackBy",e.trackByChapterIdentity)}}function Kl(i,a){if(i&1&&(g(0),j(1,99),f()),i&2){let t=a.$implicit;l(7);let e=b(12);r(),o("ngTemplateOutlet",e)("ngTemplateOutletContext",N(2,Xe,t))}}function Yl(i,a){if(i&1&&m(0,Kl,2,4,"ng-container",98),i&2){l();let t=b(1),e=l(5);o("ngForOf",t.viewPortItems)("ngForTrackBy",e.trackByChapterIdentity)}}function Xl(i,a){if(i&1&&(s(0,"virtual-scroller",102,13),m(2,Jl,4,2,"ng-container",85)(3,Yl,1,2,"ng-template",null,18,v),c()),i&2){let t=b(4);l(3);let e=b(1),n=l(2);o("items",n.specials)("parentScroll",e)("childHeight",1),r(2),o("ngIf",n.renderMode===n.PageLayoutMode.Cards)("ngIfElse",t)}}function Zl(i,a){if(i&1&&(s(0,"li",93)(1,"a",94),d(2),c(),m(3,Xl,5,5,"ng-template",95),c()),i&2){let t=l(3).$implicit,e=l();o("ngbNavItem",e.TabID.Specials),r(2),u(t("specials-tab"))}}function es(i,a){if(i&1&&(g(0),_(1,"app-series-card",103),f()),i&2){let t=a.$implicit;r(),o("data",t.series)("libraryId",t.series.libraryId)("relation",t.relation)}}function ts(i,a){if(i&1&&(s(0,"virtual-scroller",102,13)(2,"div",97,15),m(4,es,2,3,"ng-container",98),c()()),i&2){let t=b(1);l(3);let e=b(1),n=l(2);o("items",n.relations)("parentScroll",e)("childHeight",1),r(4),o("ngForOf",t.viewPortItems)("ngForTrackBy",n.trackByRelatedSeriesIdentify)}}function is(i,a){if(i&1&&(s(0,"li",93)(1,"a",94),d(2),c(),m(3,ts,5,5,"ng-template",95),c()),i&2){let t=l(3).$implicit,e=l();o("ngbNavItem",e.TabID.Related),r(2),u(t("related-tab"))}}function ns(i,a){if(i&1&&(g(0),_(1,"app-series-card",104),f()),i&2){let t=l().$implicit;r(),o("data",t)("previewOnClick",!0)("libraryId",t.libraryId)}}function as(i,a){if(i&1&&_(0,"app-external-series-card",105),i&2){let t=l().$implicit;o("previewOnClick",!0)("data",t)}}function rs(i,a){if(i&1&&(g(0),m(1,ns,2,3,"ng-container",85)(2,as,1,2,"ng-template",null,20,v),f()),i&2){let t=a.$implicit,e=b(3);r(),o("ngIf",!t.hasOwnProperty("coverUrl"))("ngIfElse",e)}}function os(i,a){if(i&1&&(g(0),s(1,"div",97,15),m(3,rs,4,2,"ng-container",98),c(),f()),i&2){l();let t=b(1),e=l(5);r(3),o("ngForOf",t.viewPortItems)("ngForTrackBy",e.trackBySeriesIdentify)}}function ls(i,a){if(i&1){let t=k();g(0),s(1,"app-external-list-item",106),g(2,26),s(3,"span",107),w("click",function(n){y(t);let p=l().$implicit;return l(7).previewSeries(p,!1),n.stopPropagation(),S(n.preventDefault())}),s(4,"a",108),d(5),c()(),f(),c(),f()}if(i&2){let t=l().$implicit,e=l(7);r(),o("imageUrl",e.imageService.getSeriesCoverImage(t.id))("summary",t.summary),r(3),gi("href","/library/",t.libraryId,"/series/",t.id,"",Q),r(),u(t.name)}}function ss(i,a){if(i&1){let t=k();s(0,"app-external-list-item",106),g(1,26),s(2,"span",107),w("click",function(n){y(t);let p=l().$implicit;return l(7).previewSeries(p,!0),n.stopPropagation(),S(n.preventDefault())}),s(3,"a",109),d(4),c()(),f(),c()}if(i&2){let t=l().$implicit;o("imageUrl",t.coverUrl)("summary",t.summary),r(3),o("href",t.url,Q),r(),u(t.name)}}function cs(i,a){if(i&1&&(g(0),m(1,ls,6,6,"ng-container",85)(2,ss,5,4,"ng-template",null,20,v),f()),i&2){let t=a.$implicit,e=b(3);r(),o("ngIf",!t.hasOwnProperty("coverUrl"))("ngIfElse",e)}}function ps(i,a){if(i&1&&m(0,cs,4,2,"ng-container",98),i&2){l();let t=b(1),e=l(5);o("ngForOf",t.viewPortItems)("ngForTrackBy",e.trackBySeriesIdentify)}}function ms(i,a){if(i&1&&(s(0,"virtual-scroller",102,13),m(2,os,4,2,"ng-container",85)(3,ps,1,2,"ng-template",null,19,v),c()),i&2){let t=b(4);l(3);let e=b(1),n=l(2);o("items",n.combinedRecs)("parentScroll",e)("childHeight",1),r(2),o("ngIf",n.renderMode===n.PageLayoutMode.Cards)("ngIfElse",t)}}function ds(i,a){if(i&1&&(s(0,"li",93)(1,"a",94),d(2),c(),m(3,ms,5,5,"ng-template",95),c()),i&2){let t=l(3).$implicit,e=l();o("ngbNavItem",e.TabID.Recommendations),r(2),u(t("recommendations-tab"))}}function _s(i,a){if(i&1){let t=k();g(0),s(1,"ul",90,12),De("activeIdChange",function(n){y(t);let p=l(3);return Me(p.activeTabId,n)||(p.activeTabId=n),S(n)}),w("navChange",function(n){y(t);let p=l(3);return S(p.onNavChange(n))}),m(3,Ll,4,2,"li",91)(4,Al,4,2,"li",91)(5,ql,4,2,"li",91)(6,Zl,4,2,"li",91)(7,is,4,2,"li",91)(8,ds,4,2,"li",91),c(),_(9,"div",92),f()}if(i&2){let t=b(2),e=l(3);r(),Re("activeId",e.activeTabId),o("destroyOnHide",!1),r(2),o("ngIf",e.ShowStorylineTab),r(),o("ngIf",e.ShowVolumeTab),r(),o("ngIf",e.ShowChaptersTab),r(),o("ngIf",e.hasSpecials),r(),o("ngIf",e.hasRelations),r(),o("ngIf",e.hasRecommendations),r(),o("ngbNavOutlet",t)}}function gs(i,a){if(i&1){let t=k();s(0,"div",48,9)(2,"div",49)(3,"div",50),m(4,hl,3,2,"div",51),_(5,"app-image",52),m(6,ul,6,10,"ng-container",53),c(),s(7,"div",54)(8,"div",40)(9,"div",55)(10,"div",56)(11,"button",57),w("click",function(){y(t);let n=l(2);return S(n.read())}),s(12,"span"),_(13,"i",58),s(14,"span",59),d(15),c()()(),s(16,"div",60),_(17,"button",61),s(18,"div",62)(19,"button",63),w("click",function(){y(t);let n=l(2);return S(n.read(!0))}),s(20,"span"),_(21,"i",64),s(22,"span",59),d(23),c()()()()()()(),s(24,"div",65)(25,"button",66),w("click",function(){y(t);let n=l(2);return S(n.toggleWantToRead())}),s(26,"span"),_(27,"i",58),c()()(),m(28,Cl,4,1,"div",67),s(29,"div",68)(30,"div",69)(31,"app-card-actionables",70),w("actionHandler",function(n){y(t);let p=l(2);return S(p.performAction(n))}),c()()(),m(32,bl,4,3,"div",71),c(),m(33,Il,2,6,"div",72),c(),s(34,"div",73)(35,"app-carousel-reel",74),w("sectionClick",function(){y(t);let n=l(2);return S(n.openReviewModal())}),m(36,wl,1,1,"ng-template",null,10,v),c()()(),m(38,_s,10,9,"ng-container",53),_(39,"app-loading",75),c()}if(i&2){let t=l().$implicit,e=l();o("ngStyle",N(28,sl,e.ScrollingBlockHeight)),r(4),o("ngIf",e.unreadCount>0&&e.unreadCount!==e.totalCount),r(),o("imageUrl",e.seriesImage),r(),o("ngIf",e.series.pagesRead<e.series.pages&&e.hasReadingProgress&&e.currentlyReadingChapter&&!e.currentlyReadingChapter.isSpecial),r(7),we("fa ",e.showBook?"fa-book-open":"fa-book",""),r(2),x("\xA0",e.hasReadingProgress?t("continue"):t("read"),""),r(),X("aria-label",t("read-options-alt")),r(7),x("\xA0",e.hasReadingProgress?t("continue-incognito"):t("read-incognito"),""),r(2),lt("title",e.isWantToRead?t("remove-from-want-to-read"):t("add-to-want-to-read")),r(2),we("",e.isWantToRead?"fa-solid":"fa-regular"," fa-star"),r(),o("ngIf",e.isAdmin),r(3),o("actions",e.seriesActions)("labelBy",e.series.name),r(),o("ngIf",e.isAdmin||e.hasDownloadingRole),r(),B(33,e.seriesMetadata?33:-1),r(),o("ngClass",N(30,cl,!e.seriesMetadata||e.seriesMetadata.summary.length===0)),r(),ie("iconClasses","fa-solid fa-",e.getUserReview().length>0?"pen":"plus",""),o("items",e.reviews)("alwaysShow",!0)("title",t("user-reviews-alt"))("clickableTitle",!0),r(3),o("ngIf",e.series),r(),o("loading",e.isLoading)}}function fs(i,a){if(i&1&&_(0,"app-next-expected-card",112),i&2){let t=l(5);o("entity",t.nextExpectedChapter)("imageUrl",t.imageService.getSeriesCoverImage(t.series.id))}}function hs(i,a){if(i&1&&(g(0),m(1,fs,1,2,"app-next-expected-card",111),f()),i&2){let t=l(4);r(),o("ngIf",t.nextExpectedChapter.volumeNumber!==t.SpecialVolumeNumber&&t.nextExpectedChapter.chapterNumber===t.LooseLeafOrSpecialNumber)}}function us(i,a){if(i&1&&(g(0),_(1,"app-next-expected-card",112),f()),i&2){let t=l(4);r(),o("entity",t.nextExpectedChapter)("imageUrl",t.imageService.getSeriesCoverImage(t.series.id))}}function Cs(i,a){if(i&1&&(g(0),_(1,"app-next-expected-card",112),f()),i&2){let t=l(4);r(),o("entity",t.nextExpectedChapter)("imageUrl",t.imageService.getSeriesCoverImage(t.series.id))}}function xs(i,a){if(i&1&&(g(0)(1,100),m(2,hs,2,1,"ng-container",110)(3,us,2,2,"ng-container",110)(4,Cs,2,2,"ng-container",110),f()()),i&2){let t=l().tabId,e=l(2);r(),o("ngSwitch",t),r(),o("ngSwitchCase",e.TabID.Volumes),r(),o("ngSwitchCase",e.TabID.Chapters),r(),o("ngSwitchCase",e.TabID.Storyline)}}function vs(i,a){if(i&1&&m(0,xs,5,4,"ng-container",53),i&2){let t=l(2);o("ngIf",t.nextExpectedChapter)}}function ys(i,a){if(i&1&&(g(0),s(1,"div",null,6),m(3,fl,10,7,"app-side-nav-companion-bar",22),c(),_(4,"app-bulk-operations",23),m(5,gs,40,32,"div",24)(6,vs,1,1,"ng-template",null,7,v),f()),i&2){let t=l();r(3),o("ngIf",t.series!==void 0),r(),o("actionCallback",t.bulkActionCallback)("topOffset",56),r(),o("ngIf",t.series!==void 0)}}function Ss(i,a){if(i&1){let t=k();s(0,"app-card-item",114),w("click",function(){y(t);let n=l().$implicit,p=l();return S(p.openChapter(n))})("selection",function(n){y(t);let p=l(),h=p.scroll,T=p.idx,G=p.totalLength,q=l();return S(q.bulkSelectionService.handleCardSelection("chapter",h.viewPortInfo.startIndexWithBuffer+T,G,n))}),c()}if(i&2){let t=l(),e=t.$implicit,n=t.scroll,p=t.idx,h=l();o("entity",e)("title",e.title)("imageUrl",h.imageService.getChapterCoverImage(e.id))("read",e.pagesRead)("total",e.pages)("actions",h.chapterActions)("count",e.files.length)("selected",h.bulkSelectionService.isCardSelected("chapter",n.viewPortInfo.startIndexWithBuffer+p))("allowSelection",!0)}}function bs(i,a){if(i&1&&m(0,Ss,1,9,"app-card-item",113),i&2){let t=a.$implicit;o("ngIf",!t.isSpecial)}}function Is(i,a){if(i&1){let t=k();s(0,"app-card-item",116),w("click",function(){y(t);let n=l().$implicit,p=l();return S(p.openVolume(n))})("selection",function(n){y(t);let p=l(),h=p.scroll,T=p.idx,G=p.totalLength,q=l();return S(q.bulkSelectionService.handleCardSelection("volume",h.viewPortInfo.startIndexWithBuffer+T,G,n))}),c()}if(i&2){let t=l(),e=t.$implicit,n=t.scroll,p=t.idx,h=l();o("entity",e)("title",e.name)("imageUrl",h.imageService.getVolumeCoverImage(e.id))("read",e.pagesRead)("total",e.pages)("actions",h.volumeActions)("selected",h.bulkSelectionService.isCardSelected("volume",n.viewPortInfo.startIndexWithBuffer+p))("allowSelection",!0)}}function ws(i,a){if(i&1&&m(0,Is,1,8,"app-card-item",115),i&2){let t=a.$implicit,e=l();o("ngIf",t.number!==e.LooseLeafOrSpecialNumber)}}function Ts(i,a){if(i&1){let t=k();s(0,"app-card-item",114),w("click",function(){let n=y(t).$implicit,p=l();return S(p.openChapter(n))})("selection",function(n){let p=y(t),h=p.scroll,T=p.idx,G=p.totalLength,q=l();return S(q.bulkSelectionService.handleCardSelection("special",h.viewPortInfo.startIndexWithBuffer+T,G,n))}),c()}if(i&2){let t=a.$implicit,e=a.scroll,n=a.idx,p=l();o("entity",t)("title",t.title||t.range)("imageUrl",p.imageService.getChapterCoverImage(t.id))("read",t.pagesRead)("total",t.pages)("actions",p.chapterActions)("count",t.files.length)("selected",p.bulkSelectionService.isCardSelected("special",e.viewPortInfo.startIndexWithBuffer+n))("allowSelection",!0)}}function Es(i,a){if(i&1){let t=k();s(0,"app-list-item",118),w("read",function(){y(t);let n=l().$implicit,p=l();return S(p.openChapter(n))}),g(1,26),_(2,"app-entity-title",119),f(),c()}if(i&2){let t=l().$implicit,e=l();o("imageUrl",e.imageService.getChapterCoverImage(t.id))("libraryId",e.libraryId)("seriesName",e.series.name)("entity",t)("actions",e.chapterActions)("libraryType",e.libraryType)("pagesRead",t.pagesRead)("totalPages",t.pages)("blur",(e.user==null||e.user.preferences==null?null:e.user.preferences.blurUnreadSummaries)||!1),r(2),o("libraryType",e.libraryType)("entity",t)("seriesName",e.series.name)("prioritizeTitleName",!1)}}function ks(i,a){if(i&1&&m(0,Es,3,13,"app-list-item",117),i&2){let t=a.$implicit;o("ngIf",!t.isSpecial)}}function Rs(i,a){if(i&1){let t=k();s(0,"app-list-item",118),w("read",function(){y(t);let n=l().$implicit,p=l();return S(p.openVolume(n))}),g(1,26),_(2,"app-entity-title",119),f(),c()}if(i&2){let t=l().$implicit,e=l();o("imageUrl",e.imageService.getVolumeCoverImage(t.id))("libraryId",e.libraryId)("seriesName",e.series.name)("entity",t)("actions",e.volumeActions)("libraryType",e.libraryType)("pagesRead",t.pagesRead)("totalPages",t.pages)("blur",(e.user==null||e.user.preferences==null?null:e.user.preferences.blurUnreadSummaries)||!1),r(2),o("libraryType",e.libraryType)("entity",t)("seriesName",e.series.name)("prioritizeTitleName",!1)}}function Ms(i,a){if(i&1&&m(0,Rs,3,13,"app-list-item",117),i&2){let t=a.$implicit,e=l();o("ngIf",t.number!==e.LooseLeafOrSpecialNumber)}}function Ds(i,a){if(i&1){let t=k();s(0,"app-list-item",118),w("read",function(){let n=y(t).$implicit,p=l();return S(p.openChapter(n))}),g(1,26),d(2),f(),c()}if(i&2){let t=a.$implicit,e=l();o("imageUrl",e.imageService.getChapterCoverImage(t.id))("libraryId",e.libraryId)("seriesName",e.series.name)("entity",t)("actions",e.chapterActions)("libraryType",e.libraryType)("pagesRead",t.pagesRead)("totalPages",t.pages)("blur",(e.user==null||e.user.preferences==null?null:e.user.preferences.blurUnreadSummaries)||!1),r(2),x(" ",t.title||t.range," ")}}var Z=function(i){return i[i.Related=0]="Related",i[i.Specials=1]="Specials",i[i.Storyline=2]="Storyline",i[i.Volumes=3]="Volumes",i[i.Chapters=4]="Chapters",i[i.Recommendations=5]="Recommendations",i}(Z||{}),J_=(()=>{let a=class a{get ShowStorylineTab(){return this.libraryType===O.ComicVine?!1:this.libraryType===O.Book&&this.volumes.length===0&&this.chapters.length===0&&this.storyChapters.length>0?!0:this.libraryType!==O.Book&&this.libraryType!==O.LightNovel&&this.libraryType!==O.Comic&&(this.volumes.length>0||this.chapters.length>0)}get ShowVolumeTab(){return this.libraryType===O.ComicVine?this.volumes.length>1||this.specials.length===0&&this.chapters.length===0:this.volumes.length>0}get ShowChaptersTab(){return this.chapters.length>0}get UseBookLogic(){return this.libraryType===O.Book||this.libraryType===O.LightNovel}get ScrollingBlockHeight(){if(this.scrollingBlock===void 0)return"calc(var(--vh)*100)";let e=this.document.querySelector(".navbar");if(e===null)return"calc(var(--vh)*100)";let n=this.companionBar.nativeElement.offsetHeight,p=e.offsetHeight;return"calc(var(--vh)*100 - "+(n+p+21)+"px)"}get ContinuePointTitle(){if(this.currentlyReadingChapter===void 0||!this.hasReadingProgress)return"";if(!this.currentlyReadingChapter.isSpecial){let e=this.volumes.filter(n=>n.id===this.currentlyReadingChapter?.volumeId);return e.length===0?"Ch "+this.currentlyReadingChapter.minNumber:this.currentlyReadingChapter.minNumber===-1e5?"Vol "+e[0].minNumber:"Vol "+e[0].minNumber+" Ch "+this.currentlyReadingChapter.minNumber}return this.currentlyReadingChapter.title}constructor(e){this.document=e,this.destroyRef=C(Y),this.route=C(Ci),this.seriesService=C(se),this.metadataService=C(Dt),this.router=C(Ue),this.modalService=C(xt),this.toastr=C(he),this.accountService=C(ue),this.actionFactoryService=C(Et),this.libraryService=C(kt),this.titleService=C(ui),this.downloadService=C(qe),this.actionService=C(Mt),this.messageHub=C(gt),this.readingListService=C(Ni),this.offcanvasService=C(Tt),this.cdRef=C($),this.scrollService=C(Ki),this.deviceService=C(Li),this.translocoService=C(xi),this.bulkSelectionService=C(Hi),this.utilityService=C(z),this.imageService=C(xe),this.navService=C(Pi),this.readerService=C(ve),this.LibraryType=O,this.PageLayoutMode=zt,this.TabID=Z,this.TagBadgeCursor=Ft,this.LooseLeafOrSpecialNumber=-1e5,this.SpecialVolumeNumber=1e5,this.volumes=[],this.chapters=[],this.storyChapters=[],this.storylineItems=[],this.libraryId=0,this.isAdmin=!1,this.hasDownloadingRole=!1,this.isLoading=!0,this.isLoadingExtra=!1,this.showBook=!0,this.currentlyReadingChapter=void 0,this.hasReadingProgress=!1,this.seriesActions=[],this.volumeActions=[],this.chapterActions=[],this.hasSpecials=!1,this.specials=[],this.activeTabId=Z.Storyline,this.reviews=[],this.ratings=[],this.libraryType=O.Manga,this.seriesMetadata=null,this.readingLists=[],this.isWantToRead=!1,this.unreadCount=0,this.totalCount=0,this.seriesImage="",this.downloadInProgress=!1,this.trackByVolumeIdentity=(n,p)=>`${p.name}_${p.pagesRead}`,this.trackByChapterIdentity=(n,p)=>`${p.title}_${p.minNumber}_${p.maxNumber}_${p.volumeId}_${p.pagesRead}`,this.trackByRelatedSeriesIdentify=(n,p)=>`${p.series.name}_${p.series.libraryId}_${p.series.pagesRead}_${p.relation}`,this.trackBySeriesIdentify=(n,p)=>`${p.name}_${p.libraryId}_${p.pagesRead}`,this.trackByStoryLineIdentity=(n,p)=>p.isChapter?this.trackByChapterIdentity(n,p.chapter):this.trackByVolumeIdentity(n,p.volume),this.hasRelations=!1,this.hasRecommendations=!1,this.relations=[],this.combinedRecs=[],this.sortingOptions=[{value:"Storyline",text:"Storyline"},{value:"Release",text:"Release"},{value:"Added",text:"Added"}],this.renderMode=zt.Cards,this.pageExtrasGroup=new ht({sortingOption:new Ye(this.sortingOptions[0].value,[]),renderMode:new Ye(this.renderMode,[])}),this.download$=null,this.bulkActionCallback=(n,p)=>{if(this.series===void 0)return;let h=this.series.id,T=this.bulkSelectionService.getSelectedCardsForSource("volume"),G=this.bulkSelectionService.getSelectedCardsForSource("chapter"),q=this.bulkSelectionService.getSelectedCardsForSource("special"),Ze=this.storyChapters;this.activeTabId===Z.Chapters&&(Ze=this.chapters);let Qt=this.activeTabId===Z.Storyline?this.volumes.length:0,Jt=Ze.filter((Pe,me)=>{let Ln=me+Qt;return G.includes(Ln+"")}),Qe=this.volumes.filter((Pe,me)=>T.includes(me+"")),Kt=this.specials.filter((Pe,me)=>q.includes(me+"")),Je=[...Jt,...Kt];switch(n.action){case R.AddToReadingList:this.actionService.addMultipleToReadingList(h,Qe,Je,Pe=>{Pe&&this.bulkSelectionService.deselectAll(),this.cdRef.markForCheck()});break;case R.MarkAsRead:this.actionService.markMultipleAsRead(h,Qe,Je,()=>{this.setContinuePoint(),this.bulkSelectionService.deselectAll(),this.cdRef.markForCheck()});break;case R.MarkAsUnread:this.actionService.markMultipleAsUnread(h,Qe,Je,()=>{this.setContinuePoint(),this.bulkSelectionService.deselectAll(),this.cdRef.markForCheck()});break}},this.router.routeReuseStrategy.shouldReuseRoute=()=>!1,this.accountService.currentUser$.pipe(li(1)).subscribe(n=>{n&&(this.user=n,this.isAdmin=this.accountService.hasAdminRole(n),this.hasDownloadingRole=this.accountService.hasDownloadRole(n),this.renderMode=n.preferences.globalPageLayoutMode,this.pageExtrasGroup.get("renderMode")?.setValue(this.renderMode),this.cdRef.markForCheck())})}ngAfterContentChecked(){this.scrollService.setScrollContainer(this.scrollingBlock)}ngOnInit(){let e=this.route.snapshot.paramMap.get("seriesId"),n=this.route.snapshot.paramMap.get("libraryId");if(e===null||n==null){this.router.navigateByUrl("/home");return}this.download$=this.downloadService.activeDownloads$.pipe(J(this.destroyRef),te(p=>this.downloadService.mapToEntityType(p,this.series))),this.messageHub.messages$.pipe(J(this.destroyRef)).subscribe(p=>{p.event===Ke.SeriesRemoved?p.payload.seriesId===this.seriesId&&(this.toastr.info(this.translocoService.translate("errors.series-doesnt-exist")),this.router.navigateByUrl("/home")):p.event===Ke.ScanSeries&&p.payload.seriesId===this.seriesId&&this.loadSeries(this.seriesId)}),this.seriesId=parseInt(e,10),this.libraryId=parseInt(n,10),this.seriesImage=this.imageService.getSeriesCoverImage(this.seriesId),this.cdRef.markForCheck(),this.loadSeries(this.seriesId,!0),this.pageExtrasGroup.get("renderMode")?.valueChanges.pipe(J(this.destroyRef)).subscribe(p=>{p!=null&&(this.renderMode=p,this.cdRef.markForCheck())})}handleKeypress(e){e.key===Xt.SHIFT&&(this.bulkSelectionService.isShiftDown=!0)}handleKeyUp(e){e.key===Xt.SHIFT&&(this.bulkSelectionService.isShiftDown=!1)}onNavChange(e){this.bulkSelectionService.deselectAll(),this.cdRef.markForCheck()}handleSeriesActionCallback(e,n){switch(this.cdRef.markForCheck(),e.action){case R.MarkAsRead:this.actionService.markSeriesAsRead(n,p=>{this.loadSeries(p.id)});break;case R.MarkAsUnread:this.actionService.markSeriesAsUnread(n,p=>{this.loadSeries(p.id)});break;case R.Scan:this.actionService.scanSeries(n);break;case R.RefreshMetadata:this.actionService.refreshMetdata(n);break;case R.Delete:this.deleteSeries(n);break;case R.AddToReadingList:this.actionService.addSeriesToReadingList(n);break;case R.AddToCollection:this.actionService.addMultipleSeriesToCollectionTag([n]);break;case R.AnalyzeFiles:this.actionService.analyzeFilesForSeries(n);break;case R.AddToWantToReadList:this.actionService.addMultipleSeriesToWantToReadList([n.id]);break;case R.RemoveFromWantToReadList:this.actionService.removeMultipleSeriesFromWantToReadList([n.id]);break;case R.Download:if(this.downloadInProgress)return;this.downloadSeries();break;case R.SendTo:{let p=[...this.volumes.map(T=>T.chapters.map(G=>G.id)).flat(),...this.specials.map(T=>T.id)],h=e._extra.data;this.actionService.sendToDevice(p,h);break}default:break}}handleVolumeActionCallback(e,n){switch(e.action){case R.MarkAsRead:this.markVolumeAsRead(n);break;case R.MarkAsUnread:this.markVolumeAsUnread(n);break;case R.Edit:this.openViewInfo(n);break;case R.AddToReadingList:this.actionService.addVolumeToReadingList(n,this.seriesId,()=>{});break;case R.IncognitoRead:n.chapters!=null&&n.chapters?.length>=1&&this.openChapter(n.chapters.sort(this.utilityService.sortChapters)[0],!0);break;case R.SendTo:{let p=e._extra.data;this.actionService.sendToDevice(n.chapters.map(h=>h.id),p);break}default:break}}handleChapterActionCallback(e,n){switch(e.action){case R.MarkAsRead:this.markChapterAsRead(n);break;case R.MarkAsUnread:this.markChapterAsUnread(n);break;case R.Edit:this.openViewInfo(n);break;case R.AddToReadingList:this.actionService.addChapterToReadingList(n,this.seriesId,()=>{});break;case R.IncognitoRead:this.openChapter(n,!0);break;case R.SendTo:{let p=e._extra.data;this.deviceService.sendTo([n.id],p.id).subscribe(()=>{this.toastr.success(this.translocoService.translate("series-detail.send-to",{deviceName:p.name}))});break}default:break}}deleteSeries(e){return et(this,null,function*(){yield this.actionService.deleteSeries(e,n=>{this.cdRef.markForCheck(),n&&this.router.navigate(["library",this.libraryId])})})}loadSeries(e,n=!1){this.seriesService.getMetadata(e).subscribe(p=>{this.seriesMetadata=p,this.cdRef.markForCheck(),[Zt.Ended,Zt.OnGoing].includes(this.seriesMetadata.publicationStatus)&&this.seriesService.getNextExpectedChapterDate(e).subscribe(h=>{if(h==null||h.expectedDate===null){this.nextExpectedChapter!==void 0&&(this.nextExpectedChapter=void 0,this.cdRef.markForCheck());return}this.nextExpectedChapter=h,this.cdRef.markForCheck()})}),this.seriesService.isWantToRead(e).subscribe(p=>{this.isWantToRead=p,this.cdRef.markForCheck()}),this.readingListService.getReadingListsForSeries(e).subscribe(p=>{this.readingLists=p,this.cdRef.markForCheck()}),this.setContinuePoint(),ni({libType:this.libraryService.getLibraryType(this.libraryId),series:this.seriesService.getSeries(e)}).subscribe(p=>{this.libraryType=p.libType,this.series=p.series,n&&this.loadPlusMetadata(this.seriesId,this.libraryType),this.libraryType===O.LightNovel&&(this.renderMode=zt.List,this.pageExtrasGroup.get("renderMode")?.setValue(this.renderMode),this.cdRef.markForCheck()),this.titleService.setTitle("Kavita - "+this.series.name+" Details"),this.seriesActions=this.actionFactoryService.getSeriesActions(this.handleSeriesActionCallback.bind(this)).filter(h=>h.action!==R.Edit),this.volumeActions=this.actionFactoryService.getVolumeActions(this.handleVolumeActionCallback.bind(this)),this.chapterActions=this.actionFactoryService.getChapterActions(this.handleChapterActionCallback.bind(this)),this.seriesService.getRelatedForSeries(this.seriesId).subscribe(h=>{this.relations=[...h.prequels.map(T=>this.createRelatedSeries(T,W.Prequel)),...h.sequels.map(T=>this.createRelatedSeries(T,W.Sequel)),...h.sideStories.map(T=>this.createRelatedSeries(T,W.SideStory)),...h.spinOffs.map(T=>this.createRelatedSeries(T,W.SpinOff)),...h.adaptations.map(T=>this.createRelatedSeries(T,W.Adaptation)),...h.contains.map(T=>this.createRelatedSeries(T,W.Contains)),...h.characters.map(T=>this.createRelatedSeries(T,W.Character)),...h.others.map(T=>this.createRelatedSeries(T,W.Other)),...h.alternativeSettings.map(T=>this.createRelatedSeries(T,W.AlternativeSetting)),...h.alternativeVersions.map(T=>this.createRelatedSeries(T,W.AlternativeVersion)),...h.doujinshis.map(T=>this.createRelatedSeries(T,W.Doujinshi)),...h.parent.map(T=>this.createRelatedSeries(T,W.Parent)),...h.editions.map(T=>this.createRelatedSeries(T,W.Edition)),...h.annuals.map(T=>this.createRelatedSeries(T,W.Annual))],this.relations.length>0?(this.hasRelations=!0,this.cdRef.markForCheck()):(this.hasRelations=!1,this.cdRef.markForCheck())}),this.seriesService.getSeriesDetail(this.seriesId).pipe(ri(h=>(this.router.navigateByUrl("/home"),tt(null)))).subscribe(h=>{if(h==null)return;this.unreadCount=h.unreadCount,this.totalCount=h.totalCount,this.hasSpecials=h.specials.length>0,this.specials=h.specials,this.chapters=h.chapters,this.volumes=h.volumes,this.storyChapters=h.storylineChapters,this.storylineItems=[];let T=this.volumes.map(q=>({volume:q,chapter:void 0,isChapter:!1}));this.storylineItems.push(...T);let G=this.storyChapters.map(q=>({volume:void 0,chapter:q,isChapter:!0}));this.storylineItems.push(...G),this.updateSelectedTab(),this.isLoading=!1,this.cdRef.markForCheck()})},p=>{this.router.navigateByUrl("/home")})}createRelatedSeries(e,n){return{series:e,relation:n}}updateSelectedTab(){if(this.libraryType===O.Book||this.libraryType===O.LightNovel){this.volumes.length===0?this.specials.length===0&&this.storyChapters.length>0?this.activeTabId=Z.Storyline:this.activeTabId=Z.Specials:this.activeTabId=Z.Volumes,this.cdRef.markForCheck();return}this.volumes.length===0&&this.chapters.length===0&&this.specials.length>0?this.activeTabId=Z.Specials:this.libraryType==O.Comic||this.libraryType==O.ComicVine?this.chapters.length===0?this.activeTabId=Z.Specials:this.activeTabId=Z.Chapters:this.activeTabId=Z.Storyline,this.cdRef.markForCheck()}loadPlusMetadata(e,n){this.isLoadingExtra=!0,this.cdRef.markForCheck(),this.metadataService.getSeriesMetadataFromPlus(e,n).subscribe(p=>{this.isLoadingExtra=!1,this.cdRef.markForCheck(),p!==null&&(this.reviews=[...p.reviews],p.ratings&&(this.ratings=[...p.ratings]),p.recommendations&&(this.combinedRecs=[...p.recommendations.ownedSeries,...p.recommendations.externalSeries]),this.hasRecommendations=this.combinedRecs.length>0,this.cdRef.markForCheck())})}setContinuePoint(){this.readerService.hasSeriesProgress(this.seriesId).subscribe(e=>{this.hasReadingProgress=e,this.cdRef.markForCheck()}),this.readerService.getCurrentChapter(this.seriesId).subscribe(e=>{this.currentlyReadingChapter=e,this.cdRef.markForCheck()})}markVolumeAsRead(e){this.series!==void 0&&this.actionService.markVolumeAsRead(this.seriesId,e,()=>{this.setContinuePoint()})}markVolumeAsUnread(e){this.series!==void 0&&this.actionService.markVolumeAsUnread(this.seriesId,e,()=>{this.setContinuePoint()})}markChapterAsRead(e){this.series!==void 0&&this.actionService.markChapterAsRead(this.libraryId,this.seriesId,e,()=>{this.setContinuePoint()})}markChapterAsUnread(e){this.series!==void 0&&this.actionService.markChapterAsUnread(this.libraryId,this.seriesId,e,()=>{this.setContinuePoint()})}read(e=!1){if(this.currentlyReadingChapter!==void 0){this.openChapter(this.currentlyReadingChapter,e);return}this.readerService.getCurrentChapter(this.seriesId).subscribe(n=>{this.openChapter(n,e)})}openChapter(e,n=!1){if(!this.bulkSelectionService.hasSelections()){if(e.pages===0){this.toastr.error(this.translocoService.translate("series-detail.no-pages"));return}this.router.navigate(this.readerService.getNavigationArray(this.libraryId,this.seriesId,e.id,e.files[0].format),{queryParams:{incognitoMode:n}})}}openVolume(e){if(!this.bulkSelectionService.hasSelections()){if(e.chapters===void 0||e.chapters?.length===0){this.toastr.error(this.translocoService.translate("series-detail.no-chapters"));return}if(e.pagesRead<e.pages&&e.pagesRead>0){let n=e.chapters.filter(p=>p.pagesRead<p.pages);if(n.length>0){this.openChapter(n[0]);return}this.openChapter(e.chapters[0]);return}this.openChapter([...e.chapters].sort(this.utilityService.sortChapters)[0])}}openViewInfo(e){let n=this.offcanvasService.open(Cn,{position:"bottom"});n.componentInstance.data=e,n.componentInstance.parentName=this.series?.name,n.componentInstance.seriesId=this.series?.id,n.componentInstance.libraryId=this.series?.libraryId}openEditSeriesModal(){let e=this.modalService.open(Ji,{size:"xl"});e.componentInstance.series=this.series,e.closed.subscribe(n=>{n.success&&(window.scrollTo(0,0),this.loadSeries(this.seriesId,n.updateExternal)),n.coverImageUpdate&&this.toastr.info(this.translocoService.translate("series-detail.cover-change"))})}getUserReview(){return this.reviews.filter(e=>e.username===this.user?.username&&!e.isExternal)}openReviewModal(){let e=this.getUserReview(),n=this.modalService.open(qt,{scrollable:!0,size:"lg"});n.componentInstance.series=this.series,e.length>0?n.componentInstance.review=e[0]:n.componentInstance.review={seriesId:this.series.id,tagline:"",body:""},n.closed.subscribe(p=>{this.updateOrDeleteReview(p)})}updateOrDeleteReview(e){if(e.action===be.Close)return;let n=this.reviews.findIndex(p=>p.username===e.review.username);if(e.action===be.Edit){if(n===-1){this.reviews=[e.review,...this.reviews],this.cdRef.markForCheck();return}this.reviews[n]=e.review,this.cdRef.markForCheck();return}if(e.action===be.Delete){this.reviews=[...this.reviews.filter(p=>p.username!==e.review.username)],this.cdRef.markForCheck();return}}performAction(e){typeof e.callback=="function"&&e.callback(e,this.series)}downloadSeries(){this.downloadService.download("series",this.series,e=>{e?this.downloadInProgress=!0:this.downloadInProgress=!1,this.cdRef.markForCheck()})}toggleWantToRead(){this.isWantToRead?this.actionService.removeMultipleSeriesFromWantToReadList([this.series.id]):this.actionService.addMultipleSeriesToWantToReadList([this.series.id]),this.isWantToRead=!this.isWantToRead,this.cdRef.markForCheck()}previewSeries(e,n){let p=this.offcanvasService.open(Ut,{position:"end",panelClass:"navbar-offset"});if(p.componentInstance.isExternalSeries=n,p.componentInstance.name=e.name,n){let h=e;p.componentInstance.aniListId=h.aniListId,p.componentInstance.malId=h.malId}else{let h=e;p.componentInstance.seriesId=h.id,p.componentInstance.libraryId=h.libraryId}}};a.\u0275fac=function(n){return new(n||a)(D(pt))},a.\u0275cmp=M({type:a,selectors:[["app-series-detail"]],viewQuery:function(n,p){if(n&1&&(Te(ol,5),Te(ll,5)),n&2){let h;Ee(h=ke())&&(p.scrollingBlock=h.first),Ee(h=ke())&&(p.companionBar=h.first)}},hostBindings:function(n,p){n&1&&w("keydown.shift",function(T){return p.handleKeypress(T)},!1,Yt)("keyup.shift",function(T){return p.handleKeyUp(T)},!1,Yt)},standalone:!0,features:[F],decls:13,vars:1,consts:[["nonSpecialChapterCard",""],["nonChapterVolumeCard",""],["specialChapterCard",""],["nonSpecialChapterListItem",""],["nonSpecialVolumeListItem",""],["specialChapterListItem",""],["companionBar",""],["estimatedNextCard",""],["extrasDrawer",""],["scrollingBlock",""],["carouselItem",""],["notDownloading",""],["nav","ngbNav"],["scroll",""],["storylineListLayout",""],["container",""],["volumeListLayout",""],["chapterListLayout",""],["specialListLayout",""],["recListLayout",""],["externalRec",""],[4,"transloco","translocoRead"],[3,"hasExtras","extraDrawer",4,"ngIf"],[3,"actionCallback","topOffset"],["class","main-container container-fluid pt-2",3,"ngStyle",4,"ngIf"],[3,"hasExtras","extraDrawer"],["title",""],[1,"title","text-break"],["iconClass","fa-ellipsis-v",3,"actionHandler","actions","labelBy"],["role","status",1,"spinner-border","spinner-border-sm","text-primary"],["subtitle","",4,"ngIf"],[1,"visually-hidden"],["subtitle",""],["title","Localized Name",1,"subtitle-with-actionables","text-break"],[2,"margin-top","56px"],[1,"offcanvas-header"],["id","offcanvas-basic-title",1,"offcanvas-title"],["type","button",1,"btn-close",3,"click"],[1,"offcanvas-body"],[3,"formGroup"],[1,"row","g-0"],[1,"col-md-12","col-sm-12","pe-2","mb-3"],["id","list-layout-mode-label",1,"form-label"],["role","group",1,"btn-group","d-flex","justify-content-center"],["type","radio","formControlName","renderMode","id","layout-mode-default","autocomplete","off",1,"btn-check",3,"value"],["for","layout-mode-default",1,"btn","btn-outline-primary"],["type","radio","formControlName","renderMode","id","layout-mode-col1","autocomplete","off",1,"btn-check",3,"value"],["for","layout-mode-col1",1,"btn","btn-outline-primary"],[1,"main-container","container-fluid","pt-2",3,"ngStyle"],[1,"row","mb-0","mb-xl-3","info-container"],[1,"image-container","col-4","col-sm-6","col-md-4","col-lg-4","col-xl-2","col-xxl-2","d-none","d-sm-block","mt-2"],["class","to-read-counter",4,"ngIf"],["height","100%","maxHeight","400px","objectFit","contain","background","none",3,"imageUrl"],[4,"ngIf"],[1,"col-xlg-10","col-lg-8","col-md-8","col-xs-8","col-sm-6","mt-2"],[1,"col-auto"],[1,"btn-group"],["type","button",1,"btn","btn-primary",3,"click"],["aria-hidden","true"],[1,"read-btn--text"],["ngbDropdown","","role","group","display","dynamic",1,"btn-group"],["type","button","ngbDropdownToggle","",1,"btn","btn-primary","dropdown-toggle-split"],["ngbDropdownMenu","",1,"dropdown-menu"],["ngbDropdownItem","",3,"click"],["aria-hidden","true",1,"fa","fa-glasses"],[1,"col-auto","ms-2"],[1,"btn","btn-secondary",3,"click","title"],["class","col-auto ms-2",4,"ngIf"],[1,"col-auto","ms-2","d-none","d-md-block"],[1,"card-actions"],["iconClass","fa-ellipsis-h","btnClass","btn-secondary",3,"actionHandler","actions","labelBy"],["class","col-auto ms-2 d-none d-md-block",4,"ngIf"],[1,"mt-2"],[1,"row",3,"ngClass"],[3,"sectionClick","items","alwaysShow","title","iconClasses","clickableTitle"],[3,"loading"],[1,"to-read-counter"],["fillStyle","filled",3,"selectionMode"],[1,"progress-banner",3,"ngbTooltip"],["type","primary","height","5px",3,"value","max"],[1,"under-image"],["id","edit-btn--komf",1,"btn","btn-secondary",3,"click","title"],["aria-hidden","true",1,"fa","fa-pen"],[1,"btn","btn-secondary"],[1,"btn","btn-secondary",3,"click","title","disabled"],[4,"ngIf","ngIfElse"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],["aria-hidden","true",1,"fa","fa-arrow-alt-circle-down"],[3,"seriesMetadata","readingLists","series","libraryType","ratings","hasReadingProgress"],[3,"refresh","review"],["ngbNav","",1,"nav","nav-tabs","mb-2",3,"activeIdChange","navChange","activeId","destroyOnHide"],[3,"ngbNavItem",4,"ngIf"],[3,"ngbNavOutlet"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[3,"items","bufferAmount","parentScroll","childHeight"],[1,"card-container","row","g-0"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngSwitch"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngSwitchCase"],[3,"items","parentScroll","childHeight"],[1,"col-auto","mt-2","mb-2",3,"data","libraryId","relation"],[1,"col-auto","mt-2","mb-2",3,"data","previewOnClick","libraryId"],[1,"col-auto","mt-2","mb-2",3,"previewOnClick","data"],["imageWidth","130px","imageHeight","",3,"imageUrl","summary"],[3,"click"],[3,"href"],["target","_blank","rel","noreferrer nofollow",3,"href"],[4,"ngSwitchCase"],["class","col-auto mt-2 mb-2",3,"entity","imageUrl",4,"ngIf"],[1,"col-auto","mt-2","mb-2",3,"entity","imageUrl"],["class","col-auto mt-2 mb-2",3,"entity","title","imageUrl","read","total","actions","count","selected","allowSelection","click","selection",4,"ngIf"],[1,"col-auto","mt-2","mb-2",3,"click","selection","entity","title","imageUrl","read","total","actions","count","selected","allowSelection"],["class","col-auto mt-2 mb-2",3,"entity","title","imageUrl","read","total","actions","selected","allowSelection","click","selection",4,"ngIf"],[1,"col-auto","mt-2","mb-2",3,"click","selection","entity","title","imageUrl","read","total","actions","selected","allowSelection"],["imageWidth","130px","imageHeight","",3,"imageUrl","libraryId","seriesName","entity","actions","libraryType","pagesRead","totalPages","blur","read",4,"ngIf"],["imageWidth","130px","imageHeight","",3,"read","imageUrl","libraryId","seriesName","entity","actions","libraryType","pagesRead","totalPages","blur"],[3,"libraryType","entity","seriesName","prioritizeTitleName"]],template:function(n,p){n&1&&m(0,ys,8,4,"ng-container",21)(1,bs,1,1,"ng-template",null,0,v)(3,ws,1,1,"ng-template",null,1,v)(5,Ts,1,9,"ng-template",null,2,v)(7,ks,1,1,"ng-template",null,3,v)(9,Ms,1,1,"ng-template",null,4,v)(11,Ds,3,10,"ng-template",null,5,v),n&2&&o("translocoRead","series-detail")},dependencies:[L,mn,Ge,re,ut,Ae,yi,He,ze,We,je,_t,Pt,A,oe,wt,ki,Ei,Ti,wi,Dn,dn,In,sn,St,yt,bt,vt,Ai,Ui,ne,en,yn,jt,ln,vn,xn,It,$t,Be,V,fi,mt,dt,Fn,$e,ge],styles:[`.user-review[_ngcontent-%COMP%]{font-style:italic}.to-read-counter[_ngcontent-%COMP%]{position:absolute;top:15px;left:20px}.under-image[_ngcontent-%COMP%]{background-color:var(--breadcrumb-bg-color);color:#fff;border-bottom-left-radius:5px;border-bottom-right-radius:5px;text-align:center}.rating-star[_ngcontent-%COMP%]{margin-top:2px;font-size:1.5rem}.card-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,158px);grid-gap:.5rem;justify-content:space-around}.virtual-scroller[_ngcontent-%COMP%], virtual-scroller[_ngcontent-%COMP%]{width:100%;height:calc(100vh - 85px);max-height:calc(var(--vh) * 100 - 170px)}.main-container[_ngcontent-%COMP%]{overflow-y:auto;position:relative;overscroll-behavior-y:none}.title[_ngcontent-%COMP%], .subtitle-with-actionable[_ngcontent-%COMP%]{margin-bottom:0}.image-container[_ngcontent-%COMP%]{max-height:400px;max-width:280px}.info-container[_ngcontent-%COMP%]{align-items:flex-start}  .progress{border-radius:0}.dropdown-toggle-split[_ngcontent-%COMP%]{border-radius:0 6px 6px 0/0px 6px 6px 0px!important}
/*# sourceMappingURL=series-detail.component-Y73FQMDF.css.map */`],changeDetection:0});let i=a;return i})();export{J_ as SeriesDetailComponent};
//# sourceMappingURL=chunk-7TUZOV5N.js.map
