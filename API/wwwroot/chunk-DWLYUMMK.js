import{a as M,b as K,e as E,f as Q,h as X,i as ee}from"./chunk-CMA4NIL4.js";import{a as B,b as te}from"./chunk-3BSTNBRU.js";import{a as J}from"./chunk-63UKDQJP.js";import"./chunk-COKVODYN.js";import{a as q}from"./chunk-K6JLHPZK.js";import"./chunk-SEAKSSGD.js";import{a as z}from"./chunk-KWNQHRPC.js";import"./chunk-DBXQZVFZ.js";import"./chunk-5XQ66AVT.js";import"./chunk-ZRHV3LXB.js";import{q as A}from"./chunk-SPNNO5LP.js";import"./chunk-E6ZKMAWP.js";import{$ as T,$b as L,Bb as y,Dc as c,Ec as p,Fa as D,Ga as $,Ib as o,Jd as _,Na as F,Qe as G,Rc as Y,Td as w,Ud as Z,Vb as l,Wb as d,Xb as m,Yb as u,Zb as f,cc as U,dc as S,id as H,lb as a,mb as v,oc as b,od as N,qa as j,qc as h,sd as V,td as O,va as P,xc as k,z as W,zc as C}from"./chunk-2LHIXASS.js";var I=n=>({value:n});function oe(n,r){if(n&1){let t=L();u(0),l(1,"div",1),u(2),l(3,"div",2)(4,"app-icon-and-title",3),c(5,"number"),U("click",function(i){return D(t),S().openPageByYearList(),$(i.stopPropagation())}),b(6),c(7,"compactNumber"),d()(),m(8,"div",4),f(),u(9),l(10,"div",2)(11,"app-icon-and-title",3),c(12,"number"),U("click",function(i){return D(t),S().openWordByYearList(),$(i.stopPropagation())}),b(13),c(14,"compactNumber"),d()(),m(15,"div",4),f(),u(16),l(17,"div",2)(18,"app-icon-and-title",5),c(19,"number"),b(20),c(21,"timeDuration"),d()(),m(22,"div",4),f(),u(23),l(24,"div",2)(25,"app-icon-and-title",6),b(26),c(27,"timeDuration"),d()(),m(28,"div",4),f(),u(29),l(30,"div",2)(31,"app-icon-and-title",7),c(32,"number"),b(33),c(34,"compactNumber"),d()(),m(35,"div",4),f(),u(36),l(37,"div",2)(38,"app-icon-and-title",8),b(39),c(40,"timeAgo"),d()(),f(),d(),f()}if(n&2){let t=r.$implicit,e=S();a(4),o("label",t("total-pages-read-label"))("clickable",!0)("title",t("total-pages-read-tooltip",C(42,I,p(5,22,e.totalPagesRead)))),a(2),h(" ",p(7,24,e.totalPagesRead)," "),a(5),o("label",t("total-words-read-label"))("clickable",!0)("title",t("total-words-read-tooltip",C(44,I,p(12,26,e.totalWordsRead)))),a(2),h(" ",p(14,28,e.totalWordsRead)," "),a(5),o("label",t("time-spent-reading-label"))("clickable",!1)("title",t("time-spent-reading-tooltip",C(46,I,p(19,30,e.timeSpentReading)))),a(2),h(" ",p(21,32,e.timeSpentReading)," "),a(5),o("label",t("avg-reading-per-week-label"))("clickable",!1),a(),h(" ",p(27,34,e.avgHoursPerWeekSpentReading)," "),a(5),o("label",t("chapters-read-label"))("clickable",!1)("title",t("chapters-read-tooltip",C(48,I,p(32,36,e.chaptersRead)))),a(2),h(" ",t("chapters",C(50,I,p(34,38,e.chaptersRead)))," "),a(5),o("label",t("last-active-label"))("clickable",!1),a(),h(" ",p(40,40,e.lastActive)," ")}}var ie=(()=>{let r=class r{constructor(e,i,s){this.statsService=e,this.modalService=i,this.accountService=s,this.totalPagesRead=0,this.totalWordsRead=0,this.timeSpentReading=0,this.chaptersRead=0,this.lastActive="",this.avgHoursPerWeekSpentReading=0}openPageByYearList(){let e=new B;this.statsService.getPagesPerYear().subscribe(i=>{let s=this.modalService.open(M,{scrollable:!0});s.componentInstance.items=i.map(g=>`${g.name}: ${e.transform(g.value)} pages`),s.componentInstance.title="Pages Read By Year"})}openWordByYearList(){let e=new B;this.statsService.getWordsPerYear().subscribe(i=>{let s=this.modalService.open(M,{scrollable:!0});s.componentInstance.items=i.map(g=>`${g.name}: ${e.transform(g.value)} words`),s.componentInstance.title="Words Read By Year"})}};r.\u0275fac=function(i){return new(i||r)(v(E),v(G),v(A))},r.\u0275cmp=P({type:r,selectors:[["app-user-stats-info-cards"]],inputs:{totalPagesRead:"totalPagesRead",totalWordsRead:"totalWordsRead",timeSpentReading:"timeSpentReading",chaptersRead:"chaptersRead",lastActive:"lastActive",avgHoursPerWeekSpentReading:"avgHoursPerWeekSpentReading"},standalone:!0,features:[k],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"row","g-0","mt-4","mb-3","d-flex","justify-content-around"],[1,"col-auto","mb-2"],["fontClasses","fa-regular fa-file-lines",3,"click","label","clickable","title"],[1,"vr","d-none","d-lg-block","m-2"],["fontClasses","fas fa-eye",3,"label","clickable","title"],["fontClasses","fas fa-eye",3,"label","clickable"],["fontClasses","fa-regular fa-file-lines",3,"label","clickable","title"],["fontClasses","fa-regular fa-calendar",3,"label","clickable"]],template:function(i,s){i&1&&y(0,oe,41,52,"ng-container",0),i&2&&o("translocoRead","user-stats-info-cards")},dependencies:[te,V,B,K,J,w],styles:["/*# sourceMappingURL=user-stats-info-cards.component-BYAZ2Y4Z.css.map */"],changeDetection:0});let n=r;return n})();function se(n,r){if(n&1&&(u(0),m(1,"app-user-stats-info-cards",12),f()),n&2){let t=r.ngIf;a(),o("totalPagesRead",t.totalPagesRead)("totalWordsRead",t.totalWordsRead)("timeSpentReading",t.timeSpentReading)("chaptersRead",t.chaptersRead)("lastActive",t.lastActive)("avgHoursPerWeekSpentReading",t.avgHoursPerWeekSpentReading)}}function ce(n,r){if(n&1&&(l(0,"div",2)(1,"div",3),y(2,se,2,6,"ng-container",4),c(3,"async"),d(),l(4,"div",5)(5,"div",6),m(6,"app-reading-activity",7),c(7,"async"),d()(),l(8,"div",5)(9,"div",8),m(10,"app-day-breakdown",9),d(),l(11,"div",10),m(12,"app-stat-list",11),d()()()),n&2){let t=S().$implicit,e=S();a(2),o("ngIf",p(3,8,e.userStats$)),a(4),o("userId",e.userId)("isAdmin",p(7,10,e.isAdmin$)||!1)("individualUserMode",!0),a(4),o("userId",e.userId),a(2),o("data$",e.percentageRead$)("label",t("read-percentage"))("title",t("library-read-progress-title"))}}function pe(n,r){if(n&1&&(u(0),y(1,ce,13,12,"div",1),f()),n&2){let t=S();a(),o("ngIf",t.userId)}}var De=(()=>{let r=class r{constructor(e,i,s,g,R){this.cdRef=e,this.statService=i,this.accountService=s,this.memberService=g,this.libraryService=R,this.userId=void 0,this.destroyRef=j(F),this.isAdmin$=this.accountService.currentUser$.pipe(_(this.destroyRef),W(x=>x?this.accountService.hasAdminRole(x):!1))}ngOnInit(){this.memberService.getMember().subscribe(e=>{this.userId=e.id,this.cdRef.markForCheck(),this.userStats$=this.statService.getUserStatistics(this.userId).pipe(_(this.destroyRef),T()),this.readSeries$=this.statService.getReadingHistory(this.userId).pipe(_(this.destroyRef));let i=new O("en-US");this.libraryService.getLibraryNames().subscribe(s=>{this.percentageRead$=this.userStats$.pipe(_(this.destroyRef),W(g=>g.percentReadPerLibrary.map(R=>({name:s[R.count],value:parseFloat((i.transform(R.value,"1.1-1")||"0").replace("%",""))})).sort((R,x)=>x.value-R.value)))})})}};r.\u0275fac=function(i){return new(i||r)(v(Y),v(E),v(A),v(z),v(q))},r.\u0275cmp=P({type:r,selectors:[["app-user-stats"]],standalone:!0,features:[k],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],["class","vstack gap-3",4,"ngIf"],[1,"vstack","gap-3"],[1,"row","g-0","d-flex","justify-content-around"],[4,"ngIf"],[1,"row","g-0","fixed-row"],[1,"col-md-12","col-sm-12","mt-4","pt-2"],[3,"userId","isAdmin","individualUserMode"],[1,"col-md-6","col-sm-12","mb-sm-4"],[3,"userId"],[1,"col-md-6","col-sm-12"],[3,"data$","label","title"],[3,"totalPagesRead","totalWordsRead","timeSpentReading","chaptersRead","lastActive","avgHoursPerWeekSpentReading"]],template:function(i,s){i&1&&y(0,pe,2,1,"ng-container",0),i&2&&o("translocoRead","user-stats")},dependencies:[H,ie,X,ee,N,Z,w,Q],styles:[`.fixed-row[_ngcontent-%COMP%]{height:auto}
/*# sourceMappingURL=user-stats.component-SV72R4YP.css.map */`],changeDetection:0});let n=r;return n})();export{De as UserStatsComponent};
//# sourceMappingURL=chunk-DWLYUMMK.js.map
