import{a as It,b as Yi,c as Tt,d as Et,e as we,f as en,g as tn,h as nn,i as rn}from"./chunk-CMA4NIL4.js";import{a as Zi,b as on}from"./chunk-3BSTNBRU.js";import{b as cn}from"./chunk-U42B4V5B.js";import{a as Ji,b as Pt}from"./chunk-I6T7P5FM.js";import{d as Ai,e as Ct,f as Nt,g as Oi,l as Hi}from"./chunk-CIDLU7ZZ.js";import{a as Pi}from"./chunk-FVF23ION.js";import{f as zi,g as Gi,i as St,l as Ki,m as Wi}from"./chunk-ZTKUYOP3.js";import"./chunk-2JQ3KAM5.js";import"./chunk-5TIUG6K2.js";import"./chunk-IYLIANWB.js";import{a as ji}from"./chunk-63UKDQJP.js";import{c as qi}from"./chunk-COKVODYN.js";import{a as bt}from"./chunk-K6JLHPZK.js";import{a as Ni}from"./chunk-SEAKSSGD.js";import{a as Ui}from"./chunk-KWNQHRPC.js";import{a as Xe,c as yt}from"./chunk-STVWBYRJ.js";import{a as Ye}from"./chunk-SBPQBTA5.js";import{a as Ee}from"./chunk-23B3ZJIN.js";import{a as Xi}from"./chunk-6SSGNI4N.js";import"./chunk-YK7KIY5R.js";import{a as Ri}from"./chunk-WBO5KV4A.js";import{a as sn}from"./chunk-OWYEASWT.js";import{a as Ft}from"./chunk-QL7PCTRN.js";import{a as an}from"./chunk-HOUHXGPA.js";import{a as $t,b as At,h as Bi}from"./chunk-LAUBKCQL.js";import{a as ln}from"./chunk-ZCIXPP5E.js";import{a as Ze,b as xe}from"./chunk-VAE34R3W.js";import{a as Qe}from"./chunk-46CIW37K.js";import"./chunk-76TOP2FJ.js";import"./chunk-4XR5JJUF.js";import{a as $i}from"./chunk-DBXQZVFZ.js";import"./chunk-5XQ66AVT.js";import{b as Qi}from"./chunk-RLL2TM5C.js";import{a as Fe}from"./chunk-WIQ43ZSS.js";import{a as kt}from"./chunk-CNATNHH2.js";import{c as Le,e as Di,f as Li}from"./chunk-5CMEBAZF.js";import"./chunk-ZRHV3LXB.js";import{a as Je}from"./chunk-SBTJKJNK.js";import{c as pi,e as _t,f as gt,j as Ie,k as qe,m as di,o as We,q as de}from"./chunk-SPNNO5LP.js";import{d as mi,s as oe}from"./chunk-E6ZKMAWP.js";import{$ as ye,$b as E,$d as T,$e as Vi,A as lt,Ae as vi,Bb as _,Be as hi,Ce as xi,Dc as k,De as bi,E as Rt,Ec as I,Ee as Ci,F as ei,Fa as v,Fb as le,Fc as Be,Fe as Si,Ga as h,Gb as ri,Gc as R,Ge as yi,Hd as Lt,Ib as m,Jd as W,Kb as Q,L as ct,Na as ge,Nb as oi,Pa as Ae,Pe as Te,Q as mt,Qe as pe,Rb as O,Rc as B,Rd as $,S as q,Sd as Se,Se as ki,Td as D,Te as Ii,U as ti,Ud as ue,Ue as Ti,Vb as a,Ve as Ei,Wb as o,We as Fi,Xb as g,Xe as wi,Yb as S,Zb as y,Zd as fe,_b as z,_d as ee,_e as Mi,a as Yt,be as j,bf as re,ca as pt,cc as x,ce as X,dc as c,de as te,eb as ni,fa as dt,fb as _e,fe as C,g as se,gc as ai,gd as li,ge as ut,hb as Dt,hc as ce,hd as J,he as Y,ic as si,id as U,ie as ft,kc as Me,lb as n,lc as Ve,le as vt,mb as N,mc as Re,me as ie,n as $e,nc as w,nd as ke,ne,o as Zt,oc as l,od as Ce,oe as je,pc as d,pd as ze,pe as He,qa as b,qc as u,qe as Ke,rc as De,re as _i,sd as Ge,se as ht,tc as Pe,te as gi,u as st,uc as Ue,ud as ci,ue as ui,va as M,vc as Oe,xc as V,xe as fi,ya as ii,ye as xt,z as me,zc as P,ze as H}from"./chunk-2LHIXASS.js";function Dn(e,s){if(e&1&&(a(0,"a",31),l(1),o()),e&2){let i=c(2).$implicit,t=c();m("href",t.manageLink,_e),n(),d(i("manage"))}}function Ln(e,s){if(e&1&&(a(0,"a",32),l(1),o()),e&2){let i=c(2).$implicit;m("ngbTooltip",i("invalid-license-tooltip")),n(),d(i("renew"))}}function Nn(e,s){if(e&1&&g(0,"app-loading",26),e&2){let i=c(3);m("loading",i.isChecking)}}function $n(e,s){if(e&1&&(a(0,"span"),l(1),o()),e&2){let i=c(2).$implicit;n(),d(i("check"))}}function An(e,s){if(e&1&&(a(0,"span"),l(1),o()),e&2){let i=c(2).$implicit;n(),d(i("edit"))}}function Pn(e,s){if(e&1&&(a(0,"span"),l(1),o()),e&2){let i=c(2).$implicit;n(),d(i("cancel"))}}function Un(e,s){if(e&1){let i=E();_(0,Dn,2,2,"a",27)(1,Ln,2,2),a(2,"button",28),x("click",function(){v(i);let r=c(2);return h(r.validateLicense())}),_(3,Nn,1,1,"app-loading",29)(4,$n,2,1),o(),a(5,"button",30),x("click",function(){v(i);let r=c(2);return h(r.toggleViewMode())}),_(6,An,2,1,"span")(7,Pn,2,1),o()}if(e&2){let i=c(2);O(0,i.hasValidLicense?0:1),n(3),O(3,i.isChecking?3:4),n(3),O(6,i.isViewMode?6:7)}}function On(e,s){if(e&1){let i=E();a(0,"a",33),l(1),o(),a(2,"button",34),x("click",function(){v(i);let r=c(2);return h(r.toggleViewMode())}),l(3),o()}if(e&2){let i=c().$implicit,t=c();m("href",t.buyLink,_e),n(),d(i("buy")),n(2),d(t.isViewMode?i("activate"):i("cancel"))}}function Bn(e,s){if(e&1&&(a(0,"div",37)(1,"span",38),l(2),o()()),e&2){let i=c(3).$implicit;n(2),d(i("loading"))}}function zn(e,s){if(e&1&&(a(0,"i",41)(1,"span",38),l(2),o()()),e&2){let i=c(4).$implicit;m("ngbTooltip",i("license-valid")),n(2),d(i("license-valid"))}}function Gn(e,s){if(e&1&&(a(0,"i",42)(1,"span",38),l(2),o()()),e&2){let i=c(4).$implicit;m("ngbTooltip",i("license-not-valid")),n(2),d(i("license-not-valid"))}}function qn(e,s){if(e&1&&_(0,zn,3,2,"i",39)(1,Gn,3,2,"i",40),e&2){let i=c(4);O(0,i.hasValidLicense?0:-1),n(),O(1,i.hasValidLicense?-1:1)}}function jn(e,s){if(e&1&&(a(0,"span",36),l(1,"*********"),o(),_(2,Bn,3,1,"div",37)(3,qn,2,2)),e&2){let i=c(3);n(2),O(2,i.isChecking?2:3)}}function Hn(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;u(" ",i("no-license-key")," ")}}function Kn(e,s){if(e&1&&(a(0,"div",9)(1,"span",35),_(2,jn,4,1)(3,Hn,1,1),o()()),e&2){let i=c(2);n(2),O(2,i.hasLicense?2:3)}}function Wn(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(2).$implicit;n(),u(" ",i("discord-validation")," ")}}function Qn(e,s){if(e&1&&(a(0,"div",21),_(1,Wn,2,1,"div"),o()),e&2){let i,t=c(2);n(),O(1,!((i=t.formGroup.get("discordId"))==null||i.errors==null)&&i.errors.pattern?1:-1)}}function Jn(e,s){if(e&1&&(a(0,"span"),l(1),o()),e&2){let i=c().$implicit;n(),d(i("activate-save"))}}function Xn(e,s){if(e&1){let i=E();S(0),a(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"h4",7),l(7),o()(),a(8,"div",8),_(9,Un,8,3)(10,On,4,3),o()()(),_(11,Kn,4,1,"div",9),a(12,"div",10,0),Oe("ngbCollapseChange",function(r){v(i);let p=c();return Ue(p.isViewMode,r)||(p.isViewMode=r),h(r)}),a(14,"form",11)(15,"p"),l(16),o(),a(17,"div",12)(18,"label",13),l(19),o(),g(20,"input",14),o(),a(21,"div",12)(22,"label",15),l(23),o(),g(24,"input",16),o(),a(25,"div",12)(26,"label",17),l(27),o(),g(28,"i",18),a(29,"a",19),l(30,"Help"),o(),g(31,"input",20),_(32,Qn,2,1,"div",21),o()(),a(33,"div",22)(34,"button",23),x("click",function(){v(i);let r=c();return h(r.deleteLicense())}),l(35),o(),a(36,"button",24),x("click",function(){v(i);let r=c();return h(r.resetLicense())}),l(37),o(),a(38,"button",25),x("click",function(){v(i);let r=c();return h(r.saveForm())}),_(39,Jn,2,1,"span"),g(40,"app-loading",26),o()()()()(),y()}if(e&2){let i,t,r,p=s.$implicit,f=c();n(7),d(p("title")),n(2),O(9,f.hasLicense?9:10),n(2),O(11,f.isViewMode?11:-1),n(),Pe("ngbCollapse",f.isViewMode),n(2),m("formGroup",f.formGroup),n(2),d(p("activate-description")),n(3),d(p("activate-license-label")),n(4),d(p("activate-email-label")),n(4),d(p("activate-discordId-label")),n(),m("ngbTooltip",p("activate-discordId-tooltip")),n(),m("href",f.WikiLink.KavitaPlusDiscordId,_e),n(2),Q("is-invalid",((i=f.formGroup.get("discordId"))==null?null:i.invalid)&&((i=f.formGroup.get("discordId"))==null?null:i.touched)),n(),O(32,f.formGroup.dirty||f.formGroup.touched?32:-1),n(3),u(" ",p("activate-delete")," "),n(),m("ngbTooltip",p("activate-reset-tooltip"))("disabled",!((t=f.formGroup.get("email"))!=null&&t.value)||!((t=f.formGroup.get("licenseKey"))!=null&&t.value)),n(),u(" ",p("activate-reset")," "),n(),m("disabled",!((r=f.formGroup.get("email"))!=null&&r.value)||!((r=f.formGroup.get("licenseKey"))!=null&&r.value)),n(),O(39,f.isSaving?-1:39),n(),m("loading",f.isSaving)}}var mn=(()=>{let s=class s{constructor(){this.cdRef=b(B),this.toastr=b(oe),this.confirmService=b(We),this.accountService=b(de),this.WikiLink=Qe,this.formGroup=new te({}),this.isViewMode=!0,this.hasValidLicense=!1,this.hasLicense=!1,this.isChecking=!0,this.isSaving=!1,this.buyLink=Lt.buyLink,this.manageLink=Lt.manageLink}ngOnInit(){this.formGroup.addControl("licenseKey",new C("",[T.required])),this.formGroup.addControl("email",new C("",[T.required])),this.formGroup.addControl("discordId",new C("",[T.pattern(/\d+/)])),this.isChecking=!0,this.cdRef.markForCheck(),this.accountService.hasAnyLicense().subscribe(t=>{this.hasLicense=t,this.cdRef.markForCheck(),this.hasLicense&&this.accountService.hasValidLicense().subscribe(r=>{this.hasValidLicense=r,this.isChecking=!1,this.cdRef.markForCheck()})})}resetForm(){this.formGroup.get("licenseKey")?.setValue(""),this.formGroup.get("email")?.setValue(""),this.formGroup.get("discordId")?.setValue(""),this.cdRef.markForCheck()}saveForm(){this.isSaving=!0,this.cdRef.markForCheck(),this.accountService.updateUserLicense(this.formGroup.get("licenseKey").value.trim(),this.formGroup.get("email").value.trim(),this.formGroup.get("discordId").value.trim()).subscribe(()=>{this.accountService.hasValidLicense(!0).subscribe(t=>{this.hasValidLicense=t,this.hasValidLicense?this.toastr.success($("toasts.k+-unlocked")):this.toastr.info($("toasts.k+-license-saved")),this.hasLicense=this.formGroup.get("licenseKey").value.length>0,this.resetForm(),this.isViewMode=!0,this.isSaving=!1,this.cdRef.markForCheck()})},t=>{this.isSaving=!1,this.cdRef.markForCheck(),t.hasOwnProperty("error")?this.toastr.error(JSON.parse(t.error)):this.toastr.error($("toasts.k+-error"))})}deleteLicense(){return se(this,null,function*(){(yield this.confirmService.confirm($("toasts.k+-delete-key")))&&this.accountService.deleteLicense().subscribe(()=>{this.resetForm(),this.toggleViewMode(),this.validateLicense()})})}resetLicense(){return se(this,null,function*(){(yield this.confirmService.confirm($("toasts.k+-reset-key")))&&this.accountService.resetLicense(this.formGroup.get("licenseKey").value.trim(),this.formGroup.get("email").value.trim()).subscribe(()=>{this.toastr.success($("toasts.k+-reset-key-success"))})})}toggleViewMode(){this.isViewMode=!this.isViewMode,this.resetForm()}validateLicense(){this.isChecking=!0,this.accountService.hasValidLicense(!0).subscribe(t=>{this.hasValidLicense=t,this.isChecking=!1,this.cdRef.markForCheck()})}};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-license"]],standalone:!0,features:[V],decls:1,vars:1,consts:[["collapse","ngbCollapse"],[4,"transloco","translocoRead"],[1,"card","mt-2"],[1,"card-body"],[1,"card-title"],[1,"container-fluid","row","mb-2"],[1,"col-10","col-sm-10"],["id","license-key-header"],[1,"col-2","text-end"],[1,"container-fluid","row"],[3,"ngbCollapseChange","ngbCollapse"],[3,"formGroup"],[1,"form-group","mb-3"],["for","license-key"],["id","license-key","type","text","formControlName","licenseKey","autocomplete","off",1,"form-control"],["for","email"],["id","email","type","email","formControlName","email","autocomplete","off",1,"form-control"],["for","discordId"],["aria-hidden","true",1,"fa","fa-circle-info","ms-1",3,"ngbTooltip"],["target","_blank","rel","noopener noreferrer",1,"ms-1",3,"href"],["id","discordId","type","text","formControlName","discordId","autocomplete","off",1,"form-control"],["id","inviteForm-validations",1,"invalid-feedback"],[1,"col-auto","d-flex","d-md-block","justify-content-sm-center","text-md-end","mb-3"],["type","button","aria-describedby","license-key-header",1,"flex-fill","btn","btn-danger","me-1",3,"click"],["type","button","aria-describedby","license-key-header",1,"flex-fill","btn","btn-danger","me-1",3,"click","ngbTooltip","disabled"],["type","submit","aria-describedby","license-key-header",1,"flex-fill","btn","btn-primary",3,"click","disabled"],["size","spinner-border-sm",3,"loading"],["target","_blank","rel","noreferrer nofollow",1,"btn","btn-primary","btn-sm","me-1"],[1,"btn","btn-secondary","btn-sm","me-1",2,"width","58px",3,"click"],["size","spinner-border-sm"],[1,"btn","btn-secondary","btn-sm",2,"width","62px",3,"click"],["target","_blank","rel","noreferrer nofollow",1,"btn","btn-primary","btn-sm","me-1",3,"href"],["href","mailto:kavitareader@gmail.com?subject=Kavita+Subscription+Renewal&body=Description%3A%0D%0A%0D%0ALicense%20Key%3A%0D%0A%0D%0AYour%20Email%3A",1,"btn","btn-primary","btn-sm","me-1",3,"ngbTooltip"],["target","_blank","rel","noreferrer nofollow",1,"btn","btn-secondary","btn-sm","me-1",3,"href"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"col-12"],[1,"me-1"],["role","status",1,"spinner-border","spinner-border-sm","text-primary"],[1,"visually-hidden"],[1,"fa-solid","fa-check-circle","successful-validation","ms-1"],[1,"error","fa-solid","fa-exclamation-circle","ms-1"],[1,"fa-solid","fa-check-circle","successful-validation","ms-1",3,"ngbTooltip"],[1,"error","fa-solid","fa-exclamation-circle","ms-1",3,"ngbTooltip"]],template:function(r,p){r&1&&_(0,Xn,41,21,"ng-container",1),r&2&&m("translocoRead","license")},dependencies:[re,kt,vi,H,Y,ee,j,X,ie,ne,D],styles:[`.error[_ngcontent-%COMP%]{color:var(--error-color)}.successful-validation[_ngcontent-%COMP%]{color:var(--primary-color)}
/*# sourceMappingURL=license.component-NOZQPVGC.css.map */`],changeDetection:0});let e=s;return e})();function er(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("library-scan-tooltip"))}}function tr(e,s){if(e&1&&(a(0,"option",27),l(1),o()),e&2){let i=s.$implicit,t=c(2).$implicit;m("value",i),n(),d(t(i))}}function ir(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(4).$implicit;n(),u(" ",i("required")," ")}}function nr(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(4).$implicit;n(),u(" ",i("cron-notation")," ")}}function rr(e,s){if(e&1&&(a(0,"div",30),_(1,ir,2,1,"div",31)(2,nr,2,1,"div",31),o()),e&2){let i,t,r=c(4);n(),m("ngIf",(i=r.settingsForm.get("taskScanCustom"))==null||i.errors==null?null:i.errors.required),n(),m("ngIf",(t=r.settingsForm.get("taskScanCustom"))==null||t.errors==null?null:t.errors.invalidCron)}}function or(e,s){if(e&1&&(a(0,"div",14)(1,"label",28),l(2),o(),g(3,"input",29),_(4,rr,3,2,"div",30),o()),e&2){let i,t=c(2).$implicit,r=c();n(2),d(t("custom-label")),n(),Q("is-invalid",((i=r.settingsForm.get("taskScanCustom"))==null?null:i.invalid)&&((i=r.settingsForm.get("taskScanCustom"))==null?null:i.touched)),n(),O(4,r.settingsForm.dirty||r.settingsForm.touched?4:-1)}}function ar(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("library-database-backup-tooltip"))}}function sr(e,s){if(e&1&&(a(0,"option",27),l(1),o()),e&2){let i=s.$implicit,t=c(2).$implicit;m("value",i),n(),d(t(i))}}function lr(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(4).$implicit;n(),u(" ",i("required")," ")}}function cr(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(4).$implicit;n(),u(" ",i("cron-notation")," ")}}function mr(e,s){if(e&1&&(a(0,"div",34),_(1,lr,2,1,"div",31)(2,cr,2,1,"div",31),o()),e&2){let i,t,r=c(4);n(),m("ngIf",(i=r.settingsForm.get("taskBackupCustom"))==null||i.errors==null?null:i.errors.required),n(),m("ngIf",(t=r.settingsForm.get("taskBackupCustom"))==null||t.errors==null?null:t.errors.invalidCron)}}function pr(e,s){if(e&1&&(a(0,"div",14)(1,"label",32),l(2),o(),g(3,"input",33),_(4,mr,3,2,"div",34),o()),e&2){let i,t=c(2).$implicit,r=c();n(2),d(t("custom-label")),n(),Q("is-invalid",((i=r.settingsForm.get("taskBackupCustom"))==null?null:i.invalid)&&((i=r.settingsForm.get("taskBackupCustom"))==null?null:i.touched)),n(),O(4,r.settingsForm.dirty||r.settingsForm.touched?4:-1)}}function dr(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("cleanup-tooltip"))}}function _r(e,s){if(e&1&&(a(0,"option",27),l(1),o()),e&2){let i=s.$implicit,t=c(2).$implicit;m("value",i),n(),d(t(i))}}function gr(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(4).$implicit;n(),u(" ",i("required")," ")}}function ur(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(4).$implicit;n(),u(" ",i("cron-notation")," ")}}function fr(e,s){if(e&1&&(a(0,"div",37),_(1,gr,2,1,"div",31)(2,ur,2,1,"div",31),o()),e&2){let i,t,r=c(4);n(),m("ngIf",(i=r.settingsForm.get("taskCleanupCustom"))==null||i.errors==null?null:i.errors.required),n(),m("ngIf",(t=r.settingsForm.get("taskCleanupCustom"))==null||t.errors==null?null:t.errors.invalidCron)}}function vr(e,s){if(e&1&&(a(0,"div",14)(1,"label",35),l(2),o(),g(3,"input",36),_(4,fr,3,2,"div",37),o()),e&2){let i,t=c(2).$implicit,r=c();n(2),d(t("custom-label")),n(),Q("is-invalid",((i=r.settingsForm.get("taskCleanupCustom"))==null?null:i.invalid)&&((i=r.settingsForm.get("taskCleanupCustom"))==null?null:i.touched)),n(),O(4,r.settingsForm.dirty||r.settingsForm.touched?4:-1)}}function hr(e,s){if(e&1){let i=E();a(0,"tr")(1,"td",38),l(2),o(),a(3,"td"),l(4),o(),a(5,"td")(6,"button",39),x("click",function(){let r=v(i).$implicit,p=c(3);return h(p.runAdhoc(r))}),l(7,"Run"),o()()()}if(e&2){let i=s.$implicit,t=s.index,r=c(2).$implicit;n(),ce("id","adhoctask--",t,""),n(),u(" ",r(i.name)," "),n(2),u(" ",r(i.description)," "),n(2),ri("aria-labelledby","adhoctask--",t,"")}}function xr(e,s){if(e&1&&(a(0,"tr")(1,"td"),l(2),k(3,"titlecase"),o(),a(4,"td"),l(5),k(6,"utcToLocalTime"),k(7,"defaultValue"),o(),a(8,"td"),l(9),o()()),e&2){let i=s.$implicit;n(2),u(" ",I(3,3,i.title)," "),n(3),u(" ",I(7,7,I(6,5,i.lastExecutionUtc))," "),n(4),d(i.cron)}}function br(e,s){if(e&1){let i=E();a(0,"form",6)(1,"h4"),l(2),o(),a(3,"div",7)(4,"label",8),l(5),o(),g(6,"i",9),_(7,er,1,1,"ng-template",null,0,R),a(9,"span",10),z(10,11),o(),a(11,"select",12),_(12,tr,2,2,"option",13),o(),_(13,or,5,4,"div",14),o(),a(14,"div",7)(15,"label",15),l(16),o(),g(17,"i",9),_(18,ar,1,1,"ng-template",null,1,R),a(20,"span",16),z(21,11),o(),a(22,"select",17),_(23,sr,2,2,"option",13),o(),_(24,pr,5,4,"div",14),o(),a(25,"div",7)(26,"label",18),l(27),o(),g(28,"i",9),_(29,dr,1,1,"ng-template",null,2,R),a(31,"span",19),z(32,11),o(),a(33,"select",20),_(34,_r,2,2,"option",13),o(),_(35,vr,5,4,"div",14),o(),a(36,"div",21)(37,"button",22),x("click",function(){v(i);let r=c(2);return h(r.resetToDefaults())}),l(38),o(),a(39,"button",22),x("click",function(){v(i);let r=c(2);return h(r.resetForm())}),l(40),o(),a(41,"button",23),x("click",function(){v(i);let r=c(2);return h(r.saveSettings())}),l(42),o()(),a(43,"h4"),l(44),o(),a(45,"table",24)(46,"thead")(47,"tr")(48,"th",25),l(49),o(),a(50,"th",25),l(51),o(),a(52,"th",25),l(53),o()()(),a(54,"tbody"),_(55,hr,8,6,"tr",26),o()(),a(56,"h4"),l(57),o(),a(58,"table",24)(59,"thead")(60,"tr")(61,"th",25),l(62),o(),a(63,"th",25),l(64),o(),a(65,"th",25),l(66),o()()(),a(67,"tbody"),_(68,xr,10,9,"tr",26),k(69,"async"),o()()()}if(e&2){let i=w(8),t=w(19),r=w(30),p=c().$implicit,f=c();m("formGroup",f.settingsForm),n(2),d(p("title")),n(3),d(p("library-scan-label")),n(),m("ngbTooltip",i),n(4),m("ngTemplateOutlet",i),n(2),m("ngForOf",f.taskFrequencies),n(),O(13,f.settingsForm.get("taskScan").value===f.customOption?13:-1),n(3),d(p("library-database-backup-label")),n(),m("ngbTooltip",t),n(4),m("ngTemplateOutlet",t),n(2),m("ngForOf",f.taskFrequencies),n(),O(24,f.settingsForm.get("taskBackup").value===f.customOption?24:-1),n(3),d(p("cleanup-label")),n(),m("ngbTooltip",r),n(4),m("ngTemplateOutlet",r),n(2),m("ngForOf",f.taskFrequenciesForCleanup),n(),O(35,f.settingsForm.get("taskCleanup").value===f.customOption?35:-1),n(3),d(p("reset-to-default")),n(2),d(p("reset")),n(),m("disabled",!f.settingsForm.dirty),n(),d(p("save")),n(2),d(p("adhoc-tasks-title")),n(5),d(p("job-title-header")),n(2),d(p("description-header")),n(2),d(p("action-header")),n(2),m("ngForOf",f.adhocTasks),n(2),d(p("recurring-tasks-title")),n(5),d(p("job-title-header")),n(2),d(p("last-executed-header")),n(2),d(p("cron-header")),n(2),m("ngForOf",I(69,31,f.recurringTasks$))}}function Cr(e,s){if(e&1&&(S(0),a(1,"div",4),_(2,br,70,33,"form",5),o(),y()),e&2){let i=c();n(2),m("ngIf",i.serverSettings!==void 0)}}var dn=(()=>{let s=class s{constructor(t,r,p,f,L){this.settingsService=t,this.toastr=r,this.serverService=p,this.modalService=f,this.downloadService=L,this.cdRef=b(B),this.destroyRef=b(ge),this.settingsForm=new te({}),this.taskFrequencies=[],this.taskFrequenciesForCleanup=[],this.logLevels=[],this.recurringTasks$=st([]),this.adhocTasks=[{name:"convert-media-task",description:"convert-media-task-desc",api:this.serverService.convertMedia(),successMessage:"convert-media-task-success"},{name:"bust-locale-task",description:"bust-locale-task-desc",api:Rt(()=>(localStorage.removeItem("@transloco/translations/timestamp"),localStorage.removeItem("@transloco/translations"),localStorage.removeItem("translocoLang"),st())),successMessage:"bust-locale-task-success"},{name:"clear-reading-cache-task",description:"clear-reading-cache-task-desc",api:this.serverService.clearCache(),successMessage:"clear-reading-cache-task-success"},{name:"clean-up-want-to-read-task",description:"clean-up-want-to-read-task-desc",api:this.serverService.cleanupWantToRead(),successMessage:"clean-up-want-to-read-task-success"},{name:"backup-database-task",description:"backup-database-task-desc",api:this.serverService.backupDatabase(),successMessage:"backup-database-task-success"},{name:"download-logs-task",description:"download-logs-task-desc",api:Rt(()=>st(this.downloadService.download("logs",void 0))),successMessage:""},{name:"analyze-files-task",description:"analyze-files-task-desc",api:this.serverService.analyzeFiles(),successMessage:"analyze-files-task-success"},{name:"check-for-updates-task",description:"check-for-updates-task-desc",api:this.serverService.checkForUpdate(),successMessage:"",successFunction:ae=>{if(ae===null){this.toastr.info($("toasts.no-updates"));return}let he=this.modalService.open(Ji,{scrollable:!0,size:"lg"});he.componentInstance.updateData=ae}}],this.customOption="custom"}ngOnInit(){ei({frequencies:this.settingsService.getTaskFrequencies(),levels:this.settingsService.getLoggingLevels(),settings:this.settingsService.getServerSettings()}).subscribe(t=>{this.taskFrequencies=t.frequencies,this.taskFrequencies.push(this.customOption),this.taskFrequenciesForCleanup=this.taskFrequencies.filter(r=>r!=="disabled"),this.logLevels=t.levels,this.serverSettings=t.settings,this.settingsForm.addControl("taskScan",new C(this.serverSettings.taskScan,[T.required])),this.settingsForm.addControl("taskBackup",new C(this.serverSettings.taskBackup,[T.required])),this.settingsForm.addControl("taskCleanup",new C(this.serverSettings.taskCleanup,[T.required])),this.taskFrequencies.includes(this.serverSettings.taskScan)?this.settingsForm.addControl("taskScanCustom",new C("",[T.required])):(this.settingsForm.get("taskScan")?.setValue(this.customOption),this.settingsForm.addControl("taskScanCustom",new C(this.serverSettings.taskScan,[T.required]))),this.taskFrequencies.includes(this.serverSettings.taskBackup)?this.settingsForm.addControl("taskBackupCustom",new C("",[T.required])):(this.settingsForm.get("taskBackup")?.setValue(this.customOption),this.settingsForm.addControl("taskBackupCustom",new C(this.serverSettings.taskBackup,[T.required]))),this.taskFrequenciesForCleanup.includes(this.serverSettings.taskCleanup)?this.settingsForm.addControl("taskCleanupCustom",new C("",[T.required])):(this.settingsForm.get("taskCleanup")?.setValue(this.customOption),this.settingsForm.addControl("taskCleanupCustom",new C(this.serverSettings.taskCleanup,[T.required]))),this.settingsForm.get("taskScanCustom")?.valueChanges.pipe(mt(100),pt(r=>this.settingsService.isValidCronExpression(r)),dt(r=>{r?this.settingsForm.get("taskScanCustom")?.setErrors(null):this.settingsForm.get("taskScanCustom")?.setErrors({invalidCron:!0}),this.cdRef.markForCheck()}),W(this.destroyRef)).subscribe(),this.settingsForm.get("taskBackupCustom")?.valueChanges.pipe(mt(100),pt(r=>this.settingsService.isValidCronExpression(r)),dt(r=>{r?this.settingsForm.get("taskBackupCustom")?.setErrors(null):this.settingsForm.get("taskBackupCustom")?.setErrors({invalidCron:!0}),this.cdRef.markForCheck()}),W(this.destroyRef)).subscribe(),this.settingsForm.get("taskCleanupCustom")?.valueChanges.pipe(mt(100),pt(r=>this.settingsService.isValidCronExpression(r)),dt(r=>{r?this.settingsForm.get("taskCleanupCustom")?.setErrors(null):this.settingsForm.get("taskCleanupCustom")?.setErrors({invalidCron:!0}),this.cdRef.markForCheck()}),W(this.destroyRef)).subscribe(),this.cdRef.markForCheck()}),this.recurringTasks$=this.serverService.getRecurringJobs().pipe(ye()),this.cdRef.markForCheck()}resetForm(){this.settingsForm.get("taskScan")?.setValue(this.serverSettings.taskScan),this.settingsForm.get("taskBackup")?.setValue(this.serverSettings.taskBackup),this.settingsForm.get("taskCleanup")?.setValue(this.serverSettings.taskCleanup),this.taskFrequencies.includes(this.serverSettings.taskScan)?this.settingsForm.get("taskScanCustom")?.setValue(""):this.settingsForm.get("taskScanCustom")?.setValue(this.serverSettings.taskScan),this.taskFrequencies.includes(this.serverSettings.taskBackup)?this.settingsForm.get("taskBackupCustom")?.setValue(""):this.settingsForm.get("taskBackupCustom")?.setValue(this.serverSettings.taskBackup),this.taskFrequencies.includes(this.serverSettings.taskCleanup)?this.settingsForm.get("taskCleanupCustom")?.setValue(""):this.settingsForm.get("taskCleanupCustom")?.setValue(this.serverSettings.taskCleanup),this.settingsForm.markAsPristine(),this.cdRef.markForCheck()}saveSettings(){return se(this,null,function*(){let t=Object.assign({},this.serverSettings);t.taskBackup=this.settingsForm.get("taskBackup")?.value,t.taskScan=this.settingsForm.get("taskScan")?.value,t.taskCleanup=this.settingsForm.get("taskCleanup")?.value,t.taskBackup===this.customOption&&(t.taskBackup=this.settingsForm.get("taskBackupCustom")?.value),t.taskScan===this.customOption&&(t.taskScan=this.settingsForm.get("taskScanCustom")?.value),t.taskCleanup===this.customOption&&(t.taskCleanup=this.settingsForm.get("taskCleanupCustom")?.value),this.settingsService.updateServerSettings(t).pipe(q(1)).subscribe(r=>{this.serverSettings=r,this.resetForm(),this.recurringTasks$=this.serverService.getRecurringJobs().pipe(ye()),this.toastr.success($("toasts.server-settings-updated")),this.cdRef.markForCheck()},r=>{console.error("error: ",r)})})}resetToDefaults(){this.settingsService.resetServerSettings().pipe(q(1)).subscribe(t=>se(this,null,function*(){this.serverSettings=t,this.resetForm(),this.toastr.success($("toasts.server-settings-updated"))}),t=>{console.error("error: ",t)})}runAdhoc(t){t.api.subscribe(r=>{t.successMessage.length>0&&this.toastr.success($("manage-tasks-settings."+t.successMessage)),t.successFunction&&t.successFunction(r)},r=>{console.error("error: ",r)})}};s.\u0275fac=function(r){return new(r||s)(N(Ee),N(oe),N(Fe),N(pe),N(Ki))},s.\u0275cmp=M({type:s,selectors:[["app-manage-tasks-settings"]],standalone:!0,features:[V],decls:1,vars:1,consts:[["taskScanTooltip",""],["taskBackupTooltip",""],["taskCleanupTooltip",""],[4,"transloco","translocoRead"],[1,"container-fluid"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"mb-3"],["for","settings-tasks-scan",1,"form-label"],["placement","right","role","button","tabindex","0",1,"fa","fa-info-circle","ms-1",3,"ngbTooltip"],["id","settings-tasks-scan-help",1,"visually-hidden"],[3,"ngTemplateOutlet"],["aria-describedby","settings-tasks-scan-help","formControlName","taskScan","id","settings-tasks-scan",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],[1,"mt-3"],["for","settings-tasks-backup",1,"form-label"],["id","settings-tasks-backup-help",1,"visually-hidden"],["aria-describedby","settings-tasks-backup-help","formControlName","taskBackup","id","settings-tasks-backup",1,"form-select"],["for","settings-tasks-cleanup",1,"form-label"],["id","settings-tasks-cleanup-help",1,"visually-hidden"],["aria-describedby","settings-tasks-cleanup-help","formControlName","taskCleanup","id","settings-tasks-cleanup",1,"form-select"],[1,"col-auto","d-flex","d-md-block","justify-content-sm-center","text-md-end"],["type","button",1,"flex-fill","btn","btn-secondary","me-2",3,"click"],["type","submit",1,"flex-fill","btn","btn-primary",3,"click","disabled"],[1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],[3,"value"],["for","custom-task-scan",1,"form-label"],["type","text","id","custom-task-scan","formControlName","taskScanCustom","aria-describedby","task-scan-validations",1,"form-control"],["id","task-scan-validations",1,"invalid-feedback"],[4,"ngIf"],["for","custom-task-backup",1,"form-label"],["type","text","id","custom-task-backup","formControlName","taskBackupCustom","aria-describedby","task-backup-validations",1,"form-control"],["id","task-backup-validations",1,"invalid-feedback"],["for","custom-task-cleanup",1,"form-label"],["type","text","id","custom-task-cleanup","formControlName","taskCleanupCustom","aria-describedby","task-cleanup-validations",1,"form-control"],["id","task-cleanup-validations",1,"invalid-feedback"],[3,"id"],[1,"btn","btn-primary",3,"click"]],template:function(r,p){r&1&&_(0,Cr,3,1,"ng-container",3),r&2&&m("translocoRead","manage-tasks-settings")},dependencies:[U,H,Y,He,Ke,ee,je,j,X,ie,ne,re,J,Ce,ze,Xe,ue,D,ke,yt,Ye],styles:[`.table[_ngcontent-%COMP%]{background-color:#d3d3d3}
/*# sourceMappingURL=manage-tasks-settings.component-UUVYVKUP.css.map */`],changeDetection:0});let e=s;return e})();function kr(e,s){if(e&1&&(S(0),g(1,"ngx-charts-advanced-pie-chart",11),y()),e&2){let i=c().ngIf;n(),m("results",i)}}function Ir(e,s){if(e&1&&(a(0,"tr")(1,"td",16),l(2),o(),a(3,"td"),l(4),k(5,"number"),o()()),e&2){let i=s.$implicit,t=s.index;n(),ce("id","adhoctask--",t,""),n(),u(" ",i.name," "),n(2),u(" ",Be(5,4,i.value,"1.0-0")," ")}}function Tr(e,s){if(e&1){let i=E();a(0,"table",12)(1,"thead")(2,"tr")(3,"th",13),x("sort",function(r){v(i);let p=c(3);return h(p.onSort(r))}),l(4),o(),a(5,"th",14),x("sort",function(r){v(i);let p=c(3);return h(p.onSort(r))}),l(6),o()()(),a(7,"tbody"),_(8,Ir,6,7,"tr",15),o()()}if(e&2){let i=c().ngIf,t=c().$implicit;n(4),u(" ",t("year-header")," "),n(2),u(" ",t("count-header")," "),n(2),m("ngForOf",i)}}function Er(e,s){if(e&1&&(S(0),_(1,kr,2,1,"ng-container",10)(2,Tr,9,3,"ng-template",null,0,R),y()),e&2){let i=w(3),t=c(2);n(),m("ngIf",t.formControl.value)("ngIfElse",i)}}function Fr(e,s){if(e&1&&(S(0),a(1,"div",2)(2,"div",3)(3,"div",4)(4,"h4")(5,"span"),l(6),o()()(),a(7,"div",5)(8,"form")(9,"div",6),g(10,"input",7),a(11,"label",8),l(12),o()()()()(),_(13,Er,4,2,"ng-container",9),k(14,"async"),o(),y()),e&2){let i=s.$implicit,t=c();n(6),d(i("title")),n(4),m("formControl",t.formControl),n(2),d(t.formControl.value?i("visualisation-label"):i("data-table-label")),n(),m("ngIf",I(14,4,t.publicationStatues$))}}var _n=(()=>{let s=class s{constructor(t){this.statService=t,this.currentSort=new $e({column:"value",direction:"asc"}),this.currentSort$=this.currentSort.asObservable(),this.view=[700,400],this.destroyRef=b(ge),this.formControl=new C(!0,[]),this.publicationStatues$=lt([this.currentSort$,this.statService.getPublicationStatus()]).pipe(me(([r,p])=>r.column?p.sort((f,L)=>{if(r.column==="")return 0;let ae=Ze(f[r.column],L[r.column]);return r.direction==="asc"?ae:-ae}):p),W(this.destroyRef))}onSort(t){this.currentSort.next(t),this.headers.forEach(r=>{r.sortable!==t.column&&(r.direction="")})}};s.\u0275fac=function(r){return new(r||s)(N(we))},s.\u0275cmp=M({type:s,selectors:[["app-publication-status-stats"]],viewQuery:function(r,p){if(r&1&&Me(xe,5),r&2){let f;Ve(f=Re())&&(p.headers=f)}},standalone:!0,features:[V],decls:1,vars:1,consts:[["tableLayout",""],[4,"transloco","translocoRead"],[1,"dashboard-card-content"],[1,"row","g-0","mb-2"],[1,"col-8"],[1,"col-4"],[1,"form-check","form-switch","mt-2"],["id","pub-status-viz","type","checkbox","role","switch",1,"form-check-input",3,"formControl"],["for","pub-status-viz",1,"form-check-label"],[4,"ngIf"],[4,"ngIf","ngIfElse"],[3,"results"],[1,"table","table-striped","table-hover","table-striped","table-sm","scrollable"],["scope","col","sortable","name",3,"sort"],["scope","col","sortable","value",3,"sort"],[4,"ngFor","ngForOf"],[3,"id"]],template:function(r,p){r&1&&_(0,Fr,15,6,"ng-container",1),r&2&&m("translocoRead","publication-status-stats")},dependencies:[H,Y,fe,j,X,vt,U,Et,Tt,xe,J,Ce,Ge,D],styles:[`.pie-label{color:var(--body-text-color)!important}.dashboard-card-content[_ngcontent-%COMP%]{width:100%;height:242px;display:flex;flex-flow:column;box-sizing:border-box}
/*# sourceMappingURL=publication-status-stats.component-45HICVPZ.css.map */`],changeDetection:0});let e=s;return e})();var wr=["tablelayout"];function Mr(e,s){if(e&1&&l(0),e&2){let i=c().$implicit;d(i("format-tooltip"))}}function Vr(e,s){if(e&1&&(S(0),g(1,"ngx-charts-advanced-pie-chart",13),k(2,"async"),y()),e&2){let i=c(3);n(),m("results",I(2,1,i.vizData2$))}}function Rr(e,s){if(e&1&&(a(0,"tr")(1,"td",20),l(2),o(),a(3,"td"),l(4),k(5,"mangaFormat"),o(),a(6,"td"),l(7),k(8,"bytes"),o(),a(9,"td"),l(10),k(11,"number"),o()()),e&2){let i=s.$implicit,t=s.index,r=c(3).$implicit;n(),ce("id","adhoctask--",t,""),n(),u(" ",i.extension||r("not-classified")," "),n(2),u(" ",I(5,6,i.format)," "),n(3),u(" ",I(8,8,i.totalSize)," "),n(3),u(" ",Be(11,10,i.totalFiles,"1.0-0")," ")}}function Dr(e,s){if(e&1){let i=E();a(0,"table",14)(1,"thead")(2,"tr")(3,"th",15),x("sort",function(r){v(i);let p=c(3);return h(p.onSort(r))}),l(4),o(),a(5,"th",16),x("sort",function(r){v(i);let p=c(3);return h(p.onSort(r))}),l(6),o(),a(7,"th",17),x("sort",function(r){v(i);let p=c(3);return h(p.onSort(r))}),l(8),o(),a(9,"th",18),x("sort",function(r){v(i);let p=c(3);return h(p.onSort(r))}),l(10),o()()(),a(11,"tbody"),_(12,Rr,12,13,"tr",19),o(),a(13,"tfoot")(14,"tr")(15,"td"),l(16),o(),g(17,"td")(18,"td"),a(19,"td"),l(20),k(21,"async"),k(22,"bytes"),o()()()()}if(e&2){let i,t=c().ngIf,r=c().$implicit,p=c();n(4),u(" ",r("extension-header")," "),n(2),u(" ",r("format-header")," "),n(2),u(" ",r("total-size-header")," "),n(2),u(" ",r("total-files-header")," "),n(2),m("ngForOf",t),n(4),d(r("total-file-size-title")),n(4),d(I(22,9,((i=I(21,7,p.rawData$))==null?null:i.totalFileSize)||0))}}function Lr(e,s){if(e&1&&(S(0),_(1,Vr,3,3,"ng-container",12)(2,Dr,23,11,"ng-template",null,1,R),y()),e&2){let i=w(3),t=c(2);n(),m("ngIf",t.formControl.value)("ngIfElse",i)}}function Nr(e,s){if(e&1&&(S(0),a(1,"div",3)(2,"div",4)(3,"div",5)(4,"h4")(5,"span"),l(6),o(),g(7,"i",6),o()(),a(8,"div",7)(9,"form")(10,"div",8),g(11,"input",9),a(12,"label",10),l(13),o()()()()(),_(14,Mr,1,1,"ng-template",null,0,R)(16,Lr,4,2,"ng-container",11),k(17,"async"),o(),y()),e&2){let i=s.$implicit,t=w(15),r=c();n(6),d(i("format-title")),n(),m("ngbTooltip",t),n(4),m("formControl",r.formControl),n(2),d(r.formControl.value?i("visualisation-label"):i("data-table-label")),n(3),m("ngIf",I(17,5,r.files$))}}var gn=(()=>{let s=class s{constructor(){this.destroyRef=b(ge),this.cdRef=b(B),this.currentSort=new $e({column:"extension",direction:"asc"}),this.currentSort$=this.currentSort.asObservable(),this.view=[700,400],this.formControl=new C(!0,[]),this.statService=b(we),this.translocoService=b(Se),this.ngbModal=b(pe),this.rawData$=this.statService.getFileBreakdown().pipe(W(this.destroyRef),ye()),this.files$=lt([this.currentSort$,this.rawData$]).pipe(me(([t,r])=>({sortConfig:t,fileBreakdown:r.fileBreakdown})),me(({sortConfig:t,fileBreakdown:r})=>t.column?r.sort((p,f)=>{if(t.column==="")return 0;let L=Ze(p[t.column],f[t.column]);return t.direction==="asc"?L:-L}):r),W(this.destroyRef)),this.vizData2$=this.files$.pipe(W(this.destroyRef),me(t=>t.map(r=>({name:r.extension||this.translocoService.translate("file-breakdown-stats.not-classified"),value:r.totalFiles,extra:r.totalSize}))))}onSort(t){this.currentSort.next(t),this.headers.forEach(r=>{r.sortable!==t.column&&(r.direction="")})}};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-file-breakdown-stats"]],viewQuery:function(r,p){if(r&1&&(Me(wr,5),Me(xe,5)),r&2){let f;Ve(f=Re())&&(p.tableTemplate=f.first),Ve(f=Re())&&(p.headers=f)}},standalone:!0,features:[V],decls:1,vars:1,consts:[["tooltip",""],["tableLayout",""],[4,"transloco","translocoRead"],[1,"dashboard-card-content"],[1,"row","g-0","mb-2"],[1,"col-8"],["aria-hidden","true","placement","right","role","button","tabindex","0",1,"fa","fa-info-circle","ms-1",3,"ngbTooltip"],[1,"col-4"],[1,"form-check","form-switch","mt-2"],["id","pub-file-breakdown-viz","type","checkbox","role","switch",1,"form-check-input",3,"formControl"],["for","pub-file-breakdown-viz",1,"form-check-label"],[4,"ngIf"],[4,"ngIf","ngIfElse"],[3,"results"],[1,"table","table-striped","table-striped","table-hover","table-sm","scrollable"],["scope","col","sortable","extension",3,"sort"],["scope","col","sortable","format",3,"sort"],["scope","col","sortable","totalSize",3,"sort"],["scope","col","sortable","totalFiles",3,"sort"],[4,"ngFor","ngForOf"],[3,"id"]],template:function(r,p){r&1&&_(0,Nr,18,7,"ng-container",2),r&2&&m("translocoRead","file-breakdown-stats")},dependencies:[re,H,Y,fe,j,X,vt,U,Et,Tt,xe,J,Ce,Ge,St,qi,D],styles:[`.advanced-pie-legend{top:unset!important;transform:unset!important}.dashboard-card-content[_ngcontent-%COMP%]{width:100%;height:242px;display:flex;flex-flow:column;box-sizing:border-box}
/*# sourceMappingURL=file-breakdown-stats.component-I4VKUX5T.css.map */`],changeDetection:0});let e=s;return e})();function $r(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(2).$implicit;n(),d(i("no-data"))}}function Ar(e,s){if(e&1&&l(0),e&2){let i=c(4).$implicit,t=c();De(" ",i("errored-series-label")," ",t.breakdown.erroredSeries," ")}}function Pr(e,s){if(e&1&&(a(0,"p"),l(1),_(2,Ar,1,2),o()),e&2){let i=c(3).$implicit,t=c();n(),u("",i("complete")," "),n(),O(2,t.breakdown.erroredSeries>0?2:-1)}}function Ur(e,s){if(e&1&&(a(0,"ngb-progressbar-stacked"),g(1,"ngb-progressbar",2)(2,"ngb-progressbar",3),o(),_(3,Pr,3,2,"p")),e&2){let i=c(2).$implicit,t=c();n(),m("showValue",!0)("value",t.errorPercent)("ngbTooltip",i("errored-series-label")+" "+t.breakdown.erroredSeries),n(),m("showValue",!0)("value",t.completedPercent)("ngbTooltip",i("completed-series-label")+" "+t.breakdown.seriesCompleted),n(),O(3,t.breakdown.seriesCompleted>=t.breakdown.totalSeries?3:-1)}}function Or(e,s){if(e&1&&_(0,$r,2,1,"div")(1,Ur,4,7),e&2){let i=c(2);O(0,i.breakdown.totalSeries===0||i.breakdown.seriesCompleted===0?0:1)}}function Br(e,s){if(e&1&&(S(0),a(1,"div",1)(2,"h4"),l(3),o(),a(4,"p"),l(5),o(),_(6,Or,2,1),o(),y()),e&2){let i=s.$implicit,t=c();n(3),d(i("title")),n(2),d(i("description")),n(),O(6,t.breakdown?6:-1)}}var un=(()=>{let s=class s{constructor(){this.cdRef=b(B),this.statsService=b(we),this.statsService.getKavitaPlusMetadataBreakdown().subscribe(t=>{this.breakdown=t,this.errorPercent=t.erroredSeries/t.totalSeries*100,this.completedPercent=(t.seriesCompleted-t.erroredSeries)/t.totalSeries*100,this.cdRef.markForCheck()})}};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-kavitaplus-metadata-breakdown-stats"]],standalone:!0,features:[V],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"dashboard-card-content"],["type","danger",3,"showValue","value","ngbTooltip"],["type","success",3,"showValue","value","ngbTooltip"]],template:function(r,p){r&1&&_(0,Br,7,3,"ng-container",0),r&2&&m("translocoRead","kavitaplus-metadata-breakdown-stats")},dependencies:[D,Vi,Mi,re],styles:[`.dashboard-card-content[_ngcontent-%COMP%]{max-width:400px;height:auto;box-sizing:border-box}.day-breakdown-chart[_ngcontent-%COMP%]{width:100%;margin:0 auto;max-width:400px}.error[_ngcontent-%COMP%]{color:red}.completed[_ngcontent-%COMP%]{color:var(--color-5)}
/*# sourceMappingURL=kavitaplus-metadata-breakdown-stats.component-D6AEVVMA.css.map */`],changeDetection:0});let e=s;return e})();var Ne=e=>({count:e}),et=e=>({num:e});function zr(e,s){if(e&1){let i=E();a(0,"div",8),S(1),a(2,"div",9)(3,"app-icon-and-title",10),k(4,"number"),l(5),k(6,"number"),o()(),g(7,"div",11),y(),S(8),a(9,"div",9)(10,"app-icon-and-title",12),k(11,"number"),l(12),k(13,"number"),o()(),g(14,"div",11),y(),S(15),a(16,"div",9)(17,"app-icon-and-title",13),k(18,"number"),l(19),k(20,"number"),o()(),g(21,"div",11),y(),S(22),a(23,"div",9)(24,"app-icon-and-title",14),l(25),k(26,"bytes"),o()(),g(27,"div",11),y(),S(28),a(29,"div",9)(30,"app-icon-and-title",15),k(31,"number"),x("click",function(r){return v(i),c(2).openGenreList(),h(r.stopPropagation())}),l(32),k(33,"compactNumber"),o()(),g(34,"div",11),y(),S(35),a(36,"div",9)(37,"app-icon-and-title",15),k(38,"number"),x("click",function(r){return v(i),c(2).openTagList(),h(r.stopPropagation())}),l(39),k(40,"compactNumber"),o()(),g(41,"div",11),y(),S(42),a(43,"div",9)(44,"app-icon-and-title",16),k(45,"number"),x("click",function(r){return v(i),c(2).openPeopleList(),h(r.stopPropagation())}),l(46),k(47,"compactNumber"),o()(),g(48,"div",11),y(),S(49),a(50,"div",9)(51,"app-icon-and-title",17),k(52,"number"),l(53),k(54,"timeDuration"),o()(),y(),o()}if(e&2){let i=s.ngIf,t=c().$implicit;n(3),m("label",t("total-series-label"))("clickable",!1)("title",t("total-series-tooltip",P(62,Ne,I(4,32,i.seriesCount)))),n(2),u(" ",t("series-count",P(64,et,I(6,34,i.seriesCount)))," "),n(5),m("label",t("total-volumes-label"))("clickable",!1)("title",t("total-volumes-tooltip",P(66,Ne,I(11,36,i.volumeCount)))),n(2),u(" ",t("volume-count",P(68,et,I(13,38,i.volumeCount)))," "),n(5),m("label",t("total-files-label"))("clickable",!1)("title",t("total-files-tooltip",P(70,Ne,I(18,40,i.totalFiles)))),n(2),u(" ",t("file-count",P(72,et,I(20,42,i.totalFiles)))," "),n(5),m("label",t("total-size-label"))("clickable",!1)("title",t("total-size-label")),n(),u(" ",I(26,44,i.totalSize)," "),n(5),m("label",t("total-genres-label"))("clickable",!0)("title",t("total-genres-tooltip",P(74,Ne,I(31,46,i.totalGenres)))),n(2),u(" ",t("genre-count",P(76,et,I(33,48,i.totalGenres)))," "),n(5),m("label",t("total-tags-label"))("clickable",!0)("title",t("total-tags-tooltip",P(78,Ne,I(38,50,i.totalTags)))),n(2),u(" ",t("tag-count",P(80,et,I(40,52,i.totalTags)))," "),n(5),m("label",t("total-people-label"))("clickable",!0)("title",t("total-people-tooltip",P(82,Ne,I(45,54,i.totalPeople)))),n(2),u(" ",t("people-count",P(84,et,I(47,56,i.totalPeople)))," "),n(5),m("label",t("total-read-time-label"))("clickable",!1)("title",t("total-read-time-tooltip",P(86,Ne,I(52,58,i.totalReadingTime)))),n(2),u(" ",I(54,60,i.totalReadingTime)," ")}}function Gr(e,s){e&1&&(a(0,"div",25),g(1,"app-kavitaplus-metadata-breakdown-stats"),o())}function qr(e,s){if(e&1&&(S(0),a(1,"div",18),g(2,"app-top-readers"),o(),a(3,"div",19)(4,"div",20),g(5,"app-file-breakdown-stats"),o(),a(6,"div",21),g(7,"app-publication-status-stats"),o()(),a(8,"div",19)(9,"div",22),g(10,"app-reading-activity",23),o()(),a(11,"div",19)(12,"div",24),g(13,"app-day-breakdown"),o(),_(14,Gr,2,0,"div",25),k(15,"async"),o(),y()),e&2){let i=c(2);n(10),m("isAdmin",!0),n(4),O(14,I(15,2,i.accountService.hasValidLicense$)?14:-1)}}function jr(e,s){if(e&1&&(S(0),a(1,"div",1),_(2,zr,55,88,"div",2),k(3,"async"),a(4,"div",3)(5,"div",4),g(6,"app-stat-list",5),o(),a(7,"div",4),g(8,"app-stat-list",5),o(),a(9,"div",4),g(10,"app-stat-list",5),o(),a(11,"div",4),g(12,"app-stat-list",6),o(),a(13,"div",4),g(14,"app-stat-list",6),o()(),_(15,qr,16,4,"ng-container",7),k(16,"async"),o(),y()),e&2){let i=s.$implicit,t=c();n(2),m("ngIf",I(3,19,t.stats$)),n(4),m("data$",t.releaseYears$)("title",i("release-years-title"))("label",i("series")),n(2),m("data$",t.mostActiveUsers$)("title",i("most-active-users-title"))("label",i("reads")),n(2),m("data$",t.mostActiveLibrary$)("title",i("popular-libraries-title"))("label",i("reads")),n(2),m("data$",t.mostActiveSeries$)("title",i("popular-series-title"))("image",t.seriesImage)("handleClick",t.openSeries),n(2),m("data$",t.recentlyRead$)("title",i("recently-read-title"))("image",t.seriesImage)("handleClick",t.openSeries),n(),m("ngIf",I(16,21,t.breakpoint$))}}var fn=(()=>{let s=class s{onResize(){this.breakpointSubject.next(this.utilityService.getActiveBreakpoint())}get Breakpoint(){return Di}constructor(t,r,p,f,L,ae,he){this.statService=t,this.router=r,this.imageService=p,this.metadataService=f,this.modalService=L,this.utilityService=ae,this.filterUtilityService=he,this.destroyRef=b(ge),this.accountService=b(de),this.openSeries=F=>{let K=F.extra;this.router.navigate(["library",K.libraryId,"series",K.id])},this.breakpointSubject=new Zt(1),this.breakpoint$=this.breakpointSubject.asObservable(),this.seriesImage=F=>F.extra?this.imageService.getSeriesCoverImage(F.extra.id):"",this.breakpointSubject.next(this.utilityService.getActiveBreakpoint()),this.stats$=this.statService.getServerStatistics().pipe(W(this.destroyRef),ye()),this.releaseYears$=this.statService.getTopYears().pipe(W(this.destroyRef)),this.mostActiveUsers$=this.stats$.pipe(me(F=>F.mostActiveUsers),me(F=>F.map(K=>({name:K.value.username,value:K.count}))),W(this.destroyRef)),this.mostActiveLibrary$=this.stats$.pipe(me(F=>F.mostActiveLibraries),me(F=>F.map(K=>({name:K.value.name,value:K.count}))),W(this.destroyRef)),this.mostActiveSeries$=this.stats$.pipe(me(F=>F.mostReadSeries),me(F=>F.map(K=>({name:K.value.name,value:K.count,extra:K.value}))),W(this.destroyRef)),this.recentlyRead$=this.stats$.pipe(me(F=>F.recentlyRead),me(F=>F.map(K=>({name:K.name,value:-1,extra:K}))),W(this.destroyRef))}openGenreList(){this.metadataService.getAllGenres().subscribe(t=>{let r=this.modalService.open(It,{scrollable:!0});r.componentInstance.items=t.map(p=>p.title),r.componentInstance.title=$("server-stats.genres"),r.componentInstance.clicked=p=>{this.filterUtilityService.applyFilter(["all-series"],At.Genres,$t.Contains,t.filter(f=>f.title===p)[0].id+"").subscribe()}})}openTagList(){this.metadataService.getAllTags().subscribe(t=>{let r=this.modalService.open(It,{scrollable:!0});r.componentInstance.items=t.map(p=>p.title),r.componentInstance.title=$("server-stats.tags"),r.componentInstance.clicked=p=>{this.filterUtilityService.applyFilter(["all-series"],At.Tags,$t.Contains,t.filter(f=>f.title===p)[0].id+"").subscribe()}})}openPeopleList(){this.metadataService.getAllPeople().subscribe(t=>{let r=this.modalService.open(It,{scrollable:!0});r.componentInstance.items=[...new Set(t.map(p=>p.name))],r.componentInstance.title=$("server-stats.people")})}};s.\u0275fac=function(r){return new(r||s)(N(we),N(_t),N(Ni),N(Bi),N(pe),N(Li),N(Wi))},s.\u0275cmp=M({type:s,selectors:[["app-server-stats"]],hostBindings:function(r,p){r&1&&x("resize",function(L){return p.onResize(L)},!1,Dt)("orientationchange",function(L){return p.onResize(L)},!1,Dt)},standalone:!0,features:[V],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"container-fluid"],["class","row g-0 mt-4 mb-3 d-flex justify-content-around",4,"ngIf"],[1,"grid","row","g-0","pt-2","pb-2","d-flex","justify-content-around"],[1,"col-auto"],[3,"data$","title","label"],[3,"data$","title","image","handleClick"],[4,"ngIf"],[1,"row","g-0","mt-4","mb-3","d-flex","justify-content-around"],[1,"col-auto","mb-2"],["fontClasses","fa-solid fa-book-open",3,"label","clickable","title"],[1,"vr","d-none","d-lg-block","m-2"],["fontClasses","fas fa-book",3,"label","clickable","title"],["fontClasses","fa-regular fa-file",3,"label","clickable","title"],["fontClasses","fa-solid fa-scale-unbalanced",3,"label","clickable","title"],["fontClasses","fa-solid fa-tags",3,"click","label","clickable","title"],["fontClasses","fa-solid fa-user-tag",3,"click","label","clickable","title"],["fontClasses","fas fa-eye",3,"label","clickable","title"],[1,"row","g-0","pt-2","pb-2"],[1,"row","g-0","pt-4","pb-2"],[1,"col-lg-6","col-md-12","mb-md-5"],[1,"col-lg-6","col-md-12"],[1,"col-md-12","col-sm-12","mt-4","pt-2"],[3,"isAdmin"],[1,"col-md-6","col-sm-12","mt-4","pt-2"],[1,"col-md-4","col-md-offset-2","col-sm-12","mt-4","pt-2"]],template:function(r,p){r&1&&_(0,jr,17,23,"ng-container",0),r&2&&m("translocoRead","server-stats")},dependencies:[U,on,rn,tn,gn,_n,nn,en,Ce,Ge,Zi,Yi,St,D,un],styles:[`.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,280px);grid-gap:.5rem;justify-content:space-evenly;width:100%;overflow-y:auto;overflow-x:hidden;align-items:start}
/*# sourceMappingURL=server-stats.component-3CTTIHWW.css.map */`],changeDetection:0});let e=s;return e})();function Hr(e,s){if(e&1&&(a(0,"div",3)(1,"h3"),l(2),o(),a(3,"dl")(4,"dt"),l(5),o(),a(6,"dd"),l(7),o(),a(8,"dt"),l(9),o(),a(10,"dd"),l(11),o()()()),e&2){let i=c().$implicit,t=c();n(2),d(i("title")),n(3),d(i("version-title")),n(2),d(t.serverInfo.kavitaVersion),n(2),d(i("installId-title")),n(2),d(t.serverInfo.installId)}}function Kr(e,s){if(e&1&&(S(0),a(1,"div",1),_(2,Hr,12,5,"div",2),a(3,"div",3)(4,"h3"),l(5),o(),a(6,"div",4)(7,"div",5),l(8),o(),a(9,"div",6)(10,"a",7),l(11,"kavitareader.com"),o()()(),a(12,"div",4)(13,"div",5),l(14),o(),a(15,"div",6)(16,"a",8),l(17,"wiki.kavitareader.com"),o()()(),a(18,"div",4)(19,"div",5),l(20),o(),a(21,"div",6)(22,"a",9),l(23,"discord.gg/b52wT37kt7"),o()()(),a(24,"div",4)(25,"div",5),l(26),o(),a(27,"div",6)(28,"a",10),l(29,"opencollective.com/kavita"),o()()(),a(30,"div",4)(31,"div",5),l(32),o(),a(33,"div",6)(34,"a",11),l(35,"github.com/Kareadita/Kavita"),o()()(),a(36,"div",4)(37,"div",5),l(38),o(),a(39,"div",6)(40,"a",12),l(41,"Weblate"),o(),g(42,"br"),o()(),a(43,"div",4)(44,"div",5),l(45),o(),a(46,"div",6)(47,"a",13),l(48,"https://github.com/Kareadita/Kavita/discussions/"),o(),g(49,"br"),o()()(),a(50,"div",3)(51,"h3"),l(52),o(),g(53,"app-changelog"),o()(),y()),e&2){let i=s.$implicit,t=c();n(2),m("ngIf",t.serverInfo),n(3),d(i("more-info-title")),n(3),d(i("home-page-title")),n(6),d(i("wiki-title")),n(6),d(i("discord-title")),n(6),d(i("donations-title")),n(6),d(i("source-title")),n(6),d(i("localization-title")),n(7),d(i("feature-request-title")),n(7),d(i("updates-title"))}}var vn=(()=>{let s=class s{constructor(t){this.serverService=t,this.cdRef=b(B)}ngOnInit(){this.serverService.getServerInfo().subscribe(t=>{this.serverInfo=t,this.cdRef.markForCheck()})}};s.\u0275fac=function(r){return new(r||s)(N(Fe))},s.\u0275cmp=M({type:s,selectors:[["app-manage-system"]],standalone:!0,features:[V],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"container-fluid"],["class","mb-3",4,"ngIf"],[1,"mb-3"],[1,"row"],[1,"col-4"],[1,"col"],["href","https://www.kavitareader.com","target","_blank","rel","noopener noreferrer"],["href","https://wiki.kavitareader.com","target","_blank","rel","noopener noreferrer"],["href","https://discord.gg/b52wT37kt7","target","_blank","rel","noopener noreferrer"],["href","https://opencollective.com/kavita","target","_blank","rel","noopener noreferrer"],["href","https://github.com/Kareadita/Kavita","target","_blank","rel","noopener noreferrer"],["href","https://hosted.weblate.org/engage/kavita/","target","_blank","rel","noopener noreferrer"],["href","https://github.com/Kareadita/Kavita/discussions/2529","target","_blank","rel","noopener noreferrer"]],template:function(r,p){r&1&&_(0,Kr,54,10,"ng-container",0),r&2&&m("translocoRead","manage-system")},dependencies:[U,D,Xi],styles:["/*# sourceMappingURL=manage-system.component-3E6PA36Q.css.map */"],changeDetection:0});let e=s;return e})();var hn=(()=>{let s=class s{constructor(){this.translocoService=b(Se)}transform(t){switch(t){case Le.Book:return this.translocoService.translate("library-type-pipe.book");case Le.Comic:return this.translocoService.translate("library-type-pipe.comic");case Le.ComicVine:return this.translocoService.translate("library-type-pipe.comicVine");case Le.Images:return this.translocoService.translate("library-type-pipe.image");case Le.Manga:return this.translocoService.translate("library-type-pipe.manga");case Le.LightNovel:return this.translocoService.translate("library-type-pipe.lightNovel");default:return""}}};s.\u0275fac=function(r){return new(r||s)},s.\u0275pipe=ii({name:"libraryType",type:s,pure:!0,standalone:!0});let e=s;return e})();var xn=e=>({name:e});function Wr(e,s){e&1&&(a(0,"span"),l(1,"Never"),o())}function Qr(e,s){if(e&1&&(l(0),k(1,"timeAgo"),k(2,"defaultDate")),e&2){let i=c().$implicit;u(" ",I(2,3,I(1,1,i.lastScanned))," ")}}function Jr(e,s){if(e&1){let i=E();a(0,"li",12)(1,"div")(2,"h4")(3,"span",13)(4,"a",14),l(5),o()(),l(6,"\xA0 "),a(7,"div",15)(8,"button",16),x("click",function(){let r=v(i).$implicit,p=c(2);return h(p.scanLibrary(r))}),g(9,"i",17),o(),a(10,"button",18),x("click",function(){let r=v(i).$implicit,p=c(2);return h(p.deleteLibrary(r))}),g(11,"i",19),k(12,"sentenceCase"),o(),a(13,"button",20),x("click",function(){let r=v(i).$implicit,p=c(2);return h(p.editLibrary(r))}),g(14,"i",21),k(15,"sentenceCase"),o()()()(),a(16,"div"),l(17),k(18,"libraryType"),o(),a(19,"div"),l(20),o(),a(21,"div"),l(22),_(23,Wr,2,0,"span",22)(24,Qr,3,5,"ng-template",null,0,R),o()()}if(e&2){let i=s.$implicit,t=s.index,r=w(25),p=c().$implicit,f=c();n(3),ce("id","library-name--",t,""),n(),m("routerLink","/library/"+i.id),n(),d(i.name),n(3),m("ngbTooltip",p("scan-library")),le("aria-label",p("scan-library")),n(2),m("disabled",f.deletionInProgress),n(),m("ngbTooltip",p("delete-library")),le("aria-label",p("delete-library-by-name",P(24,xn,I(12,18,i.name)))),n(3),m("ngbTooltip",p("edit-library")),le("aria-label",p("edit-library-by-name",P(26,xn,I(15,20,i.name)))),n(3),De("",p("type-title")," ",I(18,22,i.type),""),n(3),De("",p("shared-folders-title")," ",i.folders.length+" folders",""),n(2),u(" ",p("last-scanned-title")," "),n(),m("ngIf",i.lastScanned==="0001-01-01T00:00:00")("ngIfElse",r)}}function Xr(e,s){if(e&1&&(a(0,"li",23)(1,"div",24)(2,"span",25),l(3),o()()()),e&2){let i=c().$implicit;n(3),d(i("loading"))}}function Yr(e,s){if(e&1&&(a(0,"li",23),l(1),o()),e&2){let i=c().$implicit;n(),u(" ",i("no-data")," ")}}function Zr(e,s){if(e&1){let i=E();S(0),a(1,"div",2)(2,"div",3)(3,"div",4)(4,"h3"),l(5),o()(),a(6,"div",5)(7,"button",6),x("click",function(){v(i);let r=c();return h(r.addLibrary())}),g(8,"i",7),a(9,"span",8),l(10),o()()()(),a(11,"ul",9),_(12,Jr,26,28,"li",10)(13,Xr,4,1,"li",11)(14,Yr,2,1,"li",11),o()(),y()}if(e&2){let i=s.$implicit,t=c();n(5),d(i("title")),n(2),m("title",i("add-library")),n(3),d(i("add-library")),n(2),m("ngForOf",t.libraries)("ngForTrackBy",t.libraryTrackBy),n(),m("ngIf",t.loading),n(),m("ngIf",t.libraries.length===0&&!t.loading)}}var bn=(()=>{let s=class s{constructor(){this.actionService=b(Oi),this.libraryService=b(bt),this.modalService=b(pe),this.toastr=b(oe),this.confirmService=b(We),this.hubService=b(qe),this.cdRef=b(B),this.destroyRef=b(ge),this.libraries=[],this.loading=!1,this.deletionInProgress=!1,this.libraryTrackBy=(t,r)=>`${r.name}_${r.lastScanned}_${r.type}_${r.folders.length}`}ngOnInit(){this.getLibraries(),this.hubService.messages$.pipe(W(this.destroyRef),ct(t=>t.event===Ie.ScanSeries||t.event===Ie.NotificationProgress),ti((t,r)=>this.hasMessageChanged(t,r))).subscribe(t=>{let r=0;t.event===Ie.ScanSeries?r=t.payload.libraryId:t.payload.body.hasOwnProperty("libraryId")&&(r=t.payload.body.libraryId),this.libraryService.getLibraries().pipe(q(1)).subscribe(p=>{let f=p.find(ae=>ae.id===r),L=this.libraries.find(ae=>ae.id===r);L!==void 0&&(L.lastScanned=f?.lastScanned||L.lastScanned,this.cdRef.markForCheck())})})}hasMessageChanged(t,r){return r.event!==t.event?!0:r.event===Ie.ScanSeries?t.payload.libraryId===r.payload.libraryId:r.event===Ie.NotificationProgress?t.payload.eventType!=r.payload.eventType:!1}getLibraries(){this.loading=!0,this.cdRef.markForCheck(),this.libraryService.getLibraries().pipe(q(1),W(this.destroyRef)).subscribe(t=>{this.libraries=[...t],this.loading=!1,this.cdRef.markForCheck()})}editLibrary(t){let r=this.modalService.open(Nt,{size:"xl",fullscreen:"md"});r.componentInstance.library=t,r.closed.pipe(W(this.destroyRef)).subscribe(p=>{p&&this.getLibraries()})}addLibrary(){this.modalService.open(Nt,{size:"xl",fullscreen:"md"}).closed.pipe(W(this.destroyRef)).subscribe(r=>{r&&this.getLibraries()})}deleteLibrary(t){return se(this,null,function*(){(yield this.confirmService.confirm($("toasts.confirm-library-delete",{name:t.name})))&&(this.deletionInProgress=!0,this.libraryService.delete(t.id).pipe(q(1)).subscribe(()=>{this.deletionInProgress=!1,this.cdRef.markForCheck(),this.getLibraries(),this.toastr.success($("toasts.library-deleted",{name:t.name}))}))})}scanLibrary(t){this.libraryService.scan(t.id).pipe(q(1)).subscribe(()=>{this.toastr.info($("toasts.scan-queued",{name:t.name}))})}};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-manage-library"]],standalone:!0,features:[V],decls:1,vars:1,consts:[["activeDate",""],[4,"transloco","translocoRead"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-8"],[1,"col-4"],[1,"btn","btn-primary","float-end",3,"click","title"],["aria-hidden","true",1,"fa","fa-plus"],[1,"phone-hidden","ms-1"],[1,"list-group"],["class","list-group-item no-hover",4,"ngFor","ngForOf","ngForTrackBy"],["class","list-group-item",4,"ngIf"],[1,"list-group-item","no-hover"],[3,"id"],[3,"routerLink"],[1,"float-end"],["placement","top",1,"btn","btn-secondary","me-2","btn-sm",3,"click","ngbTooltip"],["aria-hidden","true",1,"fa","fa-sync-alt"],[1,"btn","btn-danger","me-2","btn-sm",3,"click","disabled"],["placement","top",1,"fa","fa-trash",3,"ngbTooltip"],[1,"btn","btn-primary","btn-sm",3,"click"],["placement","top",1,"fa","fa-pen",3,"ngbTooltip"],[4,"ngIf","ngIfElse"],[1,"list-group-item"],["role","status",1,"spinner-border","text-primary"],[1,"invisible"]],template:function(r,p){r&1&&_(0,Zr,15,7,"ng-container",1),r&2&&m("translocoRead","manage-library")},dependencies:[J,gt,re,U,hn,ji,Je,ue,D,Ct],styles:["/*# sourceMappingURL=manage-library.component-QHQN5VJ4.css.map */"],changeDetection:0});let e=s;return e})();var eo=e=>({username:e});function to(e,s){if(e&1&&(a(0,"div",13)(1,"strong"),l(2),o(),l(3),o()),e&2){let i=c().$implicit,t=c();n(2),d(i("error-label")),n(),u(" ",t.errorMessage," ")}}function io(e,s){if(e&1){let i=E();S(0),a(1,"form",1)(2,"div",2)(3,"h4",3),l(4),k(5,"sentenceCase"),o(),a(6,"button",4),x("click",function(){v(i);let r=c();return h(r.close())}),o()(),a(7,"div",5),_(8,to,4,2,"div",6),a(9,"div",7)(10,"label",8),l(11),o(),g(12,"input",9),o()(),a(13,"div",10)(14,"button",11),x("click",function(){v(i);let r=c();return h(r.close())}),l(15),o(),a(16,"button",12),x("click",function(){v(i);let r=c();return h(r.save())}),l(17),o()()(),y()}if(e&2){let i=s.$implicit,t=c();n(),m("formGroup",t.resetPasswordForm),n(3),d(i("title",P(10,eo,I(5,8,t.member.username)))),n(2),le("aria-label",i("close")),n(2),m("ngIf",t.errorMessage!==""),n(3),d(i("new-password-label")),n(4),d(i("cancel")),n(),m("disabled",t.resetPasswordForm.value.password.length===0),n(),d(i("save"))}}var Cn=(()=>{let s=class s{constructor(){this.toastr=b(oe),this.accountService=b(de),this.modal=b(Te),this.errorMessage="",this.resetPasswordForm=new te({password:new C("",[T.required])})}save(){this.accountService.resetPassword(this.member.username,this.resetPasswordForm.value.password,"").subscribe(()=>{this.toastr.success($("toasts.password-updated")),this.modal.close()})}close(){this.modal.close()}};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-reset-password-modal"]],inputs:{member:"member"},standalone:!0,features:[V],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[3,"formGroup"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],["class","alert alert-info",4,"ngIf"],[1,"mb-3"],["for","password",1,"form-label"],["id","password","minlength","4","formControlName","password","type","password",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"],[1,"alert","alert-info"]],template:function(r,p){r&1&&_(0,io,18,12,"ng-container",0),r&2&&m("translocoRead","reset-password-modal")},dependencies:[H,Y,ee,j,X,ui,ie,ne,U,Je,D],styles:["/*# sourceMappingURL=reset-password-modal.component-ZF2QSERR.css.map */"]});let e=s;return e})();function no(e,s){if(e&1){let i=E();a(0,"div",6)(1,"input",7),x("change",function(){v(i);let r=c(3);return h(r.toggleAll())}),o(),a(2,"label",8),l(3),o()()}if(e&2){let i=c(2).$implicit,t=c();n(),m("ngModel",t.selectAll)("indeterminate",t.hasSomeSelected),n(2),d(t.selectAll?i("deselect-all"):i("select-all"))}}function ro(e,s){if(e&1){let i=E();a(0,"li",9)(1,"div",6)(2,"input",10),x("change",function(){let r=v(i).$implicit,p=c(3);return h(p.handleSelection(r))}),o(),a(3,"label",11),l(4),o()()()}if(e&2){let i=s.$implicit,t=s.index,r=c(3);n(2),ce("id","library-",t,""),m("ngModel",r.selections.isSelected(i)),n(),ce("for","library-",t,""),n(),d(i.name)}}function oo(e,s){if(e&1&&(a(0,"li",9),l(1),o()),e&2){let i=c(2).$implicit;n(),u(" ",i("no-data")," ")}}function ao(e,s){if(e&1&&(a(0,"div",2),_(1,no,4,3,"div",3),a(2,"ul"),_(3,ro,5,6,"li",4)(4,oo,2,1,"li",5),o()()),e&2){let i=c(2);n(),m("ngIf",i.allLibraries.length>0),n(2),m("ngForOf",i.allLibraries),n(),m("ngIf",i.allLibraries.length===0)}}function so(e,s){if(e&1&&(S(0),a(1,"h4"),l(2),o(),_(3,ao,5,3,"div",1),y()),e&2){let i=s.$implicit,t=c();n(2),d(i("title")),n(),m("ngIf",!t.isLoading)}}var wt=(()=>{let s=class s{get hasSomeSelected(){return this.selections!=null&&this.selections.hasSomeSelected()}constructor(t,r){this.libraryService=t,this.fb=r,this.selected=new Ae,this.allLibraries=[],this.selectedLibraries=[],this.selectAll=!1,this.isLoading=!1}ngOnInit(){this.libraryService.getLibraries().subscribe(t=>{this.allLibraries=t,this.setupSelections()})}setupSelections(){this.selections=new Gi(!1,this.allLibraries),this.isLoading=!1,this.member!==void 0&&(this.member.libraries.forEach(t=>{this.selections.toggle(t,!0,(r,p)=>r.name===p.name)}),this.selectAll=this.selections.selected().length===this.allLibraries.length,this.selected.emit(this.selections.selected()))}toggleAll(){this.selectAll=!this.selectAll,this.allLibraries.forEach(t=>this.selections.toggle(t,this.selectAll)),this.selected.emit(this.selections.selected())}handleSelection(t){this.selections.toggle(t);let r=this.selections.selected().length;r==0?this.selectAll=!1:r==this.selectedLibraries.length&&(this.selectAll=!0),this.selected.emit(this.selections.selected())}};s.\u0275fac=function(r){return new(r||s)(N(bt),N(fi))},s.\u0275cmp=M({type:s,selectors:[["app-library-selector"]],inputs:{member:"member"},outputs:{selected:"selected"},standalone:!0,features:[V],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],["class","list-group",4,"ngIf"],[1,"list-group"],["class","form-check",4,"ngIf"],["class","list-group-item",4,"ngFor","ngForOf"],["class","list-group-item",4,"ngIf"],[1,"form-check"],["id","select-all","type","checkbox",1,"form-check-input",3,"change","ngModel","indeterminate"],["for","select-all",1,"form-check-label"],[1,"list-group-item"],["type","checkbox",1,"form-check-input",3,"change","id","ngModel"],[1,"form-check-label",3,"for"]],template:function(r,p){r&1&&_(0,so,4,2,"ng-container",0),r&2&&m("translocoRead","library-selector")},dependencies:[U,H,fe,j,xt,ut,J,D],styles:[`.list-group-item[_ngcontent-%COMP%]{border:none}
/*# sourceMappingURL=library-selector.component-HGJC66GO.css.map */`]});let e=s;return e})();function lo(e,s){if(e&1){let i=E();a(0,"li",3)(1,"div",4)(2,"input",5),Oe("ngModelChange",function(r){let p=v(i).$implicit;return Ue(p.selected,r)||(p.selected=r),h(r)}),x("ngModelChange",function(){v(i);let r=c(2);return h(r.handleModelUpdate())}),o(),a(3,"label",6),l(4),o()()()}if(e&2){let i=s.$implicit,t=s.index;n(2),ce("id","role-",t,""),Pe("ngModel",i.selected),m("disabled",i.disabled),n(),ce("for","role-",t,""),n(),d(i.data)}}function co(e,s){if(e&1&&(S(0),a(1,"h4"),l(2),o(),a(3,"ul",1),_(4,lo,5,7,"li",2),o(),y()),e&2){let i=s.$implicit,t=c();n(2),d(i("title")),n(2),m("ngForOf",t.selectedRoles)}}var Mt=(()=>{let s=class s{constructor(t,r,p){this.modal=t,this.accountService=r,this.cdRef=p,this.allowAdmin=!1,this.selected=new Ae,this.allRoles=[],this.selectedRoles=[]}ngOnInit(){this.accountService.getRoles().subscribe(t=>{let r=["Pleb"];this.allowAdmin||r.push("Admin"),t=t.filter(p=>!r.includes(p)),this.allRoles=t,this.selectedRoles=t.map(p=>({selected:!1,disabled:!1,data:p})),this.cdRef.markForCheck(),this.preselect(),this.selected.emit(this.selectedRoles.filter(p=>p.selected).map(p=>p.data))})}preselect(){this.member!==void 0?this.member.roles.forEach(t=>{let r=this.selectedRoles.filter(p=>p.data===t);r.length>0&&(r[0].selected=!0)}):this.selectedRoles.forEach(t=>{t.data=="Login"&&(t.selected=!0)}),this.cdRef.markForCheck()}handleModelUpdate(){let t=this.selectedRoles.filter(r=>r.selected).map(r=>r.data);t.filter(r=>r==="Admin").length>0?this.selectedRoles.filter(r=>r.data!=="Admin").forEach(r=>{r.disabled=!0}):this.selectedRoles.forEach(r=>{r.disabled=!1}),this.cdRef.markForCheck(),this.selected.emit(t)}};s.\u0275fac=function(r){return new(r||s)(N(Te),N(de),N(B))},s.\u0275cmp=M({type:s,selectors:[["app-role-selector"]],inputs:{member:"member",allowAdmin:"allowAdmin"},outputs:{selected:"selected"},standalone:!0,features:[V],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"form-check"],["type","checkbox","name","role",1,"form-check-input",3,"ngModelChange","id","ngModel","disabled"],[1,"form-check-label",3,"for"]],template:function(r,p){r&1&&_(0,co,5,2,"ng-container",0),r&2&&m("translocoRead","role-selector")},dependencies:[J,H,fe,j,xt,ut,D],styles:[`.list-group-item[_ngcontent-%COMP%]{border:none}
/*# sourceMappingURL=role-selector.component-VO67KA6S.css.map */`],changeDetection:0});let e=s;return e})();function mo(e,s){if(e&1&&(g(0,"p",12),k(1,"safeHtml")),e&2){let i=c().$implicit;m("innerHTML",I(1,1,i("description")),ni)}}function po(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(3).$implicit;n(),u(" ",i("required-field")," ")}}function _o(e,s){if(e&1&&(a(0,"div",24),_(1,po,2,1,"div",8),o()),e&2){let i=c(3);n(),m("ngIf",i.email==null||i.email.errors==null?null:i.email.errors.required)}}function go(e,s){if(e&1){let i=E();a(0,"form",13)(1,"div",14)(2,"div",15)(3,"label",16),l(4),o(),g(5,"input",17),_(6,_o,2,1,"div",18),o()(),a(7,"div",14)(8,"div",19)(9,"app-role-selector",20),x("selected",function(r){v(i);let p=c(2);return h(p.updateRoleSelection(r))}),o()(),a(10,"div",19)(11,"app-library-selector",21),x("selected",function(r){v(i);let p=c(2);return h(p.updateLibrarySelection(r))}),o()()(),a(12,"div",14)(13,"div",22)(14,"app-restriction-selector",23),x("selected",function(r){v(i);let p=c(2);return h(p.updateRestrictionSelection(r))}),o()()()()}if(e&2){let i,t=c().$implicit,r=c();m("formGroup",r.inviteForm),n(4),d(t("email")),n(),Q("is-invalid",((i=r.inviteForm.get("email"))==null?null:i.invalid)&&((i=r.inviteForm.get("email"))==null?null:i.touched)),n(),m("ngIf",r.inviteForm.dirty||r.inviteForm.touched),n(3),m("allowAdmin",!0),n(5),m("isAdmin",r.hasAdminRoleSelected)}}function uo(e,s){if(e&1&&(a(0,"div",25)(1,"strong"),l(2),o(),l(3),o()),e&2){let i=c(2).$implicit;n(2),d(i("notice")),n(),u(" ",i("email-not-sent")," ")}}function fo(e,s){if(e&1&&(S(0),a(1,"h4"),l(2),o(),a(3,"p"),l(4),o(),_(5,uo,4,2,"div",25),a(6,"a",26),l(7),o(),g(8,"app-api-key",27),y()),e&2){let i=c().$implicit,t=c();n(2),d(i("setup-user-title")),n(2),d(i("setup-user-description")),n(),O(5,t.inviteError?5:-1),n(),ai("href",t.emailLink,_e),n(),d(i("setup-user-account")),n(),m("title",i("invite-url-label"))("tooltipText",i("setup-user-account-tooltip"))("hideData",!1)("showRefresh",!1)("transform",t.makeLink)}}function vo(e,s){e&1&&g(0,"span",30)}function ho(e,s){if(e&1){let i=E();a(0,"button",28),x("click",function(){v(i);let r=c(2);return h(r.invite())}),_(1,vo,1,0,"span",29),a(2,"span"),l(3),o()()}if(e&2){let i=c().$implicit,t=c();m("disabled",t.isSending||!t.inviteForm.valid||t.emailLink!==""),n(),m("ngIf",t.isSending),n(2),d(t.isSending?i("inviting"):i("invite"))}}function xo(e,s){if(e&1){let i=E();S(0),a(1,"div",1)(2,"div",2)(3,"h4",3),l(4),o(),a(5,"button",4),x("click",function(){v(i);let r=c();return h(r.close())}),o()(),a(6,"div",5),_(7,mo,2,3,"p",6)(8,go,15,7,"form",7)(9,fo,9,10,"ng-container",8),o(),a(10,"div",9)(11,"button",10),x("click",function(){v(i);let r=c();return h(r.close())}),l(12),o(),_(13,ho,4,3,"button",11),o()(),y()}if(e&2){let i=s.$implicit,t=c();n(4),d(i("title")),n(),le("aria-label",i("close")),n(2),m("ngIf",!t.invited),n(),m("ngIf",t.emailLink===""),n(),m("ngIf",t.emailLink!==""),n(2),oi("btn btn-",t.invited?"primary":"secondary",""),n(),u(" ",t.invited?i("cancel"):i("close")," "),n(),m("ngIf",!t.invited)}}var yn=(()=>{let s=class s{get hasAdminRoleSelected(){return this.selectedRoles.includes("Admin")}get email(){return this.inviteForm.get("email")}constructor(t,r,p){this.modal=t,this.accountService=r,this.toastr=p,this.isSending=!1,this.inviteForm=new te({}),this.selectedRoles=[],this.selectedLibraries=[],this.selectedRestriction={ageRating:an.NotApplicable,includeUnknowns:!1},this.emailLink="",this.invited=!1,this.inviteError=!1,this.cdRef=b(B),this.makeLink=f=>this.emailLink}ngOnInit(){this.inviteForm.addControl("email",new C("",[T.required]))}close(){this.modal.close(!1)}invite(){this.isSending=!0;let t=this.inviteForm.get("email")?.value.trim();this.accountService.inviteUser({email:t,libraries:this.selectedLibraries,roles:this.selectedRoles,ageRestriction:this.selectedRestriction}).subscribe(r=>{if(this.emailLink=r.emailLink,this.isSending=!1,this.invited=!0,this.cdRef.markForCheck(),r.invalidEmail){this.toastr.info($("toasts.email-not-sent")),this.inviteError=!0,this.cdRef.markForCheck();return}r.emailSent&&(this.toastr.info($("toasts.email-sent",{email:t})),this.modal.close(!0))},r=>{this.isSending=!1,this.cdRef.markForCheck()})}updateRoleSelection(t){this.selectedRoles=t}updateLibrarySelection(t){this.selectedLibraries=t.map(r=>r.id)}updateRestrictionSelection(t){this.selectedRestriction=t}};s.\u0275fac=function(r){return new(r||s)(N(Te),N(de),N(oe))},s.\u0275cmp=M({type:s,selectors:[["app-invite-user"]],standalone:!0,features:[V],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"modal-container"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body","scrollable-modal"],[3,"innerHTML",4,"ngIf"],[3,"formGroup",4,"ngIf"],[4,"ngIf"],[1,"modal-footer"],["type","button",3,"click"],["type","button","class","btn btn-primary",3,"disabled","click",4,"ngIf"],[3,"innerHTML"],[3,"formGroup"],[1,"row","g-0"],[1,"mb-3",2,"width","100%"],["for","email",1,"form-label"],["type","email","inputmode","email","id","email","formControlName","email","required","",1,"form-control"],["id","inviteForm-validations","class","invalid-feedback",4,"ngIf"],[1,"col-md-6"],[3,"selected","allowAdmin"],[3,"selected"],[1,"col-md-12"],[3,"selected","isAdmin"],["id","inviteForm-validations",1,"invalid-feedback"],["role","alert",1,"alert","alert-warning"],["target","_blank","rel","noopener noreferrer",1,"email-link",3,"href"],[3,"title","tooltipText","hideData","showRefresh","transform"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(r,p){r&1&&_(0,xo,14,10,"ng-container",0),r&2&&m("translocoRead","invite-user")},dependencies:[U,H,Y,ee,j,X,gi,ie,ne,Mt,wt,Ft,sn,D,di],styles:[`.email-link[_ngcontent-%COMP%]{word-break:break-all;margin-bottom:15px;display:block}
/*# sourceMappingURL=invite-user.component-574N2VHX.css.map */`]});let e=s;return e})();var bo=e=>({characters:e});function Co(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(2).$implicit;n(),u(" ",i("required")," ")}}function So(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(2).$implicit,t=c();n(),u(" ",i("username-pattern",P(1,bo,t.allowedCharacters))," ")}}function yo(e,s){if(e&1&&(a(0,"div",27),_(1,Co,2,1,"div",28)(2,So,2,3,"div",28),o()),e&2){let i,t,r=c(2);n(),m("ngIf",(i=r.userForm.get("username"))==null||i.errors==null?null:i.errors.required),n(),m("ngIf",(t=r.userForm.get("username"))==null||t.errors==null?null:t.errors.pattern)}}function ko(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(2).$implicit;n(),u(" ",i("required")," ")}}function Io(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(2).$implicit;n(),u(" ",i("not-valid-email")," ")}}function To(e,s){if(e&1&&(a(0,"div",29),_(1,ko,2,1,"div",28)(2,Io,2,1,"div",28),o()),e&2){let i,t,r=c(2);n(),m("ngIf",(i=r.userForm.get("email"))==null||i.errors==null?null:i.errors.required),n(),m("ngIf",(t=r.userForm.get("email"))==null||t.errors==null?null:t.errors.email)}}function Eo(e,s){e&1&&g(0,"span",30)}function Fo(e,s){if(e&1){let i=E();S(0),a(1,"div",1)(2,"div",2)(3,"h4",3),l(4),k(5,"sentenceCase"),o(),a(6,"button",4),x("click",function(){v(i);let r=c();return h(r.close())}),o()(),a(7,"div",5)(8,"form",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"label",10),l(13),o(),g(14,"input",11),_(15,yo,3,2,"div",12),o()(),a(16,"div",13)(17,"div",14)(18,"label",15),l(19),o(),g(20,"input",16),_(21,To,3,2,"div",17),o()()(),a(22,"div",7)(23,"div",18)(24,"app-role-selector",19),x("selected",function(r){v(i);let p=c();return h(p.updateRoleSelection(r))}),o()(),a(25,"div",18)(26,"app-library-selector",20),x("selected",function(r){v(i);let p=c();return h(p.updateLibrarySelection(r))}),o()()(),a(27,"div",7)(28,"div",21)(29,"app-restriction-selector",22),x("selected",function(r){v(i);let p=c();return h(p.updateRestrictionSelection(r))}),o()()()()(),a(30,"div",23)(31,"button",24),x("click",function(){v(i);let r=c();return h(r.close())}),l(32),o(),a(33,"button",25),x("click",function(){v(i);let r=c();return h(r.save())}),_(34,Eo,1,0,"span",26),a(35,"span"),l(36),o()()()(),y()}if(e&2){let i,t,r=s.$implicit,p=c();n(4),De("",r("edit")," ",I(5,21,p.member.username),""),n(2),le("aria-label",r("close")),n(2),m("formGroup",p.userForm),n(5),d(r("username")),n(),Q("is-invalid",((i=p.userForm.get("username"))==null?null:i.invalid)&&((i=p.userForm.get("username"))==null?null:i.touched)),n(),m("ngIf",p.userForm.dirty||p.userForm.touched),n(4),d(r("email")),n(),Q("is-invalid",((t=p.userForm.get("email"))==null?null:t.invalid)&&((t=p.userForm.get("email"))==null?null:t.touched)),n(),m("ngIf",p.userForm.dirty||p.userForm.touched),n(3),m("allowAdmin",!0)("member",p.member),n(2),m("member",p.member),n(3),m("isAdmin",p.hasAdminRoleSelected)("member",p.member),n(3),u(" ",r("cancel")," "),n(),m("disabled",p.isSaving||!p.userForm.valid),n(),m("ngIf",p.isSaving),n(2),d(p.isSaving?r("saving"):r("update"))}}var wo=/^[\sa-zA-Z0-9\-._@+/\s]*$/,kn=(()=>{let s=class s{get email(){return this.userForm.get("email")}get username(){return this.userForm.get("username")}get password(){return this.userForm.get("password")}get hasAdminRoleSelected(){return this.selectedRoles.includes("Admin")}constructor(t,r){this.modal=t,this.accountService=r,this.selectedRoles=[],this.selectedLibraries=[],this.isSaving=!1,this.userForm=new te({}),this.allowedCharacters="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._@+/"}ngOnInit(){this.userForm.addControl("email",new C(this.member.email,[T.required,T.email])),this.userForm.addControl("username",new C(this.member.username,[T.required,T.pattern(wo)])),this.userForm.get("email")?.disable(),this.selectedRestriction=this.member.ageRestriction}updateRoleSelection(t){this.selectedRoles=t}updateRestrictionSelection(t){this.selectedRestriction=t}updateLibrarySelection(t){this.selectedLibraries=t.map(r=>r.id)}close(){this.modal.close(!1)}save(){let t=this.userForm.getRawValue();t.userId=this.member.id,t.roles=this.selectedRoles,t.libraries=this.selectedLibraries,t.ageRestriction=this.selectedRestriction,this.accountService.update(t).subscribe(()=>{this.modal.close(!0)})}};s.\u0275fac=function(r){return new(r||s)(N(Te),N(de))},s.\u0275cmp=M({type:s,selectors:[["app-edit-user"]],inputs:{member:"member"},standalone:!0,features:[V],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"modal-container"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body","scrollable-modal"],[3,"formGroup"],[1,"row","g-0"],[1,"col-md-6","col-sm-12","pe-2"],[1,"mb-3"],["for","username",1,"form-label"],["id","username","formControlName","username","type","text","aria-describedby","username-validations",1,"form-control"],["id","username-validations","class","invalid-feedback",4,"ngIf"],[1,"col-md-6","col-sm-12"],[1,"mb-3",2,"width","100%"],["for","email",1,"form-label"],["inputmode","email","type","email","id","email","formControlName","email","aria-describedby","email-validations",1,"form-control"],["id","email-validations","class","invalid-feedback",4,"ngIf"],[1,"col-md-6"],[3,"selected","allowAdmin","member"],[3,"selected","member"],[1,"col-md-12"],[3,"selected","isAdmin","member"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],["id","username-validations",1,"invalid-feedback"],[4,"ngIf"],["id","email-validations",1,"invalid-feedback"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(r,p){r&1&&_(0,Fo,37,23,"ng-container",0),r&2&&m("translocoRead","edit-user")},dependencies:[H,Y,ee,j,X,ie,ne,U,Mt,wt,Ft,Je,D],styles:["/*# sourceMappingURL=edit-user.component-UCONTETX.css.map */"]});let e=s;return e})();var Mo=e=>({highlight:e}),nt=e=>({user:e});function Vo(e,s){if(e&1){let i=E();S(0),a(1,"button",27),k(2,"titlecase"),x("click",function(){v(i);let r=c(2).$implicit,p=c(2);return h(p.resendEmail(r))}),g(3,"i",28),o(),a(4,"button",29),k(5,"titlecase"),x("click",function(){v(i);let r=c(2).$implicit,p=c(2);return h(p.setup(r))}),g(6,"i",30),o(),y()}if(e&2){let i=c(2).$implicit,t=c().$implicit;n(),m("ngbTooltip",t("resend-invite-tooltip")),le("aria-label",t("resend-invite-alt",P(8,nt,I(2,4,i.username)))),n(3),m("ngbTooltip",t("setup-user-tooltip")),le("aria-label",t("setup-user-alt",P(10,nt,I(5,6,i.username))))}}function Ro(e,s){if(e&1){let i=E();a(0,"button",29),k(1,"titlecase"),x("click",function(){v(i);let r=c(2).$implicit,p=c(2);return h(p.updatePassword(r))}),g(2,"i",31),o()}if(e&2){let i=c(2).$implicit,t=c().$implicit;m("ngbTooltip",t("change-password-tooltip")),le("aria-label",t("change-password-alt",P(4,nt,I(1,2,i.username))))}}function Do(e,s){if(e&1){let i=E();a(0,"div",21)(1,"button",22),k(2,"titlecase"),x("click",function(){v(i);let r=c().$implicit,p=c(2);return h(p.deleteUser(r))}),g(3,"i",23),o(),a(4,"button",24),k(5,"titlecase"),x("click",function(){v(i);let r=c().$implicit,p=c(2);return h(p.openEditUser(r))}),g(6,"i",25),o(),_(7,Vo,7,12,"ng-container",19)(8,Ro,3,6,"button",26),o()}if(e&2){let i=c().$implicit,t=c().$implicit;n(),m("ngbTooltip",t("delete-user-tooltip")),le("aria-label",t("delete-user-alt",P(10,nt,I(2,6,i.username)))),n(3),m("ngbTooltip",t("edit-user-tooltip")),le("aria-label",t("edit-user-alt",P(12,nt,I(5,8,i.username)))),n(3),m("ngIf",i.isPending),n(),m("ngIf",!i.isPending)}}function Lo(e,s){if(e&1&&(a(0,"span",32),l(1),o()),e&2){let i=c(2).$implicit;n(),d(i("pending-title"))}}function No(e,s){if(e&1&&g(0,"i",34),e&2){let i=c(3).$implicit;m("title",i("online-now-tooltip"))}}function $o(e,s){if(e&1&&(a(0,"span"),l(1),k(2,"utcToLocalTime"),k(3,"defaultDate"),_(4,No,1,1,"i",33),k(5,"async"),o()),e&2){let i,t=c().$implicit,r=c(2);n(),u("",I(3,4,I(2,2,t.lastActiveUtc))," "),n(3),m("ngIf",(i=I(5,6,r.messageHub.onlineUsers$))==null?null:i.includes(t.username))}}function Ao(e,s){if(e&1&&(a(0,"app-tag-badge",36),l(1),o()),e&2){let i=s.$implicit;n(),d(i.name)}}function Po(e,s){if(e&1&&(a(0,"div"),l(1),_(2,Ao,2,1,"app-tag-badge",35),o()),e&2){let i=c().$implicit,t=c().$implicit;n(),u(" ",t("sharing-title")," "),n(),m("ngForOf",i.libraries)}}function Uo(e,s){e&1&&(a(0,"span"),l(1),k(2,"defaultValue"),o()),e&2&&(n(),d(I(2,1,null)))}function Oo(e,s){if(e&1&&(S(0),a(1,"app-tag-badge",36),l(2),o(),y()),e&2){let i=c(4).$implicit;n(2),d(i("admin"))}}function Bo(e,s){if(e&1&&(a(0,"app-tag-badge",36),l(1),o()),e&2){let i=s.$implicit;n(),d(i)}}function zo(e,s){if(e&1&&_(0,Bo,2,1,"app-tag-badge",35),e&2){let i=c(2).ngIf;m("ngForOf",i)}}function Go(e,s){if(e&1&&_(0,Oo,3,1,"ng-container",37)(1,zo,1,1,"ng-template",null,2,R),e&2){let i=w(2),t=c(2).$implicit,r=c(2);m("ngIf",r.hasAdminRole(t))("ngIfElse",i)}}function qo(e,s){if(e&1&&(a(0,"div"),l(1),_(2,Uo,3,3,"span",37)(3,Go,3,2,"ng-template",null,1,R),o()),e&2){let i=s.ngIf,t=w(4),r=c(2).$implicit;n(),u(" ",r("roles-title")," "),n(),m("ngIf",i.length===0)("ngIfElse",t)}}function jo(e,s){if(e&1&&(a(0,"li",14)(1,"div")(2,"h4")(3,"span",15),l(4),k(5,"titlecase"),o(),_(6,Do,9,14,"div",16),o(),a(7,"div",17)(8,"div"),l(9),_(10,Lo,2,1,"span",18)(11,$o,6,8,"ng-template",null,0,R),o(),_(13,Po,3,2,"div",19),a(14,"div",20),_(15,qo,5,3,"div",19),o()()()()),e&2){let i=s.$implicit,t=s.index,r=w(12),p=c().$implicit,f=c();n(3),ce("id","member-name--",t,""),m("ngClass",P(12,Mo,i.username===f.loggedInUsername)),n(),d(I(5,10,i.username)),n(2),m("ngIf",f.canEditMember(i)),n(3),u("",p("last-active-title")," "),n(),m("ngIf",i.isPending)("ngIfElse",r),n(3),m("ngIf",!f.hasAdminRole(i)&&i.libraries.length>0),n(2),m("ngIf",f.getRoles(i))}}function Ho(e,s){if(e&1&&(a(0,"li",38)(1,"div",39)(2,"span",40),l(3),o()()()),e&2){let i=c().$implicit;n(3),d(i("loading"))}}function Ko(e,s){if(e&1&&(a(0,"li",38),l(1),o()),e&2){let i=c().$implicit;n(),u(" ",i("no-data")," ")}}function Wo(e,s){if(e&1){let i=E();S(0),a(1,"div",4)(2,"div",5)(3,"div",6)(4,"h3"),l(5),o()(),a(6,"div",7)(7,"button",8),x("click",function(){v(i);let r=c();return h(r.inviteUser())}),g(8,"i",9),a(9,"span",10),l(10),o()()()(),a(11,"ul",11),_(12,jo,16,14,"li",12)(13,Ho,4,1,"li",13)(14,Ko,2,1,"li",13),o()(),y()}if(e&2){let i=s.$implicit,t=c();n(5),d(i("title")),n(5),u("\xA0",i("invite"),""),n(2),m("ngForOf",t.members),n(),m("ngIf",t.loadingMembers),n(),m("ngIf",t.members.length===0&&!t.loadingMembers)}}var In=(()=>{let s=class s{constructor(){this.members=[],this.loggedInUsername="",this.loadingMembers=!1,this.translocoService=b(Se),this.cdRef=b(B),this.memberService=b(Ui),this.accountService=b(de),this.modalService=b(pe),this.toastr=b(oe),this.confirmService=b(We),this.messageHub=b(qe),this.serverService=b(Fe),this.router=b(_t),this.accountService.currentUser$.pipe(q(1)).subscribe(t=>{t&&(this.loggedInUsername=t.username,this.cdRef.markForCheck())})}ngOnInit(){this.loadMembers()}loadMembers(){this.loadingMembers=!0,this.cdRef.markForCheck(),this.memberService.getMembers(!0).subscribe(t=>{this.members=t,this.members.sort((r,p)=>{if(r.username===this.loggedInUsername||p.username===this.loggedInUsername)return 1;let f=r.username.toUpperCase(),L=p.username.toUpperCase();return f<L?-1:f>L?1:0}),this.loadingMembers=!1,this.cdRef.markForCheck()})}canEditMember(t){return this.loggedInUsername!==t.username}openEditUser(t){let r=this.modalService.open(kn,{size:"lg"});r.componentInstance.member=t,r.closed.subscribe(()=>{this.loadMembers()})}deleteUser(t){return se(this,null,function*(){(yield this.confirmService.confirm(this.translocoService.translate("toasts.confirm-delete-user")))&&this.memberService.deleteMember(t.username).subscribe(()=>{setTimeout(()=>{this.loadMembers(),this.toastr.success(this.translocoService.translate("toasts.user-deleted",{user:t.username}))},30)})})}inviteUser(){this.modalService.open(yn,{size:"lg"}).closed.subscribe(r=>{this.loadMembers()})}resendEmail(t){this.accountService.resendConfirmationEmail(t.id).subscribe(r=>se(this,null,function*(){if(r.emailSent){this.toastr.info(this.translocoService.translate("toasts.email-sent",{email:t.username}));return}yield this.confirmService.alert(this.translocoService.translate("toasts.click-email-link")+'<br/> <a href="'+r.emailLink+'" target="_blank" rel="noopener noreferrer">'+r.emailLink+"</a>")}))}setup(t){this.accountService.getInviteUrl(t.id,!1).subscribe(r=>{r&&this.router.navigateByUrl(r)})}updatePassword(t){let r=this.modalService.open(Cn);r.componentInstance.member=t}formatLibraries(t){return t.libraries.length===0?$("manage-users.none"):t.libraries.map(r=>r.name).join(", ")}hasAdminRole(t){return t.roles.indexOf("Admin")>=0}getRoles(t){return t.roles.filter(r=>r!="Pleb")}};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-manage-users"]],standalone:!0,features:[V],decls:1,vars:1,consts:[["activeTime",""],["showRoles",""],["allRoles",""],[4,"transloco","translocoRead"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-8"],[1,"col-4"],[1,"btn","btn-primary","float-end",3,"click"],["aria-hidden","true",1,"fa","fa-plus"],[1,"phone-hidden"],[1,"list-group"],["class","list-group-item no-hover",4,"ngFor","ngForOf"],["class","list-group-item",4,"ngIf"],[1,"list-group-item","no-hover"],[3,"id","ngClass"],["class","float-end",4,"ngIf"],[1,"user-info"],["class","badge bg-secondary text-dark ms-1 pending-badge",4,"ngIf","ngIfElse"],[4,"ngIf"],[1,"row","g-0"],[1,"float-end"],["placement","top",1,"btn","btn-danger","btn-sm","me-2",3,"click","ngbTooltip"],["aria-hidden","true",1,"fa","fa-trash"],["placement","top",1,"btn","btn-primary","btn-sm","me-2",3,"click","ngbTooltip"],["aria-hidden","true",1,"fa","fa-pen"],["class","btn btn-secondary btn-sm","placement","top",3,"ngbTooltip","click",4,"ngIf"],["placement","top",1,"btn","btn-secondary","btn-sm","me-2",3,"click","ngbTooltip"],["aria-hidden","true",1,"fa-solid","fa-share-from-square"],["placement","top",1,"btn","btn-secondary","btn-sm",3,"click","ngbTooltip"],["aria-hidden","true",1,"fa-solid","fa-sliders"],["aria-hidden","true",1,"fa","fa-key"],[1,"badge","bg-secondary","text-dark","ms-1","pending-badge"],["class","presence fa fa-circle ms-1","aria-hidden","true",3,"title",4,"ngIf"],["aria-hidden","true",1,"presence","fa","fa-circle","ms-1",3,"title"],["class","col-auto",4,"ngFor","ngForOf"],[1,"col-auto"],[4,"ngIf","ngIfElse"],[1,"list-group-item"],["role","status",1,"spinner-border","text-secondary"],[1,"visually-hidden"]],template:function(r,p){r&1&&_(0,Wo,15,5,"ng-container",3),r&2&&m("translocoRead","manage-users")},dependencies:[J,U,re,zi,Ce,ze,ue,D,Ct,li,Xe,Ye],styles:[`.presence[_ngcontent-%COMP%]{font-size:12px;color:var(--primary-color)}.user-info[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-top:3px}.highlight[_ngcontent-%COMP%]{color:var(--primary-color)}.pending-badge[_ngcontent-%COMP%]{font-size:15px}
/*# sourceMappingURL=manage-users.component-F5MJUCP2.css.map */`],changeDetection:0});let e=s;return e})();var Vt=function(e){return e[e.PNG=0]="PNG",e[e.WebP=1]="WebP",e[e.AVIF=2]="AVIF",e}(Vt||{}),Tn=[{value:Vt.PNG,title:"PNG"},{value:Vt.WebP,title:"WebP"},{value:Vt.AVIF,title:"AVIF"}];var Qo=e=>({seriesName:e});function Jo(e,s){if(e&1&&(a(0,"tr")(1,"td",16),g(2,"app-loading",17),o()()),e&2){let i=c(2);n(2),m("loading",i.isLoading)}}function Xo(e,s){e&1&&(a(0,"tr")(1,"td",16),l(2,"No issues"),o()())}function Yo(e,s){if(e&1){let i=E();a(0,"tr")(1,"td")(2,"a",19),l(3),o()(),a(4,"td"),l(5),k(6,"utcToLocalTime"),k(7,"defaultValue"),o(),a(8,"td"),l(9),o(),a(10,"td")(11,"button",20),x("click",function(){let r=v(i).$implicit,p=c(3);return h(p.editSeries(r.seriesId))}),g(12,"i",21),a(13,"span",22),l(14),o()()()()}if(e&2){let i=s.$implicit,t=c(2).$implicit;n(2),si("href","library/",i.libraryId,"/series/",i.seriesId,"",_e),n(),d(i.details),n(2),u(" ",I(7,9,I(6,7,i.createdUtc))," "),n(4),u(" ",i.comment," "),n(5),d(t("edit-item-alt",P(11,Qo,i.details)))}}function Zo(e,s){if(e&1&&(S(0),_(1,Xo,3,0,"tr",15)(2,Yo,15,13,"tr",18),y()),e&2){let i=s.ngIf,t=c(2);n(),m("ngIf",i.length===0&&!t.isLoading),n(),m("ngForOf",i)}}function ea(e,s){if(e&1){let i=E();S(0),a(1,"p"),l(2),o(),a(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),l(7),o(),a(8,"div",7),g(9,"input",8),a(10,"button",9),x("click",function(){v(i);let r=c();return h(r.clear())}),l(11),o()()()()(),a(12,"table",10)(13,"thead",null,0)(15,"tr")(16,"th",11),x("sort",function(r){v(i);let p=c();return h(p.onSort(r))}),l(17),o(),a(18,"th",12),x("sort",function(r){v(i);let p=c();return h(p.onSort(r))}),l(19),o(),a(20,"th",13),x("sort",function(r){v(i);let p=c();return h(p.onSort(r))}),l(21),o(),a(22,"th",14),l(23),o()()(),a(24,"tbody",null,1),_(26,Jo,3,1,"tr",15)(27,Zo,3,2,"ng-container",15),k(28,"filter"),o()(),y()}if(e&2){let i=s.$implicit,t=c();n(2),d(i("description")),n(),m("formGroup",t.formGroup),n(4),d(i("filter-label")),n(2),m("placeholder",i("filter-label")),n(2),d(i("clear-errors")),n(6),u(" ",i("series-header")," "),n(2),u(" ",i("created-header")," "),n(2),u(" ",i("comment-header")," "),n(2),u(" ",i("edit-header")," "),n(3),m("ngIf",t.isLoading),n(),m("ngIf",Be(28,11,t.data,t.filterList))}}var En=(()=>{let s=class s{constructor(){this.scrobbleCount=new Ae,this.scrobbleService=b(Qi),this.messageHub=b(qe),this.cdRef=b(B),this.destroyRef=b(ge),this.seriesService=b(Pi),this.modalService=b(pe),this.messageHubUpdate$=this.messageHub.messages$.pipe(W(this.destroyRef),ct(t=>t.event===Ie.ScanSeries),ye()),this.currentSort=new $e({column:"created",direction:"asc"}),this.currentSort$=this.currentSort.asObservable(),this.data=[],this.isLoading=!0,this.formGroup=new te({filter:new C("",[])}),this.filterList=t=>{let r=(this.formGroup.get("filter")?.value||"").toLowerCase();return t.comment.toLowerCase().indexOf(r)>=0||t.details.toLowerCase().indexOf(r)>=0}}ngOnInit(){this.loadData(),this.messageHubUpdate$.subscribe(t=>this.loadData()),this.currentSort$.subscribe(t=>{this.data=t.column?this.data.sort((r,p)=>{if(t.column==="")return 0;let f=Ze(r[t.column],p[t.column]);return t.direction==="asc"?f:-f}):this.data,this.cdRef.markForCheck()})}onSort(t){this.currentSort.next(t),this.headers.forEach(r=>{r.sortable!==t.column&&(r.direction="")})}loadData(){this.isLoading=!0,this.cdRef.markForCheck(),this.scrobbleService.getScrobbleErrors().subscribe(t=>{this.data=t,this.isLoading=!1,this.scrobbleCount.emit(t.length),this.cdRef.detectChanges()})}clear(){this.scrobbleService.clearScrobbleErrors().subscribe(t=>this.loadData())}editSeries(t){this.seriesService.getSeries(t).subscribe(r=>{let p=this.modalService.open(Hi,{size:"xl"});p.componentInstance.series=r})}};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-manage-scrobble-errors"]],viewQuery:function(r,p){if(r&1&&Me(xe,5),r&2){let f;Ve(f=Re())&&(p.headers=f)}},outputs:{scrobbleCount:"scrobbleCount"},standalone:!0,features:[V],decls:1,vars:1,consts:[["header",""],["container",""],[4,"transloco","translocoRead"],[3,"formGroup"],[1,"row","g-0","mb-3"],[1,"col-md-12"],["for","filter",1,"visually-hidden"],[1,"input-group"],["id","filter","type","text","formControlName","filter",1,"form-control",3,"placeholder"],["type","button",1,"btn","btn-primary",3,"click"],[1,"table","table-striped","table-hover","table-sm","table-hover"],["scope","col","sortable","seriesId",3,"sort"],["scope","col","sortable","created",3,"sort"],["scope","col","sortable","comment",3,"sort"],["scope","col"],[4,"ngIf"],["colspan","4",2,"text-align","center"],[3,"loading"],[4,"ngFor","ngForOf"],["target","_blank",3,"href"],[1,"btn","btn-icon","primary-icon",3,"click"],["aria-hidden","true",1,"fa","fa-pen","me-1"],[1,"visually-hidden"]],template:function(r,p){r&1&&_(0,ea,29,14,"ng-container",2),r&2&&m("translocoRead","manage-scrobble-errors")},dependencies:[ci,J,U,H,Y,ee,j,X,ie,ne,$i,kt,xe,ue,D,Xe,yt,Ye],styles:[`.primary-icon[_ngcontent-%COMP%], button[_ngcontent-%COMP%]   i.fa[_ngcontent-%COMP%]{color:var(--primary-color)}
/*# sourceMappingURL=manage-scrobble-errors.component-UWJE5T3G.css.map */`],changeDetection:0});let e=s;return e})();var rt=function(e){return e[e.Default=1]="Default",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.XLarge=4]="XLarge",e}(rt||{}),Fn=[{value:rt.Default,title:"cover-image-size.default"},{value:rt.Medium,title:"cover-image-size.medium"},{value:rt.Large,title:"cover-image-size.large"},{value:rt.XLarge,title:"cover-image-size.xlarge"}];function ta(e,s){if(e&1&&(a(0,"div",39),l(1),o()),e&2){let i=c(2).$implicit;n(),d(i("media-warning"))}}function ia(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("encode-as-tooltip"))}}function na(e,s){if(e&1&&(a(0,"option",40),l(1),o()),e&2){let i=s.$implicit;m("value",i.value),n(),d(i.title)}}function ra(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("cover-image-size-tooltip"))}}function oa(e,s){if(e&1&&(a(0,"option",40),l(1),o()),e&2){let i=s.$implicit;m("value",i.value),n(),d(i.title)}}function aa(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("bookmark-dir-tooltip"))}}function sa(e,s){if(e&1){let i=E();a(0,"form",13)(1,"div",14)(2,"p"),l(3),a(4,"a",15),l(5),o(),l(6,"/"),a(7,"a",16),l(8),o(),g(9,"br"),a(10,"b"),l(11),o()(),_(12,ta,2,1,"div",17),a(13,"div",18)(14,"label",19),l(15),o(),g(16,"i",20),_(17,ia,1,1,"ng-template",null,0,R),a(19,"span",21),z(20,22),o(),a(21,"select",23),_(22,na,2,2,"option",24),o()(),a(23,"div",25)(24,"label",26),l(25),o(),g(26,"i",20),_(27,ra,1,1,"ng-template",null,1,R),a(29,"span",27),z(30,22),o(),a(31,"select",28),_(32,oa,2,2,"option",24),o()()(),a(33,"div",14)(34,"div",29)(35,"label",30),l(36),o(),g(37,"i",31),_(38,aa,1,1,"ng-template",null,2,R),a(40,"span",32),z(41,22),o(),a(42,"div",33),g(43,"input",34),a(44,"button",35),x("click",function(){let r;v(i);let p=c(2);return h(p.openDirectoryChooser((r=p.settingsForm.get("bookmarksDirectory"))==null?null:r.value,"bookmarksDirectory"))}),l(45),o()()()(),a(46,"div",36)(47,"button",37),x("click",function(){v(i);let r=c(2);return h(r.resetToDefaults())}),l(48),o(),a(49,"button",37),x("click",function(){v(i);let r=c(2);return h(r.resetForm())}),l(50),o(),a(51,"button",38),x("click",function(){v(i);let r=c(2);return h(r.saveSettings())}),l(52),o()()()}if(e&2){let i,t=w(18),r=w(28),p=w(39),f=c().$implicit,L=c();m("formGroup",L.settingsForm),n(3),u("",f("encode-as-description-part-1")," "),n(2),d(f("encode-as-description-part-2")),n(3),d(f("encode-as-description-part-3")),n(3),d(f("encode-as-warning")),n(),m("ngIf",(i=L.settingsForm.get("encodeMediaAs"))==null?null:i.dirty),n(3),d(f("encode-as-label")),n(),m("ngbTooltip",t),n(4),m("ngTemplateOutlet",t),n(2),m("ngForOf",L.EncodeFormats),n(3),d(f("cover-image-size-label")),n(),m("ngbTooltip",r),n(4),m("ngTemplateOutlet",r),n(2),m("ngForOf",L.coverImageSizes),n(4),d(f("bookmark-dir-label")),n(),m("ngbTooltip",p),n(4),m("ngTemplateOutlet",p),n(4),u(" ",f("change")," "),n(3),d(f("reset-to-default")),n(2),d(f("reset")),n(),m("disabled",!L.settingsForm.dirty),n(),d(f("save"))}}function la(e,s){if(e&1&&(a(0,"span",41),l(1),o()),e&2){let i=c(2);n(),u("(",i.alertCount,")")}}function ca(e,s){if(e&1){let i=E();a(0,"app-manage-alerts",42),x("alertCount",function(r){v(i);let p=c(2);return h(p.alertCount=r)}),o()}}function ma(e,s){if(e&1&&(a(0,"span",41),l(1),o()),e&2){let i=c(2);n(),u("(",i.scrobbleCount,")")}}function pa(e,s){if(e&1){let i=E();a(0,"app-manage-scrobble-errors",43),x("scrobbleCount",function(r){v(i);let p=c(2);return h(p.scrobbleCount=r)}),o()}}function da(e,s){if(e&1&&(S(0),a(1,"div",4),_(2,sa,53,22,"form",5),a(3,"div",6)(4,"div",7)(5,"h2",8)(6,"button",9),l(7),_(8,la,2,1,"span",10),o()(),a(9,"div",11)(10,"div",12),_(11,ca,1,0,"ng-template"),o()()()(),a(12,"div",6)(13,"div",7)(14,"h2",8)(15,"button",9),l(16),_(17,ma,2,1,"span",10),o()(),a(18,"div",11)(19,"div",12),_(20,pa,1,0,"ng-template"),o()()()()(),y()),e&2){let i=s.$implicit,t=c();n(2),m("ngIf",t.serverSettings!==void 0),n(),m("destroyOnHide",!1),n(4),u(" ",i("media-issue-title")," "),n(),m("ngIf",t.alertCount>0),n(4),m("destroyOnHide",!1),n(4),u(" ",i("scrobble-issue-title")," "),n(),m("ngIf",t.scrobbleCount>0)}}var wn=(()=>{let s=class s{get EncodeFormats(){return Tn}constructor(t,r,p){this.settingsService=t,this.toastr=r,this.modalService=p,this.settingsForm=new te({}),this.alertCount=0,this.scrobbleCount=0,this.coverImageSizes=Fn.map(f=>{let L=Yt({},f);return L.title=$(f.title),L}),this.translocoService=b(Se),this.cdRef=b(B)}ngOnInit(){this.settingsService.getServerSettings().pipe(q(1)).subscribe(t=>{this.serverSettings=t,this.settingsForm.addControl("encodeMediaAs",new C(this.serverSettings.encodeMediaAs,[T.required])),this.settingsForm.addControl("bookmarksDirectory",new C(this.serverSettings.bookmarksDirectory,[T.required])),this.settingsForm.addControl("coverImageSize",new C(this.serverSettings.coverImageSize,[T.required])),this.cdRef.markForCheck()})}resetForm(){this.settingsForm.get("encodeMediaAs")?.setValue(this.serverSettings.encodeMediaAs),this.settingsForm.get("bookmarksDirectory")?.setValue(this.serverSettings.bookmarksDirectory),this.settingsForm.get("coverImageSize")?.setValue(this.serverSettings.coverImageSize),this.settingsForm.markAsPristine(),this.cdRef.markForCheck()}saveSettings(){let t=Object.assign({},this.serverSettings);t.encodeMediaAs=parseInt(this.settingsForm.get("encodeMediaAs")?.value,10),t.bookmarksDirectory=this.settingsForm.get("bookmarksDirectory")?.value,t.coverImageSize=parseInt(this.settingsForm.get("coverImageSize")?.value,10),this.settingsService.updateServerSettings(t).pipe(q(1)).subscribe(r=>se(this,null,function*(){this.serverSettings=r,this.resetForm(),this.toastr.success(this.translocoService.translate("toasts.server-settings-updated"))}),r=>{console.error("error: ",r)})}resetToDefaults(){this.settingsService.resetServerSettings().pipe(q(1)).subscribe(t=>{this.serverSettings=t,this.resetForm(),this.toastr.success(this.translocoService.translate("toasts.server-settings-updated"))},t=>{console.error("error: ",t)})}openDirectoryChooser(t,r){let p=this.modalService.open(Ai,{scrollable:!0,size:"lg",fullscreen:"md"});p.componentInstance.startingFolder=t||"",p.componentInstance.helpUrl="",p.closed.subscribe(f=>{f.success&&f.folderPath!==""&&(this.settingsForm.get(r)?.setValue(f.folderPath),this.settingsForm.markAsDirty(),this.cdRef.markForCheck())})}};s.\u0275fac=function(r){return new(r||s)(N(Ee),N(oe),N(pe))},s.\u0275cmp=M({type:s,selectors:[["app-manage-media-settings"]],standalone:!0,features:[V],decls:1,vars:1,consts:[["encodeMediaAsTooltip",""],["coverImageSizeTooltip",""],["bookmarksDirectoryTooltip",""],[4,"transloco","translocoRead"],[1,"container-fluid"],["class","mb-2",3,"formGroup",4,"ngIf"],["ngbAccordion","",1,"mt-3",3,"destroyOnHide"],["ngbAccordionItem",""],["ngbAccordionHeader",""],["ngbAccordionButton",""],["class","ms-1",4,"ngIf"],["ngbAccordionCollapse",""],["ngbAccordionBody",""],[1,"mb-2",3,"formGroup"],[1,"row","g-0"],["href","https://caniuse.com/?search=webp","target","_blank","rel","noopener noreferrer"],["href","https://caniuse.com/?search=avif","target","_blank","rel","noopener noreferrer"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"col-md-6","col-sm-12","mb-3","pe-1"],["for","settings-media-encodeMediaAs",1,"form-label","me-1"],["placement","right","role","button","tabindex","0",1,"fa","fa-info-circle",3,"ngbTooltip"],["id","settings-media-encodeMediaAs-help",1,"visually-hidden"],[3,"ngTemplateOutlet"],["aria-describedby","settings-media-encodeMediaAs-help","formControlName","encodeMediaAs","id","settings-media-encodeMediaAs",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-6","col-sm-12","mb-3"],["for","settings-media-coverImageSize",1,"form-label","me-1"],["id","settings-media-coverImageSize-help",1,"visually-hidden"],["aria-describedby","settings-media-coverImageSize-help","formControlName","coverImageSize","id","settings-media-coverImageSize",1,"form-select"],[1,"mb-3"],["for","settings-bookmarksdir",1,"form-label"],["placement","right","role","button","tabindex","0",1,"fa","fa-info-circle","ms-1",3,"ngbTooltip"],["id","settings-bookmarksdir-help",1,"visually-hidden"],[1,"input-group"],["readonly","","id","settings-bookmarksdir","aria-describedby","settings-bookmarksdir-help","formControlName","bookmarksDirectory","type","text","aria-describedby","change-bookmarks-dir",1,"form-control"],["id","change-bookmarks-dir",1,"btn","btn-primary",3,"click"],[1,"col-auto","d-flex","d-md-block","justify-content-sm-center","text-md-end"],["type","button",1,"flex-fill","btn","btn-secondary","me-2",3,"click"],["type","submit",1,"flex-fill","btn","btn-primary",3,"click","disabled"],["role","alert",1,"alert","alert-danger"],[3,"value"],[1,"ms-1"],[3,"alertCount"],[3,"scrobbleCount"]],template:function(r,p){r&1&&_(0,da,21,7,"ng-container",3),r&2&&m("translocoRead","manage-media-settings")},dependencies:[U,H,Y,He,Ke,ee,je,j,X,ie,ne,re,ke,J,yi,Si,Ci,bi,xi,hi,ln,En,D],styles:["/*# sourceMappingURL=manage-media-settings.component-7Q5QGM2P.css.map */"],changeDetection:0});let e=s;return e})();function _a(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("host-name-tooltip"))}}function ga(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(3).$implicit;n(),u(" ",i("host-name-validation")," ")}}function ua(e,s){if(e&1&&(a(0,"div",53),_(1,ga,2,1,"div",54),o()),e&2){let i,t=c(3);n(),m("ngIf",(i=t.settingsForm.get("hostName"))==null||i.errors==null?null:i.errors.pattern)}}function fa(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("sender-address-tooltip"))}}function va(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("sender-displayname-tooltip"))}}function ha(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("host-tooltip"))}}function xa(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("username-tooltip"))}}function ba(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("size-limit-tooltip"))}}function Ca(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("customized-templates-tooltip"))}}function Sa(e,s){if(e&1){let i=E();a(0,"form",10)(1,"h4",11),l(2),o(),a(3,"p"),l(4,"You must fill out both Host Name and SMTP settings to use email-based functionality within Kavita."),o(),a(5,"div",12)(6,"label",13),l(7),o(),g(8,"i",14),_(9,_a,1,1,"ng-template",null,0,R),a(11,"span",15),z(12,16),o(),a(13,"div",17),g(14,"input",18),a(15,"button",19),x("click",function(){v(i);let r=c(2);return h(r.autofillGmail())}),l(16),o(),a(17,"button",19),x("click",function(){v(i);let r=c(2);return h(r.autofillOutlook())}),l(18),o()(),_(19,ua,2,1,"div",20),o(),a(20,"div",21)(21,"div",22)(22,"div",23)(23,"label",24),l(24),o(),g(25,"i",25),_(26,fa,1,1,"ng-template",null,1,R),a(28,"span",26),z(29,16),o(),g(30,"input",27),o(),a(31,"div",23)(32,"label",28),l(33),o(),g(34,"i",25),_(35,va,1,1,"ng-template",null,2,R),a(37,"span",29),z(38,16),o(),g(39,"input",30),o()(),a(40,"div",22)(41,"div",31)(42,"label",24),l(43),o(),g(44,"i",25),_(45,ha,1,1,"ng-template",null,3,R),a(47,"span",32),z(48,16),o(),g(49,"input",33),o(),a(50,"div",31)(51,"label",34),l(52),o(),g(53,"input",35),o(),a(54,"div",31)(55,"div",36),g(56,"input",37),a(57,"label",38),l(58),o()()()(),a(59,"div",22)(60,"div",23)(61,"label",39),l(62),o(),g(63,"i",25),_(64,xa,1,1,"ng-template",null,4,R),a(66,"span",40),z(67,16),o(),g(68,"input",41),o(),a(69,"div",23)(70,"label",42),l(71),o(),g(72,"input",43),o()(),a(73,"div",22)(74,"div",23)(75,"label",44),l(76),o(),g(77,"i",25),_(78,ba,1,1,"ng-template",null,5,R),a(80,"span",45),z(81,16),o(),g(82,"input",46),o(),a(83,"div",23)(84,"div",36),g(85,"input",47),a(86,"label",48),l(87),o(),g(88,"i",25),_(89,Ca,1,1,"ng-template",null,6,R),a(91,"span",49),z(92,16),o()()()()(),a(93,"div",50)(94,"button",51),x("click",function(){v(i);let r=c(2);return h(r.test())}),l(95),o(),a(96,"button",51),x("click",function(){v(i);let r=c(2);return h(r.resetToDefaults())}),l(97),o(),a(98,"button",51),x("click",function(){v(i);let r=c(2);return h(r.resetForm())}),l(99),o(),a(100,"button",52),x("click",function(){v(i);let r=c(2);return h(r.saveSettings())}),l(101),o()()()}if(e&2){let i,t=w(10),r=w(27),p=w(36),f=w(46),L=w(65),ae=w(79),he=w(90),F=c().$implicit,K=c();m("formGroup",K.settingsForm),n(2),d(F("title")),n(5),d(F("host-name-label")),n(),m("ngbTooltip",t),n(4),m("ngTemplateOutlet",t),n(2),Q("is-invalid",((i=K.settingsForm.get("hostName"))==null?null:i.invalid)&&((i=K.settingsForm.get("hostName"))==null?null:i.touched)),n(2),d(F("gmail-label")),n(2),d(F("outlook-label")),n(),m("ngIf",K.settingsForm.dirty||K.settingsForm.touched),n(5),d(F("sender-address-label")),n(),m("ngbTooltip",r),n(4),m("ngTemplateOutlet",r),n(4),d(F("sender-displayname-label")),n(),m("ngbTooltip",p),n(4),m("ngTemplateOutlet",p),n(5),d(F("host-label")),n(),m("ngbTooltip",f),n(4),m("ngTemplateOutlet",f),n(4),d(F("port-label")),n(6),d(F("enable-ssl-label")),n(4),d(F("username-label")),n(),m("ngbTooltip",L),n(4),m("ngTemplateOutlet",L),n(4),d(F("password-label")),n(5),d(F("size-limit-label")),n(),m("ngbTooltip",ae),n(4),m("ngTemplateOutlet",ae),n(6),d(F("customized-templates-label")),n(),m("ngbTooltip",he),n(4),m("ngTemplateOutlet",he),n(3),d(F("test")),n(2),d(F("reset-to-default")),n(2),d(F("reset")),n(),m("disabled",!K.settingsForm.dirty),n(),d(F("save"))}}function ya(e,s){if(e&1&&(S(0),a(1,"div",8),_(2,Sa,102,36,"form",9),o(),y()),e&2){let i=c();n(2),m("ngIf",i.serverSettings!==void 0)}}var Mn=(()=>{let s=class s{constructor(){this.cdRef=b(B),this.settingsService=b(Ee),this.toastr=b(oe),this.settingsForm=new te({})}ngOnInit(){this.settingsService.getServerSettings().pipe(q(1)).subscribe(t=>{this.serverSettings=t,this.settingsForm.addControl("hostName",new C(this.serverSettings.hostName,[T.pattern(/^(http:|https:)+[^\s]+[\w]$/)])),this.settingsForm.addControl("host",new C(this.serverSettings.smtpConfig.host,[])),this.settingsForm.addControl("port",new C(this.serverSettings.smtpConfig.port,[])),this.settingsForm.addControl("userName",new C(this.serverSettings.smtpConfig.userName,[])),this.settingsForm.addControl("enableSsl",new C(this.serverSettings.smtpConfig.enableSsl,[])),this.settingsForm.addControl("password",new C(this.serverSettings.smtpConfig.password,[])),this.settingsForm.addControl("senderAddress",new C(this.serverSettings.smtpConfig.senderAddress,[])),this.settingsForm.addControl("senderDisplayName",new C(this.serverSettings.smtpConfig.senderDisplayName,[])),this.settingsForm.addControl("sizeLimit",new C(this.serverSettings.smtpConfig.sizeLimit,[T.min(1)])),this.settingsForm.addControl("customizedTemplates",new C(this.serverSettings.smtpConfig.customizedTemplates,[T.min(1)])),this.cdRef.markForCheck()})}resetForm(){this.settingsForm.get("hostName")?.setValue(this.serverSettings.hostName),this.settingsForm.addControl("host",new C(this.serverSettings.smtpConfig.host,[])),this.settingsForm.addControl("port",new C(this.serverSettings.smtpConfig.port,[])),this.settingsForm.addControl("userName",new C(this.serverSettings.smtpConfig.userName,[])),this.settingsForm.addControl("enableSsl",new C(this.serverSettings.smtpConfig.enableSsl,[])),this.settingsForm.addControl("password",new C(this.serverSettings.smtpConfig.password,[])),this.settingsForm.addControl("senderAddress",new C(this.serverSettings.smtpConfig.senderAddress,[])),this.settingsForm.addControl("senderDisplayName",new C(this.serverSettings.smtpConfig.senderDisplayName,[])),this.settingsForm.addControl("sizeLimit",new C(this.serverSettings.smtpConfig.sizeLimit,[T.min(1)])),this.settingsForm.addControl("customizedTemplates",new C(this.serverSettings.smtpConfig.customizedTemplates,[T.min(1)])),this.settingsForm.markAsPristine(),this.cdRef.markForCheck()}autofillGmail(){this.settingsForm.get("host")?.setValue("smtp.gmail.com"),this.settingsForm.get("port")?.setValue(587),this.settingsForm.get("sizeLimit")?.setValue(26214400),this.settingsForm.get("enableSsl")?.setValue(!0),this.settingsForm.markAsDirty(),this.cdRef.markForCheck()}autofillOutlook(){this.settingsForm.get("host")?.setValue("smtp-mail.outlook.com"),this.settingsForm.get("port")?.setValue(587),this.settingsForm.get("sizeLimit")?.setValue(1048576),this.settingsForm.get("enableSsl")?.setValue(!0),this.settingsForm.markAsDirty(),this.cdRef.markForCheck()}saveSettings(){return se(this,null,function*(){let t=Object.assign({},this.serverSettings);t.emailServiceUrl=this.settingsForm.get("emailServiceUrl")?.value,t.hostName=this.settingsForm.get("hostName")?.value,t.smtpConfig.host=this.settingsForm.get("host")?.value,t.smtpConfig.port=this.settingsForm.get("port")?.value,t.smtpConfig.userName=this.settingsForm.get("userName")?.value,t.smtpConfig.enableSsl=this.settingsForm.get("enableSsl")?.value,t.smtpConfig.password=this.settingsForm.get("password")?.value,t.smtpConfig.senderAddress=this.settingsForm.get("senderAddress")?.value,t.smtpConfig.senderDisplayName=this.settingsForm.get("senderDisplayName")?.value,t.smtpConfig.sizeLimit=this.settingsForm.get("sizeLimit")?.value,t.smtpConfig.customizedTemplates=this.settingsForm.get("customizedTemplates")?.value,this.settingsService.updateServerSettings(t).pipe(q(1)).subscribe(r=>{this.serverSettings=r,this.resetForm(),this.toastr.success($("toasts.server-settings-updated"))},r=>{console.error("error: ",r)})})}resetToDefaults(){this.settingsService.resetServerSettings().pipe(q(1)).subscribe(t=>{this.serverSettings=t,this.resetForm(),this.toastr.success($("toasts.server-settings-updated"))},t=>{console.error("error: ",t)})}test(){this.settingsService.testEmailServerSettings().subscribe(t=>{t.successful?this.toastr.success($("toasts.email-sent",{email:t.emailAddress})):this.toastr.error(t.errorMessage)})}};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-manage-email-settings"]],standalone:!0,features:[V],decls:1,vars:1,consts:[["hostNameTooltip",""],["senderAddressTooltip",""],["senderDisplayNameTooltip",""],["hostTooltip",""],["usernameTooltip",""],["sizeLimitTooltip",""],["customizedTemplatesTooltip",""],[4,"transloco","translocoRead"],[1,"container-fluid"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["id","email-header"],[1,"mb-3","pe-2","ps-2"],["for","settings-hostname",1,"form-label"],["placement","right","role","button","tabindex","0",1,"fa","fa-info-circle","ms-1",3,"ngbTooltip"],["id","settings-hostname-help",1,"visually-hidden"],[3,"ngTemplateOutlet"],[1,"input-group"],["id","settings-hostname","aria-describedby","settings-hostname-help","formControlName","hostName","type","text",1,"form-control"],[1,"btn","btn-outline-secondary",3,"click"],["id","hostname-validations","class","invalid-feedback",4,"ngIf"],[1,"mt-3"],[1,"row","g-0"],[1,"col-md-6","col-sm-12","pe-2","ps-2","mb-2"],["for","settings-sender-address",1,"form-label"],["aria-hidden","true","placement","right","role","button","tabindex","0",1,"fa","fa-info-circle","ms-1",3,"ngbTooltip"],["id","settings-sender-address-help",1,"visually-hidden"],["type","text","aria-describedby","email-header","formControlName","senderAddress","id","settings-sender-address",1,"form-control"],["for","settings-sender-displayname",1,"form-label"],["id","settings-sender-displayname-help",1,"visually-hidden"],["type","text","aria-describedby","email-header","formControlName","senderDisplayName","id","settings-sender-displayname",1,"form-control"],[1,"col-md-4","col-sm-12","pe-2","ps-2","mb-2"],["id","settings-host-help",1,"visually-hidden"],["type","text","aria-describedby","email-header","formControlName","host","id","settings-host",1,"form-control"],["for","settings-port",1,"form-label"],["type","number","min","1","aria-describedby","email-header","formControlName","port","id","settings-port",1,"form-control"],[1,"form-check","form-switch",2,"margin-top","36px"],["type","checkbox","id","settings-enable-ssl","role","switch","formControlName","enableSsl","aria-labelledby","auto-close-label",1,"form-check-input"],["for","settings-enable-ssl",1,"form-check-label"],["for","settings-username",1,"form-label"],["id","settings-username-help",1,"visually-hidden"],["type","text","aria-describedby","email-header","formControlName","userName","id","settings-username",1,"form-control"],["for","settings-password",1,"form-label"],["type","password","aria-describedby","email-header","formControlName","password","id","settings-password",1,"form-control"],["for","settings-size-limit",1,"form-label"],["id","settings-size-limit-help",1,"visually-hidden"],["type","text","aria-describedby","email-header","formControlName","sizeLimit","id","settings-size-limit",1,"form-control"],["type","checkbox","id","settings-customized-templates","role","switch","formControlName","customizedTemplates","aria-labelledby","auto-close-label",1,"form-check-input"],["for","settings-customized-templates",1,"form-check-label"],["id","settings-customized-templates-help",1,"visually-hidden"],[1,"col-auto","d-flex","d-md-block","justify-content-sm-center","text-md-end"],["type","button",1,"flex-fill","btn","btn-secondary","me-2",3,"click"],["type","submit",1,"flex-fill","btn","btn-primary",3,"click","disabled"],["id","hostname-validations",1,"invalid-feedback"],[4,"ngIf"]],template:function(r,p){r&1&&_(0,ya,3,1,"ng-container",7),r&2&&m("translocoRead","manage-email-settings")},dependencies:[U,H,Y,ee,ft,fe,j,X,ht,ie,ne,re,ke,ue,D],styles:["/*# sourceMappingURL=manage-email-settings.component-ICGWDK2G.css.map */"],changeDetection:0});let e=s;return e})();var Vn=e=>({num:e});function ka(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("host-name-tooltip"))}}function Ia(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(3).$implicit;n(),u(" ",i("host-name-validation")," ")}}function Ta(e,s){if(e&1&&(a(0,"div",78),_(1,Ia,2,1,"div",42),o()),e&2){let i,t=c(3);n(),m("ngIf",(i=t.settingsForm.get("hostName"))==null||i.errors==null?null:i.errors.pattern)}}function Ea(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("base-url-tooltip"))}}function Fa(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(3).$implicit;n(),u(" ",i("base-url-validation")," ")}}function wa(e,s){if(e&1&&(a(0,"div",79),_(1,Fa,2,1,"div",42),o()),e&2){let i,t=c(3);n(),m("ngIf",(i=t.settingsForm.get("baseUrl"))==null||i.errors==null?null:i.errors.pattern)}}function Ma(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("ip-address-tooltip"))}}function Va(e,s){if(e&1&&(a(0,"div"),l(1),o()),e&2){let i=c(3).$implicit;n(),u(" ",i("ip-address-validation")," ")}}function Ra(e,s){if(e&1&&(a(0,"div",80),_(1,Va,2,1,"div",42),o()),e&2){let i,t=c(3);n(),m("ngIf",(i=t.settingsForm.get("ipAddresses"))==null||i.errors==null?null:i.errors.pattern)}}function Da(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("port-tooltip"))}}function La(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;u("",i("backup-tooltip"),".")}}function Na(e,s){if(e&1&&(a(0,"p",82),l(1),o()),e&2){let i=c(3).$implicit;n(),u(" ",i("min-backup-validation")," ")}}function $a(e,s){if(e&1&&(a(0,"p",82),l(1),o()),e&2){let i=c().ngIf,t=c(2).$implicit;n(),u(" ",t("max-backup-validation",P(1,Vn,i.max.max))," ")}}function Aa(e,s){if(e&1&&(a(0,"p",82),l(1),o()),e&2){let i=c(3).$implicit;n(),u(" ",i("field-required")," ")}}function Pa(e,s){if(e&1&&(S(0),_(1,Na,2,1,"p",81)(2,$a,2,3,"p",81)(3,Aa,2,1,"p",81),y()),e&2){let i=s.ngIf;n(),m("ngIf",i.min),n(),m("ngIf",i.max),n(),m("ngIf",i.required)}}function Ua(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("log-tooltip"))}}function Oa(e,s){if(e&1&&(a(0,"p",82),l(1),o()),e&2){let i=c(3).$implicit;n(),u(" ",i("min-log-validation")," ")}}function Ba(e,s){if(e&1&&(a(0,"p",82),l(1),o()),e&2){let i=c().ngIf,t=c(2).$implicit;n(),u(" ",t("max-logs-validation",P(1,Vn,i.max.max))," ")}}function za(e,s){if(e&1&&(a(0,"p",82),l(1),o()),e&2){let i=c(3).$implicit;n(),u(" ",i("field-required")," ")}}function Ga(e,s){if(e&1&&(S(0),_(1,Oa,2,1,"p",81)(2,Ba,2,3,"p",81)(3,za,2,1,"p",81),y()),e&2){let i=s.ngIf;n(),m("ngIf",i.min),n(),m("ngIf",i.max),n(),m("ngIf",i.required)}}function qa(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("logging-level-tooltip"))}}function ja(e,s){if(e&1&&(a(0,"option",83),l(1),k(2,"titlecase"),o()),e&2){let i=s.$implicit;m("value",i),n(),d(I(2,2,i))}}function Ha(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("cache-size-tooltip"))}}function Ka(e,s){if(e&1&&(a(0,"p",82),l(1),o()),e&2){let i=c(3).$implicit;n(),u(" ",i("min-cache-validation")," ")}}function Wa(e,s){if(e&1&&(a(0,"p",82),l(1),o()),e&2){let i=c(3).$implicit;n(),u(" ",i("field-required")," ")}}function Qa(e,s){if(e&1&&(S(0),_(1,Ka,2,1,"p",81)(2,Wa,2,1,"p",81),y()),e&2){let i=s.ngIf;n(),m("ngIf",i.min),n(),m("ngIf",i.required)}}function Ja(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("on-deck-last-progress-tooltip"))}}function Xa(e,s){if(e&1&&(a(0,"p",82),l(1),o()),e&2){let i=c(3).$implicit;n(),u(" ",i("min-days-validation")," ")}}function Ya(e,s){if(e&1&&(a(0,"p",82),l(1),o()),e&2){let i=c(3).$implicit;n(),u(" ",i("field-required")," ")}}function Za(e,s){if(e&1&&(S(0),_(1,Xa,2,1,"p",81)(2,Ya,2,1,"p",81),y()),e&2){let i=s.ngIf;n(),m("ngIf",i.min),n(),m("ngIf",i.required)}}function es(e,s){if(e&1&&l(0),e&2){let i=c(2).$implicit;d(i("on-deck-last-chapter-add-tooltip"))}}function ts(e,s){if(e&1&&(a(0,"p",82),l(1),o()),e&2){let i=c(3).$implicit;n(),u(" ",i("min-days-validation")," ")}}function is(e,s){if(e&1&&(a(0,"p",82),l(1),o()),e&2){let i=c(3).$implicit;n(),u(" ",i("field-required")," ")}}function ns(e,s){if(e&1&&(S(0),_(1,ts,2,1,"p",81)(2,is,2,1,"p",81),y()),e&2){let i=s.ngIf;n(),m("ngIf",i.min),n(),m("ngIf",i.required)}}function rs(e,s){if(e&1){let i=E();a(0,"form",13)(1,"div",14)(2,"strong"),l(3),o(),l(4),o(),a(5,"div",15)(6,"label",16),l(7),o(),g(8,"i",17),_(9,ka,1,1,"ng-template",null,0,R),a(11,"span",18),z(12,19),o(),g(13,"input",20),_(14,Ta,2,1,"div",21),o(),a(15,"div",15)(16,"label",22),l(17),o(),g(18,"i",17),_(19,Ea,1,1,"ng-template",null,1,R),a(21,"span",23),z(22,19),o(),a(23,"div",24),g(24,"input",25),a(25,"button",26),x("click",function(){v(i);let r=c(2);return h(r.resetBaseUrl())}),l(26),o()(),_(27,wa,2,1,"div",27),o(),a(28,"div",28)(29,"div",29)(30,"label",30),l(31),o(),g(32,"i",17),_(33,Ma,1,1,"ng-template",null,2,R),a(35,"span",31),z(36,19),o(),a(37,"div",24),g(38,"input",32),a(39,"button",26),x("click",function(){v(i);let r=c(2);return h(r.resetIPAddresses())}),l(40,"Reset"),o()(),_(41,Ra,2,1,"div",33),o(),a(42,"div",34)(43,"label",35),l(44),o(),g(45,"i",17),_(46,Da,1,1,"ng-template",null,3,R),a(48,"span",36),z(49,19),o(),g(50,"input",37),o()(),a(51,"div",28)(52,"div",38)(53,"label",39),l(54),o(),g(55,"i",17),_(56,La,1,1,"ng-template",null,4,R),a(58,"span",40),z(59,19),o(),g(60,"input",41),_(61,Pa,4,3,"ng-container",42),o(),a(62,"div",38)(63,"label",43),l(64),o(),g(65,"i",17),_(66,Ua,1,1,"ng-template",null,5,R),a(68,"span",44),z(69,19),o(),g(70,"input",45),_(71,Ga,4,3,"ng-container",42),o(),a(72,"div",34)(73,"label",46),l(74),o(),g(75,"i",17),_(76,qa,1,1,"ng-template",null,6,R),a(78,"span",47),z(79,19),o(),a(80,"select",48),_(81,ja,3,4,"option",49),o()()(),a(82,"div",50)(83,"div",38)(84,"label",51),l(85),o(),g(86,"i",17),_(87,Ha,1,1,"ng-template",null,7,R),a(89,"span",52),z(90,19),o(),g(91,"input",53),_(92,Qa,3,2,"ng-container",42),o(),a(93,"div",38)(94,"label",54),l(95),o(),g(96,"i",17),_(97,Ja,1,1,"ng-template",null,8,R),a(99,"span",55),z(100,19),o(),g(101,"input",56),_(102,Za,3,2,"ng-container",42),o(),a(103,"div",34)(104,"label",57),l(105),o(),g(106,"i",17),_(107,es,1,1,"ng-template",null,9,R),a(109,"span",58),z(110,19),o(),g(111,"input",59),_(112,ns,3,2,"ng-container",42),o()(),a(113,"div",60)(114,"label",61),l(115),o(),a(116,"p",62),l(117),a(118,"a",63),l(119,"wiki"),o(),l(120),o(),a(121,"div",64),g(122,"input",65),a(123,"label",66),l(124),o()()(),a(125,"div",15)(126,"label",67),l(127),o(),a(128,"p",68),l(129),o(),a(130,"div",64),g(131,"input",69),a(132,"label",70),l(133),o()()(),a(134,"div",15)(135,"label",71),l(136),o(),a(137,"p",72),l(138),o(),a(139,"div",64),g(140,"input",73),a(141,"label",74),l(142),o()()(),a(143,"div",75)(144,"button",76),x("click",function(){v(i);let r=c(2);return h(r.resetToDefaults())}),l(145),o(),a(146,"button",76),x("click",function(){v(i);let r=c(2);return h(r.resetForm())}),l(147),o(),a(148,"button",77),x("click",function(){v(i);let r=c(2);return h(r.saveSettings())}),l(149),o()()()}if(e&2){let i,t,r,p,f,L,ae,he,F,K,ot,Ot,at,Bt,zt=w(10),Gt=w(20),qt=w(34),jt=w(47),Ht=w(57),Kt=w(67),Wt=w(77),Qt=w(88),Jt=w(98),Xt=w(108),G=c().$implicit,A=c();m("formGroup",A.settingsForm),n(3),d(G("notice")),n(),u(" ",G("restart-required")," "),n(3),d(G("host-name-label")),n(),m("ngbTooltip",zt),n(4),m("ngTemplateOutlet",zt),n(),Q("is-invalid",((i=A.settingsForm.get("hostName"))==null?null:i.invalid)&&((i=A.settingsForm.get("hostName"))==null?null:i.touched)),n(),m("ngIf",A.settingsForm.dirty||A.settingsForm.touched),n(3),d(G("base-url-label")),n(),m("ngbTooltip",Gt),n(4),m("ngTemplateOutlet",Gt),n(2),Q("is-invalid",((t=A.settingsForm.get("baseUrl"))==null?null:t.invalid)&&((t=A.settingsForm.get("baseUrl"))==null?null:t.touched)),n(2),d(G("reset")),n(),m("ngIf",A.settingsForm.dirty||A.settingsForm.touched),n(4),d(G("ip-address-label")),n(),m("ngbTooltip",qt),n(4),m("ngTemplateOutlet",qt),n(2),Q("is-invalid",((r=A.settingsForm.get("ipAddresses"))==null?null:r.invalid)&&((r=A.settingsForm.get("ipAddresses"))==null?null:r.touched)),n(3),m("ngIf",A.settingsForm.dirty||A.settingsForm.touched),n(3),d(G("port-label")),n(),m("ngbTooltip",jt),n(4),m("ngTemplateOutlet",jt),n(5),d(G("backup-label")),n(),m("ngbTooltip",Ht),n(4),m("ngTemplateOutlet",Ht),n(),Q("is-invalid",((p=A.settingsForm.get("totalBackups"))==null?null:p.invalid)&&((p=A.settingsForm.get("totalBackups"))==null?null:p.touched)),n(),m("ngIf",(f=A.settingsForm.get("totalBackups"))==null?null:f.errors),n(3),d(G("log-label")),n(),m("ngbTooltip",Kt),n(4),m("ngTemplateOutlet",Kt),n(),Q("is-invalid",((L=A.settingsForm.get("totalLogs"))==null?null:L.invalid)&&((L=A.settingsForm.get("totalLogs"))==null?null:L.touched)),n(),m("ngIf",(ae=A.settingsForm.get("totalLogs"))==null?null:ae.errors),n(3),d(G("logging-level-label")),n(),m("ngbTooltip",Wt),n(4),m("ngTemplateOutlet",Wt),n(),Q("is-invalid",((he=A.settingsForm.get("loggingLevel"))==null?null:he.invalid)&&((he=A.settingsForm.get("loggingLevel"))==null?null:he.touched)),n(),m("ngForOf",A.logLevels),n(4),d(G("cache-size-label")),n(),m("ngbTooltip",Qt),n(4),m("ngTemplateOutlet",Qt),n(),Q("is-invalid",((F=A.settingsForm.get("cacheSize"))==null?null:F.invalid)&&((F=A.settingsForm.get("cacheSize"))==null?null:F.touched)),n(),m("ngIf",(K=A.settingsForm.get("cacheSize"))==null?null:K.errors),n(3),d(G("on-deck-last-progress-label")),n(),m("ngbTooltip",Jt),n(4),m("ngTemplateOutlet",Jt),n(),Q("is-invalid",((ot=A.settingsForm.get("onDeckProgressDays"))==null?null:ot.invalid)&&((ot=A.settingsForm.get("onDeckProgressDays"))==null?null:ot.touched)),n(),m("ngIf",(Ot=A.settingsForm.get("onDeckProgressDays"))==null?null:Ot.errors),n(3),d(G("on-deck-last-chapter-add-label")),n(),m("ngbTooltip",Xt),n(4),m("ngTemplateOutlet",Xt),n(),Q("is-invalid",((at=A.settingsForm.get("onDeckUpdateDays"))==null?null:at.invalid)&&((at=A.settingsForm.get("onDeckUpdateDays"))==null?null:at.touched)),n(),m("ngIf",(Bt=A.settingsForm.get("onDeckUpdateDays"))==null?null:Bt.errors),n(3),d(G("allow-stats-label")),n(2),d(G("allow-stats-tooltip-part-1")),n(),m("href",A.WikiLink.DataCollection,_e),n(2),u(" ",G("allow-stats-tooltip-part-2"),""),n(4),d(G("send-data")),n(3),d(G("opds-label")),n(2),d(G("opds-tooltip")),n(4),d(G("enable-opds")),n(3),d(G("folder-watching-label")),n(2),d(G("folder-watching-tooltip")),n(4),d(G("enable-folder-watching")),n(3),d(G("reset-to-default")),n(2),d(G("reset")),n(),m("disabled",!A.settingsForm.dirty),n(),d(G("save"))}}function os(e,s){if(e&1&&(S(0),a(1,"div",11),_(2,rs,150,76,"form",12),o(),y()),e&2){let i=c();n(2),m("ngIf",i.serverSettings!==void 0)}}var as=/^(\s*((([12]?\d{1,2}\.){3}[12]?\d{1,2})|(([\da-f]{0,4}\:){0,7}([\da-f]{0,4})))\s*\,)*\s*((([12]?\d{1,2}\.){3}[12]?\d{1,2})|(([\da-f]{0,4}\:){0,7}([\da-f]{0,4})))\s*$/i,Rn=(()=>{let s=class s{constructor(){this.translocoService=b(Se),this.cdRef=b(B),this.settingsService=b(Ee),this.toastr=b(oe),this.serverService=b(Fe),this.WikiLink=Qe,this.settingsForm=new te({}),this.taskFrequencies=[],this.logLevels=[]}ngOnInit(){this.settingsService.getTaskFrequencies().pipe(q(1)).subscribe(t=>{this.taskFrequencies=t,this.cdRef.markForCheck()}),this.settingsService.getLoggingLevels().pipe(q(1)).subscribe(t=>{this.logLevels=t,this.cdRef.markForCheck()}),this.settingsService.getServerSettings().pipe(q(1)).subscribe(t=>{this.serverSettings=t,this.settingsForm.addControl("cacheDirectory",new C(this.serverSettings.cacheDirectory,[T.required])),this.settingsForm.addControl("taskScan",new C(this.serverSettings.taskScan,[T.required])),this.settingsForm.addControl("taskBackup",new C(this.serverSettings.taskBackup,[T.required])),this.settingsForm.addControl("taskCleanup",new C(this.serverSettings.taskCleanup,[T.required])),this.settingsForm.addControl("ipAddresses",new C(this.serverSettings.ipAddresses,[T.required,T.pattern(as)])),this.settingsForm.addControl("port",new C(this.serverSettings.port,[T.required])),this.settingsForm.addControl("loggingLevel",new C(this.serverSettings.loggingLevel,[T.required])),this.settingsForm.addControl("allowStatCollection",new C(this.serverSettings.allowStatCollection,[T.required])),this.settingsForm.addControl("enableOpds",new C(this.serverSettings.enableOpds,[T.required])),this.settingsForm.addControl("baseUrl",new C(this.serverSettings.baseUrl,[T.pattern(/^(\/[\w-]+)*\/$/)])),this.settingsForm.addControl("emailServiceUrl",new C(this.serverSettings.emailServiceUrl,[T.required])),this.settingsForm.addControl("totalBackups",new C(this.serverSettings.totalBackups,[T.required,T.min(1),T.max(30)])),this.settingsForm.addControl("cacheSize",new C(this.serverSettings.cacheSize,[T.required,T.min(50)])),this.settingsForm.addControl("totalLogs",new C(this.serverSettings.totalLogs,[T.required,T.min(1),T.max(30)])),this.settingsForm.addControl("enableFolderWatching",new C(this.serverSettings.enableFolderWatching,[T.required])),this.settingsForm.addControl("encodeMediaAs",new C(this.serverSettings.encodeMediaAs,[])),this.settingsForm.addControl("hostName",new C(this.serverSettings.hostName,[T.pattern(/^(http:|https:)+[^\s]+[\w]$/)])),this.settingsForm.addControl("onDeckProgressDays",new C(this.serverSettings.onDeckProgressDays,[T.required])),this.settingsForm.addControl("onDeckUpdateDays",new C(this.serverSettings.onDeckUpdateDays,[T.required])),this.serverService.getServerInfo().subscribe(r=>{r.isDocker&&(this.settingsForm.get("ipAddresses")?.disable(),this.settingsForm.get("port")?.disable(),this.cdRef.markForCheck())}),this.cdRef.markForCheck()}),this.cdRef.markForCheck()}resetForm(){this.settingsForm.get("cacheDirectory")?.setValue(this.serverSettings.cacheDirectory),this.settingsForm.get("scanTask")?.setValue(this.serverSettings.taskScan),this.settingsForm.get("taskBackup")?.setValue(this.serverSettings.taskBackup),this.settingsForm.get("taskCleanup")?.setValue(this.serverSettings.taskCleanup),this.settingsForm.get("ipAddresses")?.setValue(this.serverSettings.ipAddresses),this.settingsForm.get("port")?.setValue(this.serverSettings.port),this.settingsForm.get("loggingLevel")?.setValue(this.serverSettings.loggingLevel),this.settingsForm.get("allowStatCollection")?.setValue(this.serverSettings.allowStatCollection),this.settingsForm.get("enableOpds")?.setValue(this.serverSettings.enableOpds),this.settingsForm.get("baseUrl")?.setValue(this.serverSettings.baseUrl),this.settingsForm.get("emailServiceUrl")?.setValue(this.serverSettings.emailServiceUrl),this.settingsForm.get("totalBackups")?.setValue(this.serverSettings.totalBackups),this.settingsForm.get("totalLogs")?.setValue(this.serverSettings.totalLogs),this.settingsForm.get("enableFolderWatching")?.setValue(this.serverSettings.enableFolderWatching),this.settingsForm.get("encodeMediaAs")?.setValue(this.serverSettings.encodeMediaAs),this.settingsForm.get("hostName")?.setValue(this.serverSettings.hostName),this.settingsForm.get("cacheSize")?.setValue(this.serverSettings.cacheSize),this.settingsForm.get("onDeckProgressDays")?.setValue(this.serverSettings.onDeckProgressDays),this.settingsForm.get("onDeckUpdateDays")?.setValue(this.serverSettings.onDeckUpdateDays),this.settingsForm.markAsPristine(),this.cdRef.markForCheck()}saveSettings(){return se(this,null,function*(){let t=this.settingsForm.value;t.bookmarksDirectory=this.serverSettings.bookmarksDirectory,t.smtpConfig=this.serverSettings.smtpConfig,this.settingsService.updateServerSettings(t).pipe(q(1)).subscribe(r=>{this.serverSettings=r,this.resetForm(),this.toastr.success(this.translocoService.translate("toasts.server-settings-updated"))},r=>{console.error("error: ",r)})})}resetToDefaults(){this.settingsService.resetServerSettings().pipe(q(1)).subscribe(t=>{this.serverSettings=t,this.resetForm(),this.toastr.success(this.translocoService.translate("toasts.server-settings-updated"))},t=>{console.error("error: ",t)})}resetIPAddresses(){this.settingsService.resetIPAddressesSettings().pipe(q(1)).subscribe(t=>{this.serverSettings.ipAddresses=t.ipAddresses,this.settingsForm.get("ipAddresses")?.setValue(this.serverSettings.ipAddresses),this.toastr.success(this.translocoService.translate("toasts.reset-ip-address"))},t=>{console.error("error: ",t)})}resetBaseUrl(){this.settingsService.resetBaseUrl().pipe(q(1)).subscribe(t=>{this.serverSettings.baseUrl=t.baseUrl,this.settingsForm.get("baseUrl")?.setValue(this.serverSettings.baseUrl),this.toastr.success(this.translocoService.translate("toasts.reset-base-url")),this.cdRef.markForCheck()},t=>{console.error("error: ",t)})}};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-manage-settings"]],standalone:!0,features:[V],decls:1,vars:1,consts:[["hostNameTooltip",""],["baseUrlTooltip",""],["ipAddressesTooltip",""],["portTooltip",""],["backupTasksTooltip",""],["logTasksTooltip",""],["loggingLevelTooltip",""],["cacheSizeTooltip",""],["onDeckProgressDaysTooltip",""],["onDeckUpdateDaysTooltip",""],[4,"transloco","translocoRead"],[1,"container-fluid"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["role","alert",1,"alert","alert-warning"],[1,"mb-3"],["for","settings-hostname",1,"form-label"],["placement","right","role","button","tabindex","0",1,"fa","fa-info-circle","ms-1",3,"ngbTooltip"],["id","settings-hostname-help",1,"visually-hidden"],[3,"ngTemplateOutlet"],["id","settings-hostname","aria-describedby","settings-hostname-help","formControlName","hostName","type","text",1,"form-control"],["id","hostname-validations","class","invalid-feedback",4,"ngIf"],["for","settings-baseurl",1,"form-label"],["id","settings-cachedir-help",1,"visually-hidden"],[1,"input-group"],["id","settings-baseurl","aria-describedby","settings-baseurl-help","formControlName","baseUrl","type","text",1,"form-control"],[1,"btn","btn-outline-secondary",3,"click"],["id","baseurl-validations","class","invalid-feedback",4,"ngIf"],[1,"row","g-0","mb-2"],[1,"col-md-8","col-sm-12","pe-md-2"],["for","settings-ipaddresses",1,"form-label"],["id","settings-ipaddresses-help",1,"visually-hidden"],["id","settings-ipaddresses","aria-describedby","settings-ipaddresses-help","formControlName","ipAddresses","type","text",1,"form-control"],["id","ipaddresses-validations","class","invalid-feedback",4,"ngIf"],[1,"col-md-4","col-sm-12"],["for","settings-port",1,"form-label"],["id","settings-port-help",1,"visually-hidden"],["id","settings-port","aria-describedby","settings-port-help","formControlName","port","type","number","step","1","min","1","onkeypress","return event.charCode >= 48 && event.charCode <= 57",1,"form-control"],[1,"col-md-4","col-sm-12","pe-md-2"],["for","backup-tasks",1,"form-label"],["id","backup-tasks-help",1,"visually-hidden"],["id","backup-tasks","aria-describedby","backup-tasks-help","formControlName","totalBackups","type","number","inputmode","numeric","step","1","min","1","max","30","onkeypress","return event.charCode >= 48 && event.charCode <= 57",1,"form-control"],[4,"ngIf"],["for","log-tasks",1,"form-label"],["id","log-tasks-help",1,"visually-hidden"],["id","log-tasks","aria-describedby","log-tasks-help","formControlName","totalLogs","type","number","inputmode","numeric","step","1","min","1","max","30","onkeypress","return event.charCode >= 48 && event.charCode <= 57",1,"form-control"],["for","logging-level-port",1,"form-label"],["id","logging-level-port-help",1,"visually-hidden"],["id","logging-level-port","aria-describedby","logging-level-port-help","formControlName","loggingLevel",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],[1,"row","g-0","mb-2","mt-3"],["for","cache-size",1,"form-label"],["id","cache-size-help",1,"visually-hidden"],["id","cache-size","aria-describedby","cache-size-help","formControlName","cacheSize","type","number","inputmode","numeric","step","5","min","50","onkeypress","return event.charCode >= 48 && event.charCode <= 57",1,"form-control"],["for","on-deck-progress-days",1,"form-label"],["id","on-deck-progress-days-help",1,"visually-hidden"],["id","on-deck-progress-days","aria-describedby","on-deck-progress-days-help","formControlName","onDeckProgressDays","type","number","inputmode","numeric","step","1","min","1",1,"form-control"],["for","on-deck-update-days",1,"form-label"],["id","on-deck-update-days-help",1,"visually-hidden"],["id","on-deck-update-days","aria-describedby","on-deck-update-days-help","formControlName","onDeckUpdateDays","type","number","inputmode","numeric","step","1","min","1",1,"form-control"],[1,"mb-3","mt-3"],["for","stat-collection","aria-describedby","collection-info",1,"form-label"],["id","collection-info",1,"accent"],["rel","noopener noreferrer","target","_blank","referrerpolicy","no-refer",3,"href"],[1,"form-check","form-switch"],["id","stat-collection","type","checkbox","aria-label","Stat Collection","formControlName","allowStatCollection","role","switch",1,"form-check-input"],["for","stat-collection",1,"form-check-label"],["for","opds","aria-describedby","opds-info",1,"form-label"],["id","opds-info",1,"accent"],["id","opds","type","checkbox","aria-label","OPDS Support","formControlName","enableOpds",1,"form-check-input"],["for","opds",1,"form-check-label"],["for","folder-watching","aria-describedby","folder-watching-info",1,"form-label"],["id","folder-watching-info",1,"accent"],["id","folder-watching","type","checkbox","formControlName","enableFolderWatching","role","switch",1,"form-check-input"],["for","folder-watching",1,"form-check-label"],[1,"col-auto","d-flex","d-md-block","justify-content-sm-center","text-md-end"],["type","button",1,"flex-fill","btn","btn-secondary","me-2",3,"click"],["type","submit",1,"flex-fill","btn","btn-primary",3,"click","disabled"],["id","hostname-validations",1,"invalid-feedback"],["id","baseurl-validations",1,"invalid-feedback"],["id","ipaddresses-validations",1,"invalid-feedback"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"],[3,"value"]],template:function(r,p){r&1&&_(0,os,3,1,"ng-container",10),r&2&&m("translocoRead","manage-settings")},dependencies:[U,H,Y,He,Ke,ee,ft,fe,je,j,X,ht,_i,ie,ne,re,J,ze,ue,D,ke],styles:[`.invalid-feedback[_ngcontent-%COMP%]{display:inherit}
/*# sourceMappingURL=manage-settings.component-SKL4PFAT.css.map */`],changeDetection:0});let e=s;return e})();function ss(e,s){e&1&&(S(0),g(1,"app-manage-settings"),y())}function ls(e,s){e&1&&(S(0),g(1,"app-manage-email-settings"),y())}function cs(e,s){e&1&&(S(0),g(1,"app-manage-media-settings"),y())}function ms(e,s){e&1&&(S(0),g(1,"app-manage-users"),y())}function ps(e,s){e&1&&(S(0),g(1,"app-manage-library"),y())}function ds(e,s){e&1&&(S(0),g(1,"app-manage-system"),y())}function _s(e,s){e&1&&(S(0),g(1,"app-server-stats"),y())}function gs(e,s){e&1&&(S(0),g(1,"app-manage-tasks-settings"),y())}function us(e,s){if(e&1&&(S(0),a(1,"p"),l(2),a(3,"a",11),l(4),o(),l(5),a(6,"a",11),l(7,"FAQ"),o()(),a(8,"p"),l(9),a(10,"a",12),l(11),o()(),g(12,"app-license"),y()),e&2){let i=c(3).$implicit,t=c();n(2),u("",i("kavita+-desc-part-1")," "),n(),m("href",t.WikiLink.KavitaPlus,_e),n(),d(i("kavita+-desc-part-2")),n(),u(" ",i("kavita+-desc-part-3")," "),n(),m("href",t.WikiLink.KavitaPlusFAQ,_e),n(3),u("",i("kavita+-requirement")," "),n(),m("routerLink","/announcements"),n(),d(i("kavita+-releases"))}}function fs(e,s){if(e&1&&_(0,ss,2,0,"ng-container",10)(1,ls,2,0,"ng-container",10)(2,cs,2,0,"ng-container",10)(3,ms,2,0,"ng-container",10)(4,ps,2,0,"ng-container",10)(5,ds,2,0,"ng-container",10)(6,_s,2,0,"ng-container",10)(7,gs,2,0,"ng-container",10)(8,us,13,8,"ng-container",10),e&2){let i=c().$implicit,t=c(2);m("ngIf",i.fragment===t.TabID.General),n(),m("ngIf",i.fragment===t.TabID.Email),n(),m("ngIf",i.fragment===t.TabID.Media),n(),m("ngIf",i.fragment===t.TabID.Users),n(),m("ngIf",i.fragment===t.TabID.Libraries),n(),m("ngIf",i.fragment===t.TabID.System),n(),m("ngIf",i.fragment===t.TabID.Statistics),n(),m("ngIf",i.fragment===t.TabID.Tasks),n(),m("ngIf",i.fragment===t.TabID.KavitaPlus)}}function vs(e,s){if(e&1&&(a(0,"li",7)(1,"a",8),l(2),o(),_(3,fs,9,9,"ng-template",9),o()),e&2){let i=s.$implicit,t=c().$implicit;m("ngbNavItem",i),n(),m("fragment",i.fragment),n(),d(t(i.title))}}function hs(e,s){if(e&1){let i=E();S(0),a(1,"app-side-nav-companion-bar")(2,"h2",2),l(3),o()(),a(4,"div",3)(5,"ul",4,0),Oe("activeIdChange",function(r){v(i);let p=c();return Ue(p.active,r)||(p.active=r),h(r)}),_(7,vs,4,3,"li",5),o(),g(8,"div",6),o(),y()}if(e&2){let i=s.$implicit,t=w(6),r=c();n(3),u(" ",i("title")," "),n(2),Pe("activeId",r.active),n(2),m("ngForOf",r.tabs),n(),m("ngbNavOutlet",t)}}var be=function(e){return e.General="",e.Email="email",e.Media="media",e.Users="users",e.Libraries="libraries",e.System="system",e.Tasks="tasks",e.Logs="logs",e.Statistics="statistics",e.KavitaPlus="kavitaplus",e}(be||{}),Ut=(()=>{let s=class s{constructor(){this.cdRef=b(B),this.route=b(pi),this.navService=b(Ri),this.titleService=b(mi),this.TabID=be,this.WikiLink=Qe,this.tabs=[{title:"general-tab",fragment:be.General},{title:"users-tab",fragment:be.Users},{title:"libraries-tab",fragment:be.Libraries},{title:"media-tab",fragment:be.Media},{title:"email-tab",fragment:be.Email},{title:"tasks-tab",fragment:be.Tasks},{title:"statistics-tab",fragment:be.Statistics},{title:"system-tab",fragment:be.System},{title:"kavita+-tab",fragment:be.KavitaPlus}],this.active=this.tabs[0],this.route.fragment.subscribe(t=>{let r=this.tabs.filter(p=>p.fragment===t);r.length>0?this.active=r[0]:this.active=this.tabs[0],this.cdRef.markForCheck()})}ngOnInit(){this.titleService.setTitle("Kavita - "+$("admin-dashboard.title"))}};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-dashboard"]],standalone:!0,features:[V],decls:1,vars:1,consts:[["nav","ngbNav"],[4,"transloco","translocoRead"],["title",""],[1,"container-fluid","g-0"],["ngbNav","",1,"nav","nav-tabs",3,"activeIdChange","activeId"],["class","tab",3,"ngbNavItem",4,"ngFor","ngForOf"],[1,"mt-3","mb-3",3,"ngbNavOutlet"],[1,"tab",3,"ngbNavItem"],["ngbNavLink","","routerLink",".",3,"fragment"],["ngbNavContent",""],[4,"ngIf"],["target","_blank","rel","noreferrer nofollow",3,"href"],[3,"routerLink"]],template:function(r,p){r&1&&_(0,hs,9,4,"ng-container",1),r&2&&m("translocoRead","admin-dashboard")},dependencies:[cn,Ei,J,Ti,Ii,Fi,gt,ki,U,Rn,Mn,wn,In,bn,vn,fn,dn,mn,wi,D],styles:[`.container[_ngcontent-%COMP%]{padding-top:10px}.tab[_ngcontent-%COMP%]:last-child > a.active[_ngcontent-%COMP%], .tab[_ngcontent-%COMP%]:last-child > a[_ngcontent-%COMP%]:before{background-color:#ffba15}
/*# sourceMappingURL=dashboard.component-IICI7VRW.css.map */`],changeDetection:0});let e=s;return e})();var rd=[{path:"**",component:Ut,pathMatch:"full",canActivate:[Pt]},{path:"",runGuardsAndResolvers:"always",canActivate:[Pt],children:[{path:"dashboard",component:Ut}]}];export{rd as routes};
//# sourceMappingURL=chunk-OMT2OGRR.js.map
