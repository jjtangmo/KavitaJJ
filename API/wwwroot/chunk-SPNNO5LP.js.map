{"version":3,"sources":["node_modules/@angular/router/fesm2022/router.mjs","node_modules/@microsoft/signalr/dist/esm/Errors.js","node_modules/@microsoft/signalr/dist/esm/HttpClient.js","node_modules/@microsoft/signalr/dist/esm/ILogger.js","node_modules/@microsoft/signalr/dist/esm/Loggers.js","node_modules/@microsoft/signalr/dist/esm/Utils.js","node_modules/@microsoft/signalr/dist/esm/FetchHttpClient.js","node_modules/@microsoft/signalr/dist/esm/XhrHttpClient.js","node_modules/@microsoft/signalr/dist/esm/DefaultHttpClient.js","node_modules/@microsoft/signalr/dist/esm/TextMessageFormat.js","node_modules/@microsoft/signalr/dist/esm/HandshakeProtocol.js","node_modules/@microsoft/signalr/dist/esm/IHubProtocol.js","node_modules/@microsoft/signalr/dist/esm/Subject.js","node_modules/@microsoft/signalr/dist/esm/HubConnection.js","node_modules/@microsoft/signalr/dist/esm/DefaultReconnectPolicy.js","node_modules/@microsoft/signalr/src/HeaderNames.ts","node_modules/@microsoft/signalr/dist/esm/AccessTokenHttpClient.js","node_modules/@microsoft/signalr/dist/esm/ITransport.js","node_modules/@microsoft/signalr/dist/esm/AbortController.js","node_modules/@microsoft/signalr/dist/esm/LongPollingTransport.js","node_modules/@microsoft/signalr/dist/esm/ServerSentEventsTransport.js","node_modules/@microsoft/signalr/dist/esm/WebSocketTransport.js","node_modules/@microsoft/signalr/dist/esm/HttpConnection.js","node_modules/@microsoft/signalr/dist/esm/JsonHubProtocol.js","node_modules/@microsoft/signalr/dist/esm/HubConnectionBuilder.js","src/app/_services/message-hub.service.ts","src/app/_pipes/safe-html.pipe.ts","src/app/shared/confirm-dialog/confirm-dialog.component.ts","src/app/shared/confirm-dialog/confirm-dialog.component.html","src/app/shared/confirm-dialog/_models/confirm-config.ts","src/app/shared/confirm.service.ts","src/app/_models/preferences/site-theme.ts","src/app/_services/theme.service.ts","src/app/_services/account.service.ts"],"sourcesContent":["/**\n * @license Angular v17.3.0\n * (c) 2010-2022 Google LLC. https://angular.io/\n * License: MIT\n */\n\nimport * as i0 from '@angular/core';\nimport { ɵisPromise, ɵRuntimeError, Injectable, EventEmitter, inject, ViewContainerRef, ChangeDetectorRef, EnvironmentInjector, Directive, Input, Output, InjectionToken, reflectComponentType, Component, createEnvironmentInjector, ɵisNgModule, isStandalone, ɵisInjectable, runInInjectionContext, Compiler, NgModuleFactory, NgZone, afterNextRender, ɵConsole, ɵPendingTasks, ɵɵsanitizeUrlOrResourceUrl, booleanAttribute, Attribute, HostBinding, HostListener, Optional, ContentChildren, makeEnvironmentProviders, APP_BOOTSTRAP_LISTENER, ENVIRONMENT_INITIALIZER, Injector, ApplicationRef, InjectFlags, APP_INITIALIZER, SkipSelf, NgModule, Inject, Version } from '@angular/core';\nimport { isObservable, from, of, BehaviorSubject, combineLatest, EmptyError, concat, defer, pipe, throwError, EMPTY, ConnectableObservable, Subject, Subscription } from 'rxjs';\nimport * as i3 from '@angular/common';\nimport { DOCUMENT, Location, ViewportScroller, LOCATION_INITIALIZED, LocationStrategy, HashLocationStrategy, PathLocationStrategy } from '@angular/common';\nimport { map, switchMap, take, startWith, filter, mergeMap, first, concatMap, tap, catchError, scan, defaultIfEmpty, last as last$1, takeLast, mapTo, finalize, refCount, takeUntil, mergeAll } from 'rxjs/operators';\nimport * as i1 from '@angular/platform-browser';\n\n/**\n * The primary routing outlet.\n *\n * @publicApi\n */\nconst PRIMARY_OUTLET = 'primary';\n/**\n * A private symbol used to store the value of `Route.title` inside the `Route.data` if it is a\n * static string or `Route.resolve` if anything else. This allows us to reuse the existing route\n * data/resolvers to support the title feature without new instrumentation in the `Router` pipeline.\n */\nconst RouteTitleKey = /* @__PURE__ */Symbol('RouteTitle');\nclass ParamsAsMap {\n  constructor(params) {\n    this.params = params || {};\n  }\n  has(name) {\n    return Object.prototype.hasOwnProperty.call(this.params, name);\n  }\n  get(name) {\n    if (this.has(name)) {\n      const v = this.params[name];\n      return Array.isArray(v) ? v[0] : v;\n    }\n    return null;\n  }\n  getAll(name) {\n    if (this.has(name)) {\n      const v = this.params[name];\n      return Array.isArray(v) ? v : [v];\n    }\n    return [];\n  }\n  get keys() {\n    return Object.keys(this.params);\n  }\n}\n/**\n * Converts a `Params` instance to a `ParamMap`.\n * @param params The instance to convert.\n * @returns The new map instance.\n *\n * @publicApi\n */\nfunction convertToParamMap(params) {\n  return new ParamsAsMap(params);\n}\n/**\n * Matches the route configuration (`route`) against the actual URL (`segments`).\n *\n * When no matcher is defined on a `Route`, this is the matcher used by the Router by default.\n *\n * @param segments The remaining unmatched segments in the current navigation\n * @param segmentGroup The current segment group being matched\n * @param route The `Route` to match against.\n *\n * @see {@link UrlMatchResult}\n * @see {@link Route}\n *\n * @returns The resulting match information or `null` if the `route` should not match.\n * @publicApi\n */\nfunction defaultUrlMatcher(segments, segmentGroup, route) {\n  const parts = route.path.split('/');\n  if (parts.length > segments.length) {\n    // The actual URL is shorter than the config, no match\n    return null;\n  }\n  if (route.pathMatch === 'full' && (segmentGroup.hasChildren() || parts.length < segments.length)) {\n    // The config is longer than the actual URL but we are looking for a full match, return null\n    return null;\n  }\n  const posParams = {};\n  // Check each config part against the actual URL\n  for (let index = 0; index < parts.length; index++) {\n    const part = parts[index];\n    const segment = segments[index];\n    const isParameter = part.startsWith(':');\n    if (isParameter) {\n      posParams[part.substring(1)] = segment;\n    } else if (part !== segment.path) {\n      // The actual URL part does not match the config, no match\n      return null;\n    }\n  }\n  return {\n    consumed: segments.slice(0, parts.length),\n    posParams\n  };\n}\nfunction shallowEqualArrays(a, b) {\n  if (a.length !== b.length) return false;\n  for (let i = 0; i < a.length; ++i) {\n    if (!shallowEqual(a[i], b[i])) return false;\n  }\n  return true;\n}\nfunction shallowEqual(a, b) {\n  // While `undefined` should never be possible, it would sometimes be the case in IE 11\n  // and pre-chromium Edge. The check below accounts for this edge case.\n  const k1 = a ? getDataKeys(a) : undefined;\n  const k2 = b ? getDataKeys(b) : undefined;\n  if (!k1 || !k2 || k1.length != k2.length) {\n    return false;\n  }\n  let key;\n  for (let i = 0; i < k1.length; i++) {\n    key = k1[i];\n    if (!equalArraysOrString(a[key], b[key])) {\n      return false;\n    }\n  }\n  return true;\n}\n/**\n * Gets the keys of an object, including `symbol` keys.\n */\nfunction getDataKeys(obj) {\n  return [...Object.keys(obj), ...Object.getOwnPropertySymbols(obj)];\n}\n/**\n * Test equality for arrays of strings or a string.\n */\nfunction equalArraysOrString(a, b) {\n  if (Array.isArray(a) && Array.isArray(b)) {\n    if (a.length !== b.length) return false;\n    const aSorted = [...a].sort();\n    const bSorted = [...b].sort();\n    return aSorted.every((val, index) => bSorted[index] === val);\n  } else {\n    return a === b;\n  }\n}\n/**\n * Return the last element of an array.\n */\nfunction last(a) {\n  return a.length > 0 ? a[a.length - 1] : null;\n}\nfunction wrapIntoObservable(value) {\n  if (isObservable(value)) {\n    return value;\n  }\n  if (ɵisPromise(value)) {\n    // Use `Promise.resolve()` to wrap promise-like instances.\n    // Required ie when a Resolver returns a AngularJS `$q` promise to correctly trigger the\n    // change detection.\n    return from(Promise.resolve(value));\n  }\n  return of(value);\n}\nconst pathCompareMap = {\n  'exact': equalSegmentGroups,\n  'subset': containsSegmentGroup\n};\nconst paramCompareMap = {\n  'exact': equalParams,\n  'subset': containsParams,\n  'ignored': () => true\n};\nfunction containsTree(container, containee, options) {\n  return pathCompareMap[options.paths](container.root, containee.root, options.matrixParams) && paramCompareMap[options.queryParams](container.queryParams, containee.queryParams) && !(options.fragment === 'exact' && container.fragment !== containee.fragment);\n}\nfunction equalParams(container, containee) {\n  // TODO: This does not handle array params correctly.\n  return shallowEqual(container, containee);\n}\nfunction equalSegmentGroups(container, containee, matrixParams) {\n  if (!equalPath(container.segments, containee.segments)) return false;\n  if (!matrixParamsMatch(container.segments, containee.segments, matrixParams)) {\n    return false;\n  }\n  if (container.numberOfChildren !== containee.numberOfChildren) return false;\n  for (const c in containee.children) {\n    if (!container.children[c]) return false;\n    if (!equalSegmentGroups(container.children[c], containee.children[c], matrixParams)) return false;\n  }\n  return true;\n}\nfunction containsParams(container, containee) {\n  return Object.keys(containee).length <= Object.keys(container).length && Object.keys(containee).every(key => equalArraysOrString(container[key], containee[key]));\n}\nfunction containsSegmentGroup(container, containee, matrixParams) {\n  return containsSegmentGroupHelper(container, containee, containee.segments, matrixParams);\n}\nfunction containsSegmentGroupHelper(container, containee, containeePaths, matrixParams) {\n  if (container.segments.length > containeePaths.length) {\n    const current = container.segments.slice(0, containeePaths.length);\n    if (!equalPath(current, containeePaths)) return false;\n    if (containee.hasChildren()) return false;\n    if (!matrixParamsMatch(current, containeePaths, matrixParams)) return false;\n    return true;\n  } else if (container.segments.length === containeePaths.length) {\n    if (!equalPath(container.segments, containeePaths)) return false;\n    if (!matrixParamsMatch(container.segments, containeePaths, matrixParams)) return false;\n    for (const c in containee.children) {\n      if (!container.children[c]) return false;\n      if (!containsSegmentGroup(container.children[c], containee.children[c], matrixParams)) {\n        return false;\n      }\n    }\n    return true;\n  } else {\n    const current = containeePaths.slice(0, container.segments.length);\n    const next = containeePaths.slice(container.segments.length);\n    if (!equalPath(container.segments, current)) return false;\n    if (!matrixParamsMatch(container.segments, current, matrixParams)) return false;\n    if (!container.children[PRIMARY_OUTLET]) return false;\n    return containsSegmentGroupHelper(container.children[PRIMARY_OUTLET], containee, next, matrixParams);\n  }\n}\nfunction matrixParamsMatch(containerPaths, containeePaths, options) {\n  return containeePaths.every((containeeSegment, i) => {\n    return paramCompareMap[options](containerPaths[i].parameters, containeeSegment.parameters);\n  });\n}\n/**\n * @description\n *\n * Represents the parsed URL.\n *\n * Since a router state is a tree, and the URL is nothing but a serialized state, the URL is a\n * serialized tree.\n * UrlTree is a data structure that provides a lot of affordances in dealing with URLs\n *\n * @usageNotes\n * ### Example\n *\n * ```\n * @Component({templateUrl:'template.html'})\n * class MyComponent {\n *   constructor(router: Router) {\n *     const tree: UrlTree =\n *       router.parseUrl('/team/33/(user/victor//support:help)?debug=true#fragment');\n *     const f = tree.fragment; // return 'fragment'\n *     const q = tree.queryParams; // returns {debug: 'true'}\n *     const g: UrlSegmentGroup = tree.root.children[PRIMARY_OUTLET];\n *     const s: UrlSegment[] = g.segments; // returns 2 segments 'team' and '33'\n *     g.children[PRIMARY_OUTLET].segments; // returns 2 segments 'user' and 'victor'\n *     g.children['support'].segments; // return 1 segment 'help'\n *   }\n * }\n * ```\n *\n * @publicApi\n */\nclass UrlTree {\n  constructor( /** The root segment group of the URL tree */\n  root = new UrlSegmentGroup([], {}), /** The query params of the URL */\n  queryParams = {}, /** The fragment of the URL */\n  fragment = null) {\n    this.root = root;\n    this.queryParams = queryParams;\n    this.fragment = fragment;\n    if (typeof ngDevMode === 'undefined' || ngDevMode) {\n      if (root.segments.length > 0) {\n        throw new ɵRuntimeError(4015 /* RuntimeErrorCode.INVALID_ROOT_URL_SEGMENT */, 'The root `UrlSegmentGroup` should not contain `segments`. ' + 'Instead, these segments belong in the `children` so they can be associated with a named outlet.');\n      }\n    }\n  }\n  get queryParamMap() {\n    this._queryParamMap ??= convertToParamMap(this.queryParams);\n    return this._queryParamMap;\n  }\n  /** @docsNotRequired */\n  toString() {\n    return DEFAULT_SERIALIZER.serialize(this);\n  }\n}\n/**\n * @description\n *\n * Represents the parsed URL segment group.\n *\n * See `UrlTree` for more information.\n *\n * @publicApi\n */\nclass UrlSegmentGroup {\n  constructor( /** The URL segments of this group. See `UrlSegment` for more information */\n  segments, /** The list of children of this group */\n  children) {\n    this.segments = segments;\n    this.children = children;\n    /** The parent node in the url tree */\n    this.parent = null;\n    Object.values(children).forEach(v => v.parent = this);\n  }\n  /** Whether the segment has child segments */\n  hasChildren() {\n    return this.numberOfChildren > 0;\n  }\n  /** Number of child segments */\n  get numberOfChildren() {\n    return Object.keys(this.children).length;\n  }\n  /** @docsNotRequired */\n  toString() {\n    return serializePaths(this);\n  }\n}\n/**\n * @description\n *\n * Represents a single URL segment.\n *\n * A UrlSegment is a part of a URL between the two slashes. It contains a path and the matrix\n * parameters associated with the segment.\n *\n * @usageNotes\n * ### Example\n *\n * ```\n * @Component({templateUrl:'template.html'})\n * class MyComponent {\n *   constructor(router: Router) {\n *     const tree: UrlTree = router.parseUrl('/team;id=33');\n *     const g: UrlSegmentGroup = tree.root.children[PRIMARY_OUTLET];\n *     const s: UrlSegment[] = g.segments;\n *     s[0].path; // returns 'team'\n *     s[0].parameters; // returns {id: 33}\n *   }\n * }\n * ```\n *\n * @publicApi\n */\nclass UrlSegment {\n  constructor( /** The path part of a URL segment */\n  path, /** The matrix parameters associated with a segment */\n  parameters) {\n    this.path = path;\n    this.parameters = parameters;\n  }\n  get parameterMap() {\n    this._parameterMap ??= convertToParamMap(this.parameters);\n    return this._parameterMap;\n  }\n  /** @docsNotRequired */\n  toString() {\n    return serializePath(this);\n  }\n}\nfunction equalSegments(as, bs) {\n  return equalPath(as, bs) && as.every((a, i) => shallowEqual(a.parameters, bs[i].parameters));\n}\nfunction equalPath(as, bs) {\n  if (as.length !== bs.length) return false;\n  return as.every((a, i) => a.path === bs[i].path);\n}\nfunction mapChildrenIntoArray(segment, fn) {\n  let res = [];\n  Object.entries(segment.children).forEach(([childOutlet, child]) => {\n    if (childOutlet === PRIMARY_OUTLET) {\n      res = res.concat(fn(child, childOutlet));\n    }\n  });\n  Object.entries(segment.children).forEach(([childOutlet, child]) => {\n    if (childOutlet !== PRIMARY_OUTLET) {\n      res = res.concat(fn(child, childOutlet));\n    }\n  });\n  return res;\n}\n/**\n * @description\n *\n * Serializes and deserializes a URL string into a URL tree.\n *\n * The url serialization strategy is customizable. You can\n * make all URLs case insensitive by providing a custom UrlSerializer.\n *\n * See `DefaultUrlSerializer` for an example of a URL serializer.\n *\n * @publicApi\n */\nlet UrlSerializer = /*#__PURE__*/(() => {\n  class UrlSerializer {\n    static {\n      this.ɵfac = function UrlSerializer_Factory(t) {\n        return new (t || UrlSerializer)();\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: UrlSerializer,\n        factory: () => (() => new DefaultUrlSerializer())(),\n        providedIn: 'root'\n      });\n    }\n  }\n  return UrlSerializer;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n/**\n * @description\n *\n * A default implementation of the `UrlSerializer`.\n *\n * Example URLs:\n *\n * ```\n * /inbox/33(popup:compose)\n * /inbox/33;open=true/messages/44\n * ```\n *\n * DefaultUrlSerializer uses parentheses to serialize secondary segments (e.g., popup:compose), the\n * colon syntax to specify the outlet, and the ';parameter=value' syntax (e.g., open=true) to\n * specify route specific parameters.\n *\n * @publicApi\n */\nclass DefaultUrlSerializer {\n  /** Parses a url into a `UrlTree` */\n  parse(url) {\n    const p = new UrlParser(url);\n    return new UrlTree(p.parseRootSegment(), p.parseQueryParams(), p.parseFragment());\n  }\n  /** Converts a `UrlTree` into a url */\n  serialize(tree) {\n    const segment = `/${serializeSegment(tree.root, true)}`;\n    const query = serializeQueryParams(tree.queryParams);\n    const fragment = typeof tree.fragment === `string` ? `#${encodeUriFragment(tree.fragment)}` : '';\n    return `${segment}${query}${fragment}`;\n  }\n}\nconst DEFAULT_SERIALIZER = /*#__PURE__*/new DefaultUrlSerializer();\nfunction serializePaths(segment) {\n  return segment.segments.map(p => serializePath(p)).join('/');\n}\nfunction serializeSegment(segment, root) {\n  if (!segment.hasChildren()) {\n    return serializePaths(segment);\n  }\n  if (root) {\n    const primary = segment.children[PRIMARY_OUTLET] ? serializeSegment(segment.children[PRIMARY_OUTLET], false) : '';\n    const children = [];\n    Object.entries(segment.children).forEach(([k, v]) => {\n      if (k !== PRIMARY_OUTLET) {\n        children.push(`${k}:${serializeSegment(v, false)}`);\n      }\n    });\n    return children.length > 0 ? `${primary}(${children.join('//')})` : primary;\n  } else {\n    const children = mapChildrenIntoArray(segment, (v, k) => {\n      if (k === PRIMARY_OUTLET) {\n        return [serializeSegment(segment.children[PRIMARY_OUTLET], false)];\n      }\n      return [`${k}:${serializeSegment(v, false)}`];\n    });\n    // use no parenthesis if the only child is a primary outlet route\n    if (Object.keys(segment.children).length === 1 && segment.children[PRIMARY_OUTLET] != null) {\n      return `${serializePaths(segment)}/${children[0]}`;\n    }\n    return `${serializePaths(segment)}/(${children.join('//')})`;\n  }\n}\n/**\n * Encodes a URI string with the default encoding. This function will only ever be called from\n * `encodeUriQuery` or `encodeUriSegment` as it's the base set of encodings to be used. We need\n * a custom encoding because encodeURIComponent is too aggressive and encodes stuff that doesn't\n * have to be encoded per https://url.spec.whatwg.org.\n */\nfunction encodeUriString(s) {\n  return encodeURIComponent(s).replace(/%40/g, '@').replace(/%3A/gi, ':').replace(/%24/g, '$').replace(/%2C/gi, ',');\n}\n/**\n * This function should be used to encode both keys and values in a query string key/value. In\n * the following URL, you need to call encodeUriQuery on \"k\" and \"v\":\n *\n * http://www.site.org/html;mk=mv?k=v#f\n */\nfunction encodeUriQuery(s) {\n  return encodeUriString(s).replace(/%3B/gi, ';');\n}\n/**\n * This function should be used to encode a URL fragment. In the following URL, you need to call\n * encodeUriFragment on \"f\":\n *\n * http://www.site.org/html;mk=mv?k=v#f\n */\nfunction encodeUriFragment(s) {\n  return encodeURI(s);\n}\n/**\n * This function should be run on any URI segment as well as the key and value in a key/value\n * pair for matrix params. In the following URL, you need to call encodeUriSegment on \"html\",\n * \"mk\", and \"mv\":\n *\n * http://www.site.org/html;mk=mv?k=v#f\n */\nfunction encodeUriSegment(s) {\n  return encodeUriString(s).replace(/\\(/g, '%28').replace(/\\)/g, '%29').replace(/%26/gi, '&');\n}\nfunction decode(s) {\n  return decodeURIComponent(s);\n}\n// Query keys/values should have the \"+\" replaced first, as \"+\" in a query string is \" \".\n// decodeURIComponent function will not decode \"+\" as a space.\nfunction decodeQuery(s) {\n  return decode(s.replace(/\\+/g, '%20'));\n}\nfunction serializePath(path) {\n  return `${encodeUriSegment(path.path)}${serializeMatrixParams(path.parameters)}`;\n}\nfunction serializeMatrixParams(params) {\n  return Object.entries(params).map(([key, value]) => `;${encodeUriSegment(key)}=${encodeUriSegment(value)}`).join('');\n}\nfunction serializeQueryParams(params) {\n  const strParams = Object.entries(params).map(([name, value]) => {\n    return Array.isArray(value) ? value.map(v => `${encodeUriQuery(name)}=${encodeUriQuery(v)}`).join('&') : `${encodeUriQuery(name)}=${encodeUriQuery(value)}`;\n  }).filter(s => s);\n  return strParams.length ? `?${strParams.join('&')}` : '';\n}\nconst SEGMENT_RE = /^[^\\/()?;#]+/;\nfunction matchSegments(str) {\n  const match = str.match(SEGMENT_RE);\n  return match ? match[0] : '';\n}\nconst MATRIX_PARAM_SEGMENT_RE = /^[^\\/()?;=#]+/;\nfunction matchMatrixKeySegments(str) {\n  const match = str.match(MATRIX_PARAM_SEGMENT_RE);\n  return match ? match[0] : '';\n}\nconst QUERY_PARAM_RE = /^[^=?&#]+/;\n// Return the name of the query param at the start of the string or an empty string\nfunction matchQueryParams(str) {\n  const match = str.match(QUERY_PARAM_RE);\n  return match ? match[0] : '';\n}\nconst QUERY_PARAM_VALUE_RE = /^[^&#]+/;\n// Return the value of the query param at the start of the string or an empty string\nfunction matchUrlQueryParamValue(str) {\n  const match = str.match(QUERY_PARAM_VALUE_RE);\n  return match ? match[0] : '';\n}\nclass UrlParser {\n  constructor(url) {\n    this.url = url;\n    this.remaining = url;\n  }\n  parseRootSegment() {\n    this.consumeOptional('/');\n    if (this.remaining === '' || this.peekStartsWith('?') || this.peekStartsWith('#')) {\n      return new UrlSegmentGroup([], {});\n    }\n    // The root segment group never has segments\n    return new UrlSegmentGroup([], this.parseChildren());\n  }\n  parseQueryParams() {\n    const params = {};\n    if (this.consumeOptional('?')) {\n      do {\n        this.parseQueryParam(params);\n      } while (this.consumeOptional('&'));\n    }\n    return params;\n  }\n  parseFragment() {\n    return this.consumeOptional('#') ? decodeURIComponent(this.remaining) : null;\n  }\n  parseChildren() {\n    if (this.remaining === '') {\n      return {};\n    }\n    this.consumeOptional('/');\n    const segments = [];\n    if (!this.peekStartsWith('(')) {\n      segments.push(this.parseSegment());\n    }\n    while (this.peekStartsWith('/') && !this.peekStartsWith('//') && !this.peekStartsWith('/(')) {\n      this.capture('/');\n      segments.push(this.parseSegment());\n    }\n    let children = {};\n    if (this.peekStartsWith('/(')) {\n      this.capture('/');\n      children = this.parseParens(true);\n    }\n    let res = {};\n    if (this.peekStartsWith('(')) {\n      res = this.parseParens(false);\n    }\n    if (segments.length > 0 || Object.keys(children).length > 0) {\n      res[PRIMARY_OUTLET] = new UrlSegmentGroup(segments, children);\n    }\n    return res;\n  }\n  // parse a segment with its matrix parameters\n  // ie `name;k1=v1;k2`\n  parseSegment() {\n    const path = matchSegments(this.remaining);\n    if (path === '' && this.peekStartsWith(';')) {\n      throw new ɵRuntimeError(4009 /* RuntimeErrorCode.EMPTY_PATH_WITH_PARAMS */, (typeof ngDevMode === 'undefined' || ngDevMode) && `Empty path url segment cannot have parameters: '${this.remaining}'.`);\n    }\n    this.capture(path);\n    return new UrlSegment(decode(path), this.parseMatrixParams());\n  }\n  parseMatrixParams() {\n    const params = {};\n    while (this.consumeOptional(';')) {\n      this.parseParam(params);\n    }\n    return params;\n  }\n  parseParam(params) {\n    const key = matchMatrixKeySegments(this.remaining);\n    if (!key) {\n      return;\n    }\n    this.capture(key);\n    let value = '';\n    if (this.consumeOptional('=')) {\n      const valueMatch = matchSegments(this.remaining);\n      if (valueMatch) {\n        value = valueMatch;\n        this.capture(value);\n      }\n    }\n    params[decode(key)] = decode(value);\n  }\n  // Parse a single query parameter `name[=value]`\n  parseQueryParam(params) {\n    const key = matchQueryParams(this.remaining);\n    if (!key) {\n      return;\n    }\n    this.capture(key);\n    let value = '';\n    if (this.consumeOptional('=')) {\n      const valueMatch = matchUrlQueryParamValue(this.remaining);\n      if (valueMatch) {\n        value = valueMatch;\n        this.capture(value);\n      }\n    }\n    const decodedKey = decodeQuery(key);\n    const decodedVal = decodeQuery(value);\n    if (params.hasOwnProperty(decodedKey)) {\n      // Append to existing values\n      let currentVal = params[decodedKey];\n      if (!Array.isArray(currentVal)) {\n        currentVal = [currentVal];\n        params[decodedKey] = currentVal;\n      }\n      currentVal.push(decodedVal);\n    } else {\n      // Create a new value\n      params[decodedKey] = decodedVal;\n    }\n  }\n  // parse `(a/b//outlet_name:c/d)`\n  parseParens(allowPrimary) {\n    const segments = {};\n    this.capture('(');\n    while (!this.consumeOptional(')') && this.remaining.length > 0) {\n      const path = matchSegments(this.remaining);\n      const next = this.remaining[path.length];\n      // if is is not one of these characters, then the segment was unescaped\n      // or the group was not closed\n      if (next !== '/' && next !== ')' && next !== ';') {\n        throw new ɵRuntimeError(4010 /* RuntimeErrorCode.UNPARSABLE_URL */, (typeof ngDevMode === 'undefined' || ngDevMode) && `Cannot parse url '${this.url}'`);\n      }\n      let outletName = undefined;\n      if (path.indexOf(':') > -1) {\n        outletName = path.slice(0, path.indexOf(':'));\n        this.capture(outletName);\n        this.capture(':');\n      } else if (allowPrimary) {\n        outletName = PRIMARY_OUTLET;\n      }\n      const children = this.parseChildren();\n      segments[outletName] = Object.keys(children).length === 1 ? children[PRIMARY_OUTLET] : new UrlSegmentGroup([], children);\n      this.consumeOptional('//');\n    }\n    return segments;\n  }\n  peekStartsWith(str) {\n    return this.remaining.startsWith(str);\n  }\n  // Consumes the prefix when it is present and returns whether it has been consumed\n  consumeOptional(str) {\n    if (this.peekStartsWith(str)) {\n      this.remaining = this.remaining.substring(str.length);\n      return true;\n    }\n    return false;\n  }\n  capture(str) {\n    if (!this.consumeOptional(str)) {\n      throw new ɵRuntimeError(4011 /* RuntimeErrorCode.UNEXPECTED_VALUE_IN_URL */, (typeof ngDevMode === 'undefined' || ngDevMode) && `Expected \"${str}\".`);\n    }\n  }\n}\nfunction createRoot(rootCandidate) {\n  return rootCandidate.segments.length > 0 ? new UrlSegmentGroup([], {\n    [PRIMARY_OUTLET]: rootCandidate\n  }) : rootCandidate;\n}\n/**\n * Recursively\n * - merges primary segment children into their parents\n * - drops empty children (those which have no segments and no children themselves). This latter\n * prevents serializing a group into something like `/a(aux:)`, where `aux` is an empty child\n * segment.\n * - merges named outlets without a primary segment sibling into the children. This prevents\n * serializing a URL like `//(a:a)(b:b) instead of `/(a:a//b:b)` when the aux b route lives on the\n * root but the `a` route lives under an empty path primary route.\n */\nfunction squashSegmentGroup(segmentGroup) {\n  const newChildren = {};\n  for (const [childOutlet, child] of Object.entries(segmentGroup.children)) {\n    const childCandidate = squashSegmentGroup(child);\n    // moves named children in an empty path primary child into this group\n    if (childOutlet === PRIMARY_OUTLET && childCandidate.segments.length === 0 && childCandidate.hasChildren()) {\n      for (const [grandChildOutlet, grandChild] of Object.entries(childCandidate.children)) {\n        newChildren[grandChildOutlet] = grandChild;\n      }\n    } // don't add empty children\n    else if (childCandidate.segments.length > 0 || childCandidate.hasChildren()) {\n      newChildren[childOutlet] = childCandidate;\n    }\n  }\n  const s = new UrlSegmentGroup(segmentGroup.segments, newChildren);\n  return mergeTrivialChildren(s);\n}\n/**\n * When possible, merges the primary outlet child into the parent `UrlSegmentGroup`.\n *\n * When a segment group has only one child which is a primary outlet, merges that child into the\n * parent. That is, the child segment group's segments are merged into the `s` and the child's\n * children become the children of `s`. Think of this like a 'squash', merging the child segment\n * group into the parent.\n */\nfunction mergeTrivialChildren(s) {\n  if (s.numberOfChildren === 1 && s.children[PRIMARY_OUTLET]) {\n    const c = s.children[PRIMARY_OUTLET];\n    return new UrlSegmentGroup(s.segments.concat(c.segments), c.children);\n  }\n  return s;\n}\nfunction isUrlTree(v) {\n  return v instanceof UrlTree;\n}\n\n/**\n * Creates a `UrlTree` relative to an `ActivatedRouteSnapshot`.\n *\n * @publicApi\n *\n *\n * @param relativeTo The `ActivatedRouteSnapshot` to apply the commands to\n * @param commands An array of URL fragments with which to construct the new URL tree.\n * If the path is static, can be the literal URL string. For a dynamic path, pass an array of path\n * segments, followed by the parameters for each segment.\n * The fragments are applied to the one provided in the `relativeTo` parameter.\n * @param queryParams The query parameters for the `UrlTree`. `null` if the `UrlTree` does not have\n *     any query parameters.\n * @param fragment The fragment for the `UrlTree`. `null` if the `UrlTree` does not have a fragment.\n *\n * @usageNotes\n *\n * ```\n * // create /team/33/user/11\n * createUrlTreeFromSnapshot(snapshot, ['/team', 33, 'user', 11]);\n *\n * // create /team/33;expand=true/user/11\n * createUrlTreeFromSnapshot(snapshot, ['/team', 33, {expand: true}, 'user', 11]);\n *\n * // you can collapse static segments like this (this works only with the first passed-in value):\n * createUrlTreeFromSnapshot(snapshot, ['/team/33/user', userId]);\n *\n * // If the first segment can contain slashes, and you do not want the router to split it,\n * // you can do the following:\n * createUrlTreeFromSnapshot(snapshot, [{segmentPath: '/one/two'}]);\n *\n * // create /team/33/(user/11//right:chat)\n * createUrlTreeFromSnapshot(snapshot, ['/team', 33, {outlets: {primary: 'user/11', right:\n * 'chat'}}], null, null);\n *\n * // remove the right secondary node\n * createUrlTreeFromSnapshot(snapshot, ['/team', 33, {outlets: {primary: 'user/11', right: null}}]);\n *\n * // For the examples below, assume the current URL is for the `/team/33/user/11` and the\n * `ActivatedRouteSnapshot` points to `user/11`:\n *\n * // navigate to /team/33/user/11/details\n * createUrlTreeFromSnapshot(snapshot, ['details']);\n *\n * // navigate to /team/33/user/22\n * createUrlTreeFromSnapshot(snapshot, ['../22']);\n *\n * // navigate to /team/44/user/22\n * createUrlTreeFromSnapshot(snapshot, ['../../team/44/user/22']);\n * ```\n */\nfunction createUrlTreeFromSnapshot(relativeTo, commands, queryParams = null, fragment = null) {\n  const relativeToUrlSegmentGroup = createSegmentGroupFromRoute(relativeTo);\n  return createUrlTreeFromSegmentGroup(relativeToUrlSegmentGroup, commands, queryParams, fragment);\n}\nfunction createSegmentGroupFromRoute(route) {\n  let targetGroup;\n  function createSegmentGroupFromRouteRecursive(currentRoute) {\n    const childOutlets = {};\n    for (const childSnapshot of currentRoute.children) {\n      const root = createSegmentGroupFromRouteRecursive(childSnapshot);\n      childOutlets[childSnapshot.outlet] = root;\n    }\n    const segmentGroup = new UrlSegmentGroup(currentRoute.url, childOutlets);\n    if (currentRoute === route) {\n      targetGroup = segmentGroup;\n    }\n    return segmentGroup;\n  }\n  const rootCandidate = createSegmentGroupFromRouteRecursive(route.root);\n  const rootSegmentGroup = createRoot(rootCandidate);\n  return targetGroup ?? rootSegmentGroup;\n}\nfunction createUrlTreeFromSegmentGroup(relativeTo, commands, queryParams, fragment) {\n  let root = relativeTo;\n  while (root.parent) {\n    root = root.parent;\n  }\n  // There are no commands so the `UrlTree` goes to the same path as the one created from the\n  // `UrlSegmentGroup`. All we need to do is update the `queryParams` and `fragment` without\n  // applying any other logic.\n  if (commands.length === 0) {\n    return tree(root, root, root, queryParams, fragment);\n  }\n  const nav = computeNavigation(commands);\n  if (nav.toRoot()) {\n    return tree(root, root, new UrlSegmentGroup([], {}), queryParams, fragment);\n  }\n  const position = findStartingPositionForTargetGroup(nav, root, relativeTo);\n  const newSegmentGroup = position.processChildren ? updateSegmentGroupChildren(position.segmentGroup, position.index, nav.commands) : updateSegmentGroup(position.segmentGroup, position.index, nav.commands);\n  return tree(root, position.segmentGroup, newSegmentGroup, queryParams, fragment);\n}\nfunction isMatrixParams(command) {\n  return typeof command === 'object' && command != null && !command.outlets && !command.segmentPath;\n}\n/**\n * Determines if a given command has an `outlets` map. When we encounter a command\n * with an outlets k/v map, we need to apply each outlet individually to the existing segment.\n */\nfunction isCommandWithOutlets(command) {\n  return typeof command === 'object' && command != null && command.outlets;\n}\nfunction tree(oldRoot, oldSegmentGroup, newSegmentGroup, queryParams, fragment) {\n  let qp = {};\n  if (queryParams) {\n    Object.entries(queryParams).forEach(([name, value]) => {\n      qp[name] = Array.isArray(value) ? value.map(v => `${v}`) : `${value}`;\n    });\n  }\n  let rootCandidate;\n  if (oldRoot === oldSegmentGroup) {\n    rootCandidate = newSegmentGroup;\n  } else {\n    rootCandidate = replaceSegment(oldRoot, oldSegmentGroup, newSegmentGroup);\n  }\n  const newRoot = createRoot(squashSegmentGroup(rootCandidate));\n  return new UrlTree(newRoot, qp, fragment);\n}\n/**\n * Replaces the `oldSegment` which is located in some child of the `current` with the `newSegment`.\n * This also has the effect of creating new `UrlSegmentGroup` copies to update references. This\n * shouldn't be necessary but the fallback logic for an invalid ActivatedRoute in the creation uses\n * the Router's current url tree. If we don't create new segment groups, we end up modifying that\n * value.\n */\nfunction replaceSegment(current, oldSegment, newSegment) {\n  const children = {};\n  Object.entries(current.children).forEach(([outletName, c]) => {\n    if (c === oldSegment) {\n      children[outletName] = newSegment;\n    } else {\n      children[outletName] = replaceSegment(c, oldSegment, newSegment);\n    }\n  });\n  return new UrlSegmentGroup(current.segments, children);\n}\nclass Navigation {\n  constructor(isAbsolute, numberOfDoubleDots, commands) {\n    this.isAbsolute = isAbsolute;\n    this.numberOfDoubleDots = numberOfDoubleDots;\n    this.commands = commands;\n    if (isAbsolute && commands.length > 0 && isMatrixParams(commands[0])) {\n      throw new ɵRuntimeError(4003 /* RuntimeErrorCode.ROOT_SEGMENT_MATRIX_PARAMS */, (typeof ngDevMode === 'undefined' || ngDevMode) && 'Root segment cannot have matrix parameters');\n    }\n    const cmdWithOutlet = commands.find(isCommandWithOutlets);\n    if (cmdWithOutlet && cmdWithOutlet !== last(commands)) {\n      throw new ɵRuntimeError(4004 /* RuntimeErrorCode.MISPLACED_OUTLETS_COMMAND */, (typeof ngDevMode === 'undefined' || ngDevMode) && '{outlets:{}} has to be the last command');\n    }\n  }\n  toRoot() {\n    return this.isAbsolute && this.commands.length === 1 && this.commands[0] == '/';\n  }\n}\n/** Transforms commands to a normalized `Navigation` */\nfunction computeNavigation(commands) {\n  if (typeof commands[0] === 'string' && commands.length === 1 && commands[0] === '/') {\n    return new Navigation(true, 0, commands);\n  }\n  let numberOfDoubleDots = 0;\n  let isAbsolute = false;\n  const res = commands.reduce((res, cmd, cmdIdx) => {\n    if (typeof cmd === 'object' && cmd != null) {\n      if (cmd.outlets) {\n        const outlets = {};\n        Object.entries(cmd.outlets).forEach(([name, commands]) => {\n          outlets[name] = typeof commands === 'string' ? commands.split('/') : commands;\n        });\n        return [...res, {\n          outlets\n        }];\n      }\n      if (cmd.segmentPath) {\n        return [...res, cmd.segmentPath];\n      }\n    }\n    if (!(typeof cmd === 'string')) {\n      return [...res, cmd];\n    }\n    if (cmdIdx === 0) {\n      cmd.split('/').forEach((urlPart, partIndex) => {\n        if (partIndex == 0 && urlPart === '.') {\n          // skip './a'\n        } else if (partIndex == 0 && urlPart === '') {\n          //  '/a'\n          isAbsolute = true;\n        } else if (urlPart === '..') {\n          //  '../a'\n          numberOfDoubleDots++;\n        } else if (urlPart != '') {\n          res.push(urlPart);\n        }\n      });\n      return res;\n    }\n    return [...res, cmd];\n  }, []);\n  return new Navigation(isAbsolute, numberOfDoubleDots, res);\n}\nclass Position {\n  constructor(segmentGroup, processChildren, index) {\n    this.segmentGroup = segmentGroup;\n    this.processChildren = processChildren;\n    this.index = index;\n  }\n}\nfunction findStartingPositionForTargetGroup(nav, root, target) {\n  if (nav.isAbsolute) {\n    return new Position(root, true, 0);\n  }\n  if (!target) {\n    // `NaN` is used only to maintain backwards compatibility with incorrectly mocked\n    // `ActivatedRouteSnapshot` in tests. In prior versions of this code, the position here was\n    // determined based on an internal property that was rarely mocked, resulting in `NaN`. In\n    // reality, this code path should _never_ be touched since `target` is not allowed to be falsey.\n    return new Position(root, false, NaN);\n  }\n  if (target.parent === null) {\n    return new Position(target, true, 0);\n  }\n  const modifier = isMatrixParams(nav.commands[0]) ? 0 : 1;\n  const index = target.segments.length - 1 + modifier;\n  return createPositionApplyingDoubleDots(target, index, nav.numberOfDoubleDots);\n}\nfunction createPositionApplyingDoubleDots(group, index, numberOfDoubleDots) {\n  let g = group;\n  let ci = index;\n  let dd = numberOfDoubleDots;\n  while (dd > ci) {\n    dd -= ci;\n    g = g.parent;\n    if (!g) {\n      throw new ɵRuntimeError(4005 /* RuntimeErrorCode.INVALID_DOUBLE_DOTS */, (typeof ngDevMode === 'undefined' || ngDevMode) && \"Invalid number of '../'\");\n    }\n    ci = g.segments.length;\n  }\n  return new Position(g, false, ci - dd);\n}\nfunction getOutlets(commands) {\n  if (isCommandWithOutlets(commands[0])) {\n    return commands[0].outlets;\n  }\n  return {\n    [PRIMARY_OUTLET]: commands\n  };\n}\nfunction updateSegmentGroup(segmentGroup, startIndex, commands) {\n  segmentGroup ??= new UrlSegmentGroup([], {});\n  if (segmentGroup.segments.length === 0 && segmentGroup.hasChildren()) {\n    return updateSegmentGroupChildren(segmentGroup, startIndex, commands);\n  }\n  const m = prefixedWith(segmentGroup, startIndex, commands);\n  const slicedCommands = commands.slice(m.commandIndex);\n  if (m.match && m.pathIndex < segmentGroup.segments.length) {\n    const g = new UrlSegmentGroup(segmentGroup.segments.slice(0, m.pathIndex), {});\n    g.children[PRIMARY_OUTLET] = new UrlSegmentGroup(segmentGroup.segments.slice(m.pathIndex), segmentGroup.children);\n    return updateSegmentGroupChildren(g, 0, slicedCommands);\n  } else if (m.match && slicedCommands.length === 0) {\n    return new UrlSegmentGroup(segmentGroup.segments, {});\n  } else if (m.match && !segmentGroup.hasChildren()) {\n    return createNewSegmentGroup(segmentGroup, startIndex, commands);\n  } else if (m.match) {\n    return updateSegmentGroupChildren(segmentGroup, 0, slicedCommands);\n  } else {\n    return createNewSegmentGroup(segmentGroup, startIndex, commands);\n  }\n}\nfunction updateSegmentGroupChildren(segmentGroup, startIndex, commands) {\n  if (commands.length === 0) {\n    return new UrlSegmentGroup(segmentGroup.segments, {});\n  } else {\n    const outlets = getOutlets(commands);\n    const children = {};\n    // If the set of commands applies to anything other than the primary outlet and the child\n    // segment is an empty path primary segment on its own, we want to apply the commands to the\n    // empty child path rather than here. The outcome is that the empty primary child is effectively\n    // removed from the final output UrlTree. Imagine the following config:\n    //\n    // {path: '', children: [{path: '**', outlet: 'popup'}]}.\n    //\n    // Navigation to /(popup:a) will activate the child outlet correctly Given a follow-up\n    // navigation with commands\n    // ['/', {outlets: {'popup': 'b'}}], we _would not_ want to apply the outlet commands to the\n    // root segment because that would result in\n    // //(popup:a)(popup:b) since the outlet command got applied one level above where it appears in\n    // the `ActivatedRoute` rather than updating the existing one.\n    //\n    // Because empty paths do not appear in the URL segments and the fact that the segments used in\n    // the output `UrlTree` are squashed to eliminate these empty paths where possible\n    // https://github.com/angular/angular/blob/13f10de40e25c6900ca55bd83b36bd533dacfa9e/packages/router/src/url_tree.ts#L755\n    // it can be hard to determine what is the right thing to do when applying commands to a\n    // `UrlSegmentGroup` that is created from an \"unsquashed\"/expanded `ActivatedRoute` tree.\n    // This code effectively \"squashes\" empty path primary routes when they have no siblings on\n    // the same level of the tree.\n    if (Object.keys(outlets).some(o => o !== PRIMARY_OUTLET) && segmentGroup.children[PRIMARY_OUTLET] && segmentGroup.numberOfChildren === 1 && segmentGroup.children[PRIMARY_OUTLET].segments.length === 0) {\n      const childrenOfEmptyChild = updateSegmentGroupChildren(segmentGroup.children[PRIMARY_OUTLET], startIndex, commands);\n      return new UrlSegmentGroup(segmentGroup.segments, childrenOfEmptyChild.children);\n    }\n    Object.entries(outlets).forEach(([outlet, commands]) => {\n      if (typeof commands === 'string') {\n        commands = [commands];\n      }\n      if (commands !== null) {\n        children[outlet] = updateSegmentGroup(segmentGroup.children[outlet], startIndex, commands);\n      }\n    });\n    Object.entries(segmentGroup.children).forEach(([childOutlet, child]) => {\n      if (outlets[childOutlet] === undefined) {\n        children[childOutlet] = child;\n      }\n    });\n    return new UrlSegmentGroup(segmentGroup.segments, children);\n  }\n}\nfunction prefixedWith(segmentGroup, startIndex, commands) {\n  let currentCommandIndex = 0;\n  let currentPathIndex = startIndex;\n  const noMatch = {\n    match: false,\n    pathIndex: 0,\n    commandIndex: 0\n  };\n  while (currentPathIndex < segmentGroup.segments.length) {\n    if (currentCommandIndex >= commands.length) return noMatch;\n    const path = segmentGroup.segments[currentPathIndex];\n    const command = commands[currentCommandIndex];\n    // Do not try to consume command as part of the prefixing if it has outlets because it can\n    // contain outlets other than the one being processed. Consuming the outlets command would\n    // result in other outlets being ignored.\n    if (isCommandWithOutlets(command)) {\n      break;\n    }\n    const curr = `${command}`;\n    const next = currentCommandIndex < commands.length - 1 ? commands[currentCommandIndex + 1] : null;\n    if (currentPathIndex > 0 && curr === undefined) break;\n    if (curr && next && typeof next === 'object' && next.outlets === undefined) {\n      if (!compare(curr, next, path)) return noMatch;\n      currentCommandIndex += 2;\n    } else {\n      if (!compare(curr, {}, path)) return noMatch;\n      currentCommandIndex++;\n    }\n    currentPathIndex++;\n  }\n  return {\n    match: true,\n    pathIndex: currentPathIndex,\n    commandIndex: currentCommandIndex\n  };\n}\nfunction createNewSegmentGroup(segmentGroup, startIndex, commands) {\n  const paths = segmentGroup.segments.slice(0, startIndex);\n  let i = 0;\n  while (i < commands.length) {\n    const command = commands[i];\n    if (isCommandWithOutlets(command)) {\n      const children = createNewSegmentChildren(command.outlets);\n      return new UrlSegmentGroup(paths, children);\n    }\n    // if we start with an object literal, we need to reuse the path part from the segment\n    if (i === 0 && isMatrixParams(commands[0])) {\n      const p = segmentGroup.segments[startIndex];\n      paths.push(new UrlSegment(p.path, stringify(commands[0])));\n      i++;\n      continue;\n    }\n    const curr = isCommandWithOutlets(command) ? command.outlets[PRIMARY_OUTLET] : `${command}`;\n    const next = i < commands.length - 1 ? commands[i + 1] : null;\n    if (curr && next && isMatrixParams(next)) {\n      paths.push(new UrlSegment(curr, stringify(next)));\n      i += 2;\n    } else {\n      paths.push(new UrlSegment(curr, {}));\n      i++;\n    }\n  }\n  return new UrlSegmentGroup(paths, {});\n}\nfunction createNewSegmentChildren(outlets) {\n  const children = {};\n  Object.entries(outlets).forEach(([outlet, commands]) => {\n    if (typeof commands === 'string') {\n      commands = [commands];\n    }\n    if (commands !== null) {\n      children[outlet] = createNewSegmentGroup(new UrlSegmentGroup([], {}), 0, commands);\n    }\n  });\n  return children;\n}\nfunction stringify(params) {\n  const res = {};\n  Object.entries(params).forEach(([k, v]) => res[k] = `${v}`);\n  return res;\n}\nfunction compare(path, params, segment) {\n  return path == segment.path && shallowEqual(params, segment.parameters);\n}\nconst IMPERATIVE_NAVIGATION = 'imperative';\n/**\n * Identifies the type of a router event.\n *\n * @publicApi\n */\nvar EventType = /*#__PURE__*/function (EventType) {\n  EventType[EventType[\"NavigationStart\"] = 0] = \"NavigationStart\";\n  EventType[EventType[\"NavigationEnd\"] = 1] = \"NavigationEnd\";\n  EventType[EventType[\"NavigationCancel\"] = 2] = \"NavigationCancel\";\n  EventType[EventType[\"NavigationError\"] = 3] = \"NavigationError\";\n  EventType[EventType[\"RoutesRecognized\"] = 4] = \"RoutesRecognized\";\n  EventType[EventType[\"ResolveStart\"] = 5] = \"ResolveStart\";\n  EventType[EventType[\"ResolveEnd\"] = 6] = \"ResolveEnd\";\n  EventType[EventType[\"GuardsCheckStart\"] = 7] = \"GuardsCheckStart\";\n  EventType[EventType[\"GuardsCheckEnd\"] = 8] = \"GuardsCheckEnd\";\n  EventType[EventType[\"RouteConfigLoadStart\"] = 9] = \"RouteConfigLoadStart\";\n  EventType[EventType[\"RouteConfigLoadEnd\"] = 10] = \"RouteConfigLoadEnd\";\n  EventType[EventType[\"ChildActivationStart\"] = 11] = \"ChildActivationStart\";\n  EventType[EventType[\"ChildActivationEnd\"] = 12] = \"ChildActivationEnd\";\n  EventType[EventType[\"ActivationStart\"] = 13] = \"ActivationStart\";\n  EventType[EventType[\"ActivationEnd\"] = 14] = \"ActivationEnd\";\n  EventType[EventType[\"Scroll\"] = 15] = \"Scroll\";\n  EventType[EventType[\"NavigationSkipped\"] = 16] = \"NavigationSkipped\";\n  return EventType;\n}(EventType || {});\n/**\n * Base for events the router goes through, as opposed to events tied to a specific\n * route. Fired one time for any given navigation.\n *\n * The following code shows how a class subscribes to router events.\n *\n * ```ts\n * import {Event, RouterEvent, Router} from '@angular/router';\n *\n * class MyService {\n *   constructor(public router: Router) {\n *     router.events.pipe(\n *        filter((e: Event | RouterEvent): e is RouterEvent => e instanceof RouterEvent)\n *     ).subscribe((e: RouterEvent) => {\n *       // Do something\n *     });\n *   }\n * }\n * ```\n *\n * @see {@link Event}\n * @see [Router events summary](guide/router-reference#router-events)\n * @publicApi\n */\nclass RouterEvent {\n  constructor( /** A unique ID that the router assigns to every router navigation. */\n  id, /** The URL that is the destination for this navigation. */\n  url) {\n    this.id = id;\n    this.url = url;\n  }\n}\n/**\n * An event triggered when a navigation starts.\n *\n * @publicApi\n */\nclass NavigationStart extends RouterEvent {\n  constructor( /** @docsNotRequired */\n  id, /** @docsNotRequired */\n  url, /** @docsNotRequired */\n  navigationTrigger = 'imperative', /** @docsNotRequired */\n  restoredState = null) {\n    super(id, url);\n    this.type = EventType.NavigationStart;\n    this.navigationTrigger = navigationTrigger;\n    this.restoredState = restoredState;\n  }\n  /** @docsNotRequired */\n  toString() {\n    return `NavigationStart(id: ${this.id}, url: '${this.url}')`;\n  }\n}\n/**\n * An event triggered when a navigation ends successfully.\n *\n * @see {@link NavigationStart}\n * @see {@link NavigationCancel}\n * @see {@link NavigationError}\n *\n * @publicApi\n */\nclass NavigationEnd extends RouterEvent {\n  constructor( /** @docsNotRequired */\n  id, /** @docsNotRequired */\n  url, /** @docsNotRequired */\n  urlAfterRedirects) {\n    super(id, url);\n    this.urlAfterRedirects = urlAfterRedirects;\n    this.type = EventType.NavigationEnd;\n  }\n  /** @docsNotRequired */\n  toString() {\n    return `NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`;\n  }\n}\n/**\n * A code for the `NavigationCancel` event of the `Router` to indicate the\n * reason a navigation failed.\n *\n * @publicApi\n */\nvar NavigationCancellationCode = /*#__PURE__*/function (NavigationCancellationCode) {\n  /**\n   * A navigation failed because a guard returned a `UrlTree` to redirect.\n   */\n  NavigationCancellationCode[NavigationCancellationCode[\"Redirect\"] = 0] = \"Redirect\";\n  /**\n   * A navigation failed because a more recent navigation started.\n   */\n  NavigationCancellationCode[NavigationCancellationCode[\"SupersededByNewNavigation\"] = 1] = \"SupersededByNewNavigation\";\n  /**\n   * A navigation failed because one of the resolvers completed without emitting a value.\n   */\n  NavigationCancellationCode[NavigationCancellationCode[\"NoDataFromResolver\"] = 2] = \"NoDataFromResolver\";\n  /**\n   * A navigation failed because a guard returned `false`.\n   */\n  NavigationCancellationCode[NavigationCancellationCode[\"GuardRejected\"] = 3] = \"GuardRejected\";\n  return NavigationCancellationCode;\n}(NavigationCancellationCode || {});\n/**\n * A code for the `NavigationSkipped` event of the `Router` to indicate the\n * reason a navigation was skipped.\n *\n * @publicApi\n */\nvar NavigationSkippedCode = /*#__PURE__*/function (NavigationSkippedCode) {\n  /**\n   * A navigation was skipped because the navigation URL was the same as the current Router URL.\n   */\n  NavigationSkippedCode[NavigationSkippedCode[\"IgnoredSameUrlNavigation\"] = 0] = \"IgnoredSameUrlNavigation\";\n  /**\n   * A navigation was skipped because the configured `UrlHandlingStrategy` return `false` for both\n   * the current Router URL and the target of the navigation.\n   *\n   * @see {@link UrlHandlingStrategy}\n   */\n  NavigationSkippedCode[NavigationSkippedCode[\"IgnoredByUrlHandlingStrategy\"] = 1] = \"IgnoredByUrlHandlingStrategy\";\n  return NavigationSkippedCode;\n}(NavigationSkippedCode || {});\n/**\n * An event triggered when a navigation is canceled, directly or indirectly.\n * This can happen for several reasons including when a route guard\n * returns `false` or initiates a redirect by returning a `UrlTree`.\n *\n * @see {@link NavigationStart}\n * @see {@link NavigationEnd}\n * @see {@link NavigationError}\n *\n * @publicApi\n */\nclass NavigationCancel extends RouterEvent {\n  constructor( /** @docsNotRequired */\n  id, /** @docsNotRequired */\n  url,\n  /**\n   * A description of why the navigation was cancelled. For debug purposes only. Use `code`\n   * instead for a stable cancellation reason that can be used in production.\n   */\n  reason,\n  /**\n   * A code to indicate why the navigation was canceled. This cancellation code is stable for\n   * the reason and can be relied on whereas the `reason` string could change and should not be\n   * used in production.\n   */\n  code) {\n    super(id, url);\n    this.reason = reason;\n    this.code = code;\n    this.type = EventType.NavigationCancel;\n  }\n  /** @docsNotRequired */\n  toString() {\n    return `NavigationCancel(id: ${this.id}, url: '${this.url}')`;\n  }\n}\n/**\n * An event triggered when a navigation is skipped.\n * This can happen for a couple reasons including onSameUrlHandling\n * is set to `ignore` and the navigation URL is not different than the\n * current state.\n *\n * @publicApi\n */\nclass NavigationSkipped extends RouterEvent {\n  constructor( /** @docsNotRequired */\n  id, /** @docsNotRequired */\n  url,\n  /**\n   * A description of why the navigation was skipped. For debug purposes only. Use `code`\n   * instead for a stable skipped reason that can be used in production.\n   */\n  reason,\n  /**\n   * A code to indicate why the navigation was skipped. This code is stable for\n   * the reason and can be relied on whereas the `reason` string could change and should not be\n   * used in production.\n   */\n  code) {\n    super(id, url);\n    this.reason = reason;\n    this.code = code;\n    this.type = EventType.NavigationSkipped;\n  }\n}\n/**\n * An event triggered when a navigation fails due to an unexpected error.\n *\n * @see {@link NavigationStart}\n * @see {@link NavigationEnd}\n * @see {@link NavigationCancel}\n *\n * @publicApi\n */\nclass NavigationError extends RouterEvent {\n  constructor( /** @docsNotRequired */\n  id, /** @docsNotRequired */\n  url, /** @docsNotRequired */\n  error,\n  /**\n   * The target of the navigation when the error occurred.\n   *\n   * Note that this can be `undefined` because an error could have occurred before the\n   * `RouterStateSnapshot` was created for the navigation.\n   */\n  target) {\n    super(id, url);\n    this.error = error;\n    this.target = target;\n    this.type = EventType.NavigationError;\n  }\n  /** @docsNotRequired */\n  toString() {\n    return `NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`;\n  }\n}\n/**\n * An event triggered when routes are recognized.\n *\n * @publicApi\n */\nclass RoutesRecognized extends RouterEvent {\n  constructor( /** @docsNotRequired */\n  id, /** @docsNotRequired */\n  url, /** @docsNotRequired */\n  urlAfterRedirects, /** @docsNotRequired */\n  state) {\n    super(id, url);\n    this.urlAfterRedirects = urlAfterRedirects;\n    this.state = state;\n    this.type = EventType.RoutesRecognized;\n  }\n  /** @docsNotRequired */\n  toString() {\n    return `RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`;\n  }\n}\n/**\n * An event triggered at the start of the Guard phase of routing.\n *\n * @see {@link GuardsCheckEnd}\n *\n * @publicApi\n */\nclass GuardsCheckStart extends RouterEvent {\n  constructor( /** @docsNotRequired */\n  id, /** @docsNotRequired */\n  url, /** @docsNotRequired */\n  urlAfterRedirects, /** @docsNotRequired */\n  state) {\n    super(id, url);\n    this.urlAfterRedirects = urlAfterRedirects;\n    this.state = state;\n    this.type = EventType.GuardsCheckStart;\n  }\n  toString() {\n    return `GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`;\n  }\n}\n/**\n * An event triggered at the end of the Guard phase of routing.\n *\n * @see {@link GuardsCheckStart}\n *\n * @publicApi\n */\nclass GuardsCheckEnd extends RouterEvent {\n  constructor( /** @docsNotRequired */\n  id, /** @docsNotRequired */\n  url, /** @docsNotRequired */\n  urlAfterRedirects, /** @docsNotRequired */\n  state, /** @docsNotRequired */\n  shouldActivate) {\n    super(id, url);\n    this.urlAfterRedirects = urlAfterRedirects;\n    this.state = state;\n    this.shouldActivate = shouldActivate;\n    this.type = EventType.GuardsCheckEnd;\n  }\n  toString() {\n    return `GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`;\n  }\n}\n/**\n * An event triggered at the start of the Resolve phase of routing.\n *\n * Runs in the \"resolve\" phase whether or not there is anything to resolve.\n * In future, may change to only run when there are things to be resolved.\n *\n * @see {@link ResolveEnd}\n *\n * @publicApi\n */\nclass ResolveStart extends RouterEvent {\n  constructor( /** @docsNotRequired */\n  id, /** @docsNotRequired */\n  url, /** @docsNotRequired */\n  urlAfterRedirects, /** @docsNotRequired */\n  state) {\n    super(id, url);\n    this.urlAfterRedirects = urlAfterRedirects;\n    this.state = state;\n    this.type = EventType.ResolveStart;\n  }\n  toString() {\n    return `ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`;\n  }\n}\n/**\n * An event triggered at the end of the Resolve phase of routing.\n * @see {@link ResolveStart}\n *\n * @publicApi\n */\nclass ResolveEnd extends RouterEvent {\n  constructor( /** @docsNotRequired */\n  id, /** @docsNotRequired */\n  url, /** @docsNotRequired */\n  urlAfterRedirects, /** @docsNotRequired */\n  state) {\n    super(id, url);\n    this.urlAfterRedirects = urlAfterRedirects;\n    this.state = state;\n    this.type = EventType.ResolveEnd;\n  }\n  toString() {\n    return `ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`;\n  }\n}\n/**\n * An event triggered before lazy loading a route configuration.\n *\n * @see {@link RouteConfigLoadEnd}\n *\n * @publicApi\n */\nclass RouteConfigLoadStart {\n  constructor( /** @docsNotRequired */\n  route) {\n    this.route = route;\n    this.type = EventType.RouteConfigLoadStart;\n  }\n  toString() {\n    return `RouteConfigLoadStart(path: ${this.route.path})`;\n  }\n}\n/**\n * An event triggered when a route has been lazy loaded.\n *\n * @see {@link RouteConfigLoadStart}\n *\n * @publicApi\n */\nclass RouteConfigLoadEnd {\n  constructor( /** @docsNotRequired */\n  route) {\n    this.route = route;\n    this.type = EventType.RouteConfigLoadEnd;\n  }\n  toString() {\n    return `RouteConfigLoadEnd(path: ${this.route.path})`;\n  }\n}\n/**\n * An event triggered at the start of the child-activation\n * part of the Resolve phase of routing.\n * @see {@link ChildActivationEnd}\n * @see {@link ResolveStart}\n *\n * @publicApi\n */\nclass ChildActivationStart {\n  constructor( /** @docsNotRequired */\n  snapshot) {\n    this.snapshot = snapshot;\n    this.type = EventType.ChildActivationStart;\n  }\n  toString() {\n    const path = this.snapshot.routeConfig && this.snapshot.routeConfig.path || '';\n    return `ChildActivationStart(path: '${path}')`;\n  }\n}\n/**\n * An event triggered at the end of the child-activation part\n * of the Resolve phase of routing.\n * @see {@link ChildActivationStart}\n * @see {@link ResolveStart}\n * @publicApi\n */\nclass ChildActivationEnd {\n  constructor( /** @docsNotRequired */\n  snapshot) {\n    this.snapshot = snapshot;\n    this.type = EventType.ChildActivationEnd;\n  }\n  toString() {\n    const path = this.snapshot.routeConfig && this.snapshot.routeConfig.path || '';\n    return `ChildActivationEnd(path: '${path}')`;\n  }\n}\n/**\n * An event triggered at the start of the activation part\n * of the Resolve phase of routing.\n * @see {@link ActivationEnd}\n * @see {@link ResolveStart}\n *\n * @publicApi\n */\nclass ActivationStart {\n  constructor( /** @docsNotRequired */\n  snapshot) {\n    this.snapshot = snapshot;\n    this.type = EventType.ActivationStart;\n  }\n  toString() {\n    const path = this.snapshot.routeConfig && this.snapshot.routeConfig.path || '';\n    return `ActivationStart(path: '${path}')`;\n  }\n}\n/**\n * An event triggered at the end of the activation part\n * of the Resolve phase of routing.\n * @see {@link ActivationStart}\n * @see {@link ResolveStart}\n *\n * @publicApi\n */\nclass ActivationEnd {\n  constructor( /** @docsNotRequired */\n  snapshot) {\n    this.snapshot = snapshot;\n    this.type = EventType.ActivationEnd;\n  }\n  toString() {\n    const path = this.snapshot.routeConfig && this.snapshot.routeConfig.path || '';\n    return `ActivationEnd(path: '${path}')`;\n  }\n}\n/**\n * An event triggered by scrolling.\n *\n * @publicApi\n */\nclass Scroll {\n  constructor( /** @docsNotRequired */\n  routerEvent, /** @docsNotRequired */\n  position, /** @docsNotRequired */\n  anchor) {\n    this.routerEvent = routerEvent;\n    this.position = position;\n    this.anchor = anchor;\n    this.type = EventType.Scroll;\n  }\n  toString() {\n    const pos = this.position ? `${this.position[0]}, ${this.position[1]}` : null;\n    return `Scroll(anchor: '${this.anchor}', position: '${pos}')`;\n  }\n}\nclass BeforeActivateRoutes {}\nclass RedirectRequest {\n  constructor(url) {\n    this.url = url;\n  }\n}\nfunction stringifyEvent(routerEvent) {\n  switch (routerEvent.type) {\n    case EventType.ActivationEnd:\n      return `ActivationEnd(path: '${routerEvent.snapshot.routeConfig?.path || ''}')`;\n    case EventType.ActivationStart:\n      return `ActivationStart(path: '${routerEvent.snapshot.routeConfig?.path || ''}')`;\n    case EventType.ChildActivationEnd:\n      return `ChildActivationEnd(path: '${routerEvent.snapshot.routeConfig?.path || ''}')`;\n    case EventType.ChildActivationStart:\n      return `ChildActivationStart(path: '${routerEvent.snapshot.routeConfig?.path || ''}')`;\n    case EventType.GuardsCheckEnd:\n      return `GuardsCheckEnd(id: ${routerEvent.id}, url: '${routerEvent.url}', urlAfterRedirects: '${routerEvent.urlAfterRedirects}', state: ${routerEvent.state}, shouldActivate: ${routerEvent.shouldActivate})`;\n    case EventType.GuardsCheckStart:\n      return `GuardsCheckStart(id: ${routerEvent.id}, url: '${routerEvent.url}', urlAfterRedirects: '${routerEvent.urlAfterRedirects}', state: ${routerEvent.state})`;\n    case EventType.NavigationCancel:\n      return `NavigationCancel(id: ${routerEvent.id}, url: '${routerEvent.url}')`;\n    case EventType.NavigationSkipped:\n      return `NavigationSkipped(id: ${routerEvent.id}, url: '${routerEvent.url}')`;\n    case EventType.NavigationEnd:\n      return `NavigationEnd(id: ${routerEvent.id}, url: '${routerEvent.url}', urlAfterRedirects: '${routerEvent.urlAfterRedirects}')`;\n    case EventType.NavigationError:\n      return `NavigationError(id: ${routerEvent.id}, url: '${routerEvent.url}', error: ${routerEvent.error})`;\n    case EventType.NavigationStart:\n      return `NavigationStart(id: ${routerEvent.id}, url: '${routerEvent.url}')`;\n    case EventType.ResolveEnd:\n      return `ResolveEnd(id: ${routerEvent.id}, url: '${routerEvent.url}', urlAfterRedirects: '${routerEvent.urlAfterRedirects}', state: ${routerEvent.state})`;\n    case EventType.ResolveStart:\n      return `ResolveStart(id: ${routerEvent.id}, url: '${routerEvent.url}', urlAfterRedirects: '${routerEvent.urlAfterRedirects}', state: ${routerEvent.state})`;\n    case EventType.RouteConfigLoadEnd:\n      return `RouteConfigLoadEnd(path: ${routerEvent.route.path})`;\n    case EventType.RouteConfigLoadStart:\n      return `RouteConfigLoadStart(path: ${routerEvent.route.path})`;\n    case EventType.RoutesRecognized:\n      return `RoutesRecognized(id: ${routerEvent.id}, url: '${routerEvent.url}', urlAfterRedirects: '${routerEvent.urlAfterRedirects}', state: ${routerEvent.state})`;\n    case EventType.Scroll:\n      const pos = routerEvent.position ? `${routerEvent.position[0]}, ${routerEvent.position[1]}` : null;\n      return `Scroll(anchor: '${routerEvent.anchor}', position: '${pos}')`;\n  }\n}\n\n/**\n * Store contextual information about a `RouterOutlet`\n *\n * @publicApi\n */\nclass OutletContext {\n  constructor() {\n    this.outlet = null;\n    this.route = null;\n    this.injector = null;\n    this.children = new ChildrenOutletContexts();\n    this.attachRef = null;\n  }\n}\n/**\n * Store contextual information about the children (= nested) `RouterOutlet`\n *\n * @publicApi\n */\nlet ChildrenOutletContexts = /*#__PURE__*/(() => {\n  class ChildrenOutletContexts {\n    constructor() {\n      // contexts for child outlets, by name.\n      this.contexts = new Map();\n    }\n    /** Called when a `RouterOutlet` directive is instantiated */\n    onChildOutletCreated(childName, outlet) {\n      const context = this.getOrCreateContext(childName);\n      context.outlet = outlet;\n      this.contexts.set(childName, context);\n    }\n    /**\n     * Called when a `RouterOutlet` directive is destroyed.\n     * We need to keep the context as the outlet could be destroyed inside a NgIf and might be\n     * re-created later.\n     */\n    onChildOutletDestroyed(childName) {\n      const context = this.getContext(childName);\n      if (context) {\n        context.outlet = null;\n        context.attachRef = null;\n      }\n    }\n    /**\n     * Called when the corresponding route is deactivated during navigation.\n     * Because the component get destroyed, all children outlet are destroyed.\n     */\n    onOutletDeactivated() {\n      const contexts = this.contexts;\n      this.contexts = new Map();\n      return contexts;\n    }\n    onOutletReAttached(contexts) {\n      this.contexts = contexts;\n    }\n    getOrCreateContext(childName) {\n      let context = this.getContext(childName);\n      if (!context) {\n        context = new OutletContext();\n        this.contexts.set(childName, context);\n      }\n      return context;\n    }\n    getContext(childName) {\n      return this.contexts.get(childName) || null;\n    }\n    static {\n      this.ɵfac = function ChildrenOutletContexts_Factory(t) {\n        return new (t || ChildrenOutletContexts)();\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: ChildrenOutletContexts,\n        factory: ChildrenOutletContexts.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return ChildrenOutletContexts;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nclass Tree {\n  constructor(root) {\n    this._root = root;\n  }\n  get root() {\n    return this._root.value;\n  }\n  /**\n   * @internal\n   */\n  parent(t) {\n    const p = this.pathFromRoot(t);\n    return p.length > 1 ? p[p.length - 2] : null;\n  }\n  /**\n   * @internal\n   */\n  children(t) {\n    const n = findNode(t, this._root);\n    return n ? n.children.map(t => t.value) : [];\n  }\n  /**\n   * @internal\n   */\n  firstChild(t) {\n    const n = findNode(t, this._root);\n    return n && n.children.length > 0 ? n.children[0].value : null;\n  }\n  /**\n   * @internal\n   */\n  siblings(t) {\n    const p = findPath(t, this._root);\n    if (p.length < 2) return [];\n    const c = p[p.length - 2].children.map(c => c.value);\n    return c.filter(cc => cc !== t);\n  }\n  /**\n   * @internal\n   */\n  pathFromRoot(t) {\n    return findPath(t, this._root).map(s => s.value);\n  }\n}\n// DFS for the node matching the value\nfunction findNode(value, node) {\n  if (value === node.value) return node;\n  for (const child of node.children) {\n    const node = findNode(value, child);\n    if (node) return node;\n  }\n  return null;\n}\n// Return the path to the node with the given value using DFS\nfunction findPath(value, node) {\n  if (value === node.value) return [node];\n  for (const child of node.children) {\n    const path = findPath(value, child);\n    if (path.length) {\n      path.unshift(node);\n      return path;\n    }\n  }\n  return [];\n}\nclass TreeNode {\n  constructor(value, children) {\n    this.value = value;\n    this.children = children;\n  }\n  toString() {\n    return `TreeNode(${this.value})`;\n  }\n}\n// Return the list of T indexed by outlet name\nfunction nodeChildrenAsMap(node) {\n  const map = {};\n  if (node) {\n    node.children.forEach(child => map[child.value.outlet] = child);\n  }\n  return map;\n}\n\n/**\n * Represents the state of the router as a tree of activated routes.\n *\n * @usageNotes\n *\n * Every node in the route tree is an `ActivatedRoute` instance\n * that knows about the \"consumed\" URL segments, the extracted parameters,\n * and the resolved data.\n * Use the `ActivatedRoute` properties to traverse the tree from any node.\n *\n * The following fragment shows how a component gets the root node\n * of the current state to establish its own route tree:\n *\n * ```\n * @Component({templateUrl:'template.html'})\n * class MyComponent {\n *   constructor(router: Router) {\n *     const state: RouterState = router.routerState;\n *     const root: ActivatedRoute = state.root;\n *     const child = root.firstChild;\n *     const id: Observable<string> = child.params.map(p => p.id);\n *     //...\n *   }\n * }\n * ```\n *\n * @see {@link ActivatedRoute}\n * @see [Getting route information](guide/router#getting-route-information)\n *\n * @publicApi\n */\nclass RouterState extends Tree {\n  /** @internal */\n  constructor(root, /** The current snapshot of the router state */\n  snapshot) {\n    super(root);\n    this.snapshot = snapshot;\n    setRouterState(this, root);\n  }\n  toString() {\n    return this.snapshot.toString();\n  }\n}\nfunction createEmptyState(rootComponent) {\n  const snapshot = createEmptyStateSnapshot(rootComponent);\n  const emptyUrl = new BehaviorSubject([new UrlSegment('', {})]);\n  const emptyParams = new BehaviorSubject({});\n  const emptyData = new BehaviorSubject({});\n  const emptyQueryParams = new BehaviorSubject({});\n  const fragment = new BehaviorSubject('');\n  const activated = new ActivatedRoute(emptyUrl, emptyParams, emptyQueryParams, fragment, emptyData, PRIMARY_OUTLET, rootComponent, snapshot.root);\n  activated.snapshot = snapshot.root;\n  return new RouterState(new TreeNode(activated, []), snapshot);\n}\nfunction createEmptyStateSnapshot(rootComponent) {\n  const emptyParams = {};\n  const emptyData = {};\n  const emptyQueryParams = {};\n  const fragment = '';\n  const activated = new ActivatedRouteSnapshot([], emptyParams, emptyQueryParams, fragment, emptyData, PRIMARY_OUTLET, rootComponent, null, {});\n  return new RouterStateSnapshot('', new TreeNode(activated, []));\n}\n/**\n * Provides access to information about a route associated with a component\n * that is loaded in an outlet.\n * Use to traverse the `RouterState` tree and extract information from nodes.\n *\n * The following example shows how to construct a component using information from a\n * currently activated route.\n *\n * Note: the observables in this class only emit when the current and previous values differ based\n * on shallow equality. For example, changing deeply nested properties in resolved `data` will not\n * cause the `ActivatedRoute.data` `Observable` to emit a new value.\n *\n * {@example router/activated-route/module.ts region=\"activated-route\"\n *     header=\"activated-route.component.ts\"}\n *\n * @see [Getting route information](guide/router#getting-route-information)\n *\n * @publicApi\n */\nclass ActivatedRoute {\n  /** @internal */\n  constructor( /** @internal */\n  urlSubject, /** @internal */\n  paramsSubject, /** @internal */\n  queryParamsSubject, /** @internal */\n  fragmentSubject, /** @internal */\n  dataSubject, /** The outlet name of the route, a constant. */\n  outlet, /** The component of the route, a constant. */\n  component, futureSnapshot) {\n    this.urlSubject = urlSubject;\n    this.paramsSubject = paramsSubject;\n    this.queryParamsSubject = queryParamsSubject;\n    this.fragmentSubject = fragmentSubject;\n    this.dataSubject = dataSubject;\n    this.outlet = outlet;\n    this.component = component;\n    this._futureSnapshot = futureSnapshot;\n    this.title = this.dataSubject?.pipe(map(d => d[RouteTitleKey])) ?? of(undefined);\n    // TODO(atscott): Verify that these can be changed to `.asObservable()` with TGP.\n    this.url = urlSubject;\n    this.params = paramsSubject;\n    this.queryParams = queryParamsSubject;\n    this.fragment = fragmentSubject;\n    this.data = dataSubject;\n  }\n  /** The configuration used to match this route. */\n  get routeConfig() {\n    return this._futureSnapshot.routeConfig;\n  }\n  /** The root of the router state. */\n  get root() {\n    return this._routerState.root;\n  }\n  /** The parent of this route in the router state tree. */\n  get parent() {\n    return this._routerState.parent(this);\n  }\n  /** The first child of this route in the router state tree. */\n  get firstChild() {\n    return this._routerState.firstChild(this);\n  }\n  /** The children of this route in the router state tree. */\n  get children() {\n    return this._routerState.children(this);\n  }\n  /** The path from the root of the router state tree to this route. */\n  get pathFromRoot() {\n    return this._routerState.pathFromRoot(this);\n  }\n  /**\n   * An Observable that contains a map of the required and optional parameters\n   * specific to the route.\n   * The map supports retrieving single and multiple values from the same parameter.\n   */\n  get paramMap() {\n    this._paramMap ??= this.params.pipe(map(p => convertToParamMap(p)));\n    return this._paramMap;\n  }\n  /**\n   * An Observable that contains a map of the query parameters available to all routes.\n   * The map supports retrieving single and multiple values from the query parameter.\n   */\n  get queryParamMap() {\n    this._queryParamMap ??= this.queryParams.pipe(map(p => convertToParamMap(p)));\n    return this._queryParamMap;\n  }\n  toString() {\n    return this.snapshot ? this.snapshot.toString() : `Future(${this._futureSnapshot})`;\n  }\n}\n/**\n * Returns the inherited params, data, and resolve for a given route.\n *\n * By default, we do not inherit parent data unless the current route is path-less or the parent\n * route is component-less.\n */\nfunction getInherited(route, parent, paramsInheritanceStrategy = 'emptyOnly') {\n  let inherited;\n  const {\n    routeConfig\n  } = route;\n  if (parent !== null && (paramsInheritanceStrategy === 'always' ||\n  // inherit parent data if route is empty path\n  routeConfig?.path === '' ||\n  // inherit parent data if parent was componentless\n  !parent.component && !parent.routeConfig?.loadComponent)) {\n    inherited = {\n      params: {\n        ...parent.params,\n        ...route.params\n      },\n      data: {\n        ...parent.data,\n        ...route.data\n      },\n      resolve: {\n        // Snapshots are created with data inherited from parent and guards (i.e. canActivate) can\n        // change data because it's not frozen...\n        // This first line could be deleted chose to break/disallow mutating the `data` object in\n        // guards.\n        // Note that data from parents still override this mutated data so anyone relying on this\n        // might be surprised that it doesn't work if parent data is inherited but otherwise does.\n        ...route.data,\n        // Ensure inherited resolved data overrides inherited static data\n        ...parent.data,\n        // static data from the current route overrides any inherited data\n        ...routeConfig?.data,\n        // resolved data from current route overrides everything\n        ...route._resolvedData\n      }\n    };\n  } else {\n    inherited = {\n      params: {\n        ...route.params\n      },\n      data: {\n        ...route.data\n      },\n      resolve: {\n        ...route.data,\n        ...(route._resolvedData ?? {})\n      }\n    };\n  }\n  if (routeConfig && hasStaticTitle(routeConfig)) {\n    inherited.resolve[RouteTitleKey] = routeConfig.title;\n  }\n  return inherited;\n}\n/**\n * @description\n *\n * Contains the information about a route associated with a component loaded in an\n * outlet at a particular moment in time. ActivatedRouteSnapshot can also be used to\n * traverse the router state tree.\n *\n * The following example initializes a component with route information extracted\n * from the snapshot of the root node at the time of creation.\n *\n * ```\n * @Component({templateUrl:'./my-component.html'})\n * class MyComponent {\n *   constructor(route: ActivatedRoute) {\n *     const id: string = route.snapshot.params.id;\n *     const url: string = route.snapshot.url.join('');\n *     const user = route.snapshot.data.user;\n *   }\n * }\n * ```\n *\n * @publicApi\n */\nclass ActivatedRouteSnapshot {\n  /** The resolved route title */\n  get title() {\n    // Note: This _must_ be a getter because the data is mutated in the resolvers. Title will not be\n    // available at the time of class instantiation.\n    return this.data?.[RouteTitleKey];\n  }\n  /** @internal */\n  constructor( /** The URL segments matched by this route */\n  url,\n  /**\n   *  The matrix parameters scoped to this route.\n   *\n   *  You can compute all params (or data) in the router state or to get params outside\n   *  of an activated component by traversing the `RouterState` tree as in the following\n   *  example:\n   *  ```\n   *  collectRouteParams(router: Router) {\n   *    let params = {};\n   *    let stack: ActivatedRouteSnapshot[] = [router.routerState.snapshot.root];\n   *    while (stack.length > 0) {\n   *      const route = stack.pop()!;\n   *      params = {...params, ...route.params};\n   *      stack.push(...route.children);\n   *    }\n   *    return params;\n   *  }\n   *  ```\n   */\n  params, /** The query parameters shared by all the routes */\n  queryParams, /** The URL fragment shared by all the routes */\n  fragment, /** The static and resolved data of this route */\n  data, /** The outlet name of the route */\n  outlet, /** The component of the route */\n  component, routeConfig, resolve) {\n    this.url = url;\n    this.params = params;\n    this.queryParams = queryParams;\n    this.fragment = fragment;\n    this.data = data;\n    this.outlet = outlet;\n    this.component = component;\n    this.routeConfig = routeConfig;\n    this._resolve = resolve;\n  }\n  /** The root of the router state */\n  get root() {\n    return this._routerState.root;\n  }\n  /** The parent of this route in the router state tree */\n  get parent() {\n    return this._routerState.parent(this);\n  }\n  /** The first child of this route in the router state tree */\n  get firstChild() {\n    return this._routerState.firstChild(this);\n  }\n  /** The children of this route in the router state tree */\n  get children() {\n    return this._routerState.children(this);\n  }\n  /** The path from the root of the router state tree to this route */\n  get pathFromRoot() {\n    return this._routerState.pathFromRoot(this);\n  }\n  get paramMap() {\n    this._paramMap ??= convertToParamMap(this.params);\n    return this._paramMap;\n  }\n  get queryParamMap() {\n    this._queryParamMap ??= convertToParamMap(this.queryParams);\n    return this._queryParamMap;\n  }\n  toString() {\n    const url = this.url.map(segment => segment.toString()).join('/');\n    const matched = this.routeConfig ? this.routeConfig.path : '';\n    return `Route(url:'${url}', path:'${matched}')`;\n  }\n}\n/**\n * @description\n *\n * Represents the state of the router at a moment in time.\n *\n * This is a tree of activated route snapshots. Every node in this tree knows about\n * the \"consumed\" URL segments, the extracted parameters, and the resolved data.\n *\n * The following example shows how a component is initialized with information\n * from the snapshot of the root node's state at the time of creation.\n *\n * ```\n * @Component({templateUrl:'template.html'})\n * class MyComponent {\n *   constructor(router: Router) {\n *     const state: RouterState = router.routerState;\n *     const snapshot: RouterStateSnapshot = state.snapshot;\n *     const root: ActivatedRouteSnapshot = snapshot.root;\n *     const child = root.firstChild;\n *     const id: Observable<string> = child.params.map(p => p.id);\n *     //...\n *   }\n * }\n * ```\n *\n * @publicApi\n */\nclass RouterStateSnapshot extends Tree {\n  /** @internal */\n  constructor( /** The url from which this snapshot was created */\n  url, root) {\n    super(root);\n    this.url = url;\n    setRouterState(this, root);\n  }\n  toString() {\n    return serializeNode(this._root);\n  }\n}\nfunction setRouterState(state, node) {\n  node.value._routerState = state;\n  node.children.forEach(c => setRouterState(state, c));\n}\nfunction serializeNode(node) {\n  const c = node.children.length > 0 ? ` { ${node.children.map(serializeNode).join(', ')} } ` : '';\n  return `${node.value}${c}`;\n}\n/**\n * The expectation is that the activate route is created with the right set of parameters.\n * So we push new values into the observables only when they are not the initial values.\n * And we detect that by checking if the snapshot field is set.\n */\nfunction advanceActivatedRoute(route) {\n  if (route.snapshot) {\n    const currentSnapshot = route.snapshot;\n    const nextSnapshot = route._futureSnapshot;\n    route.snapshot = nextSnapshot;\n    if (!shallowEqual(currentSnapshot.queryParams, nextSnapshot.queryParams)) {\n      route.queryParamsSubject.next(nextSnapshot.queryParams);\n    }\n    if (currentSnapshot.fragment !== nextSnapshot.fragment) {\n      route.fragmentSubject.next(nextSnapshot.fragment);\n    }\n    if (!shallowEqual(currentSnapshot.params, nextSnapshot.params)) {\n      route.paramsSubject.next(nextSnapshot.params);\n    }\n    if (!shallowEqualArrays(currentSnapshot.url, nextSnapshot.url)) {\n      route.urlSubject.next(nextSnapshot.url);\n    }\n    if (!shallowEqual(currentSnapshot.data, nextSnapshot.data)) {\n      route.dataSubject.next(nextSnapshot.data);\n    }\n  } else {\n    route.snapshot = route._futureSnapshot;\n    // this is for resolved data\n    route.dataSubject.next(route._futureSnapshot.data);\n  }\n}\nfunction equalParamsAndUrlSegments(a, b) {\n  const equalUrlParams = shallowEqual(a.params, b.params) && equalSegments(a.url, b.url);\n  const parentsMismatch = !a.parent !== !b.parent;\n  return equalUrlParams && !parentsMismatch && (!a.parent || equalParamsAndUrlSegments(a.parent, b.parent));\n}\nfunction hasStaticTitle(config) {\n  return typeof config.title === 'string' || config.title === null;\n}\n\n/**\n * @description\n *\n * Acts as a placeholder that Angular dynamically fills based on the current router state.\n *\n * Each outlet can have a unique name, determined by the optional `name` attribute.\n * The name cannot be set or changed dynamically. If not set, default value is \"primary\".\n *\n * ```\n * <router-outlet></router-outlet>\n * <router-outlet name='left'></router-outlet>\n * <router-outlet name='right'></router-outlet>\n * ```\n *\n * Named outlets can be the targets of secondary routes.\n * The `Route` object for a secondary route has an `outlet` property to identify the target outlet:\n *\n * `{path: <base-path>, component: <component>, outlet: <target_outlet_name>}`\n *\n * Using named outlets and secondary routes, you can target multiple outlets in\n * the same `RouterLink` directive.\n *\n * The router keeps track of separate branches in a navigation tree for each named outlet and\n * generates a representation of that tree in the URL.\n * The URL for a secondary route uses the following syntax to specify both the primary and secondary\n * routes at the same time:\n *\n * `http://base-path/primary-route-path(outlet-name:route-path)`\n *\n * A router outlet emits an activate event when a new component is instantiated,\n * deactivate event when a component is destroyed.\n * An attached event emits when the `RouteReuseStrategy` instructs the outlet to reattach the\n * subtree, and the detached event emits when the `RouteReuseStrategy` instructs the outlet to\n * detach the subtree.\n *\n * ```\n * <router-outlet\n *   (activate)='onActivate($event)'\n *   (deactivate)='onDeactivate($event)'\n *   (attach)='onAttach($event)'\n *   (detach)='onDetach($event)'></router-outlet>\n * ```\n *\n * @see [Routing tutorial](guide/router-tutorial-toh#named-outlets \"Example of a named\n * outlet and secondary route configuration\").\n * @see {@link RouterLink}\n * @see {@link Route}\n * @ngModule RouterModule\n *\n * @publicApi\n */\nlet RouterOutlet = /*#__PURE__*/(() => {\n  class RouterOutlet {\n    constructor() {\n      this.activated = null;\n      this._activatedRoute = null;\n      /**\n       * The name of the outlet\n       *\n       * @see [named outlets](guide/router-tutorial-toh#displaying-multiple-routes-in-named-outlets)\n       */\n      this.name = PRIMARY_OUTLET;\n      this.activateEvents = new EventEmitter();\n      this.deactivateEvents = new EventEmitter();\n      /**\n       * Emits an attached component instance when the `RouteReuseStrategy` instructs to re-attach a\n       * previously detached subtree.\n       **/\n      this.attachEvents = new EventEmitter();\n      /**\n       * Emits a detached component instance when the `RouteReuseStrategy` instructs to detach the\n       * subtree.\n       */\n      this.detachEvents = new EventEmitter();\n      this.parentContexts = inject(ChildrenOutletContexts);\n      this.location = inject(ViewContainerRef);\n      this.changeDetector = inject(ChangeDetectorRef);\n      this.environmentInjector = inject(EnvironmentInjector);\n      this.inputBinder = inject(INPUT_BINDER, {\n        optional: true\n      });\n      /** @nodoc */\n      this.supportsBindingToComponentInputs = true;\n    }\n    /** @internal */\n    get activatedComponentRef() {\n      return this.activated;\n    }\n    /** @nodoc */\n    ngOnChanges(changes) {\n      if (changes['name']) {\n        const {\n          firstChange,\n          previousValue\n        } = changes['name'];\n        if (firstChange) {\n          // The first change is handled by ngOnInit. Because ngOnChanges doesn't get called when no\n          // input is set at all, we need to centrally handle the first change there.\n          return;\n        }\n        // unregister with the old name\n        if (this.isTrackedInParentContexts(previousValue)) {\n          this.deactivate();\n          this.parentContexts.onChildOutletDestroyed(previousValue);\n        }\n        // register the new name\n        this.initializeOutletWithName();\n      }\n    }\n    /** @nodoc */\n    ngOnDestroy() {\n      // Ensure that the registered outlet is this one before removing it on the context.\n      if (this.isTrackedInParentContexts(this.name)) {\n        this.parentContexts.onChildOutletDestroyed(this.name);\n      }\n      this.inputBinder?.unsubscribeFromRouteData(this);\n    }\n    isTrackedInParentContexts(outletName) {\n      return this.parentContexts.getContext(outletName)?.outlet === this;\n    }\n    /** @nodoc */\n    ngOnInit() {\n      this.initializeOutletWithName();\n    }\n    initializeOutletWithName() {\n      this.parentContexts.onChildOutletCreated(this.name, this);\n      if (this.activated) {\n        return;\n      }\n      // If the outlet was not instantiated at the time the route got activated we need to populate\n      // the outlet when it is initialized (ie inside a NgIf)\n      const context = this.parentContexts.getContext(this.name);\n      if (context?.route) {\n        if (context.attachRef) {\n          // `attachRef` is populated when there is an existing component to mount\n          this.attach(context.attachRef, context.route);\n        } else {\n          // otherwise the component defined in the configuration is created\n          this.activateWith(context.route, context.injector);\n        }\n      }\n    }\n    get isActivated() {\n      return !!this.activated;\n    }\n    /**\n     * @returns The currently activated component instance.\n     * @throws An error if the outlet is not activated.\n     */\n    get component() {\n      if (!this.activated) throw new ɵRuntimeError(4012 /* RuntimeErrorCode.OUTLET_NOT_ACTIVATED */, (typeof ngDevMode === 'undefined' || ngDevMode) && 'Outlet is not activated');\n      return this.activated.instance;\n    }\n    get activatedRoute() {\n      if (!this.activated) throw new ɵRuntimeError(4012 /* RuntimeErrorCode.OUTLET_NOT_ACTIVATED */, (typeof ngDevMode === 'undefined' || ngDevMode) && 'Outlet is not activated');\n      return this._activatedRoute;\n    }\n    get activatedRouteData() {\n      if (this._activatedRoute) {\n        return this._activatedRoute.snapshot.data;\n      }\n      return {};\n    }\n    /**\n     * Called when the `RouteReuseStrategy` instructs to detach the subtree\n     */\n    detach() {\n      if (!this.activated) throw new ɵRuntimeError(4012 /* RuntimeErrorCode.OUTLET_NOT_ACTIVATED */, (typeof ngDevMode === 'undefined' || ngDevMode) && 'Outlet is not activated');\n      this.location.detach();\n      const cmp = this.activated;\n      this.activated = null;\n      this._activatedRoute = null;\n      this.detachEvents.emit(cmp.instance);\n      return cmp;\n    }\n    /**\n     * Called when the `RouteReuseStrategy` instructs to re-attach a previously detached subtree\n     */\n    attach(ref, activatedRoute) {\n      this.activated = ref;\n      this._activatedRoute = activatedRoute;\n      this.location.insert(ref.hostView);\n      this.inputBinder?.bindActivatedRouteToOutletComponent(this);\n      this.attachEvents.emit(ref.instance);\n    }\n    deactivate() {\n      if (this.activated) {\n        const c = this.component;\n        this.activated.destroy();\n        this.activated = null;\n        this._activatedRoute = null;\n        this.deactivateEvents.emit(c);\n      }\n    }\n    activateWith(activatedRoute, environmentInjector) {\n      if (this.isActivated) {\n        throw new ɵRuntimeError(4013 /* RuntimeErrorCode.OUTLET_ALREADY_ACTIVATED */, (typeof ngDevMode === 'undefined' || ngDevMode) && 'Cannot activate an already activated outlet');\n      }\n      this._activatedRoute = activatedRoute;\n      const location = this.location;\n      const snapshot = activatedRoute.snapshot;\n      const component = snapshot.component;\n      const childContexts = this.parentContexts.getOrCreateContext(this.name).children;\n      const injector = new OutletInjector(activatedRoute, childContexts, location.injector);\n      this.activated = location.createComponent(component, {\n        index: location.length,\n        injector,\n        environmentInjector: environmentInjector ?? this.environmentInjector\n      });\n      // Calling `markForCheck` to make sure we will run the change detection when the\n      // `RouterOutlet` is inside a `ChangeDetectionStrategy.OnPush` component.\n      this.changeDetector.markForCheck();\n      this.inputBinder?.bindActivatedRouteToOutletComponent(this);\n      this.activateEvents.emit(this.activated.instance);\n    }\n    static {\n      this.ɵfac = function RouterOutlet_Factory(t) {\n        return new (t || RouterOutlet)();\n      };\n    }\n    static {\n      this.ɵdir = /* @__PURE__ */i0.ɵɵdefineDirective({\n        type: RouterOutlet,\n        selectors: [[\"router-outlet\"]],\n        inputs: {\n          name: \"name\"\n        },\n        outputs: {\n          activateEvents: \"activate\",\n          deactivateEvents: \"deactivate\",\n          attachEvents: \"attach\",\n          detachEvents: \"detach\"\n        },\n        exportAs: [\"outlet\"],\n        standalone: true,\n        features: [i0.ɵɵNgOnChangesFeature]\n      });\n    }\n  }\n  return RouterOutlet;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nclass OutletInjector {\n  constructor(route, childContexts, parent) {\n    this.route = route;\n    this.childContexts = childContexts;\n    this.parent = parent;\n  }\n  get(token, notFoundValue) {\n    if (token === ActivatedRoute) {\n      return this.route;\n    }\n    if (token === ChildrenOutletContexts) {\n      return this.childContexts;\n    }\n    return this.parent.get(token, notFoundValue);\n  }\n}\nconst INPUT_BINDER = /*#__PURE__*/new InjectionToken('');\n/**\n * Injectable used as a tree-shakable provider for opting in to binding router data to component\n * inputs.\n *\n * The RouterOutlet registers itself with this service when an `ActivatedRoute` is attached or\n * activated. When this happens, the service subscribes to the `ActivatedRoute` observables (params,\n * queryParams, data) and sets the inputs of the component using `ComponentRef.setInput`.\n * Importantly, when an input does not have an item in the route data with a matching key, this\n * input is set to `undefined`. If it were not done this way, the previous information would be\n * retained if the data got removed from the route (i.e. if a query parameter is removed).\n *\n * The `RouterOutlet` should unregister itself when destroyed via `unsubscribeFromRouteData` so that\n * the subscriptions are cleaned up.\n */\nlet RoutedComponentInputBinder = /*#__PURE__*/(() => {\n  class RoutedComponentInputBinder {\n    constructor() {\n      this.outletDataSubscriptions = new Map();\n    }\n    bindActivatedRouteToOutletComponent(outlet) {\n      this.unsubscribeFromRouteData(outlet);\n      this.subscribeToRouteData(outlet);\n    }\n    unsubscribeFromRouteData(outlet) {\n      this.outletDataSubscriptions.get(outlet)?.unsubscribe();\n      this.outletDataSubscriptions.delete(outlet);\n    }\n    subscribeToRouteData(outlet) {\n      const {\n        activatedRoute\n      } = outlet;\n      const dataSubscription = combineLatest([activatedRoute.queryParams, activatedRoute.params, activatedRoute.data]).pipe(switchMap(([queryParams, params, data], index) => {\n        data = {\n          ...queryParams,\n          ...params,\n          ...data\n        };\n        // Get the first result from the data subscription synchronously so it's available to\n        // the component as soon as possible (and doesn't require a second change detection).\n        if (index === 0) {\n          return of(data);\n        }\n        // Promise.resolve is used to avoid synchronously writing the wrong data when\n        // two of the Observables in the `combineLatest` stream emit one after\n        // another.\n        return Promise.resolve(data);\n      })).subscribe(data => {\n        // Outlet may have been deactivated or changed names to be associated with a different\n        // route\n        if (!outlet.isActivated || !outlet.activatedComponentRef || outlet.activatedRoute !== activatedRoute || activatedRoute.component === null) {\n          this.unsubscribeFromRouteData(outlet);\n          return;\n        }\n        const mirror = reflectComponentType(activatedRoute.component);\n        if (!mirror) {\n          this.unsubscribeFromRouteData(outlet);\n          return;\n        }\n        for (const {\n          templateName\n        } of mirror.inputs) {\n          outlet.activatedComponentRef.setInput(templateName, data[templateName]);\n        }\n      });\n      this.outletDataSubscriptions.set(outlet, dataSubscription);\n    }\n    static {\n      this.ɵfac = function RoutedComponentInputBinder_Factory(t) {\n        return new (t || RoutedComponentInputBinder)();\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: RoutedComponentInputBinder,\n        factory: RoutedComponentInputBinder.ɵfac\n      });\n    }\n  }\n  return RoutedComponentInputBinder;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nfunction createRouterState(routeReuseStrategy, curr, prevState) {\n  const root = createNode(routeReuseStrategy, curr._root, prevState ? prevState._root : undefined);\n  return new RouterState(root, curr);\n}\nfunction createNode(routeReuseStrategy, curr, prevState) {\n  // reuse an activated route that is currently displayed on the screen\n  if (prevState && routeReuseStrategy.shouldReuseRoute(curr.value, prevState.value.snapshot)) {\n    const value = prevState.value;\n    value._futureSnapshot = curr.value;\n    const children = createOrReuseChildren(routeReuseStrategy, curr, prevState);\n    return new TreeNode(value, children);\n  } else {\n    if (routeReuseStrategy.shouldAttach(curr.value)) {\n      // retrieve an activated route that is used to be displayed, but is not currently displayed\n      const detachedRouteHandle = routeReuseStrategy.retrieve(curr.value);\n      if (detachedRouteHandle !== null) {\n        const tree = detachedRouteHandle.route;\n        tree.value._futureSnapshot = curr.value;\n        tree.children = curr.children.map(c => createNode(routeReuseStrategy, c));\n        return tree;\n      }\n    }\n    const value = createActivatedRoute(curr.value);\n    const children = curr.children.map(c => createNode(routeReuseStrategy, c));\n    return new TreeNode(value, children);\n  }\n}\nfunction createOrReuseChildren(routeReuseStrategy, curr, prevState) {\n  return curr.children.map(child => {\n    for (const p of prevState.children) {\n      if (routeReuseStrategy.shouldReuseRoute(child.value, p.value.snapshot)) {\n        return createNode(routeReuseStrategy, child, p);\n      }\n    }\n    return createNode(routeReuseStrategy, child);\n  });\n}\nfunction createActivatedRoute(c) {\n  return new ActivatedRoute(new BehaviorSubject(c.url), new BehaviorSubject(c.params), new BehaviorSubject(c.queryParams), new BehaviorSubject(c.fragment), new BehaviorSubject(c.data), c.outlet, c.component, c);\n}\nconst NAVIGATION_CANCELING_ERROR = 'ngNavigationCancelingError';\nfunction redirectingNavigationError(urlSerializer, redirect) {\n  const {\n    redirectTo,\n    navigationBehaviorOptions\n  } = isUrlTree(redirect) ? {\n    redirectTo: redirect,\n    navigationBehaviorOptions: undefined\n  } : redirect;\n  const error = navigationCancelingError(ngDevMode && `Redirecting to \"${urlSerializer.serialize(redirectTo)}\"`, NavigationCancellationCode.Redirect);\n  error.url = redirectTo;\n  error.navigationBehaviorOptions = navigationBehaviorOptions;\n  return error;\n}\nfunction navigationCancelingError(message, code) {\n  const error = new Error(`NavigationCancelingError: ${message || ''}`);\n  error[NAVIGATION_CANCELING_ERROR] = true;\n  error.cancellationCode = code;\n  return error;\n}\nfunction isRedirectingNavigationCancelingError(error) {\n  return isNavigationCancelingError(error) && isUrlTree(error.url);\n}\nfunction isNavigationCancelingError(error) {\n  return !!error && error[NAVIGATION_CANCELING_ERROR];\n}\n\n/**\n * This component is used internally within the router to be a placeholder when an empty\n * router-outlet is needed. For example, with a config such as:\n *\n * `{path: 'parent', outlet: 'nav', children: [...]}`\n *\n * In order to render, there needs to be a component on this config, which will default\n * to this `EmptyOutletComponent`.\n */\nlet ɵEmptyOutletComponent = /*#__PURE__*/(() => {\n  class ɵEmptyOutletComponent {\n    static {\n      this.ɵfac = function ɵEmptyOutletComponent_Factory(t) {\n        return new (t || ɵEmptyOutletComponent)();\n      };\n    }\n    static {\n      this.ɵcmp = /* @__PURE__ */i0.ɵɵdefineComponent({\n        type: ɵEmptyOutletComponent,\n        selectors: [[\"ng-component\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 1,\n        vars: 0,\n        template: function _EmptyOutletComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelement(0, \"router-outlet\");\n          }\n        },\n        dependencies: [RouterOutlet],\n        encapsulation: 2\n      });\n    }\n  }\n  return ɵEmptyOutletComponent;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n/**\n * Creates an `EnvironmentInjector` if the `Route` has providers and one does not already exist\n * and returns the injector. Otherwise, if the `Route` does not have `providers`, returns the\n * `currentInjector`.\n *\n * @param route The route that might have providers\n * @param currentInjector The parent injector of the `Route`\n */\nfunction getOrCreateRouteInjectorIfNeeded(route, currentInjector) {\n  if (route.providers && !route._injector) {\n    route._injector = createEnvironmentInjector(route.providers, currentInjector, `Route: ${route.path}`);\n  }\n  return route._injector ?? currentInjector;\n}\nfunction getLoadedRoutes(route) {\n  return route._loadedRoutes;\n}\nfunction getLoadedInjector(route) {\n  return route._loadedInjector;\n}\nfunction getLoadedComponent(route) {\n  return route._loadedComponent;\n}\nfunction getProvidersInjector(route) {\n  return route._injector;\n}\nfunction validateConfig(config, parentPath = '', requireStandaloneComponents = false) {\n  // forEach doesn't iterate undefined values\n  for (let i = 0; i < config.length; i++) {\n    const route = config[i];\n    const fullPath = getFullPath(parentPath, route);\n    validateNode(route, fullPath, requireStandaloneComponents);\n  }\n}\nfunction assertStandalone(fullPath, component) {\n  if (component && ɵisNgModule(component)) {\n    throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `Invalid configuration of route '${fullPath}'. You are using 'loadComponent' with a module, ` + `but it must be used with standalone components. Use 'loadChildren' instead.`);\n  } else if (component && !isStandalone(component)) {\n    throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `Invalid configuration of route '${fullPath}'. The component must be standalone.`);\n  }\n}\nfunction validateNode(route, fullPath, requireStandaloneComponents) {\n  if (typeof ngDevMode === 'undefined' || ngDevMode) {\n    if (!route) {\n      throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `\n      Invalid configuration of route '${fullPath}': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    `);\n    }\n    if (Array.isArray(route)) {\n      throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `Invalid configuration of route '${fullPath}': Array cannot be specified`);\n    }\n    if (!route.redirectTo && !route.component && !route.loadComponent && !route.children && !route.loadChildren && route.outlet && route.outlet !== PRIMARY_OUTLET) {\n      throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `Invalid configuration of route '${fullPath}': a componentless route without children or loadChildren cannot have a named outlet set`);\n    }\n    if (route.redirectTo && route.children) {\n      throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `Invalid configuration of route '${fullPath}': redirectTo and children cannot be used together`);\n    }\n    if (route.redirectTo && route.loadChildren) {\n      throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `Invalid configuration of route '${fullPath}': redirectTo and loadChildren cannot be used together`);\n    }\n    if (route.children && route.loadChildren) {\n      throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `Invalid configuration of route '${fullPath}': children and loadChildren cannot be used together`);\n    }\n    if (route.redirectTo && (route.component || route.loadComponent)) {\n      throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `Invalid configuration of route '${fullPath}': redirectTo and component/loadComponent cannot be used together`);\n    }\n    if (route.component && route.loadComponent) {\n      throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `Invalid configuration of route '${fullPath}': component and loadComponent cannot be used together`);\n    }\n    if (route.redirectTo && route.canActivate) {\n      throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `Invalid configuration of route '${fullPath}': redirectTo and canActivate cannot be used together. Redirects happen before activation ` + `so canActivate will never be executed.`);\n    }\n    if (route.path && route.matcher) {\n      throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `Invalid configuration of route '${fullPath}': path and matcher cannot be used together`);\n    }\n    if (route.redirectTo === void 0 && !route.component && !route.loadComponent && !route.children && !route.loadChildren) {\n      throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `Invalid configuration of route '${fullPath}'. One of the following must be provided: component, loadComponent, redirectTo, children or loadChildren`);\n    }\n    if (route.path === void 0 && route.matcher === void 0) {\n      throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `Invalid configuration of route '${fullPath}': routes must have either a path or a matcher specified`);\n    }\n    if (typeof route.path === 'string' && route.path.charAt(0) === '/') {\n      throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `Invalid configuration of route '${fullPath}': path cannot start with a slash`);\n    }\n    if (route.path === '' && route.redirectTo !== void 0 && route.pathMatch === void 0) {\n      const exp = `The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`;\n      throw new ɵRuntimeError(4014 /* RuntimeErrorCode.INVALID_ROUTE_CONFIG */, `Invalid configuration of route '{path: \"${fullPath}\", redirectTo: \"${route.redirectTo}\"}': please provide 'pathMatch'. ${exp}`);\n    }\n    if (requireStandaloneComponents) {\n      assertStandalone(fullPath, route.component);\n    }\n  }\n  if (route.children) {\n    validateConfig(route.children, fullPath, requireStandaloneComponents);\n  }\n}\nfunction getFullPath(parentPath, currentRoute) {\n  if (!currentRoute) {\n    return parentPath;\n  }\n  if (!parentPath && !currentRoute.path) {\n    return '';\n  } else if (parentPath && !currentRoute.path) {\n    return `${parentPath}/`;\n  } else if (!parentPath && currentRoute.path) {\n    return currentRoute.path;\n  } else {\n    return `${parentPath}/${currentRoute.path}`;\n  }\n}\n/**\n * Makes a copy of the config and adds any default required properties.\n */\nfunction standardizeConfig(r) {\n  const children = r.children && r.children.map(standardizeConfig);\n  const c = children ? {\n    ...r,\n    children\n  } : {\n    ...r\n  };\n  if (!c.component && !c.loadComponent && (children || c.loadChildren) && c.outlet && c.outlet !== PRIMARY_OUTLET) {\n    c.component = ɵEmptyOutletComponent;\n  }\n  return c;\n}\n/** Returns the `route.outlet` or PRIMARY_OUTLET if none exists. */\nfunction getOutlet(route) {\n  return route.outlet || PRIMARY_OUTLET;\n}\n/**\n * Sorts the `routes` such that the ones with an outlet matching `outletName` come first.\n * The order of the configs is otherwise preserved.\n */\nfunction sortByMatchingOutlets(routes, outletName) {\n  const sortedConfig = routes.filter(r => getOutlet(r) === outletName);\n  sortedConfig.push(...routes.filter(r => getOutlet(r) !== outletName));\n  return sortedConfig;\n}\n/**\n * Gets the first injector in the snapshot's parent tree.\n *\n * If the `Route` has a static list of providers, the returned injector will be the one created from\n * those. If it does not exist, the returned injector may come from the parents, which may be from a\n * loaded config or their static providers.\n *\n * Returns `null` if there is neither this nor any parents have a stored injector.\n *\n * Generally used for retrieving the injector to use for getting tokens for guards/resolvers and\n * also used for getting the correct injector to use for creating components.\n */\nfunction getClosestRouteInjector(snapshot) {\n  if (!snapshot) return null;\n  // If the current route has its own injector, which is created from the static providers on the\n  // route itself, we should use that. Otherwise, we start at the parent since we do not want to\n  // include the lazy loaded injector from this route.\n  if (snapshot.routeConfig?._injector) {\n    return snapshot.routeConfig._injector;\n  }\n  for (let s = snapshot.parent; s; s = s.parent) {\n    const route = s.routeConfig;\n    // Note that the order here is important. `_loadedInjector` stored on the route with\n    // `loadChildren: () => NgModule` so it applies to child routes with priority. The `_injector`\n    // is created from the static providers on that parent route, so it applies to the children as\n    // well, but only if there is no lazy loaded NgModuleRef injector.\n    if (route?._loadedInjector) return route._loadedInjector;\n    if (route?._injector) return route._injector;\n  }\n  return null;\n}\nlet warnedAboutUnsupportedInputBinding = false;\nconst activateRoutes = (rootContexts, routeReuseStrategy, forwardEvent, inputBindingEnabled) => map(t => {\n  new ActivateRoutes(routeReuseStrategy, t.targetRouterState, t.currentRouterState, forwardEvent, inputBindingEnabled).activate(rootContexts);\n  return t;\n});\nclass ActivateRoutes {\n  constructor(routeReuseStrategy, futureState, currState, forwardEvent, inputBindingEnabled) {\n    this.routeReuseStrategy = routeReuseStrategy;\n    this.futureState = futureState;\n    this.currState = currState;\n    this.forwardEvent = forwardEvent;\n    this.inputBindingEnabled = inputBindingEnabled;\n  }\n  activate(parentContexts) {\n    const futureRoot = this.futureState._root;\n    const currRoot = this.currState ? this.currState._root : null;\n    this.deactivateChildRoutes(futureRoot, currRoot, parentContexts);\n    advanceActivatedRoute(this.futureState.root);\n    this.activateChildRoutes(futureRoot, currRoot, parentContexts);\n  }\n  // De-activate the child route that are not re-used for the future state\n  deactivateChildRoutes(futureNode, currNode, contexts) {\n    const children = nodeChildrenAsMap(currNode);\n    // Recurse on the routes active in the future state to de-activate deeper children\n    futureNode.children.forEach(futureChild => {\n      const childOutletName = futureChild.value.outlet;\n      this.deactivateRoutes(futureChild, children[childOutletName], contexts);\n      delete children[childOutletName];\n    });\n    // De-activate the routes that will not be re-used\n    Object.values(children).forEach(v => {\n      this.deactivateRouteAndItsChildren(v, contexts);\n    });\n  }\n  deactivateRoutes(futureNode, currNode, parentContext) {\n    const future = futureNode.value;\n    const curr = currNode ? currNode.value : null;\n    if (future === curr) {\n      // Reusing the node, check to see if the children need to be de-activated\n      if (future.component) {\n        // If we have a normal route, we need to go through an outlet.\n        const context = parentContext.getContext(future.outlet);\n        if (context) {\n          this.deactivateChildRoutes(futureNode, currNode, context.children);\n        }\n      } else {\n        // if we have a componentless route, we recurse but keep the same outlet map.\n        this.deactivateChildRoutes(futureNode, currNode, parentContext);\n      }\n    } else {\n      if (curr) {\n        // Deactivate the current route which will not be re-used\n        this.deactivateRouteAndItsChildren(currNode, parentContext);\n      }\n    }\n  }\n  deactivateRouteAndItsChildren(route, parentContexts) {\n    // If there is no component, the Route is never attached to an outlet (because there is no\n    // component to attach).\n    if (route.value.component && this.routeReuseStrategy.shouldDetach(route.value.snapshot)) {\n      this.detachAndStoreRouteSubtree(route, parentContexts);\n    } else {\n      this.deactivateRouteAndOutlet(route, parentContexts);\n    }\n  }\n  detachAndStoreRouteSubtree(route, parentContexts) {\n    const context = parentContexts.getContext(route.value.outlet);\n    const contexts = context && route.value.component ? context.children : parentContexts;\n    const children = nodeChildrenAsMap(route);\n    for (const treeNode of Object.values(children)) {\n      this.deactivateRouteAndItsChildren(treeNode, contexts);\n    }\n    if (context && context.outlet) {\n      const componentRef = context.outlet.detach();\n      const contexts = context.children.onOutletDeactivated();\n      this.routeReuseStrategy.store(route.value.snapshot, {\n        componentRef,\n        route,\n        contexts\n      });\n    }\n  }\n  deactivateRouteAndOutlet(route, parentContexts) {\n    const context = parentContexts.getContext(route.value.outlet);\n    // The context could be `null` if we are on a componentless route but there may still be\n    // children that need deactivating.\n    const contexts = context && route.value.component ? context.children : parentContexts;\n    const children = nodeChildrenAsMap(route);\n    for (const treeNode of Object.values(children)) {\n      this.deactivateRouteAndItsChildren(treeNode, contexts);\n    }\n    if (context) {\n      if (context.outlet) {\n        // Destroy the component\n        context.outlet.deactivate();\n        // Destroy the contexts for all the outlets that were in the component\n        context.children.onOutletDeactivated();\n      }\n      // Clear the information about the attached component on the context but keep the reference to\n      // the outlet. Clear even if outlet was not yet activated to avoid activating later with old\n      // info\n      context.attachRef = null;\n      context.route = null;\n    }\n  }\n  activateChildRoutes(futureNode, currNode, contexts) {\n    const children = nodeChildrenAsMap(currNode);\n    futureNode.children.forEach(c => {\n      this.activateRoutes(c, children[c.value.outlet], contexts);\n      this.forwardEvent(new ActivationEnd(c.value.snapshot));\n    });\n    if (futureNode.children.length) {\n      this.forwardEvent(new ChildActivationEnd(futureNode.value.snapshot));\n    }\n  }\n  activateRoutes(futureNode, currNode, parentContexts) {\n    const future = futureNode.value;\n    const curr = currNode ? currNode.value : null;\n    advanceActivatedRoute(future);\n    // reusing the node\n    if (future === curr) {\n      if (future.component) {\n        // If we have a normal route, we need to go through an outlet.\n        const context = parentContexts.getOrCreateContext(future.outlet);\n        this.activateChildRoutes(futureNode, currNode, context.children);\n      } else {\n        // if we have a componentless route, we recurse but keep the same outlet map.\n        this.activateChildRoutes(futureNode, currNode, parentContexts);\n      }\n    } else {\n      if (future.component) {\n        // if we have a normal route, we need to place the component into the outlet and recurse.\n        const context = parentContexts.getOrCreateContext(future.outlet);\n        if (this.routeReuseStrategy.shouldAttach(future.snapshot)) {\n          const stored = this.routeReuseStrategy.retrieve(future.snapshot);\n          this.routeReuseStrategy.store(future.snapshot, null);\n          context.children.onOutletReAttached(stored.contexts);\n          context.attachRef = stored.componentRef;\n          context.route = stored.route.value;\n          if (context.outlet) {\n            // Attach right away when the outlet has already been instantiated\n            // Otherwise attach from `RouterOutlet.ngOnInit` when it is instantiated\n            context.outlet.attach(stored.componentRef, stored.route.value);\n          }\n          advanceActivatedRoute(stored.route.value);\n          this.activateChildRoutes(futureNode, null, context.children);\n        } else {\n          const injector = getClosestRouteInjector(future.snapshot);\n          context.attachRef = null;\n          context.route = future;\n          context.injector = injector;\n          if (context.outlet) {\n            // Activate the outlet when it has already been instantiated\n            // Otherwise it will get activated from its `ngOnInit` when instantiated\n            context.outlet.activateWith(future, context.injector);\n          }\n          this.activateChildRoutes(futureNode, null, context.children);\n        }\n      } else {\n        // if we have a componentless route, we recurse but keep the same outlet map.\n        this.activateChildRoutes(futureNode, null, parentContexts);\n      }\n    }\n    if (typeof ngDevMode === 'undefined' || ngDevMode) {\n      const context = parentContexts.getOrCreateContext(future.outlet);\n      const outlet = context.outlet;\n      if (outlet && this.inputBindingEnabled && !outlet.supportsBindingToComponentInputs && !warnedAboutUnsupportedInputBinding) {\n        console.warn(`'withComponentInputBinding' feature is enabled but ` + `this application is using an outlet that may not support binding to component inputs.`);\n        warnedAboutUnsupportedInputBinding = true;\n      }\n    }\n  }\n}\nclass CanActivate {\n  constructor(path) {\n    this.path = path;\n    this.route = this.path[this.path.length - 1];\n  }\n}\nclass CanDeactivate {\n  constructor(component, route) {\n    this.component = component;\n    this.route = route;\n  }\n}\nfunction getAllRouteGuards(future, curr, parentContexts) {\n  const futureRoot = future._root;\n  const currRoot = curr ? curr._root : null;\n  return getChildRouteGuards(futureRoot, currRoot, parentContexts, [futureRoot.value]);\n}\nfunction getCanActivateChild(p) {\n  const canActivateChild = p.routeConfig ? p.routeConfig.canActivateChild : null;\n  if (!canActivateChild || canActivateChild.length === 0) return null;\n  return {\n    node: p,\n    guards: canActivateChild\n  };\n}\nfunction getTokenOrFunctionIdentity(tokenOrFunction, injector) {\n  const NOT_FOUND = Symbol();\n  const result = injector.get(tokenOrFunction, NOT_FOUND);\n  if (result === NOT_FOUND) {\n    if (typeof tokenOrFunction === 'function' && !ɵisInjectable(tokenOrFunction)) {\n      // We think the token is just a function so return it as-is\n      return tokenOrFunction;\n    } else {\n      // This will throw the not found error\n      return injector.get(tokenOrFunction);\n    }\n  }\n  return result;\n}\nfunction getChildRouteGuards(futureNode, currNode, contexts, futurePath, checks = {\n  canDeactivateChecks: [],\n  canActivateChecks: []\n}) {\n  const prevChildren = nodeChildrenAsMap(currNode);\n  // Process the children of the future route\n  futureNode.children.forEach(c => {\n    getRouteGuards(c, prevChildren[c.value.outlet], contexts, futurePath.concat([c.value]), checks);\n    delete prevChildren[c.value.outlet];\n  });\n  // Process any children left from the current route (not active for the future route)\n  Object.entries(prevChildren).forEach(([k, v]) => deactivateRouteAndItsChildren(v, contexts.getContext(k), checks));\n  return checks;\n}\nfunction getRouteGuards(futureNode, currNode, parentContexts, futurePath, checks = {\n  canDeactivateChecks: [],\n  canActivateChecks: []\n}) {\n  const future = futureNode.value;\n  const curr = currNode ? currNode.value : null;\n  const context = parentContexts ? parentContexts.getContext(futureNode.value.outlet) : null;\n  // reusing the node\n  if (curr && future.routeConfig === curr.routeConfig) {\n    const shouldRun = shouldRunGuardsAndResolvers(curr, future, future.routeConfig.runGuardsAndResolvers);\n    if (shouldRun) {\n      checks.canActivateChecks.push(new CanActivate(futurePath));\n    } else {\n      // we need to set the data\n      future.data = curr.data;\n      future._resolvedData = curr._resolvedData;\n    }\n    // If we have a component, we need to go through an outlet.\n    if (future.component) {\n      getChildRouteGuards(futureNode, currNode, context ? context.children : null, futurePath, checks);\n      // if we have a componentless route, we recurse but keep the same outlet map.\n    } else {\n      getChildRouteGuards(futureNode, currNode, parentContexts, futurePath, checks);\n    }\n    if (shouldRun && context && context.outlet && context.outlet.isActivated) {\n      checks.canDeactivateChecks.push(new CanDeactivate(context.outlet.component, curr));\n    }\n  } else {\n    if (curr) {\n      deactivateRouteAndItsChildren(currNode, context, checks);\n    }\n    checks.canActivateChecks.push(new CanActivate(futurePath));\n    // If we have a component, we need to go through an outlet.\n    if (future.component) {\n      getChildRouteGuards(futureNode, null, context ? context.children : null, futurePath, checks);\n      // if we have a componentless route, we recurse but keep the same outlet map.\n    } else {\n      getChildRouteGuards(futureNode, null, parentContexts, futurePath, checks);\n    }\n  }\n  return checks;\n}\nfunction shouldRunGuardsAndResolvers(curr, future, mode) {\n  if (typeof mode === 'function') {\n    return mode(curr, future);\n  }\n  switch (mode) {\n    case 'pathParamsChange':\n      return !equalPath(curr.url, future.url);\n    case 'pathParamsOrQueryParamsChange':\n      return !equalPath(curr.url, future.url) || !shallowEqual(curr.queryParams, future.queryParams);\n    case 'always':\n      return true;\n    case 'paramsOrQueryParamsChange':\n      return !equalParamsAndUrlSegments(curr, future) || !shallowEqual(curr.queryParams, future.queryParams);\n    case 'paramsChange':\n    default:\n      return !equalParamsAndUrlSegments(curr, future);\n  }\n}\nfunction deactivateRouteAndItsChildren(route, context, checks) {\n  const children = nodeChildrenAsMap(route);\n  const r = route.value;\n  Object.entries(children).forEach(([childName, node]) => {\n    if (!r.component) {\n      deactivateRouteAndItsChildren(node, context, checks);\n    } else if (context) {\n      deactivateRouteAndItsChildren(node, context.children.getContext(childName), checks);\n    } else {\n      deactivateRouteAndItsChildren(node, null, checks);\n    }\n  });\n  if (!r.component) {\n    checks.canDeactivateChecks.push(new CanDeactivate(null, r));\n  } else if (context && context.outlet && context.outlet.isActivated) {\n    checks.canDeactivateChecks.push(new CanDeactivate(context.outlet.component, r));\n  } else {\n    checks.canDeactivateChecks.push(new CanDeactivate(null, r));\n  }\n}\n\n/**\n * Simple function check, but generic so type inference will flow. Example:\n *\n * function product(a: number, b: number) {\n *   return a * b;\n * }\n *\n * if (isFunction<product>(fn)) {\n *   return fn(1, 2);\n * } else {\n *   throw \"Must provide the `product` function\";\n * }\n */\nfunction isFunction(v) {\n  return typeof v === 'function';\n}\nfunction isBoolean(v) {\n  return typeof v === 'boolean';\n}\nfunction isCanLoad(guard) {\n  return guard && isFunction(guard.canLoad);\n}\nfunction isCanActivate(guard) {\n  return guard && isFunction(guard.canActivate);\n}\nfunction isCanActivateChild(guard) {\n  return guard && isFunction(guard.canActivateChild);\n}\nfunction isCanDeactivate(guard) {\n  return guard && isFunction(guard.canDeactivate);\n}\nfunction isCanMatch(guard) {\n  return guard && isFunction(guard.canMatch);\n}\nfunction isEmptyError(e) {\n  return e instanceof EmptyError || e?.name === 'EmptyError';\n}\nconst INITIAL_VALUE = /* @__PURE__ */Symbol('INITIAL_VALUE');\nfunction prioritizedGuardValue() {\n  return switchMap(obs => {\n    return combineLatest(obs.map(o => o.pipe(take(1), startWith(INITIAL_VALUE)))).pipe(map(results => {\n      for (const result of results) {\n        if (result === true) {\n          // If result is true, check the next one\n          continue;\n        } else if (result === INITIAL_VALUE) {\n          // If guard has not finished, we need to stop processing.\n          return INITIAL_VALUE;\n        } else if (result === false || result instanceof UrlTree) {\n          // Result finished and was not true. Return the result.\n          // Note that we only allow false/UrlTree. Other values are considered invalid and\n          // ignored.\n          return result;\n        }\n      }\n      // Everything resolved to true. Return true.\n      return true;\n    }), filter(item => item !== INITIAL_VALUE), take(1));\n  });\n}\nfunction checkGuards(injector, forwardEvent) {\n  return mergeMap(t => {\n    const {\n      targetSnapshot,\n      currentSnapshot,\n      guards: {\n        canActivateChecks,\n        canDeactivateChecks\n      }\n    } = t;\n    if (canDeactivateChecks.length === 0 && canActivateChecks.length === 0) {\n      return of({\n        ...t,\n        guardsResult: true\n      });\n    }\n    return runCanDeactivateChecks(canDeactivateChecks, targetSnapshot, currentSnapshot, injector).pipe(mergeMap(canDeactivate => {\n      return canDeactivate && isBoolean(canDeactivate) ? runCanActivateChecks(targetSnapshot, canActivateChecks, injector, forwardEvent) : of(canDeactivate);\n    }), map(guardsResult => ({\n      ...t,\n      guardsResult\n    })));\n  });\n}\nfunction runCanDeactivateChecks(checks, futureRSS, currRSS, injector) {\n  return from(checks).pipe(mergeMap(check => runCanDeactivate(check.component, check.route, currRSS, futureRSS, injector)), first(result => {\n    return result !== true;\n  }, true));\n}\nfunction runCanActivateChecks(futureSnapshot, checks, injector, forwardEvent) {\n  return from(checks).pipe(concatMap(check => {\n    return concat(fireChildActivationStart(check.route.parent, forwardEvent), fireActivationStart(check.route, forwardEvent), runCanActivateChild(futureSnapshot, check.path, injector), runCanActivate(futureSnapshot, check.route, injector));\n  }), first(result => {\n    return result !== true;\n  }, true));\n}\n/**\n * This should fire off `ActivationStart` events for each route being activated at this\n * level.\n * In other words, if you're activating `a` and `b` below, `path` will contain the\n * `ActivatedRouteSnapshot`s for both and we will fire `ActivationStart` for both. Always\n * return\n * `true` so checks continue to run.\n */\nfunction fireActivationStart(snapshot, forwardEvent) {\n  if (snapshot !== null && forwardEvent) {\n    forwardEvent(new ActivationStart(snapshot));\n  }\n  return of(true);\n}\n/**\n * This should fire off `ChildActivationStart` events for each route being activated at this\n * level.\n * In other words, if you're activating `a` and `b` below, `path` will contain the\n * `ActivatedRouteSnapshot`s for both and we will fire `ChildActivationStart` for both. Always\n * return\n * `true` so checks continue to run.\n */\nfunction fireChildActivationStart(snapshot, forwardEvent) {\n  if (snapshot !== null && forwardEvent) {\n    forwardEvent(new ChildActivationStart(snapshot));\n  }\n  return of(true);\n}\nfunction runCanActivate(futureRSS, futureARS, injector) {\n  const canActivate = futureARS.routeConfig ? futureARS.routeConfig.canActivate : null;\n  if (!canActivate || canActivate.length === 0) return of(true);\n  const canActivateObservables = canActivate.map(canActivate => {\n    return defer(() => {\n      const closestInjector = getClosestRouteInjector(futureARS) ?? injector;\n      const guard = getTokenOrFunctionIdentity(canActivate, closestInjector);\n      const guardVal = isCanActivate(guard) ? guard.canActivate(futureARS, futureRSS) : runInInjectionContext(closestInjector, () => guard(futureARS, futureRSS));\n      return wrapIntoObservable(guardVal).pipe(first());\n    });\n  });\n  return of(canActivateObservables).pipe(prioritizedGuardValue());\n}\nfunction runCanActivateChild(futureRSS, path, injector) {\n  const futureARS = path[path.length - 1];\n  const canActivateChildGuards = path.slice(0, path.length - 1).reverse().map(p => getCanActivateChild(p)).filter(_ => _ !== null);\n  const canActivateChildGuardsMapped = canActivateChildGuards.map(d => {\n    return defer(() => {\n      const guardsMapped = d.guards.map(canActivateChild => {\n        const closestInjector = getClosestRouteInjector(d.node) ?? injector;\n        const guard = getTokenOrFunctionIdentity(canActivateChild, closestInjector);\n        const guardVal = isCanActivateChild(guard) ? guard.canActivateChild(futureARS, futureRSS) : runInInjectionContext(closestInjector, () => guard(futureARS, futureRSS));\n        return wrapIntoObservable(guardVal).pipe(first());\n      });\n      return of(guardsMapped).pipe(prioritizedGuardValue());\n    });\n  });\n  return of(canActivateChildGuardsMapped).pipe(prioritizedGuardValue());\n}\nfunction runCanDeactivate(component, currARS, currRSS, futureRSS, injector) {\n  const canDeactivate = currARS && currARS.routeConfig ? currARS.routeConfig.canDeactivate : null;\n  if (!canDeactivate || canDeactivate.length === 0) return of(true);\n  const canDeactivateObservables = canDeactivate.map(c => {\n    const closestInjector = getClosestRouteInjector(currARS) ?? injector;\n    const guard = getTokenOrFunctionIdentity(c, closestInjector);\n    const guardVal = isCanDeactivate(guard) ? guard.canDeactivate(component, currARS, currRSS, futureRSS) : runInInjectionContext(closestInjector, () => guard(component, currARS, currRSS, futureRSS));\n    return wrapIntoObservable(guardVal).pipe(first());\n  });\n  return of(canDeactivateObservables).pipe(prioritizedGuardValue());\n}\nfunction runCanLoadGuards(injector, route, segments, urlSerializer) {\n  const canLoad = route.canLoad;\n  if (canLoad === undefined || canLoad.length === 0) {\n    return of(true);\n  }\n  const canLoadObservables = canLoad.map(injectionToken => {\n    const guard = getTokenOrFunctionIdentity(injectionToken, injector);\n    const guardVal = isCanLoad(guard) ? guard.canLoad(route, segments) : runInInjectionContext(injector, () => guard(route, segments));\n    return wrapIntoObservable(guardVal);\n  });\n  return of(canLoadObservables).pipe(prioritizedGuardValue(), redirectIfUrlTree(urlSerializer));\n}\nfunction redirectIfUrlTree(urlSerializer) {\n  return pipe(tap(result => {\n    if (!isUrlTree(result)) return;\n    throw redirectingNavigationError(urlSerializer, result);\n  }), map(result => result === true));\n}\nfunction runCanMatchGuards(injector, route, segments, urlSerializer) {\n  const canMatch = route.canMatch;\n  if (!canMatch || canMatch.length === 0) return of(true);\n  const canMatchObservables = canMatch.map(injectionToken => {\n    const guard = getTokenOrFunctionIdentity(injectionToken, injector);\n    const guardVal = isCanMatch(guard) ? guard.canMatch(route, segments) : runInInjectionContext(injector, () => guard(route, segments));\n    return wrapIntoObservable(guardVal);\n  });\n  return of(canMatchObservables).pipe(prioritizedGuardValue(), redirectIfUrlTree(urlSerializer));\n}\nclass NoMatch {\n  constructor(segmentGroup) {\n    this.segmentGroup = segmentGroup || null;\n  }\n}\nclass AbsoluteRedirect extends Error {\n  constructor(urlTree) {\n    super();\n    this.urlTree = urlTree;\n  }\n}\nfunction noMatch$1(segmentGroup) {\n  return throwError(new NoMatch(segmentGroup));\n}\nfunction absoluteRedirect(newTree) {\n  return throwError(new AbsoluteRedirect(newTree));\n}\nfunction namedOutletsRedirect(redirectTo) {\n  return throwError(new ɵRuntimeError(4000 /* RuntimeErrorCode.NAMED_OUTLET_REDIRECT */, (typeof ngDevMode === 'undefined' || ngDevMode) && `Only absolute redirects can have named outlets. redirectTo: '${redirectTo}'`));\n}\nfunction canLoadFails(route) {\n  return throwError(navigationCancelingError((typeof ngDevMode === 'undefined' || ngDevMode) && `Cannot load children because the guard of the route \"path: '${route.path}'\" returned false`, NavigationCancellationCode.GuardRejected));\n}\nclass ApplyRedirects {\n  constructor(urlSerializer, urlTree) {\n    this.urlSerializer = urlSerializer;\n    this.urlTree = urlTree;\n  }\n  lineralizeSegments(route, urlTree) {\n    let res = [];\n    let c = urlTree.root;\n    while (true) {\n      res = res.concat(c.segments);\n      if (c.numberOfChildren === 0) {\n        return of(res);\n      }\n      if (c.numberOfChildren > 1 || !c.children[PRIMARY_OUTLET]) {\n        return namedOutletsRedirect(route.redirectTo);\n      }\n      c = c.children[PRIMARY_OUTLET];\n    }\n  }\n  applyRedirectCommands(segments, redirectTo, posParams) {\n    const newTree = this.applyRedirectCreateUrlTree(redirectTo, this.urlSerializer.parse(redirectTo), segments, posParams);\n    if (redirectTo.startsWith('/')) {\n      throw new AbsoluteRedirect(newTree);\n    }\n    return newTree;\n  }\n  applyRedirectCreateUrlTree(redirectTo, urlTree, segments, posParams) {\n    const newRoot = this.createSegmentGroup(redirectTo, urlTree.root, segments, posParams);\n    return new UrlTree(newRoot, this.createQueryParams(urlTree.queryParams, this.urlTree.queryParams), urlTree.fragment);\n  }\n  createQueryParams(redirectToParams, actualParams) {\n    const res = {};\n    Object.entries(redirectToParams).forEach(([k, v]) => {\n      const copySourceValue = typeof v === 'string' && v.startsWith(':');\n      if (copySourceValue) {\n        const sourceName = v.substring(1);\n        res[k] = actualParams[sourceName];\n      } else {\n        res[k] = v;\n      }\n    });\n    return res;\n  }\n  createSegmentGroup(redirectTo, group, segments, posParams) {\n    const updatedSegments = this.createSegments(redirectTo, group.segments, segments, posParams);\n    let children = {};\n    Object.entries(group.children).forEach(([name, child]) => {\n      children[name] = this.createSegmentGroup(redirectTo, child, segments, posParams);\n    });\n    return new UrlSegmentGroup(updatedSegments, children);\n  }\n  createSegments(redirectTo, redirectToSegments, actualSegments, posParams) {\n    return redirectToSegments.map(s => s.path.startsWith(':') ? this.findPosParam(redirectTo, s, posParams) : this.findOrReturn(s, actualSegments));\n  }\n  findPosParam(redirectTo, redirectToUrlSegment, posParams) {\n    const pos = posParams[redirectToUrlSegment.path.substring(1)];\n    if (!pos) throw new ɵRuntimeError(4001 /* RuntimeErrorCode.MISSING_REDIRECT */, (typeof ngDevMode === 'undefined' || ngDevMode) && `Cannot redirect to '${redirectTo}'. Cannot find '${redirectToUrlSegment.path}'.`);\n    return pos;\n  }\n  findOrReturn(redirectToUrlSegment, actualSegments) {\n    let idx = 0;\n    for (const s of actualSegments) {\n      if (s.path === redirectToUrlSegment.path) {\n        actualSegments.splice(idx);\n        return s;\n      }\n      idx++;\n    }\n    return redirectToUrlSegment;\n  }\n}\nconst noMatch = {\n  matched: false,\n  consumedSegments: [],\n  remainingSegments: [],\n  parameters: {},\n  positionalParamSegments: {}\n};\nfunction matchWithChecks(segmentGroup, route, segments, injector, urlSerializer) {\n  const result = match(segmentGroup, route, segments);\n  if (!result.matched) {\n    return of(result);\n  }\n  // Only create the Route's `EnvironmentInjector` if it matches the attempted\n  // navigation\n  injector = getOrCreateRouteInjectorIfNeeded(route, injector);\n  return runCanMatchGuards(injector, route, segments, urlSerializer).pipe(map(v => v === true ? result : {\n    ...noMatch\n  }));\n}\nfunction match(segmentGroup, route, segments) {\n  if (route.path === '**') {\n    return createWildcardMatchResult(segments);\n  }\n  if (route.path === '') {\n    if (route.pathMatch === 'full' && (segmentGroup.hasChildren() || segments.length > 0)) {\n      return {\n        ...noMatch\n      };\n    }\n    return {\n      matched: true,\n      consumedSegments: [],\n      remainingSegments: segments,\n      parameters: {},\n      positionalParamSegments: {}\n    };\n  }\n  const matcher = route.matcher || defaultUrlMatcher;\n  const res = matcher(segments, segmentGroup, route);\n  if (!res) return {\n    ...noMatch\n  };\n  const posParams = {};\n  Object.entries(res.posParams ?? {}).forEach(([k, v]) => {\n    posParams[k] = v.path;\n  });\n  const parameters = res.consumed.length > 0 ? {\n    ...posParams,\n    ...res.consumed[res.consumed.length - 1].parameters\n  } : posParams;\n  return {\n    matched: true,\n    consumedSegments: res.consumed,\n    remainingSegments: segments.slice(res.consumed.length),\n    // TODO(atscott): investigate combining parameters and positionalParamSegments\n    parameters,\n    positionalParamSegments: res.posParams ?? {}\n  };\n}\nfunction createWildcardMatchResult(segments) {\n  return {\n    matched: true,\n    parameters: segments.length > 0 ? last(segments).parameters : {},\n    consumedSegments: segments,\n    remainingSegments: [],\n    positionalParamSegments: {}\n  };\n}\nfunction split(segmentGroup, consumedSegments, slicedSegments, config) {\n  if (slicedSegments.length > 0 && containsEmptyPathMatchesWithNamedOutlets(segmentGroup, slicedSegments, config)) {\n    const s = new UrlSegmentGroup(consumedSegments, createChildrenForEmptyPaths(config, new UrlSegmentGroup(slicedSegments, segmentGroup.children)));\n    return {\n      segmentGroup: s,\n      slicedSegments: []\n    };\n  }\n  if (slicedSegments.length === 0 && containsEmptyPathMatches(segmentGroup, slicedSegments, config)) {\n    const s = new UrlSegmentGroup(segmentGroup.segments, addEmptyPathsToChildrenIfNeeded(segmentGroup, slicedSegments, config, segmentGroup.children));\n    return {\n      segmentGroup: s,\n      slicedSegments\n    };\n  }\n  const s = new UrlSegmentGroup(segmentGroup.segments, segmentGroup.children);\n  return {\n    segmentGroup: s,\n    slicedSegments\n  };\n}\nfunction addEmptyPathsToChildrenIfNeeded(segmentGroup, slicedSegments, routes, children) {\n  const res = {};\n  for (const r of routes) {\n    if (emptyPathMatch(segmentGroup, slicedSegments, r) && !children[getOutlet(r)]) {\n      const s = new UrlSegmentGroup([], {});\n      res[getOutlet(r)] = s;\n    }\n  }\n  return {\n    ...children,\n    ...res\n  };\n}\nfunction createChildrenForEmptyPaths(routes, primarySegment) {\n  const res = {};\n  res[PRIMARY_OUTLET] = primarySegment;\n  for (const r of routes) {\n    if (r.path === '' && getOutlet(r) !== PRIMARY_OUTLET) {\n      const s = new UrlSegmentGroup([], {});\n      res[getOutlet(r)] = s;\n    }\n  }\n  return res;\n}\nfunction containsEmptyPathMatchesWithNamedOutlets(segmentGroup, slicedSegments, routes) {\n  return routes.some(r => emptyPathMatch(segmentGroup, slicedSegments, r) && getOutlet(r) !== PRIMARY_OUTLET);\n}\nfunction containsEmptyPathMatches(segmentGroup, slicedSegments, routes) {\n  return routes.some(r => emptyPathMatch(segmentGroup, slicedSegments, r));\n}\nfunction emptyPathMatch(segmentGroup, slicedSegments, r) {\n  if ((segmentGroup.hasChildren() || slicedSegments.length > 0) && r.pathMatch === 'full') {\n    return false;\n  }\n  return r.path === '';\n}\n/**\n * Determines if `route` is a path match for the `rawSegment`, `segments`, and `outlet` without\n * verifying that its children are a full match for the remainder of the `rawSegment` children as\n * well.\n */\nfunction isImmediateMatch(route, rawSegment, segments, outlet) {\n  // We allow matches to empty paths when the outlets differ so we can match a url like `/(b:b)` to\n  // a config like\n  // * `{path: '', children: [{path: 'b', outlet: 'b'}]}`\n  // or even\n  // * `{path: '', outlet: 'a', children: [{path: 'b', outlet: 'b'}]`\n  //\n  // The exception here is when the segment outlet is for the primary outlet. This would\n  // result in a match inside the named outlet because all children there are written as primary\n  // outlets. So we need to prevent child named outlet matches in a url like `/b` in a config like\n  // * `{path: '', outlet: 'x' children: [{path: 'b'}]}`\n  // This should only match if the url is `/(x:b)`.\n  if (getOutlet(route) !== outlet && (outlet === PRIMARY_OUTLET || !emptyPathMatch(rawSegment, segments, route))) {\n    return false;\n  }\n  return match(rawSegment, route, segments).matched;\n}\nfunction noLeftoversInUrl(segmentGroup, segments, outlet) {\n  return segments.length === 0 && !segmentGroup.children[outlet];\n}\n\n/**\n * Class used to indicate there were no additional route config matches but that all segments of\n * the URL were consumed during matching so the route was URL matched. When this happens, we still\n * try to match child configs in case there are empty path children.\n */\nclass NoLeftoversInUrl {}\nfunction recognize$1(injector, configLoader, rootComponentType, config, urlTree, urlSerializer, paramsInheritanceStrategy = 'emptyOnly') {\n  return new Recognizer(injector, configLoader, rootComponentType, config, urlTree, paramsInheritanceStrategy, urlSerializer).recognize();\n}\nconst MAX_ALLOWED_REDIRECTS = 31;\nclass Recognizer {\n  constructor(injector, configLoader, rootComponentType, config, urlTree, paramsInheritanceStrategy, urlSerializer) {\n    this.injector = injector;\n    this.configLoader = configLoader;\n    this.rootComponentType = rootComponentType;\n    this.config = config;\n    this.urlTree = urlTree;\n    this.paramsInheritanceStrategy = paramsInheritanceStrategy;\n    this.urlSerializer = urlSerializer;\n    this.applyRedirects = new ApplyRedirects(this.urlSerializer, this.urlTree);\n    this.absoluteRedirectCount = 0;\n    this.allowRedirects = true;\n  }\n  noMatchError(e) {\n    return new ɵRuntimeError(4002 /* RuntimeErrorCode.NO_MATCH */, typeof ngDevMode === 'undefined' || ngDevMode ? `Cannot match any routes. URL Segment: '${e.segmentGroup}'` : `'${e.segmentGroup}'`);\n  }\n  recognize() {\n    const rootSegmentGroup = split(this.urlTree.root, [], [], this.config).segmentGroup;\n    return this.match(rootSegmentGroup).pipe(map(children => {\n      // Use Object.freeze to prevent readers of the Router state from modifying it outside\n      // of a navigation, resulting in the router being out of sync with the browser.\n      const root = new ActivatedRouteSnapshot([], Object.freeze({}), Object.freeze({\n        ...this.urlTree.queryParams\n      }), this.urlTree.fragment, {}, PRIMARY_OUTLET, this.rootComponentType, null, {});\n      const rootNode = new TreeNode(root, children);\n      const routeState = new RouterStateSnapshot('', rootNode);\n      const tree = createUrlTreeFromSnapshot(root, [], this.urlTree.queryParams, this.urlTree.fragment);\n      // https://github.com/angular/angular/issues/47307\n      // Creating the tree stringifies the query params\n      // We don't want to do this here so reassign them to the original.\n      tree.queryParams = this.urlTree.queryParams;\n      routeState.url = this.urlSerializer.serialize(tree);\n      this.inheritParamsAndData(routeState._root, null);\n      return {\n        state: routeState,\n        tree\n      };\n    }));\n  }\n  match(rootSegmentGroup) {\n    const expanded$ = this.processSegmentGroup(this.injector, this.config, rootSegmentGroup, PRIMARY_OUTLET);\n    return expanded$.pipe(catchError(e => {\n      if (e instanceof AbsoluteRedirect) {\n        this.urlTree = e.urlTree;\n        return this.match(e.urlTree.root);\n      }\n      if (e instanceof NoMatch) {\n        throw this.noMatchError(e);\n      }\n      throw e;\n    }));\n  }\n  inheritParamsAndData(routeNode, parent) {\n    const route = routeNode.value;\n    const i = getInherited(route, parent, this.paramsInheritanceStrategy);\n    route.params = Object.freeze(i.params);\n    route.data = Object.freeze(i.data);\n    routeNode.children.forEach(n => this.inheritParamsAndData(n, route));\n  }\n  processSegmentGroup(injector, config, segmentGroup, outlet) {\n    if (segmentGroup.segments.length === 0 && segmentGroup.hasChildren()) {\n      return this.processChildren(injector, config, segmentGroup);\n    }\n    return this.processSegment(injector, config, segmentGroup, segmentGroup.segments, outlet, true).pipe(map(child => child instanceof TreeNode ? [child] : []));\n  }\n  /**\n   * Matches every child outlet in the `segmentGroup` to a `Route` in the config. Returns `null` if\n   * we cannot find a match for _any_ of the children.\n   *\n   * @param config - The `Routes` to match against\n   * @param segmentGroup - The `UrlSegmentGroup` whose children need to be matched against the\n   *     config.\n   */\n  processChildren(injector, config, segmentGroup) {\n    // Expand outlets one at a time, starting with the primary outlet. We need to do it this way\n    // because an absolute redirect from the primary outlet takes precedence.\n    const childOutlets = [];\n    for (const child of Object.keys(segmentGroup.children)) {\n      if (child === 'primary') {\n        childOutlets.unshift(child);\n      } else {\n        childOutlets.push(child);\n      }\n    }\n    return from(childOutlets).pipe(concatMap(childOutlet => {\n      const child = segmentGroup.children[childOutlet];\n      // Sort the config so that routes with outlets that match the one being activated\n      // appear first, followed by routes for other outlets, which might match if they have\n      // an empty path.\n      const sortedConfig = sortByMatchingOutlets(config, childOutlet);\n      return this.processSegmentGroup(injector, sortedConfig, child, childOutlet);\n    }), scan((children, outletChildren) => {\n      children.push(...outletChildren);\n      return children;\n    }), defaultIfEmpty(null), last$1(), mergeMap(children => {\n      if (children === null) return noMatch$1(segmentGroup);\n      // Because we may have matched two outlets to the same empty path segment, we can have\n      // multiple activated results for the same outlet. We should merge the children of\n      // these results so the final return value is only one `TreeNode` per outlet.\n      const mergedChildren = mergeEmptyPathMatches(children);\n      if (typeof ngDevMode === 'undefined' || ngDevMode) {\n        // This should really never happen - we are only taking the first match for each\n        // outlet and merge the empty path matches.\n        checkOutletNameUniqueness(mergedChildren);\n      }\n      sortActivatedRouteSnapshots(mergedChildren);\n      return of(mergedChildren);\n    }));\n  }\n  processSegment(injector, routes, segmentGroup, segments, outlet, allowRedirects) {\n    return from(routes).pipe(concatMap(r => {\n      return this.processSegmentAgainstRoute(r._injector ?? injector, routes, r, segmentGroup, segments, outlet, allowRedirects).pipe(catchError(e => {\n        if (e instanceof NoMatch) {\n          return of(null);\n        }\n        throw e;\n      }));\n    }), first(x => !!x), catchError(e => {\n      if (isEmptyError(e)) {\n        if (noLeftoversInUrl(segmentGroup, segments, outlet)) {\n          return of(new NoLeftoversInUrl());\n        }\n        return noMatch$1(segmentGroup);\n      }\n      throw e;\n    }));\n  }\n  processSegmentAgainstRoute(injector, routes, route, rawSegment, segments, outlet, allowRedirects) {\n    if (!isImmediateMatch(route, rawSegment, segments, outlet)) return noMatch$1(rawSegment);\n    if (route.redirectTo === undefined) {\n      return this.matchSegmentAgainstRoute(injector, rawSegment, route, segments, outlet);\n    }\n    if (this.allowRedirects && allowRedirects) {\n      return this.expandSegmentAgainstRouteUsingRedirect(injector, rawSegment, routes, route, segments, outlet);\n    }\n    return noMatch$1(rawSegment);\n  }\n  expandSegmentAgainstRouteUsingRedirect(injector, segmentGroup, routes, route, segments, outlet) {\n    const {\n      matched,\n      consumedSegments,\n      positionalParamSegments,\n      remainingSegments\n    } = match(segmentGroup, route, segments);\n    if (!matched) return noMatch$1(segmentGroup);\n    // TODO(atscott): Move all of this under an if(ngDevMode) as a breaking change and allow stack\n    // size exceeded in production\n    if (route.redirectTo.startsWith('/')) {\n      this.absoluteRedirectCount++;\n      if (this.absoluteRedirectCount > MAX_ALLOWED_REDIRECTS) {\n        if (ngDevMode) {\n          throw new ɵRuntimeError(4016 /* RuntimeErrorCode.INFINITE_REDIRECT */, `Detected possible infinite redirect when redirecting from '${this.urlTree}' to '${route.redirectTo}'.\\n` + `This is currently a dev mode only error but will become a` + ` call stack size exceeded error in production in a future major version.`);\n        }\n        this.allowRedirects = false;\n      }\n    }\n    const newTree = this.applyRedirects.applyRedirectCommands(consumedSegments, route.redirectTo, positionalParamSegments);\n    return this.applyRedirects.lineralizeSegments(route, newTree).pipe(mergeMap(newSegments => {\n      return this.processSegment(injector, routes, segmentGroup, newSegments.concat(remainingSegments), outlet, false);\n    }));\n  }\n  matchSegmentAgainstRoute(injector, rawSegment, route, segments, outlet) {\n    const matchResult = matchWithChecks(rawSegment, route, segments, injector, this.urlSerializer);\n    if (route.path === '**') {\n      // Prior versions of the route matching algorithm would stop matching at the wildcard route.\n      // We should investigate a better strategy for any existing children. Otherwise, these\n      // child segments are silently dropped from the navigation.\n      // https://github.com/angular/angular/issues/40089\n      rawSegment.children = {};\n    }\n    return matchResult.pipe(switchMap(result => {\n      if (!result.matched) {\n        return noMatch$1(rawSegment);\n      }\n      // If the route has an injector created from providers, we should start using that.\n      injector = route._injector ?? injector;\n      return this.getChildConfig(injector, route, segments).pipe(switchMap(({\n        routes: childConfig\n      }) => {\n        const childInjector = route._loadedInjector ?? injector;\n        const {\n          consumedSegments,\n          remainingSegments,\n          parameters\n        } = result;\n        const snapshot = new ActivatedRouteSnapshot(consumedSegments, parameters, Object.freeze({\n          ...this.urlTree.queryParams\n        }), this.urlTree.fragment, getData(route), getOutlet(route), route.component ?? route._loadedComponent ?? null, route, getResolve(route));\n        const {\n          segmentGroup,\n          slicedSegments\n        } = split(rawSegment, consumedSegments, remainingSegments, childConfig);\n        if (slicedSegments.length === 0 && segmentGroup.hasChildren()) {\n          return this.processChildren(childInjector, childConfig, segmentGroup).pipe(map(children => {\n            if (children === null) {\n              return null;\n            }\n            return new TreeNode(snapshot, children);\n          }));\n        }\n        if (childConfig.length === 0 && slicedSegments.length === 0) {\n          return of(new TreeNode(snapshot, []));\n        }\n        const matchedOnOutlet = getOutlet(route) === outlet;\n        // If we matched a config due to empty path match on a different outlet, we need to\n        // continue passing the current outlet for the segment rather than switch to PRIMARY.\n        // Note that we switch to primary when we have a match because outlet configs look like\n        // this: {path: 'a', outlet: 'a', children: [\n        //  {path: 'b', component: B},\n        //  {path: 'c', component: C},\n        // ]}\n        // Notice that the children of the named outlet are configured with the primary outlet\n        return this.processSegment(childInjector, childConfig, segmentGroup, slicedSegments, matchedOnOutlet ? PRIMARY_OUTLET : outlet, true).pipe(map(child => {\n          return new TreeNode(snapshot, child instanceof TreeNode ? [child] : []);\n        }));\n      }));\n    }));\n  }\n  getChildConfig(injector, route, segments) {\n    if (route.children) {\n      // The children belong to the same module\n      return of({\n        routes: route.children,\n        injector\n      });\n    }\n    if (route.loadChildren) {\n      // lazy children belong to the loaded module\n      if (route._loadedRoutes !== undefined) {\n        return of({\n          routes: route._loadedRoutes,\n          injector: route._loadedInjector\n        });\n      }\n      return runCanLoadGuards(injector, route, segments, this.urlSerializer).pipe(mergeMap(shouldLoadResult => {\n        if (shouldLoadResult) {\n          return this.configLoader.loadChildren(injector, route).pipe(tap(cfg => {\n            route._loadedRoutes = cfg.routes;\n            route._loadedInjector = cfg.injector;\n          }));\n        }\n        return canLoadFails(route);\n      }));\n    }\n    return of({\n      routes: [],\n      injector\n    });\n  }\n}\nfunction sortActivatedRouteSnapshots(nodes) {\n  nodes.sort((a, b) => {\n    if (a.value.outlet === PRIMARY_OUTLET) return -1;\n    if (b.value.outlet === PRIMARY_OUTLET) return 1;\n    return a.value.outlet.localeCompare(b.value.outlet);\n  });\n}\nfunction hasEmptyPathConfig(node) {\n  const config = node.value.routeConfig;\n  return config && config.path === '';\n}\n/**\n * Finds `TreeNode`s with matching empty path route configs and merges them into `TreeNode` with\n * the children from each duplicate. This is necessary because different outlets can match a\n * single empty path route config and the results need to then be merged.\n */\nfunction mergeEmptyPathMatches(nodes) {\n  const result = [];\n  // The set of nodes which contain children that were merged from two duplicate empty path nodes.\n  const mergedNodes = new Set();\n  for (const node of nodes) {\n    if (!hasEmptyPathConfig(node)) {\n      result.push(node);\n      continue;\n    }\n    const duplicateEmptyPathNode = result.find(resultNode => node.value.routeConfig === resultNode.value.routeConfig);\n    if (duplicateEmptyPathNode !== undefined) {\n      duplicateEmptyPathNode.children.push(...node.children);\n      mergedNodes.add(duplicateEmptyPathNode);\n    } else {\n      result.push(node);\n    }\n  }\n  // For each node which has children from multiple sources, we need to recompute a new `TreeNode`\n  // by also merging those children. This is necessary when there are multiple empty path configs\n  // in a row. Put another way: whenever we combine children of two nodes, we need to also check\n  // if any of those children can be combined into a single node as well.\n  for (const mergedNode of mergedNodes) {\n    const mergedChildren = mergeEmptyPathMatches(mergedNode.children);\n    result.push(new TreeNode(mergedNode.value, mergedChildren));\n  }\n  return result.filter(n => !mergedNodes.has(n));\n}\nfunction checkOutletNameUniqueness(nodes) {\n  const names = {};\n  nodes.forEach(n => {\n    const routeWithSameOutletName = names[n.value.outlet];\n    if (routeWithSameOutletName) {\n      const p = routeWithSameOutletName.url.map(s => s.toString()).join('/');\n      const c = n.value.url.map(s => s.toString()).join('/');\n      throw new ɵRuntimeError(4006 /* RuntimeErrorCode.TWO_SEGMENTS_WITH_SAME_OUTLET */, (typeof ngDevMode === 'undefined' || ngDevMode) && `Two segments cannot have the same outlet name: '${p}' and '${c}'.`);\n    }\n    names[n.value.outlet] = n.value;\n  });\n}\nfunction getData(route) {\n  return route.data || {};\n}\nfunction getResolve(route) {\n  return route.resolve || {};\n}\nfunction recognize(injector, configLoader, rootComponentType, config, serializer, paramsInheritanceStrategy) {\n  return mergeMap(t => recognize$1(injector, configLoader, rootComponentType, config, t.extractedUrl, serializer, paramsInheritanceStrategy).pipe(map(({\n    state: targetSnapshot,\n    tree: urlAfterRedirects\n  }) => {\n    return {\n      ...t,\n      targetSnapshot,\n      urlAfterRedirects\n    };\n  })));\n}\nfunction resolveData(paramsInheritanceStrategy, injector) {\n  return mergeMap(t => {\n    const {\n      targetSnapshot,\n      guards: {\n        canActivateChecks\n      }\n    } = t;\n    if (!canActivateChecks.length) {\n      return of(t);\n    }\n    // Iterating a Set in javascript  happens in insertion order so it is safe to use a `Set` to\n    // preserve the correct order that the resolvers should run in.\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set#description\n    const routesWithResolversToRun = new Set(canActivateChecks.map(check => check.route));\n    const routesNeedingDataUpdates = new Set();\n    for (const route of routesWithResolversToRun) {\n      if (routesNeedingDataUpdates.has(route)) {\n        continue;\n      }\n      // All children under the route with a resolver to run need to recompute inherited data.\n      for (const newRoute of flattenRouteTree(route)) {\n        routesNeedingDataUpdates.add(newRoute);\n      }\n    }\n    let routesProcessed = 0;\n    return from(routesNeedingDataUpdates).pipe(concatMap(route => {\n      if (routesWithResolversToRun.has(route)) {\n        return runResolve(route, targetSnapshot, paramsInheritanceStrategy, injector);\n      } else {\n        route.data = getInherited(route, route.parent, paramsInheritanceStrategy).resolve;\n        return of(void 0);\n      }\n    }), tap(() => routesProcessed++), takeLast(1), mergeMap(_ => routesProcessed === routesNeedingDataUpdates.size ? of(t) : EMPTY));\n  });\n}\n/**\n *  Returns the `ActivatedRouteSnapshot` tree as an array, using DFS to traverse the route tree.\n */\nfunction flattenRouteTree(route) {\n  const descendants = route.children.map(child => flattenRouteTree(child)).flat();\n  return [route, ...descendants];\n}\nfunction runResolve(futureARS, futureRSS, paramsInheritanceStrategy, injector) {\n  const config = futureARS.routeConfig;\n  const resolve = futureARS._resolve;\n  if (config?.title !== undefined && !hasStaticTitle(config)) {\n    resolve[RouteTitleKey] = config.title;\n  }\n  return resolveNode(resolve, futureARS, futureRSS, injector).pipe(map(resolvedData => {\n    futureARS._resolvedData = resolvedData;\n    futureARS.data = getInherited(futureARS, futureARS.parent, paramsInheritanceStrategy).resolve;\n    return null;\n  }));\n}\nfunction resolveNode(resolve, futureARS, futureRSS, injector) {\n  const keys = getDataKeys(resolve);\n  if (keys.length === 0) {\n    return of({});\n  }\n  const data = {};\n  return from(keys).pipe(mergeMap(key => getResolver(resolve[key], futureARS, futureRSS, injector).pipe(first(), tap(value => {\n    data[key] = value;\n  }))), takeLast(1), mapTo(data), catchError(e => isEmptyError(e) ? EMPTY : throwError(e)));\n}\nfunction getResolver(injectionToken, futureARS, futureRSS, injector) {\n  const closestInjector = getClosestRouteInjector(futureARS) ?? injector;\n  const resolver = getTokenOrFunctionIdentity(injectionToken, closestInjector);\n  const resolverValue = resolver.resolve ? resolver.resolve(futureARS, futureRSS) : runInInjectionContext(closestInjector, () => resolver(futureARS, futureRSS));\n  return wrapIntoObservable(resolverValue);\n}\n\n/**\n * Perform a side effect through a switchMap for every emission on the source Observable,\n * but return an Observable that is identical to the source. It's essentially the same as\n * the `tap` operator, but if the side effectful `next` function returns an ObservableInput,\n * it will wait before continuing with the original value.\n */\nfunction switchTap(next) {\n  return switchMap(v => {\n    const nextResult = next(v);\n    if (nextResult) {\n      return from(nextResult).pipe(map(() => v));\n    }\n    return of(v);\n  });\n}\n\n/**\n * Provides a strategy for setting the page title after a router navigation.\n *\n * The built-in implementation traverses the router state snapshot and finds the deepest primary\n * outlet with `title` property. Given the `Routes` below, navigating to\n * `/base/child(popup:aux)` would result in the document title being set to \"child\".\n * ```\n * [\n *   {path: 'base', title: 'base', children: [\n *     {path: 'child', title: 'child'},\n *   ],\n *   {path: 'aux', outlet: 'popup', title: 'popupTitle'}\n * ]\n * ```\n *\n * This class can be used as a base class for custom title strategies. That is, you can create your\n * own class that extends the `TitleStrategy`. Note that in the above example, the `title`\n * from the named outlet is never used. However, a custom strategy might be implemented to\n * incorporate titles in named outlets.\n *\n * @publicApi\n * @see [Page title guide](guide/router#setting-the-page-title)\n */\nlet TitleStrategy = /*#__PURE__*/(() => {\n  class TitleStrategy {\n    /**\n     * @returns The `title` of the deepest primary route.\n     */\n    buildTitle(snapshot) {\n      let pageTitle;\n      let route = snapshot.root;\n      while (route !== undefined) {\n        pageTitle = this.getResolvedTitleForRoute(route) ?? pageTitle;\n        route = route.children.find(child => child.outlet === PRIMARY_OUTLET);\n      }\n      return pageTitle;\n    }\n    /**\n     * Given an `ActivatedRouteSnapshot`, returns the final value of the\n     * `Route.title` property, which can either be a static string or a resolved value.\n     */\n    getResolvedTitleForRoute(snapshot) {\n      return snapshot.data[RouteTitleKey];\n    }\n    static {\n      this.ɵfac = function TitleStrategy_Factory(t) {\n        return new (t || TitleStrategy)();\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: TitleStrategy,\n        factory: () => (() => inject(DefaultTitleStrategy))(),\n        providedIn: 'root'\n      });\n    }\n  }\n  return TitleStrategy;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n/**\n * The default `TitleStrategy` used by the router that updates the title using the `Title` service.\n */\nlet DefaultTitleStrategy = /*#__PURE__*/(() => {\n  class DefaultTitleStrategy extends TitleStrategy {\n    constructor(title) {\n      super();\n      this.title = title;\n    }\n    /**\n     * Sets the title of the browser to the given value.\n     *\n     * @param title The `pageTitle` from the deepest primary route.\n     */\n    updateTitle(snapshot) {\n      const title = this.buildTitle(snapshot);\n      if (title !== undefined) {\n        this.title.setTitle(title);\n      }\n    }\n    static {\n      this.ɵfac = function DefaultTitleStrategy_Factory(t) {\n        return new (t || DefaultTitleStrategy)(i0.ɵɵinject(i1.Title));\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: DefaultTitleStrategy,\n        factory: DefaultTitleStrategy.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return DefaultTitleStrategy;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n/**\n * A [DI token](guide/glossary/#di-token) for the router service.\n *\n * @publicApi\n */\nconst ROUTER_CONFIGURATION = /*#__PURE__*/new InjectionToken(typeof ngDevMode === 'undefined' || ngDevMode ? 'router config' : '', {\n  providedIn: 'root',\n  factory: () => ({})\n});\n\n/**\n * The [DI token](guide/glossary/#di-token) for a router configuration.\n *\n * `ROUTES` is a low level API for router configuration via dependency injection.\n *\n * We recommend that in almost all cases to use higher level APIs such as `RouterModule.forRoot()`,\n * `provideRouter`, or `Router.resetConfig()`.\n *\n * @publicApi\n */\nconst ROUTES = /*#__PURE__*/new InjectionToken(ngDevMode ? 'ROUTES' : '');\nlet RouterConfigLoader = /*#__PURE__*/(() => {\n  class RouterConfigLoader {\n    constructor() {\n      this.componentLoaders = new WeakMap();\n      this.childrenLoaders = new WeakMap();\n      this.compiler = inject(Compiler);\n    }\n    loadComponent(route) {\n      if (this.componentLoaders.get(route)) {\n        return this.componentLoaders.get(route);\n      } else if (route._loadedComponent) {\n        return of(route._loadedComponent);\n      }\n      if (this.onLoadStartListener) {\n        this.onLoadStartListener(route);\n      }\n      const loadRunner = wrapIntoObservable(route.loadComponent()).pipe(map(maybeUnwrapDefaultExport), tap(component => {\n        if (this.onLoadEndListener) {\n          this.onLoadEndListener(route);\n        }\n        (typeof ngDevMode === 'undefined' || ngDevMode) && assertStandalone(route.path ?? '', component);\n        route._loadedComponent = component;\n      }), finalize(() => {\n        this.componentLoaders.delete(route);\n      }));\n      // Use custom ConnectableObservable as share in runners pipe increasing the bundle size too much\n      const loader = new ConnectableObservable(loadRunner, () => new Subject()).pipe(refCount());\n      this.componentLoaders.set(route, loader);\n      return loader;\n    }\n    loadChildren(parentInjector, route) {\n      if (this.childrenLoaders.get(route)) {\n        return this.childrenLoaders.get(route);\n      } else if (route._loadedRoutes) {\n        return of({\n          routes: route._loadedRoutes,\n          injector: route._loadedInjector\n        });\n      }\n      if (this.onLoadStartListener) {\n        this.onLoadStartListener(route);\n      }\n      const moduleFactoryOrRoutes$ = loadChildren(route, this.compiler, parentInjector, this.onLoadEndListener);\n      const loadRunner = moduleFactoryOrRoutes$.pipe(finalize(() => {\n        this.childrenLoaders.delete(route);\n      }));\n      // Use custom ConnectableObservable as share in runners pipe increasing the bundle size too much\n      const loader = new ConnectableObservable(loadRunner, () => new Subject()).pipe(refCount());\n      this.childrenLoaders.set(route, loader);\n      return loader;\n    }\n    static {\n      this.ɵfac = function RouterConfigLoader_Factory(t) {\n        return new (t || RouterConfigLoader)();\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: RouterConfigLoader,\n        factory: RouterConfigLoader.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return RouterConfigLoader;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n/**\n * Executes a `route.loadChildren` callback and converts the result to an array of child routes and\n * an injector if that callback returned a module.\n *\n * This function is used for the route discovery during prerendering\n * in @angular-devkit/build-angular. If there are any updates to the contract here, it will require\n * an update to the extractor.\n */\nfunction loadChildren(route, compiler, parentInjector, onLoadEndListener) {\n  return wrapIntoObservable(route.loadChildren()).pipe(map(maybeUnwrapDefaultExport), mergeMap(t => {\n    if (t instanceof NgModuleFactory || Array.isArray(t)) {\n      return of(t);\n    } else {\n      return from(compiler.compileModuleAsync(t));\n    }\n  }), map(factoryOrRoutes => {\n    if (onLoadEndListener) {\n      onLoadEndListener(route);\n    }\n    // This injector comes from the `NgModuleRef` when lazy loading an `NgModule`. There is\n    // no injector associated with lazy loading a `Route` array.\n    let injector;\n    let rawRoutes;\n    let requireStandaloneComponents = false;\n    if (Array.isArray(factoryOrRoutes)) {\n      rawRoutes = factoryOrRoutes;\n      requireStandaloneComponents = true;\n    } else {\n      injector = factoryOrRoutes.create(parentInjector).injector;\n      // When loading a module that doesn't provide `RouterModule.forChild()` preloader\n      // will get stuck in an infinite loop. The child module's Injector will look to\n      // its parent `Injector` when it doesn't find any ROUTES so it will return routes\n      // for it's parent module instead.\n      rawRoutes = injector.get(ROUTES, [], {\n        optional: true,\n        self: true\n      }).flat();\n    }\n    const routes = rawRoutes.map(standardizeConfig);\n    (typeof ngDevMode === 'undefined' || ngDevMode) && validateConfig(routes, route.path, requireStandaloneComponents);\n    return {\n      routes,\n      injector\n    };\n  }));\n}\nfunction isWrappedDefaultExport(value) {\n  // We use `in` here with a string key `'default'`, because we expect `DefaultExport` objects to be\n  // dynamically imported ES modules with a spec-mandated `default` key. Thus we don't expect that\n  // `default` will be a renamed property.\n  return value && typeof value === 'object' && 'default' in value;\n}\nfunction maybeUnwrapDefaultExport(input) {\n  // As per `isWrappedDefaultExport`, the `default` key here is generated by the browser and not\n  // subject to property renaming, so we reference it with bracket access.\n  return isWrappedDefaultExport(input) ? input['default'] : input;\n}\n\n/**\n * @description\n *\n * Provides a way to migrate AngularJS applications to Angular.\n *\n * @publicApi\n */\nlet UrlHandlingStrategy = /*#__PURE__*/(() => {\n  class UrlHandlingStrategy {\n    static {\n      this.ɵfac = function UrlHandlingStrategy_Factory(t) {\n        return new (t || UrlHandlingStrategy)();\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: UrlHandlingStrategy,\n        factory: () => (() => inject(DefaultUrlHandlingStrategy))(),\n        providedIn: 'root'\n      });\n    }\n  }\n  return UrlHandlingStrategy;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n/**\n * @publicApi\n */\nlet DefaultUrlHandlingStrategy = /*#__PURE__*/(() => {\n  class DefaultUrlHandlingStrategy {\n    shouldProcessUrl(url) {\n      return true;\n    }\n    extract(url) {\n      return url;\n    }\n    merge(newUrlPart, wholeUrl) {\n      return newUrlPart;\n    }\n    static {\n      this.ɵfac = function DefaultUrlHandlingStrategy_Factory(t) {\n        return new (t || DefaultUrlHandlingStrategy)();\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: DefaultUrlHandlingStrategy,\n        factory: DefaultUrlHandlingStrategy.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return DefaultUrlHandlingStrategy;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n/// <reference types=\"dom-view-transitions\" />\nconst CREATE_VIEW_TRANSITION = /*#__PURE__*/new InjectionToken(ngDevMode ? 'view transition helper' : '');\nconst VIEW_TRANSITION_OPTIONS = /*#__PURE__*/new InjectionToken(ngDevMode ? 'view transition options' : '');\n/**\n * A helper function for using browser view transitions. This function skips the call to\n * `startViewTransition` if the browser does not support it.\n *\n * @returns A Promise that resolves when the view transition callback begins.\n */\nfunction createViewTransition(injector, from, to) {\n  const transitionOptions = injector.get(VIEW_TRANSITION_OPTIONS);\n  const document = injector.get(DOCUMENT);\n  // Create promises outside the Angular zone to avoid causing extra change detections\n  return injector.get(NgZone).runOutsideAngular(() => {\n    if (!document.startViewTransition || transitionOptions.skipNextTransition) {\n      transitionOptions.skipNextTransition = false;\n      return Promise.resolve();\n    }\n    let resolveViewTransitionStarted;\n    const viewTransitionStarted = new Promise(resolve => {\n      resolveViewTransitionStarted = resolve;\n    });\n    const transition = document.startViewTransition(() => {\n      resolveViewTransitionStarted();\n      // We don't actually update dom within the transition callback. The resolving of the above\n      // promise unblocks the Router navigation, which synchronously activates and deactivates\n      // routes (the DOM update). This view transition waits for the next change detection to\n      // complete (below), which includes the update phase of the routed components.\n      return createRenderPromise(injector);\n    });\n    const {\n      onViewTransitionCreated\n    } = transitionOptions;\n    if (onViewTransitionCreated) {\n      runInInjectionContext(injector, () => onViewTransitionCreated({\n        transition,\n        from,\n        to\n      }));\n    }\n    return viewTransitionStarted;\n  });\n}\n/**\n * Creates a promise that resolves after next render.\n */\nfunction createRenderPromise(injector) {\n  return new Promise(resolve => {\n    afterNextRender(resolve, {\n      injector\n    });\n  });\n}\nlet NavigationTransitions = /*#__PURE__*/(() => {\n  class NavigationTransitions {\n    get hasRequestedNavigation() {\n      return this.navigationId !== 0;\n    }\n    constructor() {\n      this.currentNavigation = null;\n      this.currentTransition = null;\n      this.lastSuccessfulNavigation = null;\n      /**\n       * These events are used to communicate back to the Router about the state of the transition. The\n       * Router wants to respond to these events in various ways. Because the `NavigationTransition`\n       * class is not public, this event subject is not publicly exposed.\n       */\n      this.events = new Subject();\n      /**\n       * Used to abort the current transition with an error.\n       */\n      this.transitionAbortSubject = new Subject();\n      this.configLoader = inject(RouterConfigLoader);\n      this.environmentInjector = inject(EnvironmentInjector);\n      this.urlSerializer = inject(UrlSerializer);\n      this.rootContexts = inject(ChildrenOutletContexts);\n      this.location = inject(Location);\n      this.inputBindingEnabled = inject(INPUT_BINDER, {\n        optional: true\n      }) !== null;\n      this.titleStrategy = inject(TitleStrategy);\n      this.options = inject(ROUTER_CONFIGURATION, {\n        optional: true\n      }) || {};\n      this.paramsInheritanceStrategy = this.options.paramsInheritanceStrategy || 'emptyOnly';\n      this.urlHandlingStrategy = inject(UrlHandlingStrategy);\n      this.createViewTransition = inject(CREATE_VIEW_TRANSITION, {\n        optional: true\n      });\n      this.navigationId = 0;\n      /**\n       * Hook that enables you to pause navigation after the preactivation phase.\n       * Used by `RouterModule`.\n       *\n       * @internal\n       */\n      this.afterPreactivation = () => of(void 0);\n      /** @internal */\n      this.rootComponentType = null;\n      const onLoadStart = r => this.events.next(new RouteConfigLoadStart(r));\n      const onLoadEnd = r => this.events.next(new RouteConfigLoadEnd(r));\n      this.configLoader.onLoadEndListener = onLoadEnd;\n      this.configLoader.onLoadStartListener = onLoadStart;\n    }\n    complete() {\n      this.transitions?.complete();\n    }\n    handleNavigationRequest(request) {\n      const id = ++this.navigationId;\n      this.transitions?.next({\n        ...this.transitions.value,\n        ...request,\n        id\n      });\n    }\n    setupNavigations(router, initialUrlTree, initialRouterState) {\n      this.transitions = new BehaviorSubject({\n        id: 0,\n        currentUrlTree: initialUrlTree,\n        currentRawUrl: initialUrlTree,\n        extractedUrl: this.urlHandlingStrategy.extract(initialUrlTree),\n        urlAfterRedirects: this.urlHandlingStrategy.extract(initialUrlTree),\n        rawUrl: initialUrlTree,\n        extras: {},\n        resolve: null,\n        reject: null,\n        promise: Promise.resolve(true),\n        source: IMPERATIVE_NAVIGATION,\n        restoredState: null,\n        currentSnapshot: initialRouterState.snapshot,\n        targetSnapshot: null,\n        currentRouterState: initialRouterState,\n        targetRouterState: null,\n        guards: {\n          canActivateChecks: [],\n          canDeactivateChecks: []\n        },\n        guardsResult: null\n      });\n      return this.transitions.pipe(filter(t => t.id !== 0),\n      // Extract URL\n      map(t => ({\n        ...t,\n        extractedUrl: this.urlHandlingStrategy.extract(t.rawUrl)\n      })),\n      // Using switchMap so we cancel executing navigations when a new one comes in\n      switchMap(overallTransitionState => {\n        let completed = false;\n        let errored = false;\n        return of(overallTransitionState).pipe(switchMap(t => {\n          // It is possible that `switchMap` fails to cancel previous navigations if a new one happens synchronously while the operator\n          // is processing the `next` notification of that previous navigation. This can happen when a new navigation (say 2) cancels a\n          // previous one (1) and yet another navigation (3) happens synchronously in response to the `NavigationCancel` event for (1).\n          // https://github.com/ReactiveX/rxjs/issues/7455\n          if (this.navigationId > overallTransitionState.id) {\n            const cancellationReason = typeof ngDevMode === 'undefined' || ngDevMode ? `Navigation ID ${overallTransitionState.id} is not equal to the current navigation id ${this.navigationId}` : '';\n            this.cancelNavigationTransition(overallTransitionState, cancellationReason, NavigationCancellationCode.SupersededByNewNavigation);\n            return EMPTY;\n          }\n          this.currentTransition = overallTransitionState;\n          // Store the Navigation object\n          this.currentNavigation = {\n            id: t.id,\n            initialUrl: t.rawUrl,\n            extractedUrl: t.extractedUrl,\n            trigger: t.source,\n            extras: t.extras,\n            previousNavigation: !this.lastSuccessfulNavigation ? null : {\n              ...this.lastSuccessfulNavigation,\n              previousNavigation: null\n            }\n          };\n          const urlTransition = !router.navigated || this.isUpdatingInternalState() || this.isUpdatedBrowserUrl();\n          const onSameUrlNavigation = t.extras.onSameUrlNavigation ?? router.onSameUrlNavigation;\n          if (!urlTransition && onSameUrlNavigation !== 'reload') {\n            const reason = typeof ngDevMode === 'undefined' || ngDevMode ? `Navigation to ${t.rawUrl} was ignored because it is the same as the current Router URL.` : '';\n            this.events.next(new NavigationSkipped(t.id, this.urlSerializer.serialize(t.rawUrl), reason, NavigationSkippedCode.IgnoredSameUrlNavigation));\n            t.resolve(null);\n            return EMPTY;\n          }\n          if (this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl)) {\n            return of(t).pipe(\n            // Fire NavigationStart event\n            switchMap(t => {\n              const transition = this.transitions?.getValue();\n              this.events.next(new NavigationStart(t.id, this.urlSerializer.serialize(t.extractedUrl), t.source, t.restoredState));\n              if (transition !== this.transitions?.getValue()) {\n                return EMPTY;\n              }\n              // This delay is required to match old behavior that forced\n              // navigation to always be async\n              return Promise.resolve(t);\n            }),\n            // Recognize\n            recognize(this.environmentInjector, this.configLoader, this.rootComponentType, router.config, this.urlSerializer, this.paramsInheritanceStrategy),\n            // Update URL if in `eager` update mode\n            tap(t => {\n              overallTransitionState.targetSnapshot = t.targetSnapshot;\n              overallTransitionState.urlAfterRedirects = t.urlAfterRedirects;\n              this.currentNavigation = {\n                ...this.currentNavigation,\n                finalUrl: t.urlAfterRedirects\n              };\n              // Fire RoutesRecognized\n              const routesRecognized = new RoutesRecognized(t.id, this.urlSerializer.serialize(t.extractedUrl), this.urlSerializer.serialize(t.urlAfterRedirects), t.targetSnapshot);\n              this.events.next(routesRecognized);\n            }));\n          } else if (urlTransition && this.urlHandlingStrategy.shouldProcessUrl(t.currentRawUrl)) {\n            /* When the current URL shouldn't be processed, but the previous one\n             * was, we handle this \"error condition\" by navigating to the\n             * previously successful URL, but leaving the URL intact.*/\n            const {\n              id,\n              extractedUrl,\n              source,\n              restoredState,\n              extras\n            } = t;\n            const navStart = new NavigationStart(id, this.urlSerializer.serialize(extractedUrl), source, restoredState);\n            this.events.next(navStart);\n            const targetSnapshot = createEmptyState(this.rootComponentType).snapshot;\n            this.currentTransition = overallTransitionState = {\n              ...t,\n              targetSnapshot,\n              urlAfterRedirects: extractedUrl,\n              extras: {\n                ...extras,\n                skipLocationChange: false,\n                replaceUrl: false\n              }\n            };\n            this.currentNavigation.finalUrl = extractedUrl;\n            return of(overallTransitionState);\n          } else {\n            /* When neither the current or previous URL can be processed, do\n             * nothing other than update router's internal reference to the\n             * current \"settled\" URL. This way the next navigation will be coming\n             * from the current URL in the browser.\n             */\n            const reason = typeof ngDevMode === 'undefined' || ngDevMode ? `Navigation was ignored because the UrlHandlingStrategy` + ` indicated neither the current URL ${t.currentRawUrl} nor target URL ${t.rawUrl} should be processed.` : '';\n            this.events.next(new NavigationSkipped(t.id, this.urlSerializer.serialize(t.extractedUrl), reason, NavigationSkippedCode.IgnoredByUrlHandlingStrategy));\n            t.resolve(null);\n            return EMPTY;\n          }\n        }),\n        // --- GUARDS ---\n        tap(t => {\n          const guardsStart = new GuardsCheckStart(t.id, this.urlSerializer.serialize(t.extractedUrl), this.urlSerializer.serialize(t.urlAfterRedirects), t.targetSnapshot);\n          this.events.next(guardsStart);\n        }), map(t => {\n          this.currentTransition = overallTransitionState = {\n            ...t,\n            guards: getAllRouteGuards(t.targetSnapshot, t.currentSnapshot, this.rootContexts)\n          };\n          return overallTransitionState;\n        }), checkGuards(this.environmentInjector, evt => this.events.next(evt)), tap(t => {\n          overallTransitionState.guardsResult = t.guardsResult;\n          if (isUrlTree(t.guardsResult)) {\n            throw redirectingNavigationError(this.urlSerializer, t.guardsResult);\n          }\n          const guardsEnd = new GuardsCheckEnd(t.id, this.urlSerializer.serialize(t.extractedUrl), this.urlSerializer.serialize(t.urlAfterRedirects), t.targetSnapshot, !!t.guardsResult);\n          this.events.next(guardsEnd);\n        }), filter(t => {\n          if (!t.guardsResult) {\n            this.cancelNavigationTransition(t, '', NavigationCancellationCode.GuardRejected);\n            return false;\n          }\n          return true;\n        }),\n        // --- RESOLVE ---\n        switchTap(t => {\n          if (t.guards.canActivateChecks.length) {\n            return of(t).pipe(tap(t => {\n              const resolveStart = new ResolveStart(t.id, this.urlSerializer.serialize(t.extractedUrl), this.urlSerializer.serialize(t.urlAfterRedirects), t.targetSnapshot);\n              this.events.next(resolveStart);\n            }), switchMap(t => {\n              let dataResolved = false;\n              return of(t).pipe(resolveData(this.paramsInheritanceStrategy, this.environmentInjector), tap({\n                next: () => dataResolved = true,\n                complete: () => {\n                  if (!dataResolved) {\n                    this.cancelNavigationTransition(t, typeof ngDevMode === 'undefined' || ngDevMode ? `At least one route resolver didn't emit any value.` : '', NavigationCancellationCode.NoDataFromResolver);\n                  }\n                }\n              }));\n            }), tap(t => {\n              const resolveEnd = new ResolveEnd(t.id, this.urlSerializer.serialize(t.extractedUrl), this.urlSerializer.serialize(t.urlAfterRedirects), t.targetSnapshot);\n              this.events.next(resolveEnd);\n            }));\n          }\n          return undefined;\n        }),\n        // --- LOAD COMPONENTS ---\n        switchTap(t => {\n          const loadComponents = route => {\n            const loaders = [];\n            if (route.routeConfig?.loadComponent && !route.routeConfig._loadedComponent) {\n              loaders.push(this.configLoader.loadComponent(route.routeConfig).pipe(tap(loadedComponent => {\n                route.component = loadedComponent;\n              }), map(() => void 0)));\n            }\n            for (const child of route.children) {\n              loaders.push(...loadComponents(child));\n            }\n            return loaders;\n          };\n          return combineLatest(loadComponents(t.targetSnapshot.root)).pipe(defaultIfEmpty(null), take(1));\n        }), switchTap(() => this.afterPreactivation()), switchMap(() => {\n          const {\n            currentSnapshot,\n            targetSnapshot\n          } = overallTransitionState;\n          const viewTransitionStarted = this.createViewTransition?.(this.environmentInjector, currentSnapshot.root, targetSnapshot.root);\n          // If view transitions are enabled, block the navigation until the view\n          // transition callback starts. Otherwise, continue immediately.\n          return viewTransitionStarted ? from(viewTransitionStarted).pipe(map(() => overallTransitionState)) : of(overallTransitionState);\n        }), map(t => {\n          const targetRouterState = createRouterState(router.routeReuseStrategy, t.targetSnapshot, t.currentRouterState);\n          this.currentTransition = overallTransitionState = {\n            ...t,\n            targetRouterState\n          };\n          this.currentNavigation.targetRouterState = targetRouterState;\n          return overallTransitionState;\n        }), tap(() => {\n          this.events.next(new BeforeActivateRoutes());\n        }), activateRoutes(this.rootContexts, router.routeReuseStrategy, evt => this.events.next(evt), this.inputBindingEnabled),\n        // Ensure that if some observable used to drive the transition doesn't\n        // complete, the navigation still finalizes This should never happen, but\n        // this is done as a safety measure to avoid surfacing this error (#49567).\n        take(1), tap({\n          next: t => {\n            completed = true;\n            this.lastSuccessfulNavigation = this.currentNavigation;\n            this.events.next(new NavigationEnd(t.id, this.urlSerializer.serialize(t.extractedUrl), this.urlSerializer.serialize(t.urlAfterRedirects)));\n            this.titleStrategy?.updateTitle(t.targetRouterState.snapshot);\n            t.resolve(true);\n          },\n          complete: () => {\n            completed = true;\n          }\n        }),\n        // There used to be a lot more logic happening directly within the\n        // transition Observable. Some of this logic has been refactored out to\n        // other places but there may still be errors that happen there. This gives\n        // us a way to cancel the transition from the outside. This may also be\n        // required in the future to support something like the abort signal of the\n        // Navigation API where the navigation gets aborted from outside the\n        // transition.\n        takeUntil(this.transitionAbortSubject.pipe(tap(err => {\n          throw err;\n        }))), finalize(() => {\n          /* When the navigation stream finishes either through error or success,\n           * we set the `completed` or `errored` flag. However, there are some\n           * situations where we could get here without either of those being set.\n           * For instance, a redirect during NavigationStart. Therefore, this is a\n           * catch-all to make sure the NavigationCancel event is fired when a\n           * navigation gets cancelled but not caught by other means. */\n          if (!completed && !errored) {\n            const cancelationReason = typeof ngDevMode === 'undefined' || ngDevMode ? `Navigation ID ${overallTransitionState.id} is not equal to the current navigation id ${this.navigationId}` : '';\n            this.cancelNavigationTransition(overallTransitionState, cancelationReason, NavigationCancellationCode.SupersededByNewNavigation);\n          }\n          // Only clear current navigation if it is still set to the one that\n          // finalized.\n          if (this.currentTransition?.id === overallTransitionState.id) {\n            this.currentNavigation = null;\n            this.currentTransition = null;\n          }\n        }), catchError(e => {\n          errored = true;\n          /* This error type is issued during Redirect, and is handled as a\n           * cancellation rather than an error. */\n          if (isNavigationCancelingError(e)) {\n            this.events.next(new NavigationCancel(overallTransitionState.id, this.urlSerializer.serialize(overallTransitionState.extractedUrl), e.message, e.cancellationCode));\n            // When redirecting, we need to delay resolving the navigation\n            // promise and push it to the redirect navigation\n            if (!isRedirectingNavigationCancelingError(e)) {\n              overallTransitionState.resolve(false);\n            } else {\n              this.events.next(new RedirectRequest(e.url));\n            }\n            /* All other errors should reset to the router's internal URL reference\n             * to the pre-error state. */\n          } else {\n            this.events.next(new NavigationError(overallTransitionState.id, this.urlSerializer.serialize(overallTransitionState.extractedUrl), e, overallTransitionState.targetSnapshot ?? undefined));\n            try {\n              overallTransitionState.resolve(router.errorHandler(e));\n            } catch (ee) {\n              // TODO(atscott): consider flipping the default behavior of\n              // resolveNavigationPromiseOnError to be `resolve(false)` when\n              // undefined. This is the most sane thing to do given that\n              // applications very rarely handle the promise rejection and, as a\n              // result, would get \"unhandled promise rejection\" console logs.\n              // The vast majority of applications would not be affected by this\n              // change so omitting a migration seems reasonable. Instead,\n              // applications that rely on rejection can specifically opt-in to the\n              // old behavior.\n              if (this.options.resolveNavigationPromiseOnError) {\n                overallTransitionState.resolve(false);\n              } else {\n                overallTransitionState.reject(ee);\n              }\n            }\n          }\n          return EMPTY;\n        }));\n        // casting because `pipe` returns observable({}) when called with 8+ arguments\n      }));\n    }\n    cancelNavigationTransition(t, reason, code) {\n      const navCancel = new NavigationCancel(t.id, this.urlSerializer.serialize(t.extractedUrl), reason, code);\n      this.events.next(navCancel);\n      t.resolve(false);\n    }\n    /**\n     * @returns Whether we're navigating to somewhere that is not what the Router is\n     * currently set to.\n     */\n    isUpdatingInternalState() {\n      // TODO(atscott): The serializer should likely be used instead of\n      // `UrlTree.toString()`. Custom serializers are often written to handle\n      // things better than the default one (objects, for example will be\n      // [Object object] with the custom serializer and be \"the same\" when they\n      // aren't).\n      // (Same for isUpdatedBrowserUrl)\n      return this.currentTransition?.extractedUrl.toString() !== this.currentTransition?.currentUrlTree.toString();\n    }\n    /**\n     * @returns Whether we're updating the browser URL to something new (navigation is going\n     * to somewhere not displayed in the URL bar and we will update the URL\n     * bar if navigation succeeds).\n     */\n    isUpdatedBrowserUrl() {\n      // The extracted URL is the part of the URL that this application cares about. `extract` may\n      // return only part of the browser URL and that part may have not changed even if some other\n      // portion of the URL did.\n      const extractedBrowserUrl = this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(true)));\n      return extractedBrowserUrl.toString() !== this.currentTransition?.extractedUrl.toString() && !this.currentTransition?.extras.skipLocationChange;\n    }\n    static {\n      this.ɵfac = function NavigationTransitions_Factory(t) {\n        return new (t || NavigationTransitions)();\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: NavigationTransitions,\n        factory: NavigationTransitions.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return NavigationTransitions;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nfunction isBrowserTriggeredNavigation(source) {\n  return source !== IMPERATIVE_NAVIGATION;\n}\n\n/**\n * @description\n *\n * Provides a way to customize when activated routes get reused.\n *\n * @publicApi\n */\nlet RouteReuseStrategy = /*#__PURE__*/(() => {\n  class RouteReuseStrategy {\n    static {\n      this.ɵfac = function RouteReuseStrategy_Factory(t) {\n        return new (t || RouteReuseStrategy)();\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: RouteReuseStrategy,\n        factory: () => (() => inject(DefaultRouteReuseStrategy))(),\n        providedIn: 'root'\n      });\n    }\n  }\n  return RouteReuseStrategy;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n/**\n * @description\n *\n * This base route reuse strategy only reuses routes when the matched router configs are\n * identical. This prevents components from being destroyed and recreated\n * when just the route parameters, query parameters or fragment change\n * (that is, the existing component is _reused_).\n *\n * This strategy does not store any routes for later reuse.\n *\n * Angular uses this strategy by default.\n *\n *\n * It can be used as a base class for custom route reuse strategies, i.e. you can create your own\n * class that extends the `BaseRouteReuseStrategy` one.\n * @publicApi\n */\nclass BaseRouteReuseStrategy {\n  /**\n   * Whether the given route should detach for later reuse.\n   * Always returns false for `BaseRouteReuseStrategy`.\n   * */\n  shouldDetach(route) {\n    return false;\n  }\n  /**\n   * A no-op; the route is never stored since this strategy never detaches routes for later re-use.\n   */\n  store(route, detachedTree) {}\n  /** Returns `false`, meaning the route (and its subtree) is never reattached */\n  shouldAttach(route) {\n    return false;\n  }\n  /** Returns `null` because this strategy does not store routes for later re-use. */\n  retrieve(route) {\n    return null;\n  }\n  /**\n   * Determines if a route should be reused.\n   * This strategy returns `true` when the future route config and current route config are\n   * identical.\n   */\n  shouldReuseRoute(future, curr) {\n    return future.routeConfig === curr.routeConfig;\n  }\n}\nlet DefaultRouteReuseStrategy = /*#__PURE__*/(() => {\n  class DefaultRouteReuseStrategy extends BaseRouteReuseStrategy {\n    static {\n      this.ɵfac = /* @__PURE__ */(() => {\n        let ɵDefaultRouteReuseStrategy_BaseFactory;\n        return function DefaultRouteReuseStrategy_Factory(t) {\n          return (ɵDefaultRouteReuseStrategy_BaseFactory || (ɵDefaultRouteReuseStrategy_BaseFactory = i0.ɵɵgetInheritedFactory(DefaultRouteReuseStrategy)))(t || DefaultRouteReuseStrategy);\n        };\n      })();\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: DefaultRouteReuseStrategy,\n        factory: DefaultRouteReuseStrategy.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return DefaultRouteReuseStrategy;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nlet StateManager = /*#__PURE__*/(() => {\n  class StateManager {\n    static {\n      this.ɵfac = function StateManager_Factory(t) {\n        return new (t || StateManager)();\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: StateManager,\n        factory: () => (() => inject(HistoryStateManager))(),\n        providedIn: 'root'\n      });\n    }\n  }\n  return StateManager;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nlet HistoryStateManager = /*#__PURE__*/(() => {\n  class HistoryStateManager extends StateManager {\n    constructor() {\n      super(...arguments);\n      this.location = inject(Location);\n      this.urlSerializer = inject(UrlSerializer);\n      this.options = inject(ROUTER_CONFIGURATION, {\n        optional: true\n      }) || {};\n      this.canceledNavigationResolution = this.options.canceledNavigationResolution || 'replace';\n      this.urlHandlingStrategy = inject(UrlHandlingStrategy);\n      this.urlUpdateStrategy = this.options.urlUpdateStrategy || 'deferred';\n      this.currentUrlTree = new UrlTree();\n      this.rawUrlTree = this.currentUrlTree;\n      /**\n       * The id of the currently active page in the router.\n       * Updated to the transition's target id on a successful navigation.\n       *\n       * This is used to track what page the router last activated. When an attempted navigation fails,\n       * the router can then use this to compute how to restore the state back to the previously active\n       * page.\n       */\n      this.currentPageId = 0;\n      this.lastSuccessfulId = -1;\n      this.routerState = createEmptyState(null);\n      this.stateMemento = this.createStateMemento();\n    }\n    getCurrentUrlTree() {\n      return this.currentUrlTree;\n    }\n    getRawUrlTree() {\n      return this.rawUrlTree;\n    }\n    restoredState() {\n      return this.location.getState();\n    }\n    /**\n     * The ɵrouterPageId of whatever page is currently active in the browser history. This is\n     * important for computing the target page id for new navigations because we need to ensure each\n     * page id in the browser history is 1 more than the previous entry.\n     */\n    get browserPageId() {\n      if (this.canceledNavigationResolution !== 'computed') {\n        return this.currentPageId;\n      }\n      return this.restoredState()?.ɵrouterPageId ?? this.currentPageId;\n    }\n    getRouterState() {\n      return this.routerState;\n    }\n    createStateMemento() {\n      return {\n        rawUrlTree: this.rawUrlTree,\n        currentUrlTree: this.currentUrlTree,\n        routerState: this.routerState\n      };\n    }\n    registerNonRouterCurrentEntryChangeListener(listener) {\n      return this.location.subscribe(event => {\n        if (event['type'] === 'popstate') {\n          listener(event['url'], event.state);\n        }\n      });\n    }\n    handleRouterEvent(e, currentTransition) {\n      if (e instanceof NavigationStart) {\n        this.stateMemento = this.createStateMemento();\n      } else if (e instanceof NavigationSkipped) {\n        this.rawUrlTree = currentTransition.initialUrl;\n      } else if (e instanceof RoutesRecognized) {\n        if (this.urlUpdateStrategy === 'eager') {\n          if (!currentTransition.extras.skipLocationChange) {\n            const rawUrl = this.urlHandlingStrategy.merge(currentTransition.finalUrl, currentTransition.initialUrl);\n            this.setBrowserUrl(rawUrl, currentTransition);\n          }\n        }\n      } else if (e instanceof BeforeActivateRoutes) {\n        this.currentUrlTree = currentTransition.finalUrl;\n        this.rawUrlTree = this.urlHandlingStrategy.merge(currentTransition.finalUrl, currentTransition.initialUrl);\n        this.routerState = currentTransition.targetRouterState;\n        if (this.urlUpdateStrategy === 'deferred') {\n          if (!currentTransition.extras.skipLocationChange) {\n            this.setBrowserUrl(this.rawUrlTree, currentTransition);\n          }\n        }\n      } else if (e instanceof NavigationCancel && (e.code === NavigationCancellationCode.GuardRejected || e.code === NavigationCancellationCode.NoDataFromResolver)) {\n        this.restoreHistory(currentTransition);\n      } else if (e instanceof NavigationError) {\n        this.restoreHistory(currentTransition, true);\n      } else if (e instanceof NavigationEnd) {\n        this.lastSuccessfulId = e.id;\n        this.currentPageId = this.browserPageId;\n      }\n    }\n    setBrowserUrl(url, transition) {\n      const path = this.urlSerializer.serialize(url);\n      if (this.location.isCurrentPathEqualTo(path) || !!transition.extras.replaceUrl) {\n        // replacements do not update the target page\n        const currentBrowserPageId = this.browserPageId;\n        const state = {\n          ...transition.extras.state,\n          ...this.generateNgRouterState(transition.id, currentBrowserPageId)\n        };\n        this.location.replaceState(path, '', state);\n      } else {\n        const state = {\n          ...transition.extras.state,\n          ...this.generateNgRouterState(transition.id, this.browserPageId + 1)\n        };\n        this.location.go(path, '', state);\n      }\n    }\n    /**\n     * Performs the necessary rollback action to restore the browser URL to the\n     * state before the transition.\n     */\n    restoreHistory(navigation, restoringFromCaughtError = false) {\n      if (this.canceledNavigationResolution === 'computed') {\n        const currentBrowserPageId = this.browserPageId;\n        const targetPagePosition = this.currentPageId - currentBrowserPageId;\n        if (targetPagePosition !== 0) {\n          this.location.historyGo(targetPagePosition);\n        } else if (this.currentUrlTree === navigation.finalUrl && targetPagePosition === 0) {\n          // We got to the activation stage (where currentUrlTree is set to the navigation's\n          // finalUrl), but we weren't moving anywhere in history (skipLocationChange or replaceUrl).\n          // We still need to reset the router state back to what it was when the navigation started.\n          this.resetState(navigation);\n          this.resetUrlToCurrentUrlTree();\n        } else {\n          // The browser URL and router state was not updated before the navigation cancelled so\n          // there's no restoration needed.\n        }\n      } else if (this.canceledNavigationResolution === 'replace') {\n        // TODO(atscott): It seems like we should _always_ reset the state here. It would be a no-op\n        // for `deferred` navigations that haven't change the internal state yet because guards\n        // reject. For 'eager' navigations, it seems like we also really should reset the state\n        // because the navigation was cancelled. Investigate if this can be done by running TGP.\n        if (restoringFromCaughtError) {\n          this.resetState(navigation);\n        }\n        this.resetUrlToCurrentUrlTree();\n      }\n    }\n    resetState(navigation) {\n      this.routerState = this.stateMemento.routerState;\n      this.currentUrlTree = this.stateMemento.currentUrlTree;\n      // Note here that we use the urlHandlingStrategy to get the reset `rawUrlTree` because it may be\n      // configured to handle only part of the navigation URL. This means we would only want to reset\n      // the part of the navigation handled by the Angular router rather than the whole URL. In\n      // addition, the URLHandlingStrategy may be configured to specifically preserve parts of the URL\n      // when merging, such as the query params so they are not lost on a refresh.\n      this.rawUrlTree = this.urlHandlingStrategy.merge(this.currentUrlTree, navigation.finalUrl ?? this.rawUrlTree);\n    }\n    resetUrlToCurrentUrlTree() {\n      this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree), '', this.generateNgRouterState(this.lastSuccessfulId, this.currentPageId));\n    }\n    generateNgRouterState(navigationId, routerPageId) {\n      if (this.canceledNavigationResolution === 'computed') {\n        return {\n          navigationId,\n          ɵrouterPageId: routerPageId\n        };\n      }\n      return {\n        navigationId\n      };\n    }\n    static {\n      this.ɵfac = /* @__PURE__ */(() => {\n        let ɵHistoryStateManager_BaseFactory;\n        return function HistoryStateManager_Factory(t) {\n          return (ɵHistoryStateManager_BaseFactory || (ɵHistoryStateManager_BaseFactory = i0.ɵɵgetInheritedFactory(HistoryStateManager)))(t || HistoryStateManager);\n        };\n      })();\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: HistoryStateManager,\n        factory: HistoryStateManager.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return HistoryStateManager;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nvar NavigationResult = /*#__PURE__*/function (NavigationResult) {\n  NavigationResult[NavigationResult[\"COMPLETE\"] = 0] = \"COMPLETE\";\n  NavigationResult[NavigationResult[\"FAILED\"] = 1] = \"FAILED\";\n  NavigationResult[NavigationResult[\"REDIRECTING\"] = 2] = \"REDIRECTING\";\n  return NavigationResult;\n}(NavigationResult || {});\n/**\n * Performs the given action once the router finishes its next/current navigation.\n *\n * The navigation is considered complete under the following conditions:\n * - `NavigationCancel` event emits and the code is not `NavigationCancellationCode.Redirect` or\n * `NavigationCancellationCode.SupersededByNewNavigation`. In these cases, the\n * redirecting/superseding navigation must finish.\n * - `NavigationError`, `NavigationEnd`, or `NavigationSkipped` event emits\n */\nfunction afterNextNavigation(router, action) {\n  router.events.pipe(filter(e => e instanceof NavigationEnd || e instanceof NavigationCancel || e instanceof NavigationError || e instanceof NavigationSkipped), map(e => {\n    if (e instanceof NavigationEnd || e instanceof NavigationSkipped) {\n      return NavigationResult.COMPLETE;\n    }\n    const redirecting = e instanceof NavigationCancel ? e.code === NavigationCancellationCode.Redirect || e.code === NavigationCancellationCode.SupersededByNewNavigation : false;\n    return redirecting ? NavigationResult.REDIRECTING : NavigationResult.FAILED;\n  }), filter(result => result !== NavigationResult.REDIRECTING), take(1)).subscribe(() => {\n    action();\n  });\n}\nfunction defaultErrorHandler(error) {\n  throw error;\n}\n/**\n * The equivalent `IsActiveMatchOptions` options for `Router.isActive` is called with `true`\n * (exact = true).\n */\nconst exactMatchOptions = {\n  paths: 'exact',\n  fragment: 'ignored',\n  matrixParams: 'ignored',\n  queryParams: 'exact'\n};\n/**\n * The equivalent `IsActiveMatchOptions` options for `Router.isActive` is called with `false`\n * (exact = false).\n */\nconst subsetMatchOptions = {\n  paths: 'subset',\n  fragment: 'ignored',\n  matrixParams: 'ignored',\n  queryParams: 'subset'\n};\n/**\n * @description\n *\n * A service that provides navigation among views and URL manipulation capabilities.\n *\n * @see {@link Route}\n * @see [Routing and Navigation Guide](guide/router).\n *\n * @ngModule RouterModule\n *\n * @publicApi\n */\nlet Router = /*#__PURE__*/(() => {\n  class Router {\n    get currentUrlTree() {\n      return this.stateManager.getCurrentUrlTree();\n    }\n    get rawUrlTree() {\n      return this.stateManager.getRawUrlTree();\n    }\n    /**\n     * An event stream for routing events.\n     */\n    get events() {\n      // TODO(atscott): This _should_ be events.asObservable(). However, this change requires internal\n      // cleanup: tests are doing `(route.events as Subject<Event>).next(...)`. This isn't\n      // allowed/supported but we still have to fix these or file bugs against the teams before making\n      // the change.\n      return this._events;\n    }\n    /**\n     * The current state of routing in this NgModule.\n     */\n    get routerState() {\n      return this.stateManager.getRouterState();\n    }\n    constructor() {\n      this.disposed = false;\n      this.isNgZoneEnabled = false;\n      this.console = inject(ɵConsole);\n      this.stateManager = inject(StateManager);\n      this.options = inject(ROUTER_CONFIGURATION, {\n        optional: true\n      }) || {};\n      this.pendingTasks = inject(ɵPendingTasks);\n      this.urlUpdateStrategy = this.options.urlUpdateStrategy || 'deferred';\n      this.navigationTransitions = inject(NavigationTransitions);\n      this.urlSerializer = inject(UrlSerializer);\n      this.location = inject(Location);\n      this.urlHandlingStrategy = inject(UrlHandlingStrategy);\n      /**\n       * The private `Subject` type for the public events exposed in the getter. This is used internally\n       * to push events to. The separate field allows us to expose separate types in the public API\n       * (i.e., an Observable rather than the Subject).\n       */\n      this._events = new Subject();\n      /**\n       * A handler for navigation errors in this NgModule.\n       *\n       * @deprecated Subscribe to the `Router` events and watch for `NavigationError` instead.\n       *   `provideRouter` has the `withNavigationErrorHandler` feature to make this easier.\n       * @see {@link withNavigationErrorHandler}\n       */\n      this.errorHandler = this.options.errorHandler || defaultErrorHandler;\n      /**\n       * True if at least one navigation event has occurred,\n       * false otherwise.\n       */\n      this.navigated = false;\n      /**\n       * A strategy for re-using routes.\n       *\n       * @deprecated Configure using `providers` instead:\n       *   `{provide: RouteReuseStrategy, useClass: MyStrategy}`.\n       */\n      this.routeReuseStrategy = inject(RouteReuseStrategy);\n      /**\n       * How to handle a navigation request to the current URL.\n       *\n       *\n       * @deprecated Configure this through `provideRouter` or `RouterModule.forRoot` instead.\n       * @see {@link withRouterConfig}\n       * @see {@link provideRouter}\n       * @see {@link RouterModule}\n       */\n      this.onSameUrlNavigation = this.options.onSameUrlNavigation || 'ignore';\n      this.config = inject(ROUTES, {\n        optional: true\n      })?.flat() ?? [];\n      /**\n       * Indicates whether the application has opted in to binding Router data to component inputs.\n       *\n       * This option is enabled by the `withComponentInputBinding` feature of `provideRouter` or\n       * `bindToComponentInputs` in the `ExtraOptions` of `RouterModule.forRoot`.\n       */\n      this.componentInputBindingEnabled = !!inject(INPUT_BINDER, {\n        optional: true\n      });\n      this.eventsSubscription = new Subscription();\n      this.isNgZoneEnabled = inject(NgZone) instanceof NgZone && NgZone.isInAngularZone();\n      this.resetConfig(this.config);\n      this.navigationTransitions.setupNavigations(this, this.currentUrlTree, this.routerState).subscribe({\n        error: e => {\n          this.console.warn(ngDevMode ? `Unhandled Navigation Error: ${e}` : e);\n        }\n      });\n      this.subscribeToNavigationEvents();\n    }\n    subscribeToNavigationEvents() {\n      const subscription = this.navigationTransitions.events.subscribe(e => {\n        try {\n          const currentTransition = this.navigationTransitions.currentTransition;\n          const currentNavigation = this.navigationTransitions.currentNavigation;\n          if (currentTransition !== null && currentNavigation !== null) {\n            this.stateManager.handleRouterEvent(e, currentNavigation);\n            if (e instanceof NavigationCancel && e.code !== NavigationCancellationCode.Redirect && e.code !== NavigationCancellationCode.SupersededByNewNavigation) {\n              // It seems weird that `navigated` is set to `true` when the navigation is rejected,\n              // however it's how things were written initially. Investigation would need to be done\n              // to determine if this can be removed.\n              this.navigated = true;\n            } else if (e instanceof NavigationEnd) {\n              this.navigated = true;\n            } else if (e instanceof RedirectRequest) {\n              const mergedTree = this.urlHandlingStrategy.merge(e.url, currentTransition.currentRawUrl);\n              const extras = {\n                // Persist transient navigation info from the original navigation request.\n                info: currentTransition.extras.info,\n                skipLocationChange: currentTransition.extras.skipLocationChange,\n                // The URL is already updated at this point if we have 'eager' URL\n                // updates or if the navigation was triggered by the browser (back\n                // button, URL bar, etc). We want to replace that item in history\n                // if the navigation is rejected.\n                replaceUrl: this.urlUpdateStrategy === 'eager' || isBrowserTriggeredNavigation(currentTransition.source)\n              };\n              this.scheduleNavigation(mergedTree, IMPERATIVE_NAVIGATION, null, extras, {\n                resolve: currentTransition.resolve,\n                reject: currentTransition.reject,\n                promise: currentTransition.promise\n              });\n            }\n          }\n          // Note that it's important to have the Router process the events _before_ the event is\n          // pushed through the public observable. This ensures the correct router state is in place\n          // before applications observe the events.\n          if (isPublicRouterEvent(e)) {\n            this._events.next(e);\n          }\n        } catch (e) {\n          this.navigationTransitions.transitionAbortSubject.next(e);\n        }\n      });\n      this.eventsSubscription.add(subscription);\n    }\n    /** @internal */\n    resetRootComponentType(rootComponentType) {\n      // TODO: vsavkin router 4.0 should make the root component set to null\n      // this will simplify the lifecycle of the router.\n      this.routerState.root.component = rootComponentType;\n      this.navigationTransitions.rootComponentType = rootComponentType;\n    }\n    /**\n     * Sets up the location change listener and performs the initial navigation.\n     */\n    initialNavigation() {\n      this.setUpLocationChangeListener();\n      if (!this.navigationTransitions.hasRequestedNavigation) {\n        this.navigateToSyncWithBrowser(this.location.path(true), IMPERATIVE_NAVIGATION, this.stateManager.restoredState());\n      }\n    }\n    /**\n     * Sets up the location change listener. This listener detects navigations triggered from outside\n     * the Router (the browser back/forward buttons, for example) and schedules a corresponding Router\n     * navigation so that the correct events, guards, etc. are triggered.\n     */\n    setUpLocationChangeListener() {\n      // Don't need to use Zone.wrap any more, because zone.js\n      // already patch onPopState, so location change callback will\n      // run into ngZone\n      this.nonRouterCurrentEntryChangeSubscription ??= this.stateManager.registerNonRouterCurrentEntryChangeListener((url, state) => {\n        // The `setTimeout` was added in #12160 and is likely to support Angular/AngularJS\n        // hybrid apps.\n        setTimeout(() => {\n          this.navigateToSyncWithBrowser(url, 'popstate', state);\n        }, 0);\n      });\n    }\n    /**\n     * Schedules a router navigation to synchronize Router state with the browser state.\n     *\n     * This is done as a response to a popstate event and the initial navigation. These\n     * two scenarios represent times when the browser URL/state has been updated and\n     * the Router needs to respond to ensure its internal state matches.\n     */\n    navigateToSyncWithBrowser(url, source, state) {\n      const extras = {\n        replaceUrl: true\n      };\n      // TODO: restoredState should always include the entire state, regardless\n      // of navigationId. This requires a breaking change to update the type on\n      // NavigationStart’s restoredState, which currently requires navigationId\n      // to always be present. The Router used to only restore history state if\n      // a navigationId was present.\n      // The stored navigationId is used by the RouterScroller to retrieve the scroll\n      // position for the page.\n      const restoredState = state?.navigationId ? state : null;\n      // Separate to NavigationStart.restoredState, we must also restore the state to\n      // history.state and generate a new navigationId, since it will be overwritten\n      if (state) {\n        const stateCopy = {\n          ...state\n        };\n        delete stateCopy.navigationId;\n        delete stateCopy.ɵrouterPageId;\n        if (Object.keys(stateCopy).length !== 0) {\n          extras.state = stateCopy;\n        }\n      }\n      const urlTree = this.parseUrl(url);\n      this.scheduleNavigation(urlTree, source, restoredState, extras);\n    }\n    /** The current URL. */\n    get url() {\n      return this.serializeUrl(this.currentUrlTree);\n    }\n    /**\n     * Returns the current `Navigation` object when the router is navigating,\n     * and `null` when idle.\n     */\n    getCurrentNavigation() {\n      return this.navigationTransitions.currentNavigation;\n    }\n    /**\n     * The `Navigation` object of the most recent navigation to succeed and `null` if there\n     *     has not been a successful navigation yet.\n     */\n    get lastSuccessfulNavigation() {\n      return this.navigationTransitions.lastSuccessfulNavigation;\n    }\n    /**\n     * Resets the route configuration used for navigation and generating links.\n     *\n     * @param config The route array for the new configuration.\n     *\n     * @usageNotes\n     *\n     * ```\n     * router.resetConfig([\n     *  { path: 'team/:id', component: TeamCmp, children: [\n     *    { path: 'simple', component: SimpleCmp },\n     *    { path: 'user/:name', component: UserCmp }\n     *  ]}\n     * ]);\n     * ```\n     */\n    resetConfig(config) {\n      (typeof ngDevMode === 'undefined' || ngDevMode) && validateConfig(config);\n      this.config = config.map(standardizeConfig);\n      this.navigated = false;\n    }\n    /** @nodoc */\n    ngOnDestroy() {\n      this.dispose();\n    }\n    /** Disposes of the router. */\n    dispose() {\n      this.navigationTransitions.complete();\n      if (this.nonRouterCurrentEntryChangeSubscription) {\n        this.nonRouterCurrentEntryChangeSubscription.unsubscribe();\n        this.nonRouterCurrentEntryChangeSubscription = undefined;\n      }\n      this.disposed = true;\n      this.eventsSubscription.unsubscribe();\n    }\n    /**\n     * Appends URL segments to the current URL tree to create a new URL tree.\n     *\n     * @param commands An array of URL fragments with which to construct the new URL tree.\n     * If the path is static, can be the literal URL string. For a dynamic path, pass an array of path\n     * segments, followed by the parameters for each segment.\n     * The fragments are applied to the current URL tree or the one provided  in the `relativeTo`\n     * property of the options object, if supplied.\n     * @param navigationExtras Options that control the navigation strategy.\n     * @returns The new URL tree.\n     *\n     * @usageNotes\n     *\n     * ```\n     * // create /team/33/user/11\n     * router.createUrlTree(['/team', 33, 'user', 11]);\n     *\n     * // create /team/33;expand=true/user/11\n     * router.createUrlTree(['/team', 33, {expand: true}, 'user', 11]);\n     *\n     * // you can collapse static segments like this (this works only with the first passed-in value):\n     * router.createUrlTree(['/team/33/user', userId]);\n     *\n     * // If the first segment can contain slashes, and you do not want the router to split it,\n     * // you can do the following:\n     * router.createUrlTree([{segmentPath: '/one/two'}]);\n     *\n     * // create /team/33/(user/11//right:chat)\n     * router.createUrlTree(['/team', 33, {outlets: {primary: 'user/11', right: 'chat'}}]);\n     *\n     * // remove the right secondary node\n     * router.createUrlTree(['/team', 33, {outlets: {primary: 'user/11', right: null}}]);\n     *\n     * // assuming the current url is `/team/33/user/11` and the route points to `user/11`\n     *\n     * // navigate to /team/33/user/11/details\n     * router.createUrlTree(['details'], {relativeTo: route});\n     *\n     * // navigate to /team/33/user/22\n     * router.createUrlTree(['../22'], {relativeTo: route});\n     *\n     * // navigate to /team/44/user/22\n     * router.createUrlTree(['../../team/44/user/22'], {relativeTo: route});\n     *\n     * Note that a value of `null` or `undefined` for `relativeTo` indicates that the\n     * tree should be created relative to the root.\n     * ```\n     */\n    createUrlTree(commands, navigationExtras = {}) {\n      const {\n        relativeTo,\n        queryParams,\n        fragment,\n        queryParamsHandling,\n        preserveFragment\n      } = navigationExtras;\n      const f = preserveFragment ? this.currentUrlTree.fragment : fragment;\n      let q = null;\n      switch (queryParamsHandling) {\n        case 'merge':\n          q = {\n            ...this.currentUrlTree.queryParams,\n            ...queryParams\n          };\n          break;\n        case 'preserve':\n          q = this.currentUrlTree.queryParams;\n          break;\n        default:\n          q = queryParams || null;\n      }\n      if (q !== null) {\n        q = this.removeEmptyProps(q);\n      }\n      let relativeToUrlSegmentGroup;\n      try {\n        const relativeToSnapshot = relativeTo ? relativeTo.snapshot : this.routerState.snapshot.root;\n        relativeToUrlSegmentGroup = createSegmentGroupFromRoute(relativeToSnapshot);\n      } catch (e) {\n        // This is strictly for backwards compatibility with tests that create\n        // invalid `ActivatedRoute` mocks.\n        // Note: the difference between having this fallback for invalid `ActivatedRoute` setups and\n        // just throwing is ~500 test failures. Fixing all of those tests by hand is not feasible at\n        // the moment.\n        if (typeof commands[0] !== 'string' || !commands[0].startsWith('/')) {\n          // Navigations that were absolute in the old way of creating UrlTrees\n          // would still work because they wouldn't attempt to match the\n          // segments in the `ActivatedRoute` to the `currentUrlTree` but\n          // instead just replace the root segment with the navigation result.\n          // Non-absolute navigations would fail to apply the commands because\n          // the logic could not find the segment to replace (so they'd act like there were no\n          // commands).\n          commands = [];\n        }\n        relativeToUrlSegmentGroup = this.currentUrlTree.root;\n      }\n      return createUrlTreeFromSegmentGroup(relativeToUrlSegmentGroup, commands, q, f ?? null);\n    }\n    /**\n     * Navigates to a view using an absolute route path.\n     *\n     * @param url An absolute path for a defined route. The function does not apply any delta to the\n     *     current URL.\n     * @param extras An object containing properties that modify the navigation strategy.\n     *\n     * @returns A Promise that resolves to 'true' when navigation succeeds,\n     * to 'false' when navigation fails, or is rejected on error.\n     *\n     * @usageNotes\n     *\n     * The following calls request navigation to an absolute path.\n     *\n     * ```\n     * router.navigateByUrl(\"/team/33/user/11\");\n     *\n     * // Navigate without updating the URL\n     * router.navigateByUrl(\"/team/33/user/11\", { skipLocationChange: true });\n     * ```\n     *\n     * @see [Routing and Navigation guide](guide/router)\n     *\n     */\n    navigateByUrl(url, extras = {\n      skipLocationChange: false\n    }) {\n      if (typeof ngDevMode === 'undefined' || ngDevMode) {\n        if (this.isNgZoneEnabled && !NgZone.isInAngularZone()) {\n          this.console.warn(`Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?`);\n        }\n      }\n      const urlTree = isUrlTree(url) ? url : this.parseUrl(url);\n      const mergedTree = this.urlHandlingStrategy.merge(urlTree, this.rawUrlTree);\n      return this.scheduleNavigation(mergedTree, IMPERATIVE_NAVIGATION, null, extras);\n    }\n    /**\n     * Navigate based on the provided array of commands and a starting point.\n     * If no starting route is provided, the navigation is absolute.\n     *\n     * @param commands An array of URL fragments with which to construct the target URL.\n     * If the path is static, can be the literal URL string. For a dynamic path, pass an array of path\n     * segments, followed by the parameters for each segment.\n     * The fragments are applied to the current URL or the one provided  in the `relativeTo` property\n     * of the options object, if supplied.\n     * @param extras An options object that determines how the URL should be constructed or\n     *     interpreted.\n     *\n     * @returns A Promise that resolves to `true` when navigation succeeds, or `false` when navigation\n     *     fails. The Promise is rejected when an error occurs if `resolveNavigationPromiseOnError` is\n     * not `true`.\n     *\n     * @usageNotes\n     *\n     * The following calls request navigation to a dynamic route path relative to the current URL.\n     *\n     * ```\n     * router.navigate(['team', 33, 'user', 11], {relativeTo: route});\n     *\n     * // Navigate without updating the URL, overriding the default behavior\n     * router.navigate(['team', 33, 'user', 11], {relativeTo: route, skipLocationChange: true});\n     * ```\n     *\n     * @see [Routing and Navigation guide](guide/router)\n     *\n     */\n    navigate(commands, extras = {\n      skipLocationChange: false\n    }) {\n      validateCommands(commands);\n      return this.navigateByUrl(this.createUrlTree(commands, extras), extras);\n    }\n    /** Serializes a `UrlTree` into a string */\n    serializeUrl(url) {\n      return this.urlSerializer.serialize(url);\n    }\n    /** Parses a string into a `UrlTree` */\n    parseUrl(url) {\n      try {\n        return this.urlSerializer.parse(url);\n      } catch {\n        return this.urlSerializer.parse('/');\n      }\n    }\n    isActive(url, matchOptions) {\n      let options;\n      if (matchOptions === true) {\n        options = {\n          ...exactMatchOptions\n        };\n      } else if (matchOptions === false) {\n        options = {\n          ...subsetMatchOptions\n        };\n      } else {\n        options = matchOptions;\n      }\n      if (isUrlTree(url)) {\n        return containsTree(this.currentUrlTree, url, options);\n      }\n      const urlTree = this.parseUrl(url);\n      return containsTree(this.currentUrlTree, urlTree, options);\n    }\n    removeEmptyProps(params) {\n      return Object.entries(params).reduce((result, [key, value]) => {\n        if (value !== null && value !== undefined) {\n          result[key] = value;\n        }\n        return result;\n      }, {});\n    }\n    scheduleNavigation(rawUrl, source, restoredState, extras, priorPromise) {\n      if (this.disposed) {\n        return Promise.resolve(false);\n      }\n      let resolve;\n      let reject;\n      let promise;\n      if (priorPromise) {\n        resolve = priorPromise.resolve;\n        reject = priorPromise.reject;\n        promise = priorPromise.promise;\n      } else {\n        promise = new Promise((res, rej) => {\n          resolve = res;\n          reject = rej;\n        });\n      }\n      // Indicate that the navigation is happening.\n      const taskId = this.pendingTasks.add();\n      afterNextNavigation(this, () => {\n        // Remove pending task in a microtask to allow for cancelled\n        // initial navigations and redirects within the same task.\n        queueMicrotask(() => this.pendingTasks.remove(taskId));\n      });\n      this.navigationTransitions.handleNavigationRequest({\n        source,\n        restoredState,\n        currentUrlTree: this.currentUrlTree,\n        currentRawUrl: this.currentUrlTree,\n        rawUrl,\n        extras,\n        resolve,\n        reject,\n        promise,\n        currentSnapshot: this.routerState.snapshot,\n        currentRouterState: this.routerState\n      });\n      // Make sure that the error is propagated even though `processNavigations` catch\n      // handler does not rethrow\n      return promise.catch(e => {\n        return Promise.reject(e);\n      });\n    }\n    static {\n      this.ɵfac = function Router_Factory(t) {\n        return new (t || Router)();\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: Router,\n        factory: Router.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return Router;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nfunction validateCommands(commands) {\n  for (let i = 0; i < commands.length; i++) {\n    const cmd = commands[i];\n    if (cmd == null) {\n      throw new ɵRuntimeError(4008 /* RuntimeErrorCode.NULLISH_COMMAND */, (typeof ngDevMode === 'undefined' || ngDevMode) && `The requested path contains ${cmd} segment at index ${i}`);\n    }\n  }\n}\nfunction isPublicRouterEvent(e) {\n  return !(e instanceof BeforeActivateRoutes) && !(e instanceof RedirectRequest);\n}\n\n/**\n * @description\n *\n * When applied to an element in a template, makes that element a link\n * that initiates navigation to a route. Navigation opens one or more routed components\n * in one or more `<router-outlet>` locations on the page.\n *\n * Given a route configuration `[{ path: 'user/:name', component: UserCmp }]`,\n * the following creates a static link to the route:\n * `<a routerLink=\"/user/bob\">link to user component</a>`\n *\n * You can use dynamic values to generate the link.\n * For a dynamic link, pass an array of path segments,\n * followed by the params for each segment.\n * For example, `['/team', teamId, 'user', userName, {details: true}]`\n * generates a link to `/team/11/user/bob;details=true`.\n *\n * Multiple static segments can be merged into one term and combined with dynamic segments.\n * For example, `['/team/11/user', userName, {details: true}]`\n *\n * The input that you provide to the link is treated as a delta to the current URL.\n * For instance, suppose the current URL is `/user/(box//aux:team)`.\n * The link `<a [routerLink]=\"['/user/jim']\">Jim</a>` creates the URL\n * `/user/(jim//aux:team)`.\n * See {@link Router#createUrlTree} for more information.\n *\n * @usageNotes\n *\n * You can use absolute or relative paths in a link, set query parameters,\n * control how parameters are handled, and keep a history of navigation states.\n *\n * ### Relative link paths\n *\n * The first segment name can be prepended with `/`, `./`, or `../`.\n * * If the first segment begins with `/`, the router looks up the route from the root of the\n *   app.\n * * If the first segment begins with `./`, or doesn't begin with a slash, the router\n *   looks in the children of the current activated route.\n * * If the first segment begins with `../`, the router goes up one level in the route tree.\n *\n * ### Setting and handling query params and fragments\n *\n * The following link adds a query parameter and a fragment to the generated URL:\n *\n * ```\n * <a [routerLink]=\"['/user/bob']\" [queryParams]=\"{debug: true}\" fragment=\"education\">\n *   link to user component\n * </a>\n * ```\n * By default, the directive constructs the new URL using the given query parameters.\n * The example generates the link: `/user/bob?debug=true#education`.\n *\n * You can instruct the directive to handle query parameters differently\n * by specifying the `queryParamsHandling` option in the link.\n * Allowed values are:\n *\n *  - `'merge'`: Merge the given `queryParams` into the current query params.\n *  - `'preserve'`: Preserve the current query params.\n *\n * For example:\n *\n * ```\n * <a [routerLink]=\"['/user/bob']\" [queryParams]=\"{debug: true}\" queryParamsHandling=\"merge\">\n *   link to user component\n * </a>\n * ```\n *\n * See {@link UrlCreationOptions#queryParamsHandling}.\n *\n * ### Preserving navigation history\n *\n * You can provide a `state` value to be persisted to the browser's\n * [`History.state` property](https://developer.mozilla.org/en-US/docs/Web/API/History#Properties).\n * For example:\n *\n * ```\n * <a [routerLink]=\"['/user/bob']\" [state]=\"{tracingId: 123}\">\n *   link to user component\n * </a>\n * ```\n *\n * Use {@link Router#getCurrentNavigation} to retrieve a saved\n * navigation-state value. For example, to capture the `tracingId` during the `NavigationStart`\n * event:\n *\n * ```\n * // Get NavigationStart events\n * router.events.pipe(filter(e => e instanceof NavigationStart)).subscribe(e => {\n *   const navigation = router.getCurrentNavigation();\n *   tracingService.trace({id: navigation.extras.state.tracingId});\n * });\n * ```\n *\n * @ngModule RouterModule\n *\n * @publicApi\n */\nlet RouterLink = /*#__PURE__*/(() => {\n  class RouterLink {\n    constructor(router, route, tabIndexAttribute, renderer, el, locationStrategy) {\n      this.router = router;\n      this.route = route;\n      this.tabIndexAttribute = tabIndexAttribute;\n      this.renderer = renderer;\n      this.el = el;\n      this.locationStrategy = locationStrategy;\n      /**\n       * Represents an `href` attribute value applied to a host element,\n       * when a host element is `<a>`. For other tags, the value is `null`.\n       */\n      this.href = null;\n      this.commands = null;\n      /** @internal */\n      this.onChanges = new Subject();\n      /**\n       * Passed to {@link Router#createUrlTree} as part of the\n       * `UrlCreationOptions`.\n       * @see {@link UrlCreationOptions#preserveFragment}\n       * @see {@link Router#createUrlTree}\n       */\n      this.preserveFragment = false;\n      /**\n       * Passed to {@link Router#navigateByUrl} as part of the\n       * `NavigationBehaviorOptions`.\n       * @see {@link NavigationBehaviorOptions#skipLocationChange}\n       * @see {@link Router#navigateByUrl}\n       */\n      this.skipLocationChange = false;\n      /**\n       * Passed to {@link Router#navigateByUrl} as part of the\n       * `NavigationBehaviorOptions`.\n       * @see {@link NavigationBehaviorOptions#replaceUrl}\n       * @see {@link Router#navigateByUrl}\n       */\n      this.replaceUrl = false;\n      const tagName = el.nativeElement.tagName?.toLowerCase();\n      this.isAnchorElement = tagName === 'a' || tagName === 'area';\n      if (this.isAnchorElement) {\n        this.subscription = router.events.subscribe(s => {\n          if (s instanceof NavigationEnd) {\n            this.updateHref();\n          }\n        });\n      } else {\n        this.setTabIndexIfNotOnNativeEl('0');\n      }\n    }\n    /**\n     * Modifies the tab index if there was not a tabindex attribute on the element during\n     * instantiation.\n     */\n    setTabIndexIfNotOnNativeEl(newTabIndex) {\n      if (this.tabIndexAttribute != null /* both `null` and `undefined` */ || this.isAnchorElement) {\n        return;\n      }\n      this.applyAttributeValue('tabindex', newTabIndex);\n    }\n    /** @nodoc */\n    ngOnChanges(changes) {\n      if (this.isAnchorElement) {\n        this.updateHref();\n      }\n      // This is subscribed to by `RouterLinkActive` so that it knows to update when there are changes\n      // to the RouterLinks it's tracking.\n      this.onChanges.next(this);\n    }\n    /**\n     * Commands to pass to {@link Router#createUrlTree}.\n     *   - **array**: commands to pass to {@link Router#createUrlTree}.\n     *   - **string**: shorthand for array of commands with just the string, i.e. `['/route']`\n     *   - **null|undefined**: effectively disables the `routerLink`\n     * @see {@link Router#createUrlTree}\n     */\n    set routerLink(commands) {\n      if (commands != null) {\n        this.commands = Array.isArray(commands) ? commands : [commands];\n        this.setTabIndexIfNotOnNativeEl('0');\n      } else {\n        this.commands = null;\n        this.setTabIndexIfNotOnNativeEl(null);\n      }\n    }\n    /** @nodoc */\n    onClick(button, ctrlKey, shiftKey, altKey, metaKey) {\n      const urlTree = this.urlTree;\n      if (urlTree === null) {\n        return true;\n      }\n      if (this.isAnchorElement) {\n        if (button !== 0 || ctrlKey || shiftKey || altKey || metaKey) {\n          return true;\n        }\n        if (typeof this.target === 'string' && this.target != '_self') {\n          return true;\n        }\n      }\n      const extras = {\n        skipLocationChange: this.skipLocationChange,\n        replaceUrl: this.replaceUrl,\n        state: this.state,\n        info: this.info\n      };\n      this.router.navigateByUrl(urlTree, extras);\n      // Return `false` for `<a>` elements to prevent default action\n      // and cancel the native behavior, since the navigation is handled\n      // by the Router.\n      return !this.isAnchorElement;\n    }\n    /** @nodoc */\n    ngOnDestroy() {\n      this.subscription?.unsubscribe();\n    }\n    updateHref() {\n      const urlTree = this.urlTree;\n      this.href = urlTree !== null && this.locationStrategy ? this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(urlTree)) : null;\n      const sanitizedValue = this.href === null ? null :\n      // This class represents a directive that can be added to both `<a>` elements,\n      // as well as other elements. As a result, we can't define security context at\n      // compile time. So the security context is deferred to runtime.\n      // The `ɵɵsanitizeUrlOrResourceUrl` selects the necessary sanitizer function\n      // based on the tag and property names. The logic mimics the one from\n      // `packages/compiler/src/schema/dom_security_schema.ts`, which is used at compile time.\n      //\n      // Note: we should investigate whether we can switch to using `@HostBinding('attr.href')`\n      // instead of applying a value via a renderer, after a final merge of the\n      // `RouterLinkWithHref` directive.\n      ɵɵsanitizeUrlOrResourceUrl(this.href, this.el.nativeElement.tagName.toLowerCase(), 'href');\n      this.applyAttributeValue('href', sanitizedValue);\n    }\n    applyAttributeValue(attrName, attrValue) {\n      const renderer = this.renderer;\n      const nativeElement = this.el.nativeElement;\n      if (attrValue !== null) {\n        renderer.setAttribute(nativeElement, attrName, attrValue);\n      } else {\n        renderer.removeAttribute(nativeElement, attrName);\n      }\n    }\n    get urlTree() {\n      if (this.commands === null) {\n        return null;\n      }\n      return this.router.createUrlTree(this.commands, {\n        // If the `relativeTo` input is not defined, we want to use `this.route` by default.\n        // Otherwise, we should use the value provided by the user in the input.\n        relativeTo: this.relativeTo !== undefined ? this.relativeTo : this.route,\n        queryParams: this.queryParams,\n        fragment: this.fragment,\n        queryParamsHandling: this.queryParamsHandling,\n        preserveFragment: this.preserveFragment\n      });\n    }\n    static {\n      this.ɵfac = function RouterLink_Factory(t) {\n        return new (t || RouterLink)(i0.ɵɵdirectiveInject(Router), i0.ɵɵdirectiveInject(ActivatedRoute), i0.ɵɵinjectAttribute('tabindex'), i0.ɵɵdirectiveInject(i0.Renderer2), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i3.LocationStrategy));\n      };\n    }\n    static {\n      this.ɵdir = /* @__PURE__ */i0.ɵɵdefineDirective({\n        type: RouterLink,\n        selectors: [[\"\", \"routerLink\", \"\"]],\n        hostVars: 1,\n        hostBindings: function RouterLink_HostBindings(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵlistener(\"click\", function RouterLink_click_HostBindingHandler($event) {\n              return ctx.onClick($event.button, $event.ctrlKey, $event.shiftKey, $event.altKey, $event.metaKey);\n            });\n          }\n          if (rf & 2) {\n            i0.ɵɵattribute(\"target\", ctx.target);\n          }\n        },\n        inputs: {\n          target: \"target\",\n          queryParams: \"queryParams\",\n          fragment: \"fragment\",\n          queryParamsHandling: \"queryParamsHandling\",\n          state: \"state\",\n          info: \"info\",\n          relativeTo: \"relativeTo\",\n          preserveFragment: [i0.ɵɵInputFlags.HasDecoratorInputTransform, \"preserveFragment\", \"preserveFragment\", booleanAttribute],\n          skipLocationChange: [i0.ɵɵInputFlags.HasDecoratorInputTransform, \"skipLocationChange\", \"skipLocationChange\", booleanAttribute],\n          replaceUrl: [i0.ɵɵInputFlags.HasDecoratorInputTransform, \"replaceUrl\", \"replaceUrl\", booleanAttribute],\n          routerLink: \"routerLink\"\n        },\n        standalone: true,\n        features: [i0.ɵɵInputTransformsFeature, i0.ɵɵNgOnChangesFeature]\n      });\n    }\n  }\n  return RouterLink;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n/**\n *\n * @description\n *\n * Tracks whether the linked route of an element is currently active, and allows you\n * to specify one or more CSS classes to add to the element when the linked route\n * is active.\n *\n * Use this directive to create a visual distinction for elements associated with an active route.\n * For example, the following code highlights the word \"Bob\" when the router\n * activates the associated route:\n *\n * ```\n * <a routerLink=\"/user/bob\" routerLinkActive=\"active-link\">Bob</a>\n * ```\n *\n * Whenever the URL is either '/user' or '/user/bob', the \"active-link\" class is\n * added to the anchor tag. If the URL changes, the class is removed.\n *\n * You can set more than one class using a space-separated string or an array.\n * For example:\n *\n * ```\n * <a routerLink=\"/user/bob\" routerLinkActive=\"class1 class2\">Bob</a>\n * <a routerLink=\"/user/bob\" [routerLinkActive]=\"['class1', 'class2']\">Bob</a>\n * ```\n *\n * To add the classes only when the URL matches the link exactly, add the option `exact: true`:\n *\n * ```\n * <a routerLink=\"/user/bob\" routerLinkActive=\"active-link\" [routerLinkActiveOptions]=\"{exact:\n * true}\">Bob</a>\n * ```\n *\n * To directly check the `isActive` status of the link, assign the `RouterLinkActive`\n * instance to a template variable.\n * For example, the following checks the status without assigning any CSS classes:\n *\n * ```\n * <a routerLink=\"/user/bob\" routerLinkActive #rla=\"routerLinkActive\">\n *   Bob {{ rla.isActive ? '(already open)' : ''}}\n * </a>\n * ```\n *\n * You can apply the `RouterLinkActive` directive to an ancestor of linked elements.\n * For example, the following sets the active-link class on the `<div>`  parent tag\n * when the URL is either '/user/jim' or '/user/bob'.\n *\n * ```\n * <div routerLinkActive=\"active-link\" [routerLinkActiveOptions]=\"{exact: true}\">\n *   <a routerLink=\"/user/jim\">Jim</a>\n *   <a routerLink=\"/user/bob\">Bob</a>\n * </div>\n * ```\n *\n * The `RouterLinkActive` directive can also be used to set the aria-current attribute\n * to provide an alternative distinction for active elements to visually impaired users.\n *\n * For example, the following code adds the 'active' class to the Home Page link when it is\n * indeed active and in such case also sets its aria-current attribute to 'page':\n *\n * ```\n * <a routerLink=\"/\" routerLinkActive=\"active\" ariaCurrentWhenActive=\"page\">Home Page</a>\n * ```\n *\n * @ngModule RouterModule\n *\n * @publicApi\n */\nlet RouterLinkActive = /*#__PURE__*/(() => {\n  class RouterLinkActive {\n    get isActive() {\n      return this._isActive;\n    }\n    constructor(router, element, renderer, cdr, link) {\n      this.router = router;\n      this.element = element;\n      this.renderer = renderer;\n      this.cdr = cdr;\n      this.link = link;\n      this.classes = [];\n      this._isActive = false;\n      /**\n       * Options to configure how to determine if the router link is active.\n       *\n       * These options are passed to the `Router.isActive()` function.\n       *\n       * @see {@link Router#isActive}\n       */\n      this.routerLinkActiveOptions = {\n        exact: false\n      };\n      /**\n       *\n       * You can use the output `isActiveChange` to get notified each time the link becomes\n       * active or inactive.\n       *\n       * Emits:\n       * true  -> Route is active\n       * false -> Route is inactive\n       *\n       * ```\n       * <a\n       *  routerLink=\"/user/bob\"\n       *  routerLinkActive=\"active-link\"\n       *  (isActiveChange)=\"this.onRouterLinkActive($event)\">Bob</a>\n       * ```\n       */\n      this.isActiveChange = new EventEmitter();\n      this.routerEventsSubscription = router.events.subscribe(s => {\n        if (s instanceof NavigationEnd) {\n          this.update();\n        }\n      });\n    }\n    /** @nodoc */\n    ngAfterContentInit() {\n      // `of(null)` is used to force subscribe body to execute once immediately (like `startWith`).\n      of(this.links.changes, of(null)).pipe(mergeAll()).subscribe(_ => {\n        this.update();\n        this.subscribeToEachLinkOnChanges();\n      });\n    }\n    subscribeToEachLinkOnChanges() {\n      this.linkInputChangesSubscription?.unsubscribe();\n      const allLinkChanges = [...this.links.toArray(), this.link].filter(link => !!link).map(link => link.onChanges);\n      this.linkInputChangesSubscription = from(allLinkChanges).pipe(mergeAll()).subscribe(link => {\n        if (this._isActive !== this.isLinkActive(this.router)(link)) {\n          this.update();\n        }\n      });\n    }\n    set routerLinkActive(data) {\n      const classes = Array.isArray(data) ? data : data.split(' ');\n      this.classes = classes.filter(c => !!c);\n    }\n    /** @nodoc */\n    ngOnChanges(changes) {\n      this.update();\n    }\n    /** @nodoc */\n    ngOnDestroy() {\n      this.routerEventsSubscription.unsubscribe();\n      this.linkInputChangesSubscription?.unsubscribe();\n    }\n    update() {\n      if (!this.links || !this.router.navigated) return;\n      queueMicrotask(() => {\n        const hasActiveLinks = this.hasActiveLinks();\n        if (this._isActive !== hasActiveLinks) {\n          this._isActive = hasActiveLinks;\n          this.cdr.markForCheck();\n          this.classes.forEach(c => {\n            if (hasActiveLinks) {\n              this.renderer.addClass(this.element.nativeElement, c);\n            } else {\n              this.renderer.removeClass(this.element.nativeElement, c);\n            }\n          });\n          if (hasActiveLinks && this.ariaCurrentWhenActive !== undefined) {\n            this.renderer.setAttribute(this.element.nativeElement, 'aria-current', this.ariaCurrentWhenActive.toString());\n          } else {\n            this.renderer.removeAttribute(this.element.nativeElement, 'aria-current');\n          }\n          // Emit on isActiveChange after classes are updated\n          this.isActiveChange.emit(hasActiveLinks);\n        }\n      });\n    }\n    isLinkActive(router) {\n      const options = isActiveMatchOptions(this.routerLinkActiveOptions) ? this.routerLinkActiveOptions :\n      // While the types should disallow `undefined` here, it's possible without strict inputs\n      this.routerLinkActiveOptions.exact || false;\n      return link => {\n        const urlTree = link.urlTree;\n        return urlTree ? router.isActive(urlTree, options) : false;\n      };\n    }\n    hasActiveLinks() {\n      const isActiveCheckFn = this.isLinkActive(this.router);\n      return this.link && isActiveCheckFn(this.link) || this.links.some(isActiveCheckFn);\n    }\n    static {\n      this.ɵfac = function RouterLinkActive_Factory(t) {\n        return new (t || RouterLinkActive)(i0.ɵɵdirectiveInject(Router), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.Renderer2), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(RouterLink, 8));\n      };\n    }\n    static {\n      this.ɵdir = /* @__PURE__ */i0.ɵɵdefineDirective({\n        type: RouterLinkActive,\n        selectors: [[\"\", \"routerLinkActive\", \"\"]],\n        contentQueries: function RouterLinkActive_ContentQueries(rf, ctx, dirIndex) {\n          if (rf & 1) {\n            i0.ɵɵcontentQuery(dirIndex, RouterLink, 5);\n          }\n          if (rf & 2) {\n            let _t;\n            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.links = _t);\n          }\n        },\n        inputs: {\n          routerLinkActiveOptions: \"routerLinkActiveOptions\",\n          ariaCurrentWhenActive: \"ariaCurrentWhenActive\",\n          routerLinkActive: \"routerLinkActive\"\n        },\n        outputs: {\n          isActiveChange: \"isActiveChange\"\n        },\n        exportAs: [\"routerLinkActive\"],\n        standalone: true,\n        features: [i0.ɵɵNgOnChangesFeature]\n      });\n    }\n  }\n  return RouterLinkActive;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n/**\n * Use instead of `'paths' in options` to be compatible with property renaming\n */\nfunction isActiveMatchOptions(options) {\n  return !!options.paths;\n}\n\n/**\n * @description\n *\n * Provides a preloading strategy.\n *\n * @publicApi\n */\nclass PreloadingStrategy {}\n/**\n * @description\n *\n * Provides a preloading strategy that preloads all modules as quickly as possible.\n *\n * ```\n * RouterModule.forRoot(ROUTES, {preloadingStrategy: PreloadAllModules})\n * ```\n *\n * @publicApi\n */\nlet PreloadAllModules = /*#__PURE__*/(() => {\n  class PreloadAllModules {\n    preload(route, fn) {\n      return fn().pipe(catchError(() => of(null)));\n    }\n    static {\n      this.ɵfac = function PreloadAllModules_Factory(t) {\n        return new (t || PreloadAllModules)();\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: PreloadAllModules,\n        factory: PreloadAllModules.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return PreloadAllModules;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n/**\n * @description\n *\n * Provides a preloading strategy that does not preload any modules.\n *\n * This strategy is enabled by default.\n *\n * @publicApi\n */\nlet NoPreloading = /*#__PURE__*/(() => {\n  class NoPreloading {\n    preload(route, fn) {\n      return of(null);\n    }\n    static {\n      this.ɵfac = function NoPreloading_Factory(t) {\n        return new (t || NoPreloading)();\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: NoPreloading,\n        factory: NoPreloading.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return NoPreloading;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n/**\n * The preloader optimistically loads all router configurations to\n * make navigations into lazily-loaded sections of the application faster.\n *\n * The preloader runs in the background. When the router bootstraps, the preloader\n * starts listening to all navigation events. After every such event, the preloader\n * will check if any configurations can be loaded lazily.\n *\n * If a route is protected by `canLoad` guards, the preloaded will not load it.\n *\n * @publicApi\n */\nlet RouterPreloader = /*#__PURE__*/(() => {\n  class RouterPreloader {\n    constructor(router, compiler, injector, preloadingStrategy, loader) {\n      this.router = router;\n      this.injector = injector;\n      this.preloadingStrategy = preloadingStrategy;\n      this.loader = loader;\n    }\n    setUpPreloading() {\n      this.subscription = this.router.events.pipe(filter(e => e instanceof NavigationEnd), concatMap(() => this.preload())).subscribe(() => {});\n    }\n    preload() {\n      return this.processRoutes(this.injector, this.router.config);\n    }\n    /** @nodoc */\n    ngOnDestroy() {\n      if (this.subscription) {\n        this.subscription.unsubscribe();\n      }\n    }\n    processRoutes(injector, routes) {\n      const res = [];\n      for (const route of routes) {\n        if (route.providers && !route._injector) {\n          route._injector = createEnvironmentInjector(route.providers, injector, `Route: ${route.path}`);\n        }\n        const injectorForCurrentRoute = route._injector ?? injector;\n        const injectorForChildren = route._loadedInjector ?? injectorForCurrentRoute;\n        // Note that `canLoad` is only checked as a condition that prevents `loadChildren` and not\n        // `loadComponent`. `canLoad` guards only block loading of child routes by design. This\n        // happens as a consequence of needing to descend into children for route matching immediately\n        // while component loading is deferred until route activation. Because `canLoad` guards can\n        // have side effects, we cannot execute them here so we instead skip preloading altogether\n        // when present. Lastly, it remains to be decided whether `canLoad` should behave this way\n        // at all. Code splitting and lazy loading is separate from client-side authorization checks\n        // and should not be used as a security measure to prevent loading of code.\n        if (route.loadChildren && !route._loadedRoutes && route.canLoad === undefined || route.loadComponent && !route._loadedComponent) {\n          res.push(this.preloadConfig(injectorForCurrentRoute, route));\n        }\n        if (route.children || route._loadedRoutes) {\n          res.push(this.processRoutes(injectorForChildren, route.children ?? route._loadedRoutes));\n        }\n      }\n      return from(res).pipe(mergeAll());\n    }\n    preloadConfig(injector, route) {\n      return this.preloadingStrategy.preload(route, () => {\n        let loadedChildren$;\n        if (route.loadChildren && route.canLoad === undefined) {\n          loadedChildren$ = this.loader.loadChildren(injector, route);\n        } else {\n          loadedChildren$ = of(null);\n        }\n        const recursiveLoadChildren$ = loadedChildren$.pipe(mergeMap(config => {\n          if (config === null) {\n            return of(void 0);\n          }\n          route._loadedRoutes = config.routes;\n          route._loadedInjector = config.injector;\n          // If the loaded config was a module, use that as the module/module injector going\n          // forward. Otherwise, continue using the current module/module injector.\n          return this.processRoutes(config.injector ?? injector, config.routes);\n        }));\n        if (route.loadComponent && !route._loadedComponent) {\n          const loadComponent$ = this.loader.loadComponent(route);\n          return from([recursiveLoadChildren$, loadComponent$]).pipe(mergeAll());\n        } else {\n          return recursiveLoadChildren$;\n        }\n      });\n    }\n    static {\n      this.ɵfac = function RouterPreloader_Factory(t) {\n        return new (t || RouterPreloader)(i0.ɵɵinject(Router), i0.ɵɵinject(i0.Compiler), i0.ɵɵinject(i0.EnvironmentInjector), i0.ɵɵinject(PreloadingStrategy), i0.ɵɵinject(RouterConfigLoader));\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: RouterPreloader,\n        factory: RouterPreloader.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return RouterPreloader;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\nconst ROUTER_SCROLLER = /*#__PURE__*/new InjectionToken('');\nlet RouterScroller = /*#__PURE__*/(() => {\n  class RouterScroller {\n    /** @nodoc */\n    constructor(urlSerializer, transitions, viewportScroller, zone, options = {}) {\n      this.urlSerializer = urlSerializer;\n      this.transitions = transitions;\n      this.viewportScroller = viewportScroller;\n      this.zone = zone;\n      this.options = options;\n      this.lastId = 0;\n      this.lastSource = 'imperative';\n      this.restoredId = 0;\n      this.store = {};\n      // Default both options to 'disabled'\n      options.scrollPositionRestoration ||= 'disabled';\n      options.anchorScrolling ||= 'disabled';\n    }\n    init() {\n      // we want to disable the automatic scrolling because having two places\n      // responsible for scrolling results race conditions, especially given\n      // that browser don't implement this behavior consistently\n      if (this.options.scrollPositionRestoration !== 'disabled') {\n        this.viewportScroller.setHistoryScrollRestoration('manual');\n      }\n      this.routerEventsSubscription = this.createScrollEvents();\n      this.scrollEventsSubscription = this.consumeScrollEvents();\n    }\n    createScrollEvents() {\n      return this.transitions.events.subscribe(e => {\n        if (e instanceof NavigationStart) {\n          // store the scroll position of the current stable navigations.\n          this.store[this.lastId] = this.viewportScroller.getScrollPosition();\n          this.lastSource = e.navigationTrigger;\n          this.restoredId = e.restoredState ? e.restoredState.navigationId : 0;\n        } else if (e instanceof NavigationEnd) {\n          this.lastId = e.id;\n          this.scheduleScrollEvent(e, this.urlSerializer.parse(e.urlAfterRedirects).fragment);\n        } else if (e instanceof NavigationSkipped && e.code === NavigationSkippedCode.IgnoredSameUrlNavigation) {\n          this.lastSource = undefined;\n          this.restoredId = 0;\n          this.scheduleScrollEvent(e, this.urlSerializer.parse(e.url).fragment);\n        }\n      });\n    }\n    consumeScrollEvents() {\n      return this.transitions.events.subscribe(e => {\n        if (!(e instanceof Scroll)) return;\n        // a popstate event. The pop state event will always ignore anchor scrolling.\n        if (e.position) {\n          if (this.options.scrollPositionRestoration === 'top') {\n            this.viewportScroller.scrollToPosition([0, 0]);\n          } else if (this.options.scrollPositionRestoration === 'enabled') {\n            this.viewportScroller.scrollToPosition(e.position);\n          }\n          // imperative navigation \"forward\"\n        } else {\n          if (e.anchor && this.options.anchorScrolling === 'enabled') {\n            this.viewportScroller.scrollToAnchor(e.anchor);\n          } else if (this.options.scrollPositionRestoration !== 'disabled') {\n            this.viewportScroller.scrollToPosition([0, 0]);\n          }\n        }\n      });\n    }\n    scheduleScrollEvent(routerEvent, anchor) {\n      this.zone.runOutsideAngular(() => {\n        // The scroll event needs to be delayed until after change detection. Otherwise, we may\n        // attempt to restore the scroll position before the router outlet has fully rendered the\n        // component by executing its update block of the template function.\n        setTimeout(() => {\n          this.zone.run(() => {\n            this.transitions.events.next(new Scroll(routerEvent, this.lastSource === 'popstate' ? this.store[this.restoredId] : null, anchor));\n          });\n        }, 0);\n      });\n    }\n    /** @nodoc */\n    ngOnDestroy() {\n      this.routerEventsSubscription?.unsubscribe();\n      this.scrollEventsSubscription?.unsubscribe();\n    }\n    static {\n      this.ɵfac = function RouterScroller_Factory(t) {\n        i0.ɵɵinvalidFactory();\n      };\n    }\n    static {\n      this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n        token: RouterScroller,\n        factory: RouterScroller.ɵfac\n      });\n    }\n  }\n  return RouterScroller;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n/**\n * Sets up providers necessary to enable `Router` functionality for the application.\n * Allows to configure a set of routes as well as extra features that should be enabled.\n *\n * @usageNotes\n *\n * Basic example of how you can add a Router to your application:\n * ```\n * const appRoutes: Routes = [];\n * bootstrapApplication(AppComponent, {\n *   providers: [provideRouter(appRoutes)]\n * });\n * ```\n *\n * You can also enable optional features in the Router by adding functions from the `RouterFeatures`\n * type:\n * ```\n * const appRoutes: Routes = [];\n * bootstrapApplication(AppComponent,\n *   {\n *     providers: [\n *       provideRouter(appRoutes,\n *         withDebugTracing(),\n *         withRouterConfig({paramsInheritanceStrategy: 'always'}))\n *     ]\n *   }\n * );\n * ```\n *\n * @see {@link RouterFeatures}\n *\n * @publicApi\n * @param routes A set of `Route`s to use for the application routing table.\n * @param features Optional features to configure additional router behaviors.\n * @returns A set of providers to setup a Router.\n */\nfunction provideRouter(routes, ...features) {\n  return makeEnvironmentProviders([{\n    provide: ROUTES,\n    multi: true,\n    useValue: routes\n  }, typeof ngDevMode === 'undefined' || ngDevMode ? {\n    provide: ROUTER_IS_PROVIDED,\n    useValue: true\n  } : [], {\n    provide: ActivatedRoute,\n    useFactory: rootRoute,\n    deps: [Router]\n  }, {\n    provide: APP_BOOTSTRAP_LISTENER,\n    multi: true,\n    useFactory: getBootstrapListener\n  }, features.map(feature => feature.ɵproviders)]);\n}\nfunction rootRoute(router) {\n  return router.routerState.root;\n}\n/**\n * Helper function to create an object that represents a Router feature.\n */\nfunction routerFeature(kind, providers) {\n  return {\n    ɵkind: kind,\n    ɵproviders: providers\n  };\n}\n/**\n * An Injection token used to indicate whether `provideRouter` or `RouterModule.forRoot` was ever\n * called.\n */\nconst ROUTER_IS_PROVIDED = /*#__PURE__*/new InjectionToken('', {\n  providedIn: 'root',\n  factory: () => false\n});\nconst routerIsProvidedDevModeCheck = {\n  provide: ENVIRONMENT_INITIALIZER,\n  multi: true,\n  useFactory() {\n    return () => {\n      if (!inject(ROUTER_IS_PROVIDED)) {\n        console.warn('`provideRoutes` was called without `provideRouter` or `RouterModule.forRoot`. ' + 'This is likely a mistake.');\n      }\n    };\n  }\n};\n/**\n * Registers a [DI provider](guide/glossary#provider) for a set of routes.\n * @param routes The route configuration to provide.\n *\n * @usageNotes\n *\n * ```\n * @NgModule({\n *   providers: [provideRoutes(ROUTES)]\n * })\n * class LazyLoadedChildModule {}\n * ```\n *\n * @deprecated If necessary, provide routes using the `ROUTES` `InjectionToken`.\n * @see {@link ROUTES}\n * @publicApi\n */\nfunction provideRoutes(routes) {\n  return [{\n    provide: ROUTES,\n    multi: true,\n    useValue: routes\n  }, typeof ngDevMode === 'undefined' || ngDevMode ? routerIsProvidedDevModeCheck : []];\n}\n/**\n * Enables customizable scrolling behavior for router navigations.\n *\n * @usageNotes\n *\n * Basic example of how you can enable scrolling feature:\n * ```\n * const appRoutes: Routes = [];\n * bootstrapApplication(AppComponent,\n *   {\n *     providers: [\n *       provideRouter(appRoutes, withInMemoryScrolling())\n *     ]\n *   }\n * );\n * ```\n *\n * @see {@link provideRouter}\n * @see {@link ViewportScroller}\n *\n * @publicApi\n * @param options Set of configuration parameters to customize scrolling behavior, see\n *     `InMemoryScrollingOptions` for additional information.\n * @returns A set of providers for use with `provideRouter`.\n */\nfunction withInMemoryScrolling(options = {}) {\n  const providers = [{\n    provide: ROUTER_SCROLLER,\n    useFactory: () => {\n      const viewportScroller = inject(ViewportScroller);\n      const zone = inject(NgZone);\n      const transitions = inject(NavigationTransitions);\n      const urlSerializer = inject(UrlSerializer);\n      return new RouterScroller(urlSerializer, transitions, viewportScroller, zone, options);\n    }\n  }];\n  return routerFeature(4 /* RouterFeatureKind.InMemoryScrollingFeature */, providers);\n}\nfunction getBootstrapListener() {\n  const injector = inject(Injector);\n  return bootstrappedComponentRef => {\n    const ref = injector.get(ApplicationRef);\n    if (bootstrappedComponentRef !== ref.components[0]) {\n      return;\n    }\n    const router = injector.get(Router);\n    const bootstrapDone = injector.get(BOOTSTRAP_DONE);\n    if (injector.get(INITIAL_NAVIGATION) === 1 /* InitialNavigation.EnabledNonBlocking */) {\n      router.initialNavigation();\n    }\n    injector.get(ROUTER_PRELOADER, null, InjectFlags.Optional)?.setUpPreloading();\n    injector.get(ROUTER_SCROLLER, null, InjectFlags.Optional)?.init();\n    router.resetRootComponentType(ref.componentTypes[0]);\n    if (!bootstrapDone.closed) {\n      bootstrapDone.next();\n      bootstrapDone.complete();\n      bootstrapDone.unsubscribe();\n    }\n  };\n}\n/**\n * A subject used to indicate that the bootstrapping phase is done. When initial navigation is\n * `enabledBlocking`, the first navigation waits until bootstrapping is finished before continuing\n * to the activation phase.\n */\nconst BOOTSTRAP_DONE = /*#__PURE__*/new InjectionToken(typeof ngDevMode === 'undefined' || ngDevMode ? 'bootstrap done indicator' : '', {\n  factory: () => {\n    return new Subject();\n  }\n});\nconst INITIAL_NAVIGATION = /*#__PURE__*/new InjectionToken(typeof ngDevMode === 'undefined' || ngDevMode ? 'initial navigation' : '', {\n  providedIn: 'root',\n  factory: () => 1 /* InitialNavigation.EnabledNonBlocking */\n});\n/**\n * Configures initial navigation to start before the root component is created.\n *\n * The bootstrap is blocked until the initial navigation is complete. This value is required for\n * [server-side rendering](guide/ssr) to work.\n *\n * @usageNotes\n *\n * Basic example of how you can enable this navigation behavior:\n * ```\n * const appRoutes: Routes = [];\n * bootstrapApplication(AppComponent,\n *   {\n *     providers: [\n *       provideRouter(appRoutes, withEnabledBlockingInitialNavigation())\n *     ]\n *   }\n * );\n * ```\n *\n * @see {@link provideRouter}\n *\n * @publicApi\n * @returns A set of providers for use with `provideRouter`.\n */\nfunction withEnabledBlockingInitialNavigation() {\n  const providers = [{\n    provide: INITIAL_NAVIGATION,\n    useValue: 0 /* InitialNavigation.EnabledBlocking */\n  }, {\n    provide: APP_INITIALIZER,\n    multi: true,\n    deps: [Injector],\n    useFactory: injector => {\n      const locationInitialized = injector.get(LOCATION_INITIALIZED, Promise.resolve());\n      return () => {\n        return locationInitialized.then(() => {\n          return new Promise(resolve => {\n            const router = injector.get(Router);\n            const bootstrapDone = injector.get(BOOTSTRAP_DONE);\n            afterNextNavigation(router, () => {\n              // Unblock APP_INITIALIZER in case the initial navigation was canceled or errored\n              // without a redirect.\n              resolve(true);\n            });\n            injector.get(NavigationTransitions).afterPreactivation = () => {\n              // Unblock APP_INITIALIZER once we get to `afterPreactivation`. At this point, we\n              // assume activation will complete successfully (even though this is not\n              // guaranteed).\n              resolve(true);\n              return bootstrapDone.closed ? of(void 0) : bootstrapDone;\n            };\n            router.initialNavigation();\n          });\n        });\n      };\n    }\n  }];\n  return routerFeature(2 /* RouterFeatureKind.EnabledBlockingInitialNavigationFeature */, providers);\n}\n/**\n * Disables initial navigation.\n *\n * Use if there is a reason to have more control over when the router starts its initial navigation\n * due to some complex initialization logic.\n *\n * @usageNotes\n *\n * Basic example of how you can disable initial navigation:\n * ```\n * const appRoutes: Routes = [];\n * bootstrapApplication(AppComponent,\n *   {\n *     providers: [\n *       provideRouter(appRoutes, withDisabledInitialNavigation())\n *     ]\n *   }\n * );\n * ```\n *\n * @see {@link provideRouter}\n *\n * @returns A set of providers for use with `provideRouter`.\n *\n * @publicApi\n */\nfunction withDisabledInitialNavigation() {\n  const providers = [{\n    provide: APP_INITIALIZER,\n    multi: true,\n    useFactory: () => {\n      const router = inject(Router);\n      return () => {\n        router.setUpLocationChangeListener();\n      };\n    }\n  }, {\n    provide: INITIAL_NAVIGATION,\n    useValue: 2 /* InitialNavigation.Disabled */\n  }];\n  return routerFeature(3 /* RouterFeatureKind.DisabledInitialNavigationFeature */, providers);\n}\n/**\n * Enables logging of all internal navigation events to the console.\n * Extra logging might be useful for debugging purposes to inspect Router event sequence.\n *\n * @usageNotes\n *\n * Basic example of how you can enable debug tracing:\n * ```\n * const appRoutes: Routes = [];\n * bootstrapApplication(AppComponent,\n *   {\n *     providers: [\n *       provideRouter(appRoutes, withDebugTracing())\n *     ]\n *   }\n * );\n * ```\n *\n * @see {@link provideRouter}\n *\n * @returns A set of providers for use with `provideRouter`.\n *\n * @publicApi\n */\nfunction withDebugTracing() {\n  let providers = [];\n  if (typeof ngDevMode === 'undefined' || ngDevMode) {\n    providers = [{\n      provide: ENVIRONMENT_INITIALIZER,\n      multi: true,\n      useFactory: () => {\n        const router = inject(Router);\n        return () => router.events.subscribe(e => {\n          // tslint:disable:no-console\n          console.group?.(`Router Event: ${e.constructor.name}`);\n          console.log(stringifyEvent(e));\n          console.log(e);\n          console.groupEnd?.();\n          // tslint:enable:no-console\n        });\n      }\n    }];\n  } else {\n    providers = [];\n  }\n  return routerFeature(1 /* RouterFeatureKind.DebugTracingFeature */, providers);\n}\nconst ROUTER_PRELOADER = /*#__PURE__*/new InjectionToken(typeof ngDevMode === 'undefined' || ngDevMode ? 'router preloader' : '');\n/**\n * Allows to configure a preloading strategy to use. The strategy is configured by providing a\n * reference to a class that implements a `PreloadingStrategy`.\n *\n * @usageNotes\n *\n * Basic example of how you can configure preloading:\n * ```\n * const appRoutes: Routes = [];\n * bootstrapApplication(AppComponent,\n *   {\n *     providers: [\n *       provideRouter(appRoutes, withPreloading(PreloadAllModules))\n *     ]\n *   }\n * );\n * ```\n *\n * @see {@link provideRouter}\n *\n * @param preloadingStrategy A reference to a class that implements a `PreloadingStrategy` that\n *     should be used.\n * @returns A set of providers for use with `provideRouter`.\n *\n * @publicApi\n */\nfunction withPreloading(preloadingStrategy) {\n  const providers = [{\n    provide: ROUTER_PRELOADER,\n    useExisting: RouterPreloader\n  }, {\n    provide: PreloadingStrategy,\n    useExisting: preloadingStrategy\n  }];\n  return routerFeature(0 /* RouterFeatureKind.PreloadingFeature */, providers);\n}\n/**\n * Allows to provide extra parameters to configure Router.\n *\n * @usageNotes\n *\n * Basic example of how you can provide extra configuration options:\n * ```\n * const appRoutes: Routes = [];\n * bootstrapApplication(AppComponent,\n *   {\n *     providers: [\n *       provideRouter(appRoutes, withRouterConfig({\n *          onSameUrlNavigation: 'reload'\n *       }))\n *     ]\n *   }\n * );\n * ```\n *\n * @see {@link provideRouter}\n *\n * @param options A set of parameters to configure Router, see `RouterConfigOptions` for\n *     additional information.\n * @returns A set of providers for use with `provideRouter`.\n *\n * @publicApi\n */\nfunction withRouterConfig(options) {\n  const providers = [{\n    provide: ROUTER_CONFIGURATION,\n    useValue: options\n  }];\n  return routerFeature(5 /* RouterFeatureKind.RouterConfigurationFeature */, providers);\n}\n/**\n * Provides the location strategy that uses the URL fragment instead of the history API.\n *\n * @usageNotes\n *\n * Basic example of how you can use the hash location option:\n * ```\n * const appRoutes: Routes = [];\n * bootstrapApplication(AppComponent,\n *   {\n *     providers: [\n *       provideRouter(appRoutes, withHashLocation())\n *     ]\n *   }\n * );\n * ```\n *\n * @see {@link provideRouter}\n * @see {@link HashLocationStrategy}\n *\n * @returns A set of providers for use with `provideRouter`.\n *\n * @publicApi\n */\nfunction withHashLocation() {\n  const providers = [{\n    provide: LocationStrategy,\n    useClass: HashLocationStrategy\n  }];\n  return routerFeature(6 /* RouterFeatureKind.RouterHashLocationFeature */, providers);\n}\n/**\n * Subscribes to the Router's navigation events and calls the given function when a\n * `NavigationError` happens.\n *\n * This function is run inside application's [injection context](guide/dependency-injection-context)\n * so you can use the [`inject`](api/core/inject) function.\n *\n * @usageNotes\n *\n * Basic example of how you can use the error handler option:\n * ```\n * const appRoutes: Routes = [];\n * bootstrapApplication(AppComponent,\n *   {\n *     providers: [\n *       provideRouter(appRoutes, withNavigationErrorHandler((e: NavigationError) =>\n * inject(MyErrorTracker).trackError(e)))\n *     ]\n *   }\n * );\n * ```\n *\n * @see {@link NavigationError}\n * @see {@link core/inject}\n * @see {@link runInInjectionContext}\n *\n * @returns A set of providers for use with `provideRouter`.\n *\n * @publicApi\n */\nfunction withNavigationErrorHandler(fn) {\n  const providers = [{\n    provide: ENVIRONMENT_INITIALIZER,\n    multi: true,\n    useValue: () => {\n      const injector = inject(EnvironmentInjector);\n      inject(Router).events.subscribe(e => {\n        if (e instanceof NavigationError) {\n          runInInjectionContext(injector, () => fn(e));\n        }\n      });\n    }\n  }];\n  return routerFeature(7 /* RouterFeatureKind.NavigationErrorHandlerFeature */, providers);\n}\n/**\n * Enables binding information from the `Router` state directly to the inputs of the component in\n * `Route` configurations.\n *\n * @usageNotes\n *\n * Basic example of how you can enable the feature:\n * ```\n * const appRoutes: Routes = [];\n * bootstrapApplication(AppComponent,\n *   {\n *     providers: [\n *       provideRouter(appRoutes, withComponentInputBinding())\n *     ]\n *   }\n * );\n * ```\n *\n * @returns A set of providers for use with `provideRouter`.\n */\nfunction withComponentInputBinding() {\n  const providers = [RoutedComponentInputBinder, {\n    provide: INPUT_BINDER,\n    useExisting: RoutedComponentInputBinder\n  }];\n  return routerFeature(8 /* RouterFeatureKind.ComponentInputBindingFeature */, providers);\n}\n/**\n * Enables view transitions in the Router by running the route activation and deactivation inside of\n * `document.startViewTransition`.\n *\n * Note: The View Transitions API is not available in all browsers. If the browser does not support\n * view transitions, the Router will not attempt to start a view transition and continue processing\n * the navigation as usual.\n *\n * @usageNotes\n *\n * Basic example of how you can enable the feature:\n * ```\n * const appRoutes: Routes = [];\n * bootstrapApplication(AppComponent,\n *   {\n *     providers: [\n *       provideRouter(appRoutes, withViewTransitions())\n *     ]\n *   }\n * );\n * ```\n *\n * @returns A set of providers for use with `provideRouter`.\n * @see https://developer.chrome.com/docs/web-platform/view-transitions/\n * @see https://developer.mozilla.org/en-US/docs/Web/API/View_Transitions_API\n * @experimental\n */\nfunction withViewTransitions(options) {\n  const providers = [{\n    provide: CREATE_VIEW_TRANSITION,\n    useValue: createViewTransition\n  }, {\n    provide: VIEW_TRANSITION_OPTIONS,\n    useValue: {\n      skipNextTransition: !!options?.skipInitialTransition,\n      ...options\n    }\n  }];\n  return routerFeature(9 /* RouterFeatureKind.ViewTransitionsFeature */, providers);\n}\n\n/**\n * The directives defined in the `RouterModule`.\n */\nconst ROUTER_DIRECTIVES = [RouterOutlet, RouterLink, RouterLinkActive, ɵEmptyOutletComponent];\n/**\n * @docsNotRequired\n */\nconst ROUTER_FORROOT_GUARD = /*#__PURE__*/new InjectionToken(typeof ngDevMode === 'undefined' || ngDevMode ? 'router duplicate forRoot guard' : 'ROUTER_FORROOT_GUARD');\n// TODO(atscott): All of these except `ActivatedRoute` are `providedIn: 'root'`. They are only kept\n// here to avoid a breaking change whereby the provider order matters based on where the\n// `RouterModule`/`RouterTestingModule` is imported. These can/should be removed as a \"breaking\"\n// change in a major version.\nconst ROUTER_PROVIDERS = [Location, {\n  provide: UrlSerializer,\n  useClass: DefaultUrlSerializer\n}, Router, ChildrenOutletContexts, {\n  provide: ActivatedRoute,\n  useFactory: rootRoute,\n  deps: [Router]\n}, RouterConfigLoader,\n// Only used to warn when `provideRoutes` is used without `RouterModule` or `provideRouter`. Can\n// be removed when `provideRoutes` is removed.\ntypeof ngDevMode === 'undefined' || ngDevMode ? {\n  provide: ROUTER_IS_PROVIDED,\n  useValue: true\n} : []];\n/**\n * @description\n *\n * Adds directives and providers for in-app navigation among views defined in an application.\n * Use the Angular `Router` service to declaratively specify application states and manage state\n * transitions.\n *\n * You can import this NgModule multiple times, once for each lazy-loaded bundle.\n * However, only one `Router` service can be active.\n * To ensure this, there are two ways to register routes when importing this module:\n *\n * * The `forRoot()` method creates an `NgModule` that contains all the directives, the given\n * routes, and the `Router` service itself.\n * * The `forChild()` method creates an `NgModule` that contains all the directives and the given\n * routes, but does not include the `Router` service.\n *\n * @see [Routing and Navigation guide](guide/router) for an\n * overview of how the `Router` service should be used.\n *\n * @publicApi\n */\nlet RouterModule = /*#__PURE__*/(() => {\n  class RouterModule {\n    constructor(guard) {}\n    /**\n     * Creates and configures a module with all the router providers and directives.\n     * Optionally sets up an application listener to perform an initial navigation.\n     *\n     * When registering the NgModule at the root, import as follows:\n     *\n     * ```\n     * @NgModule({\n     *   imports: [RouterModule.forRoot(ROUTES)]\n     * })\n     * class MyNgModule {}\n     * ```\n     *\n     * @param routes An array of `Route` objects that define the navigation paths for the application.\n     * @param config An `ExtraOptions` configuration object that controls how navigation is performed.\n     * @return The new `NgModule`.\n     *\n     */\n    static forRoot(routes, config) {\n      return {\n        ngModule: RouterModule,\n        providers: [ROUTER_PROVIDERS, typeof ngDevMode === 'undefined' || ngDevMode ? config?.enableTracing ? withDebugTracing().ɵproviders : [] : [], {\n          provide: ROUTES,\n          multi: true,\n          useValue: routes\n        }, {\n          provide: ROUTER_FORROOT_GUARD,\n          useFactory: provideForRootGuard,\n          deps: [[Router, new Optional(), new SkipSelf()]]\n        }, {\n          provide: ROUTER_CONFIGURATION,\n          useValue: config ? config : {}\n        }, config?.useHash ? provideHashLocationStrategy() : providePathLocationStrategy(), provideRouterScroller(), config?.preloadingStrategy ? withPreloading(config.preloadingStrategy).ɵproviders : [], config?.initialNavigation ? provideInitialNavigation(config) : [], config?.bindToComponentInputs ? withComponentInputBinding().ɵproviders : [], config?.enableViewTransitions ? withViewTransitions().ɵproviders : [], provideRouterInitializer()]\n      };\n    }\n    /**\n     * Creates a module with all the router directives and a provider registering routes,\n     * without creating a new Router service.\n     * When registering for submodules and lazy-loaded submodules, create the NgModule as follows:\n     *\n     * ```\n     * @NgModule({\n     *   imports: [RouterModule.forChild(ROUTES)]\n     * })\n     * class MyNgModule {}\n     * ```\n     *\n     * @param routes An array of `Route` objects that define the navigation paths for the submodule.\n     * @return The new NgModule.\n     *\n     */\n    static forChild(routes) {\n      return {\n        ngModule: RouterModule,\n        providers: [{\n          provide: ROUTES,\n          multi: true,\n          useValue: routes\n        }]\n      };\n    }\n    static {\n      this.ɵfac = function RouterModule_Factory(t) {\n        return new (t || RouterModule)(i0.ɵɵinject(ROUTER_FORROOT_GUARD, 8));\n      };\n    }\n    static {\n      this.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n        type: RouterModule\n      });\n    }\n    static {\n      this.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({});\n    }\n  }\n  return RouterModule;\n})();\n/*#__PURE__*/(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n/**\n * For internal use by `RouterModule` only. Note that this differs from `withInMemoryRouterScroller`\n * because it reads from the `ExtraOptions` which should not be used in the standalone world.\n */\nfunction provideRouterScroller() {\n  return {\n    provide: ROUTER_SCROLLER,\n    useFactory: () => {\n      const viewportScroller = inject(ViewportScroller);\n      const zone = inject(NgZone);\n      const config = inject(ROUTER_CONFIGURATION);\n      const transitions = inject(NavigationTransitions);\n      const urlSerializer = inject(UrlSerializer);\n      if (config.scrollOffset) {\n        viewportScroller.setOffset(config.scrollOffset);\n      }\n      return new RouterScroller(urlSerializer, transitions, viewportScroller, zone, config);\n    }\n  };\n}\n// Note: For internal use only with `RouterModule`. Standalone setup via `provideRouter` should\n// provide hash location directly via `{provide: LocationStrategy, useClass: HashLocationStrategy}`.\nfunction provideHashLocationStrategy() {\n  return {\n    provide: LocationStrategy,\n    useClass: HashLocationStrategy\n  };\n}\n// Note: For internal use only with `RouterModule`. Standalone setup via `provideRouter` does not\n// need this at all because `PathLocationStrategy` is the default factory for `LocationStrategy`.\nfunction providePathLocationStrategy() {\n  return {\n    provide: LocationStrategy,\n    useClass: PathLocationStrategy\n  };\n}\nfunction provideForRootGuard(router) {\n  if ((typeof ngDevMode === 'undefined' || ngDevMode) && router) {\n    throw new ɵRuntimeError(4007 /* RuntimeErrorCode.FOR_ROOT_CALLED_TWICE */, `The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector.` + ` Lazy loaded modules should use RouterModule.forChild() instead.`);\n  }\n  return 'guarded';\n}\n// Note: For internal use only with `RouterModule`. Standalone router setup with `provideRouter`\n// users call `withXInitialNavigation` directly.\nfunction provideInitialNavigation(config) {\n  return [config.initialNavigation === 'disabled' ? withDisabledInitialNavigation().ɵproviders : [], config.initialNavigation === 'enabledBlocking' ? withEnabledBlockingInitialNavigation().ɵproviders : []];\n}\n// TODO(atscott): This should not be in the public API\n/**\n * A [DI token](guide/glossary/#di-token) for the router initializer that\n * is called after the app is bootstrapped.\n *\n * @publicApi\n */\nconst ROUTER_INITIALIZER = /*#__PURE__*/new InjectionToken(typeof ngDevMode === 'undefined' || ngDevMode ? 'Router Initializer' : '');\nfunction provideRouterInitializer() {\n  return [\n  // ROUTER_INITIALIZER token should be removed. It's public API but shouldn't be. We can just\n  // have `getBootstrapListener` directly attached to APP_BOOTSTRAP_LISTENER.\n  {\n    provide: ROUTER_INITIALIZER,\n    useFactory: getBootstrapListener\n  }, {\n    provide: APP_BOOTSTRAP_LISTENER,\n    multi: true,\n    useExisting: ROUTER_INITIALIZER\n  }];\n}\n\n/**\n * Maps an array of injectable classes with canMatch functions to an array of equivalent\n * `CanMatchFn` for use in a `Route` definition.\n *\n * Usage {@example router/utils/functional_guards.ts region='CanActivate'}\n *\n * @publicApi\n * @see {@link Route}\n */\nfunction mapToCanMatch(providers) {\n  return providers.map(provider => (...params) => inject(provider).canMatch(...params));\n}\n/**\n * Maps an array of injectable classes with canActivate functions to an array of equivalent\n * `CanActivateFn` for use in a `Route` definition.\n *\n * Usage {@example router/utils/functional_guards.ts region='CanActivate'}\n *\n * @publicApi\n * @see {@link Route}\n */\nfunction mapToCanActivate(providers) {\n  return providers.map(provider => (...params) => inject(provider).canActivate(...params));\n}\n/**\n * Maps an array of injectable classes with canActivateChild functions to an array of equivalent\n * `CanActivateChildFn` for use in a `Route` definition.\n *\n * Usage {@example router/utils/functional_guards.ts region='CanActivate'}\n *\n * @publicApi\n * @see {@link Route}\n */\nfunction mapToCanActivateChild(providers) {\n  return providers.map(provider => (...params) => inject(provider).canActivateChild(...params));\n}\n/**\n * Maps an array of injectable classes with canDeactivate functions to an array of equivalent\n * `CanDeactivateFn` for use in a `Route` definition.\n *\n * Usage {@example router/utils/functional_guards.ts region='CanActivate'}\n *\n * @publicApi\n * @see {@link Route}\n */\nfunction mapToCanDeactivate(providers) {\n  return providers.map(provider => (...params) => inject(provider).canDeactivate(...params));\n}\n/**\n * Maps an injectable class with a resolve function to an equivalent `ResolveFn`\n * for use in a `Route` definition.\n *\n * Usage {@example router/utils/functional_guards.ts region='Resolve'}\n *\n * @publicApi\n * @see {@link Route}\n */\nfunction mapToResolve(provider) {\n  return (...params) => inject(provider).resolve(...params);\n}\n\n/**\n * @module\n * @description\n * Entry point for all public APIs of the router package.\n */\n/**\n * @publicApi\n */\nconst VERSION = /*#__PURE__*/new Version('17.3.0');\n\n/**\n * @module\n * @description\n * Entry point for all public APIs of this package.\n */\n// This file only reexports content of the `src` folder. Keep it that way.\n\n// This file is not used to build this module. It is only used during editing\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { ActivatedRoute, ActivatedRouteSnapshot, ActivationEnd, ActivationStart, BaseRouteReuseStrategy, ChildActivationEnd, ChildActivationStart, ChildrenOutletContexts, DefaultTitleStrategy, DefaultUrlSerializer, EventType, GuardsCheckEnd, GuardsCheckStart, NavigationCancel, NavigationCancellationCode, NavigationEnd, NavigationError, NavigationSkipped, NavigationSkippedCode, NavigationStart, NoPreloading, OutletContext, PRIMARY_OUTLET, PreloadAllModules, PreloadingStrategy, ROUTER_CONFIGURATION, ROUTER_INITIALIZER, ROUTES, ResolveEnd, ResolveStart, RouteConfigLoadEnd, RouteConfigLoadStart, RouteReuseStrategy, Router, RouterEvent, RouterLink, RouterLinkActive, RouterLink as RouterLinkWithHref, RouterModule, RouterOutlet, RouterPreloader, RouterState, RouterStateSnapshot, RoutesRecognized, Scroll, TitleStrategy, UrlHandlingStrategy, UrlSegment, UrlSegmentGroup, UrlSerializer, UrlTree, VERSION, convertToParamMap, createUrlTreeFromSnapshot, defaultUrlMatcher, mapToCanActivate, mapToCanActivateChild, mapToCanDeactivate, mapToCanMatch, mapToResolve, provideRouter, provideRoutes, withComponentInputBinding, withDebugTracing, withDisabledInitialNavigation, withEnabledBlockingInitialNavigation, withHashLocation, withInMemoryScrolling, withNavigationErrorHandler, withPreloading, withRouterConfig, withViewTransitions, ɵEmptyOutletComponent, ROUTER_PROVIDERS as ɵROUTER_PROVIDERS, afterNextNavigation as ɵafterNextNavigation, loadChildren as ɵloadChildren };\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\n/** Error thrown when an HTTP request fails. */\nexport class HttpError extends Error {\n  /** Constructs a new instance of {@link @microsoft/signalr.HttpError}.\r\n   *\r\n   * @param {string} errorMessage A descriptive error message.\r\n   * @param {number} statusCode The HTTP status code represented by this error.\r\n   */\n  constructor(errorMessage, statusCode) {\n    const trueProto = new.target.prototype;\n    super(`${errorMessage}: Status code '${statusCode}'`);\n    this.statusCode = statusCode;\n    // Workaround issue in Typescript compiler\n    // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\n    this.__proto__ = trueProto;\n  }\n}\n/** Error thrown when a timeout elapses. */\nexport class TimeoutError extends Error {\n  /** Constructs a new instance of {@link @microsoft/signalr.TimeoutError}.\r\n   *\r\n   * @param {string} errorMessage A descriptive error message.\r\n   */\n  constructor(errorMessage = \"A timeout occurred.\") {\n    const trueProto = new.target.prototype;\n    super(errorMessage);\n    // Workaround issue in Typescript compiler\n    // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\n    this.__proto__ = trueProto;\n  }\n}\n/** Error thrown when an action is aborted. */\nexport class AbortError extends Error {\n  /** Constructs a new instance of {@link AbortError}.\r\n   *\r\n   * @param {string} errorMessage A descriptive error message.\r\n   */\n  constructor(errorMessage = \"An abort occurred.\") {\n    const trueProto = new.target.prototype;\n    super(errorMessage);\n    // Workaround issue in Typescript compiler\n    // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\n    this.__proto__ = trueProto;\n  }\n}\n/** Error thrown when the selected transport is unsupported by the browser. */\n/** @private */\nexport class UnsupportedTransportError extends Error {\n  /** Constructs a new instance of {@link @microsoft/signalr.UnsupportedTransportError}.\r\n   *\r\n   * @param {string} message A descriptive error message.\r\n   * @param {HttpTransportType} transport The {@link @microsoft/signalr.HttpTransportType} this error occurred on.\r\n   */\n  constructor(message, transport) {\n    const trueProto = new.target.prototype;\n    super(message);\n    this.transport = transport;\n    this.errorType = 'UnsupportedTransportError';\n    // Workaround issue in Typescript compiler\n    // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\n    this.__proto__ = trueProto;\n  }\n}\n/** Error thrown when the selected transport is disabled by the browser. */\n/** @private */\nexport class DisabledTransportError extends Error {\n  /** Constructs a new instance of {@link @microsoft/signalr.DisabledTransportError}.\r\n   *\r\n   * @param {string} message A descriptive error message.\r\n   * @param {HttpTransportType} transport The {@link @microsoft/signalr.HttpTransportType} this error occurred on.\r\n   */\n  constructor(message, transport) {\n    const trueProto = new.target.prototype;\n    super(message);\n    this.transport = transport;\n    this.errorType = 'DisabledTransportError';\n    // Workaround issue in Typescript compiler\n    // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\n    this.__proto__ = trueProto;\n  }\n}\n/** Error thrown when the selected transport cannot be started. */\n/** @private */\nexport class FailedToStartTransportError extends Error {\n  /** Constructs a new instance of {@link @microsoft/signalr.FailedToStartTransportError}.\r\n   *\r\n   * @param {string} message A descriptive error message.\r\n   * @param {HttpTransportType} transport The {@link @microsoft/signalr.HttpTransportType} this error occurred on.\r\n   */\n  constructor(message, transport) {\n    const trueProto = new.target.prototype;\n    super(message);\n    this.transport = transport;\n    this.errorType = 'FailedToStartTransportError';\n    // Workaround issue in Typescript compiler\n    // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\n    this.__proto__ = trueProto;\n  }\n}\n/** Error thrown when the negotiation with the server failed to complete. */\n/** @private */\nexport class FailedToNegotiateWithServerError extends Error {\n  /** Constructs a new instance of {@link @microsoft/signalr.FailedToNegotiateWithServerError}.\r\n   *\r\n   * @param {string} message A descriptive error message.\r\n   */\n  constructor(message) {\n    const trueProto = new.target.prototype;\n    super(message);\n    this.errorType = 'FailedToNegotiateWithServerError';\n    // Workaround issue in Typescript compiler\n    // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\n    this.__proto__ = trueProto;\n  }\n}\n/** Error thrown when multiple errors have occurred. */\n/** @private */\nexport class AggregateErrors extends Error {\n  /** Constructs a new instance of {@link @microsoft/signalr.AggregateErrors}.\r\n   *\r\n   * @param {string} message A descriptive error message.\r\n   * @param {Error[]} innerErrors The collection of errors this error is aggregating.\r\n   */\n  constructor(message, innerErrors) {\n    const trueProto = new.target.prototype;\n    super(message);\n    this.innerErrors = innerErrors;\n    // Workaround issue in Typescript compiler\n    // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\n    this.__proto__ = trueProto;\n  }\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\n/** Represents an HTTP response. */\nexport class HttpResponse {\n  constructor(statusCode, statusText, content) {\n    this.statusCode = statusCode;\n    this.statusText = statusText;\n    this.content = content;\n  }\n}\n/** Abstraction over an HTTP client.\r\n *\r\n * This class provides an abstraction over an HTTP client so that a different implementation can be provided on different platforms.\r\n */\nexport class HttpClient {\n  get(url, options) {\n    return this.send({\n      ...options,\n      method: \"GET\",\n      url\n    });\n  }\n  post(url, options) {\n    return this.send({\n      ...options,\n      method: \"POST\",\n      url\n    });\n  }\n  delete(url, options) {\n    return this.send({\n      ...options,\n      method: \"DELETE\",\n      url\n    });\n  }\n  /** Gets all cookies that apply to the specified URL.\r\n   *\r\n   * @param url The URL that the cookies are valid for.\r\n   * @returns {string} A string containing all the key-value cookie pairs for the specified URL.\r\n   */\n  // @ts-ignore\n  getCookieString(url) {\n    return \"\";\n  }\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\n// These values are designed to match the ASP.NET Log Levels since that's the pattern we're emulating here.\n/** Indicates the severity of a log message.\r\n *\r\n * Log Levels are ordered in increasing severity. So `Debug` is more severe than `Trace`, etc.\r\n */\nexport var LogLevel = /*#__PURE__*/function (LogLevel) {\n  /** Log level for very low severity diagnostic messages. */\n  LogLevel[LogLevel[\"Trace\"] = 0] = \"Trace\";\n  /** Log level for low severity diagnostic messages. */\n  LogLevel[LogLevel[\"Debug\"] = 1] = \"Debug\";\n  /** Log level for informational diagnostic messages. */\n  LogLevel[LogLevel[\"Information\"] = 2] = \"Information\";\n  /** Log level for diagnostic messages that indicate a non-fatal problem. */\n  LogLevel[LogLevel[\"Warning\"] = 3] = \"Warning\";\n  /** Log level for diagnostic messages that indicate a failure in the current operation. */\n  LogLevel[LogLevel[\"Error\"] = 4] = \"Error\";\n  /** Log level for diagnostic messages that indicate a failure that will terminate the entire application. */\n  LogLevel[LogLevel[\"Critical\"] = 5] = \"Critical\";\n  /** The highest possible log level. Used when configuring logging to indicate that no log messages should be emitted. */\n  LogLevel[LogLevel[\"None\"] = 6] = \"None\";\n  return LogLevel;\n}(LogLevel || {});\n\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\n/** A logger that does nothing when log messages are sent to it. */\nexport class NullLogger {\n  constructor() {}\n  /** @inheritDoc */\n  // eslint-disable-next-line\n  log(_logLevel, _message) {}\n}\n/** The singleton instance of the {@link @microsoft/signalr.NullLogger}. */\nNullLogger.instance = new NullLogger();\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\nimport { LogLevel } from \"./ILogger\";\nimport { NullLogger } from \"./Loggers\";\n// Version token that will be replaced by the prepack command\n/** The version of the SignalR client. */\nexport const VERSION = \"7.0.12\";\n/** @private */\nexport class Arg {\n  static isRequired(val, name) {\n    if (val === null || val === undefined) {\n      throw new Error(`The '${name}' argument is required.`);\n    }\n  }\n  static isNotEmpty(val, name) {\n    if (!val || val.match(/^\\s*$/)) {\n      throw new Error(`The '${name}' argument should not be empty.`);\n    }\n  }\n  static isIn(val, values, name) {\n    // TypeScript enums have keys for **both** the name and the value of each enum member on the type itself.\n    if (!(val in values)) {\n      throw new Error(`Unknown ${name} value: ${val}.`);\n    }\n  }\n}\n/** @private */\nexport class Platform {\n  // react-native has a window but no document so we should check both\n  static get isBrowser() {\n    return typeof window === \"object\" && typeof window.document === \"object\";\n  }\n  // WebWorkers don't have a window object so the isBrowser check would fail\n  static get isWebWorker() {\n    return typeof self === \"object\" && \"importScripts\" in self;\n  }\n  // react-native has a window but no document\n  static get isReactNative() {\n    return typeof window === \"object\" && typeof window.document === \"undefined\";\n  }\n  // Node apps shouldn't have a window object, but WebWorkers don't either\n  // so we need to check for both WebWorker and window\n  static get isNode() {\n    return !this.isBrowser && !this.isWebWorker && !this.isReactNative;\n  }\n}\n/** @private */\nexport function getDataDetail(data, includeContent) {\n  let detail = \"\";\n  if (isArrayBuffer(data)) {\n    detail = `Binary data of length ${data.byteLength}`;\n    if (includeContent) {\n      detail += `. Content: '${formatArrayBuffer(data)}'`;\n    }\n  } else if (typeof data === \"string\") {\n    detail = `String data of length ${data.length}`;\n    if (includeContent) {\n      detail += `. Content: '${data}'`;\n    }\n  }\n  return detail;\n}\n/** @private */\nexport function formatArrayBuffer(data) {\n  const view = new Uint8Array(data);\n  // Uint8Array.map only supports returning another Uint8Array?\n  let str = \"\";\n  view.forEach(num => {\n    const pad = num < 16 ? \"0\" : \"\";\n    str += `0x${pad}${num.toString(16)} `;\n  });\n  // Trim of trailing space.\n  return str.substr(0, str.length - 1);\n}\n// Also in signalr-protocol-msgpack/Utils.ts\n/** @private */\nexport function isArrayBuffer(val) {\n  return val && typeof ArrayBuffer !== \"undefined\" && (val instanceof ArrayBuffer ||\n  // Sometimes we get an ArrayBuffer that doesn't satisfy instanceof\n  val.constructor && val.constructor.name === \"ArrayBuffer\");\n}\n/** @private */\nexport async function sendMessage(logger, transportName, httpClient, url, content, options) {\n  const headers = {};\n  const [name, value] = getUserAgentHeader();\n  headers[name] = value;\n  logger.log(LogLevel.Trace, `(${transportName} transport) sending data. ${getDataDetail(content, options.logMessageContent)}.`);\n  const responseType = isArrayBuffer(content) ? \"arraybuffer\" : \"text\";\n  const response = await httpClient.post(url, {\n    content,\n    headers: {\n      ...headers,\n      ...options.headers\n    },\n    responseType,\n    timeout: options.timeout,\n    withCredentials: options.withCredentials\n  });\n  logger.log(LogLevel.Trace, `(${transportName} transport) request complete. Response status: ${response.statusCode}.`);\n}\n/** @private */\nexport function createLogger(logger) {\n  if (logger === undefined) {\n    return new ConsoleLogger(LogLevel.Information);\n  }\n  if (logger === null) {\n    return NullLogger.instance;\n  }\n  if (logger.log !== undefined) {\n    return logger;\n  }\n  return new ConsoleLogger(logger);\n}\n/** @private */\nexport class SubjectSubscription {\n  constructor(subject, observer) {\n    this._subject = subject;\n    this._observer = observer;\n  }\n  dispose() {\n    const index = this._subject.observers.indexOf(this._observer);\n    if (index > -1) {\n      this._subject.observers.splice(index, 1);\n    }\n    if (this._subject.observers.length === 0 && this._subject.cancelCallback) {\n      this._subject.cancelCallback().catch(_ => {});\n    }\n  }\n}\n/** @private */\nexport class ConsoleLogger {\n  constructor(minimumLogLevel) {\n    this._minLevel = minimumLogLevel;\n    this.out = console;\n  }\n  log(logLevel, message) {\n    if (logLevel >= this._minLevel) {\n      const msg = `[${new Date().toISOString()}] ${LogLevel[logLevel]}: ${message}`;\n      switch (logLevel) {\n        case LogLevel.Critical:\n        case LogLevel.Error:\n          this.out.error(msg);\n          break;\n        case LogLevel.Warning:\n          this.out.warn(msg);\n          break;\n        case LogLevel.Information:\n          this.out.info(msg);\n          break;\n        default:\n          // console.debug only goes to attached debuggers in Node, so we use console.log for Trace and Debug\n          this.out.log(msg);\n          break;\n      }\n    }\n  }\n}\n/** @private */\nexport function getUserAgentHeader() {\n  let userAgentHeaderName = \"X-SignalR-User-Agent\";\n  if (Platform.isNode) {\n    userAgentHeaderName = \"User-Agent\";\n  }\n  return [userAgentHeaderName, constructUserAgent(VERSION, getOsName(), getRuntime(), getRuntimeVersion())];\n}\n/** @private */\nexport function constructUserAgent(version, os, runtime, runtimeVersion) {\n  // Microsoft SignalR/[Version] ([Detailed Version]; [Operating System]; [Runtime]; [Runtime Version])\n  let userAgent = \"Microsoft SignalR/\";\n  const majorAndMinor = version.split(\".\");\n  userAgent += `${majorAndMinor[0]}.${majorAndMinor[1]}`;\n  userAgent += ` (${version}; `;\n  if (os && os !== \"\") {\n    userAgent += `${os}; `;\n  } else {\n    userAgent += \"Unknown OS; \";\n  }\n  userAgent += `${runtime}`;\n  if (runtimeVersion) {\n    userAgent += `; ${runtimeVersion}`;\n  } else {\n    userAgent += \"; Unknown Runtime Version\";\n  }\n  userAgent += \")\";\n  return userAgent;\n}\n// eslint-disable-next-line spaced-comment\n/*#__PURE__*/\nfunction getOsName() {\n  if (Platform.isNode) {\n    switch (process.platform) {\n      case \"win32\":\n        return \"Windows NT\";\n      case \"darwin\":\n        return \"macOS\";\n      case \"linux\":\n        return \"Linux\";\n      default:\n        return process.platform;\n    }\n  } else {\n    return \"\";\n  }\n}\n// eslint-disable-next-line spaced-comment\n/*#__PURE__*/\nfunction getRuntimeVersion() {\n  if (Platform.isNode) {\n    return process.versions.node;\n  }\n  return undefined;\n}\nfunction getRuntime() {\n  if (Platform.isNode) {\n    return \"NodeJS\";\n  } else {\n    return \"Browser\";\n  }\n}\n/** @private */\nexport function getErrorString(e) {\n  if (e.stack) {\n    return e.stack;\n  } else if (e.message) {\n    return e.message;\n  }\n  return `${e}`;\n}\n/** @private */\nexport function getGlobalThis() {\n  // globalThis is semi-new and not available in Node until v12\n  if (typeof globalThis !== \"undefined\") {\n    return globalThis;\n  }\n  if (typeof self !== \"undefined\") {\n    return self;\n  }\n  if (typeof window !== \"undefined\") {\n    return window;\n  }\n  if (typeof global !== \"undefined\") {\n    return global;\n  }\n  throw new Error(\"could not find global\");\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\nimport { AbortError, HttpError, TimeoutError } from \"./Errors\";\nimport { HttpClient, HttpResponse } from \"./HttpClient\";\nimport { LogLevel } from \"./ILogger\";\nimport { Platform, getGlobalThis, isArrayBuffer } from \"./Utils\";\nexport class FetchHttpClient extends HttpClient {\n  constructor(logger) {\n    super();\n    this._logger = logger;\n    if (typeof fetch === \"undefined\") {\n      // In order to ignore the dynamic require in webpack builds we need to do this magic\n      // @ts-ignore: TS doesn't know about these names\n      const requireFunc = typeof __webpack_require__ === \"function\" ? __non_webpack_require__ : require;\n      // Cookies aren't automatically handled in Node so we need to add a CookieJar to preserve cookies across requests\n      this._jar = new (requireFunc(\"tough-cookie\").CookieJar)();\n      this._fetchType = requireFunc(\"node-fetch\");\n      // node-fetch doesn't have a nice API for getting and setting cookies\n      // fetch-cookie will wrap a fetch implementation with a default CookieJar or a provided one\n      this._fetchType = requireFunc(\"fetch-cookie\")(this._fetchType, this._jar);\n    } else {\n      this._fetchType = fetch.bind(getGlobalThis());\n    }\n    if (typeof AbortController === \"undefined\") {\n      // In order to ignore the dynamic require in webpack builds we need to do this magic\n      // @ts-ignore: TS doesn't know about these names\n      const requireFunc = typeof __webpack_require__ === \"function\" ? __non_webpack_require__ : require;\n      // Node needs EventListener methods on AbortController which our custom polyfill doesn't provide\n      this._abortControllerType = requireFunc(\"abort-controller\");\n    } else {\n      this._abortControllerType = AbortController;\n    }\n  }\n  /** @inheritDoc */\n  async send(request) {\n    // Check that abort was not signaled before calling send\n    if (request.abortSignal && request.abortSignal.aborted) {\n      throw new AbortError();\n    }\n    if (!request.method) {\n      throw new Error(\"No method defined.\");\n    }\n    if (!request.url) {\n      throw new Error(\"No url defined.\");\n    }\n    const abortController = new this._abortControllerType();\n    let error;\n    // Hook our abortSignal into the abort controller\n    if (request.abortSignal) {\n      request.abortSignal.onabort = () => {\n        abortController.abort();\n        error = new AbortError();\n      };\n    }\n    // If a timeout has been passed in, setup a timeout to call abort\n    // Type needs to be any to fit window.setTimeout and NodeJS.setTimeout\n    let timeoutId = null;\n    if (request.timeout) {\n      const msTimeout = request.timeout;\n      timeoutId = setTimeout(() => {\n        abortController.abort();\n        this._logger.log(LogLevel.Warning, `Timeout from HTTP request.`);\n        error = new TimeoutError();\n      }, msTimeout);\n    }\n    if (request.content === \"\") {\n      request.content = undefined;\n    }\n    if (request.content) {\n      // Explicitly setting the Content-Type header for React Native on Android platform.\n      request.headers = request.headers || {};\n      if (isArrayBuffer(request.content)) {\n        request.headers[\"Content-Type\"] = \"application/octet-stream\";\n      } else {\n        request.headers[\"Content-Type\"] = \"text/plain;charset=UTF-8\";\n      }\n    }\n    let response;\n    try {\n      response = await this._fetchType(request.url, {\n        body: request.content,\n        cache: \"no-cache\",\n        credentials: request.withCredentials === true ? \"include\" : \"same-origin\",\n        headers: {\n          \"X-Requested-With\": \"XMLHttpRequest\",\n          ...request.headers\n        },\n        method: request.method,\n        mode: \"cors\",\n        redirect: \"follow\",\n        signal: abortController.signal\n      });\n    } catch (e) {\n      if (error) {\n        throw error;\n      }\n      this._logger.log(LogLevel.Warning, `Error from HTTP request. ${e}.`);\n      throw e;\n    } finally {\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n      }\n      if (request.abortSignal) {\n        request.abortSignal.onabort = null;\n      }\n    }\n    if (!response.ok) {\n      const errorMessage = await deserializeContent(response, \"text\");\n      throw new HttpError(errorMessage || response.statusText, response.status);\n    }\n    const content = deserializeContent(response, request.responseType);\n    const payload = await content;\n    return new HttpResponse(response.status, response.statusText, payload);\n  }\n  getCookieString(url) {\n    let cookies = \"\";\n    if (Platform.isNode && this._jar) {\n      // @ts-ignore: unused variable\n      this._jar.getCookies(url, (e, c) => cookies = c.join(\"; \"));\n    }\n    return cookies;\n  }\n}\nfunction deserializeContent(response, responseType) {\n  let content;\n  switch (responseType) {\n    case \"arraybuffer\":\n      content = response.arrayBuffer();\n      break;\n    case \"text\":\n      content = response.text();\n      break;\n    case \"blob\":\n    case \"document\":\n    case \"json\":\n      throw new Error(`${responseType} is not supported.`);\n    default:\n      content = response.text();\n      break;\n  }\n  return content;\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\nimport { AbortError, HttpError, TimeoutError } from \"./Errors\";\nimport { HttpClient, HttpResponse } from \"./HttpClient\";\nimport { LogLevel } from \"./ILogger\";\nimport { isArrayBuffer } from \"./Utils\";\nexport class XhrHttpClient extends HttpClient {\n  constructor(logger) {\n    super();\n    this._logger = logger;\n  }\n  /** @inheritDoc */\n  send(request) {\n    // Check that abort was not signaled before calling send\n    if (request.abortSignal && request.abortSignal.aborted) {\n      return Promise.reject(new AbortError());\n    }\n    if (!request.method) {\n      return Promise.reject(new Error(\"No method defined.\"));\n    }\n    if (!request.url) {\n      return Promise.reject(new Error(\"No url defined.\"));\n    }\n    return new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      xhr.open(request.method, request.url, true);\n      xhr.withCredentials = request.withCredentials === undefined ? true : request.withCredentials;\n      xhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n      if (request.content === \"\") {\n        request.content = undefined;\n      }\n      if (request.content) {\n        // Explicitly setting the Content-Type header for React Native on Android platform.\n        if (isArrayBuffer(request.content)) {\n          xhr.setRequestHeader(\"Content-Type\", \"application/octet-stream\");\n        } else {\n          xhr.setRequestHeader(\"Content-Type\", \"text/plain;charset=UTF-8\");\n        }\n      }\n      const headers = request.headers;\n      if (headers) {\n        Object.keys(headers).forEach(header => {\n          xhr.setRequestHeader(header, headers[header]);\n        });\n      }\n      if (request.responseType) {\n        xhr.responseType = request.responseType;\n      }\n      if (request.abortSignal) {\n        request.abortSignal.onabort = () => {\n          xhr.abort();\n          reject(new AbortError());\n        };\n      }\n      if (request.timeout) {\n        xhr.timeout = request.timeout;\n      }\n      xhr.onload = () => {\n        if (request.abortSignal) {\n          request.abortSignal.onabort = null;\n        }\n        if (xhr.status >= 200 && xhr.status < 300) {\n          resolve(new HttpResponse(xhr.status, xhr.statusText, xhr.response || xhr.responseText));\n        } else {\n          reject(new HttpError(xhr.response || xhr.responseText || xhr.statusText, xhr.status));\n        }\n      };\n      xhr.onerror = () => {\n        this._logger.log(LogLevel.Warning, `Error from HTTP request. ${xhr.status}: ${xhr.statusText}.`);\n        reject(new HttpError(xhr.statusText, xhr.status));\n      };\n      xhr.ontimeout = () => {\n        this._logger.log(LogLevel.Warning, `Timeout from HTTP request.`);\n        reject(new TimeoutError());\n      };\n      xhr.send(request.content);\n    });\n  }\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\nimport { AbortError } from \"./Errors\";\nimport { FetchHttpClient } from \"./FetchHttpClient\";\nimport { HttpClient } from \"./HttpClient\";\nimport { Platform } from \"./Utils\";\nimport { XhrHttpClient } from \"./XhrHttpClient\";\n/** Default implementation of {@link @microsoft/signalr.HttpClient}. */\nexport class DefaultHttpClient extends HttpClient {\n  /** Creates a new instance of the {@link @microsoft/signalr.DefaultHttpClient}, using the provided {@link @microsoft/signalr.ILogger} to log messages. */\n  constructor(logger) {\n    super();\n    if (typeof fetch !== \"undefined\" || Platform.isNode) {\n      this._httpClient = new FetchHttpClient(logger);\n    } else if (typeof XMLHttpRequest !== \"undefined\") {\n      this._httpClient = new XhrHttpClient(logger);\n    } else {\n      throw new Error(\"No usable HttpClient found.\");\n    }\n  }\n  /** @inheritDoc */\n  send(request) {\n    // Check that abort was not signaled before calling send\n    if (request.abortSignal && request.abortSignal.aborted) {\n      return Promise.reject(new AbortError());\n    }\n    if (!request.method) {\n      return Promise.reject(new Error(\"No method defined.\"));\n    }\n    if (!request.url) {\n      return Promise.reject(new Error(\"No url defined.\"));\n    }\n    return this._httpClient.send(request);\n  }\n  getCookieString(url) {\n    return this._httpClient.getCookieString(url);\n  }\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\n// Not exported from index\n/** @private */\nexport class TextMessageFormat {\n  static write(output) {\n    return `${output}${TextMessageFormat.RecordSeparator}`;\n  }\n  static parse(input) {\n    if (input[input.length - 1] !== TextMessageFormat.RecordSeparator) {\n      throw new Error(\"Message is incomplete.\");\n    }\n    const messages = input.split(TextMessageFormat.RecordSeparator);\n    messages.pop();\n    return messages;\n  }\n}\nTextMessageFormat.RecordSeparatorCode = 0x1e;\nTextMessageFormat.RecordSeparator = String.fromCharCode(TextMessageFormat.RecordSeparatorCode);\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\nimport { TextMessageFormat } from \"./TextMessageFormat\";\nimport { isArrayBuffer } from \"./Utils\";\n/** @private */\nexport class HandshakeProtocol {\n  // Handshake request is always JSON\n  writeHandshakeRequest(handshakeRequest) {\n    return TextMessageFormat.write(JSON.stringify(handshakeRequest));\n  }\n  parseHandshakeResponse(data) {\n    let messageData;\n    let remainingData;\n    if (isArrayBuffer(data)) {\n      // Format is binary but still need to read JSON text from handshake response\n      const binaryData = new Uint8Array(data);\n      const separatorIndex = binaryData.indexOf(TextMessageFormat.RecordSeparatorCode);\n      if (separatorIndex === -1) {\n        throw new Error(\"Message is incomplete.\");\n      }\n      // content before separator is handshake response\n      // optional content after is additional messages\n      const responseLength = separatorIndex + 1;\n      messageData = String.fromCharCode.apply(null, Array.prototype.slice.call(binaryData.slice(0, responseLength)));\n      remainingData = binaryData.byteLength > responseLength ? binaryData.slice(responseLength).buffer : null;\n    } else {\n      const textData = data;\n      const separatorIndex = textData.indexOf(TextMessageFormat.RecordSeparator);\n      if (separatorIndex === -1) {\n        throw new Error(\"Message is incomplete.\");\n      }\n      // content before separator is handshake response\n      // optional content after is additional messages\n      const responseLength = separatorIndex + 1;\n      messageData = textData.substring(0, responseLength);\n      remainingData = textData.length > responseLength ? textData.substring(responseLength) : null;\n    }\n    // At this point we should have just the single handshake message\n    const messages = TextMessageFormat.parse(messageData);\n    const response = JSON.parse(messages[0]);\n    if (response.type) {\n      throw new Error(\"Expected a handshake response from the server.\");\n    }\n    const responseMessage = response;\n    // multiple messages could have arrived with handshake\n    // return additional data to be parsed as usual, or null if all parsed\n    return [remainingData, responseMessage];\n  }\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\n/** Defines the type of a Hub Message. */\nexport var MessageType = /*#__PURE__*/function (MessageType) {\n  /** Indicates the message is an Invocation message and implements the {@link @microsoft/signalr.InvocationMessage} interface. */\n  MessageType[MessageType[\"Invocation\"] = 1] = \"Invocation\";\n  /** Indicates the message is a StreamItem message and implements the {@link @microsoft/signalr.StreamItemMessage} interface. */\n  MessageType[MessageType[\"StreamItem\"] = 2] = \"StreamItem\";\n  /** Indicates the message is a Completion message and implements the {@link @microsoft/signalr.CompletionMessage} interface. */\n  MessageType[MessageType[\"Completion\"] = 3] = \"Completion\";\n  /** Indicates the message is a Stream Invocation message and implements the {@link @microsoft/signalr.StreamInvocationMessage} interface. */\n  MessageType[MessageType[\"StreamInvocation\"] = 4] = \"StreamInvocation\";\n  /** Indicates the message is a Cancel Invocation message and implements the {@link @microsoft/signalr.CancelInvocationMessage} interface. */\n  MessageType[MessageType[\"CancelInvocation\"] = 5] = \"CancelInvocation\";\n  /** Indicates the message is a Ping message and implements the {@link @microsoft/signalr.PingMessage} interface. */\n  MessageType[MessageType[\"Ping\"] = 6] = \"Ping\";\n  /** Indicates the message is a Close message and implements the {@link @microsoft/signalr.CloseMessage} interface. */\n  MessageType[MessageType[\"Close\"] = 7] = \"Close\";\n  return MessageType;\n}(MessageType || {});\n\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\nimport { SubjectSubscription } from \"./Utils\";\n/** Stream implementation to stream items to the server. */\nexport class Subject {\n  constructor() {\n    this.observers = [];\n  }\n  next(item) {\n    for (const observer of this.observers) {\n      observer.next(item);\n    }\n  }\n  error(err) {\n    for (const observer of this.observers) {\n      if (observer.error) {\n        observer.error(err);\n      }\n    }\n  }\n  complete() {\n    for (const observer of this.observers) {\n      if (observer.complete) {\n        observer.complete();\n      }\n    }\n  }\n  subscribe(observer) {\n    this.observers.push(observer);\n    return new SubjectSubscription(this, observer);\n  }\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\nimport { HandshakeProtocol } from \"./HandshakeProtocol\";\nimport { AbortError } from \"./Errors\";\nimport { MessageType } from \"./IHubProtocol\";\nimport { LogLevel } from \"./ILogger\";\nimport { Subject } from \"./Subject\";\nimport { Arg, getErrorString, Platform } from \"./Utils\";\nconst DEFAULT_TIMEOUT_IN_MS = 30 * 1000;\nconst DEFAULT_PING_INTERVAL_IN_MS = 15 * 1000;\n/** Describes the current state of the {@link HubConnection} to the server. */\nexport var HubConnectionState = /*#__PURE__*/function (HubConnectionState) {\n  /** The hub connection is disconnected. */\n  HubConnectionState[\"Disconnected\"] = \"Disconnected\";\n  /** The hub connection is connecting. */\n  HubConnectionState[\"Connecting\"] = \"Connecting\";\n  /** The hub connection is connected. */\n  HubConnectionState[\"Connected\"] = \"Connected\";\n  /** The hub connection is disconnecting. */\n  HubConnectionState[\"Disconnecting\"] = \"Disconnecting\";\n  /** The hub connection is reconnecting. */\n  HubConnectionState[\"Reconnecting\"] = \"Reconnecting\";\n  return HubConnectionState;\n}(HubConnectionState || {});\n/** Represents a connection to a SignalR Hub. */\nexport class HubConnection {\n  constructor(connection, logger, protocol, reconnectPolicy) {\n    this._nextKeepAlive = 0;\n    this._freezeEventListener = () => {\n      this._logger.log(LogLevel.Warning, \"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://docs.microsoft.com/aspnet/core/signalr/javascript-client#bsleep\");\n    };\n    Arg.isRequired(connection, \"connection\");\n    Arg.isRequired(logger, \"logger\");\n    Arg.isRequired(protocol, \"protocol\");\n    this.serverTimeoutInMilliseconds = DEFAULT_TIMEOUT_IN_MS;\n    this.keepAliveIntervalInMilliseconds = DEFAULT_PING_INTERVAL_IN_MS;\n    this._logger = logger;\n    this._protocol = protocol;\n    this.connection = connection;\n    this._reconnectPolicy = reconnectPolicy;\n    this._handshakeProtocol = new HandshakeProtocol();\n    this.connection.onreceive = data => this._processIncomingData(data);\n    this.connection.onclose = error => this._connectionClosed(error);\n    this._callbacks = {};\n    this._methods = {};\n    this._closedCallbacks = [];\n    this._reconnectingCallbacks = [];\n    this._reconnectedCallbacks = [];\n    this._invocationId = 0;\n    this._receivedHandshakeResponse = false;\n    this._connectionState = HubConnectionState.Disconnected;\n    this._connectionStarted = false;\n    this._cachedPingMessage = this._protocol.writeMessage({\n      type: MessageType.Ping\n    });\n  }\n  /** @internal */\n  // Using a public static factory method means we can have a private constructor and an _internal_\n  // create method that can be used by HubConnectionBuilder. An \"internal\" constructor would just\n  // be stripped away and the '.d.ts' file would have no constructor, which is interpreted as a\n  // public parameter-less constructor.\n  static create(connection, logger, protocol, reconnectPolicy) {\n    return new HubConnection(connection, logger, protocol, reconnectPolicy);\n  }\n  /** Indicates the state of the {@link HubConnection} to the server. */\n  get state() {\n    return this._connectionState;\n  }\n  /** Represents the connection id of the {@link HubConnection} on the server. The connection id will be null when the connection is either\r\n   *  in the disconnected state or if the negotiation step was skipped.\r\n   */\n  get connectionId() {\n    return this.connection ? this.connection.connectionId || null : null;\n  }\n  /** Indicates the url of the {@link HubConnection} to the server. */\n  get baseUrl() {\n    return this.connection.baseUrl || \"\";\n  }\n  /**\r\n   * Sets a new url for the HubConnection. Note that the url can only be changed when the connection is in either the Disconnected or\r\n   * Reconnecting states.\r\n   * @param {string} url The url to connect to.\r\n   */\n  set baseUrl(url) {\n    if (this._connectionState !== HubConnectionState.Disconnected && this._connectionState !== HubConnectionState.Reconnecting) {\n      throw new Error(\"The HubConnection must be in the Disconnected or Reconnecting state to change the url.\");\n    }\n    if (!url) {\n      throw new Error(\"The HubConnection url must be a valid url.\");\n    }\n    this.connection.baseUrl = url;\n  }\n  /** Starts the connection.\r\n   *\r\n   * @returns {Promise<void>} A Promise that resolves when the connection has been successfully established, or rejects with an error.\r\n   */\n  start() {\n    this._startPromise = this._startWithStateTransitions();\n    return this._startPromise;\n  }\n  async _startWithStateTransitions() {\n    if (this._connectionState !== HubConnectionState.Disconnected) {\n      return Promise.reject(new Error(\"Cannot start a HubConnection that is not in the 'Disconnected' state.\"));\n    }\n    this._connectionState = HubConnectionState.Connecting;\n    this._logger.log(LogLevel.Debug, \"Starting HubConnection.\");\n    try {\n      await this._startInternal();\n      if (Platform.isBrowser) {\n        // Log when the browser freezes the tab so users know why their connection unexpectedly stopped working\n        window.document.addEventListener(\"freeze\", this._freezeEventListener);\n      }\n      this._connectionState = HubConnectionState.Connected;\n      this._connectionStarted = true;\n      this._logger.log(LogLevel.Debug, \"HubConnection connected successfully.\");\n    } catch (e) {\n      this._connectionState = HubConnectionState.Disconnected;\n      this._logger.log(LogLevel.Debug, `HubConnection failed to start successfully because of error '${e}'.`);\n      return Promise.reject(e);\n    }\n  }\n  async _startInternal() {\n    this._stopDuringStartError = undefined;\n    this._receivedHandshakeResponse = false;\n    // Set up the promise before any connection is (re)started otherwise it could race with received messages\n    const handshakePromise = new Promise((resolve, reject) => {\n      this._handshakeResolver = resolve;\n      this._handshakeRejecter = reject;\n    });\n    await this.connection.start(this._protocol.transferFormat);\n    try {\n      const handshakeRequest = {\n        protocol: this._protocol.name,\n        version: this._protocol.version\n      };\n      this._logger.log(LogLevel.Debug, \"Sending handshake request.\");\n      await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(handshakeRequest));\n      this._logger.log(LogLevel.Information, `Using HubProtocol '${this._protocol.name}'.`);\n      // defensively cleanup timeout in case we receive a message from the server before we finish start\n      this._cleanupTimeout();\n      this._resetTimeoutPeriod();\n      this._resetKeepAliveInterval();\n      await handshakePromise;\n      // It's important to check the stopDuringStartError instead of just relying on the handshakePromise\n      // being rejected on close, because this continuation can run after both the handshake completed successfully\n      // and the connection was closed.\n      if (this._stopDuringStartError) {\n        // It's important to throw instead of returning a rejected promise, because we don't want to allow any state\n        // transitions to occur between now and the calling code observing the exceptions. Returning a rejected promise\n        // will cause the calling continuation to get scheduled to run later.\n        // eslint-disable-next-line @typescript-eslint/no-throw-literal\n        throw this._stopDuringStartError;\n      }\n      if (!this.connection.features.inherentKeepAlive) {\n        await this._sendMessage(this._cachedPingMessage);\n      }\n    } catch (e) {\n      this._logger.log(LogLevel.Debug, `Hub handshake failed with error '${e}' during start(). Stopping HubConnection.`);\n      this._cleanupTimeout();\n      this._cleanupPingTimer();\n      // HttpConnection.stop() should not complete until after the onclose callback is invoked.\n      // This will transition the HubConnection to the disconnected state before HttpConnection.stop() completes.\n      await this.connection.stop(e);\n      throw e;\n    }\n  }\n  /** Stops the connection.\r\n   *\r\n   * @returns {Promise<void>} A Promise that resolves when the connection has been successfully terminated, or rejects with an error.\r\n   */\n  async stop() {\n    // Capture the start promise before the connection might be restarted in an onclose callback.\n    const startPromise = this._startPromise;\n    this._stopPromise = this._stopInternal();\n    await this._stopPromise;\n    try {\n      // Awaiting undefined continues immediately\n      await startPromise;\n    } catch (e) {\n      // This exception is returned to the user as a rejected Promise from the start method.\n    }\n  }\n  _stopInternal(error) {\n    if (this._connectionState === HubConnectionState.Disconnected) {\n      this._logger.log(LogLevel.Debug, `Call to HubConnection.stop(${error}) ignored because it is already in the disconnected state.`);\n      return Promise.resolve();\n    }\n    if (this._connectionState === HubConnectionState.Disconnecting) {\n      this._logger.log(LogLevel.Debug, `Call to HttpConnection.stop(${error}) ignored because the connection is already in the disconnecting state.`);\n      return this._stopPromise;\n    }\n    this._connectionState = HubConnectionState.Disconnecting;\n    this._logger.log(LogLevel.Debug, \"Stopping HubConnection.\");\n    if (this._reconnectDelayHandle) {\n      // We're in a reconnect delay which means the underlying connection is currently already stopped.\n      // Just clear the handle to stop the reconnect loop (which no one is waiting on thankfully) and\n      // fire the onclose callbacks.\n      this._logger.log(LogLevel.Debug, \"Connection stopped during reconnect delay. Done reconnecting.\");\n      clearTimeout(this._reconnectDelayHandle);\n      this._reconnectDelayHandle = undefined;\n      this._completeClose();\n      return Promise.resolve();\n    }\n    this._cleanupTimeout();\n    this._cleanupPingTimer();\n    this._stopDuringStartError = error || new AbortError(\"The connection was stopped before the hub handshake could complete.\");\n    // HttpConnection.stop() should not complete until after either HttpConnection.start() fails\n    // or the onclose callback is invoked. The onclose callback will transition the HubConnection\n    // to the disconnected state if need be before HttpConnection.stop() completes.\n    return this.connection.stop(error);\n  }\n  /** Invokes a streaming hub method on the server using the specified name and arguments.\r\n   *\r\n   * @typeparam T The type of the items returned by the server.\r\n   * @param {string} methodName The name of the server method to invoke.\r\n   * @param {any[]} args The arguments used to invoke the server method.\r\n   * @returns {IStreamResult<T>} An object that yields results from the server as they are received.\r\n   */\n  stream(methodName, ...args) {\n    const [streams, streamIds] = this._replaceStreamingParams(args);\n    const invocationDescriptor = this._createStreamInvocation(methodName, args, streamIds);\n    // eslint-disable-next-line prefer-const\n    let promiseQueue;\n    const subject = new Subject();\n    subject.cancelCallback = () => {\n      const cancelInvocation = this._createCancelInvocation(invocationDescriptor.invocationId);\n      delete this._callbacks[invocationDescriptor.invocationId];\n      return promiseQueue.then(() => {\n        return this._sendWithProtocol(cancelInvocation);\n      });\n    };\n    this._callbacks[invocationDescriptor.invocationId] = (invocationEvent, error) => {\n      if (error) {\n        subject.error(error);\n        return;\n      } else if (invocationEvent) {\n        // invocationEvent will not be null when an error is not passed to the callback\n        if (invocationEvent.type === MessageType.Completion) {\n          if (invocationEvent.error) {\n            subject.error(new Error(invocationEvent.error));\n          } else {\n            subject.complete();\n          }\n        } else {\n          subject.next(invocationEvent.item);\n        }\n      }\n    };\n    promiseQueue = this._sendWithProtocol(invocationDescriptor).catch(e => {\n      subject.error(e);\n      delete this._callbacks[invocationDescriptor.invocationId];\n    });\n    this._launchStreams(streams, promiseQueue);\n    return subject;\n  }\n  _sendMessage(message) {\n    this._resetKeepAliveInterval();\n    return this.connection.send(message);\n  }\n  /**\r\n   * Sends a js object to the server.\r\n   * @param message The js object to serialize and send.\r\n   */\n  _sendWithProtocol(message) {\n    return this._sendMessage(this._protocol.writeMessage(message));\n  }\n  /** Invokes a hub method on the server using the specified name and arguments. Does not wait for a response from the receiver.\r\n   *\r\n   * The Promise returned by this method resolves when the client has sent the invocation to the server. The server may still\r\n   * be processing the invocation.\r\n   *\r\n   * @param {string} methodName The name of the server method to invoke.\r\n   * @param {any[]} args The arguments used to invoke the server method.\r\n   * @returns {Promise<void>} A Promise that resolves when the invocation has been successfully sent, or rejects with an error.\r\n   */\n  send(methodName, ...args) {\n    const [streams, streamIds] = this._replaceStreamingParams(args);\n    const sendPromise = this._sendWithProtocol(this._createInvocation(methodName, args, true, streamIds));\n    this._launchStreams(streams, sendPromise);\n    return sendPromise;\n  }\n  /** Invokes a hub method on the server using the specified name and arguments.\r\n   *\r\n   * The Promise returned by this method resolves when the server indicates it has finished invoking the method. When the promise\r\n   * resolves, the server has finished invoking the method. If the server method returns a result, it is produced as the result of\r\n   * resolving the Promise.\r\n   *\r\n   * @typeparam T The expected return type.\r\n   * @param {string} methodName The name of the server method to invoke.\r\n   * @param {any[]} args The arguments used to invoke the server method.\r\n   * @returns {Promise<T>} A Promise that resolves with the result of the server method (if any), or rejects with an error.\r\n   */\n  invoke(methodName, ...args) {\n    const [streams, streamIds] = this._replaceStreamingParams(args);\n    const invocationDescriptor = this._createInvocation(methodName, args, false, streamIds);\n    const p = new Promise((resolve, reject) => {\n      // invocationId will always have a value for a non-blocking invocation\n      this._callbacks[invocationDescriptor.invocationId] = (invocationEvent, error) => {\n        if (error) {\n          reject(error);\n          return;\n        } else if (invocationEvent) {\n          // invocationEvent will not be null when an error is not passed to the callback\n          if (invocationEvent.type === MessageType.Completion) {\n            if (invocationEvent.error) {\n              reject(new Error(invocationEvent.error));\n            } else {\n              resolve(invocationEvent.result);\n            }\n          } else {\n            reject(new Error(`Unexpected message type: ${invocationEvent.type}`));\n          }\n        }\n      };\n      const promiseQueue = this._sendWithProtocol(invocationDescriptor).catch(e => {\n        reject(e);\n        // invocationId will always have a value for a non-blocking invocation\n        delete this._callbacks[invocationDescriptor.invocationId];\n      });\n      this._launchStreams(streams, promiseQueue);\n    });\n    return p;\n  }\n  on(methodName, newMethod) {\n    if (!methodName || !newMethod) {\n      return;\n    }\n    methodName = methodName.toLowerCase();\n    if (!this._methods[methodName]) {\n      this._methods[methodName] = [];\n    }\n    // Preventing adding the same handler multiple times.\n    if (this._methods[methodName].indexOf(newMethod) !== -1) {\n      return;\n    }\n    this._methods[methodName].push(newMethod);\n  }\n  off(methodName, method) {\n    if (!methodName) {\n      return;\n    }\n    methodName = methodName.toLowerCase();\n    const handlers = this._methods[methodName];\n    if (!handlers) {\n      return;\n    }\n    if (method) {\n      const removeIdx = handlers.indexOf(method);\n      if (removeIdx !== -1) {\n        handlers.splice(removeIdx, 1);\n        if (handlers.length === 0) {\n          delete this._methods[methodName];\n        }\n      }\n    } else {\n      delete this._methods[methodName];\n    }\n  }\n  /** Registers a handler that will be invoked when the connection is closed.\r\n   *\r\n   * @param {Function} callback The handler that will be invoked when the connection is closed. Optionally receives a single argument containing the error that caused the connection to close (if any).\r\n   */\n  onclose(callback) {\n    if (callback) {\n      this._closedCallbacks.push(callback);\n    }\n  }\n  /** Registers a handler that will be invoked when the connection starts reconnecting.\r\n   *\r\n   * @param {Function} callback The handler that will be invoked when the connection starts reconnecting. Optionally receives a single argument containing the error that caused the connection to start reconnecting (if any).\r\n   */\n  onreconnecting(callback) {\n    if (callback) {\n      this._reconnectingCallbacks.push(callback);\n    }\n  }\n  /** Registers a handler that will be invoked when the connection successfully reconnects.\r\n   *\r\n   * @param {Function} callback The handler that will be invoked when the connection successfully reconnects.\r\n   */\n  onreconnected(callback) {\n    if (callback) {\n      this._reconnectedCallbacks.push(callback);\n    }\n  }\n  _processIncomingData(data) {\n    this._cleanupTimeout();\n    if (!this._receivedHandshakeResponse) {\n      data = this._processHandshakeResponse(data);\n      this._receivedHandshakeResponse = true;\n    }\n    // Data may have all been read when processing handshake response\n    if (data) {\n      // Parse the messages\n      const messages = this._protocol.parseMessages(data, this._logger);\n      for (const message of messages) {\n        switch (message.type) {\n          case MessageType.Invocation:\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\n            this._invokeClientMethod(message);\n            break;\n          case MessageType.StreamItem:\n          case MessageType.Completion:\n            {\n              const callback = this._callbacks[message.invocationId];\n              if (callback) {\n                if (message.type === MessageType.Completion) {\n                  delete this._callbacks[message.invocationId];\n                }\n                try {\n                  callback(message);\n                } catch (e) {\n                  this._logger.log(LogLevel.Error, `Stream callback threw error: ${getErrorString(e)}`);\n                }\n              }\n              break;\n            }\n          case MessageType.Ping:\n            // Don't care about pings\n            break;\n          case MessageType.Close:\n            {\n              this._logger.log(LogLevel.Information, \"Close message received from server.\");\n              const error = message.error ? new Error(\"Server returned an error on close: \" + message.error) : undefined;\n              if (message.allowReconnect === true) {\n                // It feels wrong not to await connection.stop() here, but processIncomingData is called as part of an onreceive callback which is not async,\n                // this is already the behavior for serverTimeout(), and HttpConnection.Stop() should catch and log all possible exceptions.\n                // eslint-disable-next-line @typescript-eslint/no-floating-promises\n                this.connection.stop(error);\n              } else {\n                // We cannot await stopInternal() here, but subsequent calls to stop() will await this if stopInternal() is still ongoing.\n                this._stopPromise = this._stopInternal(error);\n              }\n              break;\n            }\n          default:\n            this._logger.log(LogLevel.Warning, `Invalid message type: ${message.type}.`);\n            break;\n        }\n      }\n    }\n    this._resetTimeoutPeriod();\n  }\n  _processHandshakeResponse(data) {\n    let responseMessage;\n    let remainingData;\n    try {\n      [remainingData, responseMessage] = this._handshakeProtocol.parseHandshakeResponse(data);\n    } catch (e) {\n      const message = \"Error parsing handshake response: \" + e;\n      this._logger.log(LogLevel.Error, message);\n      const error = new Error(message);\n      this._handshakeRejecter(error);\n      throw error;\n    }\n    if (responseMessage.error) {\n      const message = \"Server returned handshake error: \" + responseMessage.error;\n      this._logger.log(LogLevel.Error, message);\n      const error = new Error(message);\n      this._handshakeRejecter(error);\n      throw error;\n    } else {\n      this._logger.log(LogLevel.Debug, \"Server handshake complete.\");\n    }\n    this._handshakeResolver();\n    return remainingData;\n  }\n  _resetKeepAliveInterval() {\n    if (this.connection.features.inherentKeepAlive) {\n      return;\n    }\n    // Set the time we want the next keep alive to be sent\n    // Timer will be setup on next message receive\n    this._nextKeepAlive = new Date().getTime() + this.keepAliveIntervalInMilliseconds;\n    this._cleanupPingTimer();\n  }\n  _resetTimeoutPeriod() {\n    if (!this.connection.features || !this.connection.features.inherentKeepAlive) {\n      // Set the timeout timer\n      this._timeoutHandle = setTimeout(() => this.serverTimeout(), this.serverTimeoutInMilliseconds);\n      // Set keepAlive timer if there isn't one\n      if (this._pingServerHandle === undefined) {\n        let nextPing = this._nextKeepAlive - new Date().getTime();\n        if (nextPing < 0) {\n          nextPing = 0;\n        }\n        // The timer needs to be set from a networking callback to avoid Chrome timer throttling from causing timers to run once a minute\n        this._pingServerHandle = setTimeout(async () => {\n          if (this._connectionState === HubConnectionState.Connected) {\n            try {\n              await this._sendMessage(this._cachedPingMessage);\n            } catch {\n              // We don't care about the error. It should be seen elsewhere in the client.\n              // The connection is probably in a bad or closed state now, cleanup the timer so it stops triggering\n              this._cleanupPingTimer();\n            }\n          }\n        }, nextPing);\n      }\n    }\n  }\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  serverTimeout() {\n    // The server hasn't talked to us in a while. It doesn't like us anymore ... :(\n    // Terminate the connection, but we don't need to wait on the promise. This could trigger reconnecting.\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    this.connection.stop(new Error(\"Server timeout elapsed without receiving a message from the server.\"));\n  }\n  async _invokeClientMethod(invocationMessage) {\n    const methodName = invocationMessage.target.toLowerCase();\n    const methods = this._methods[methodName];\n    if (!methods) {\n      this._logger.log(LogLevel.Warning, `No client method with the name '${methodName}' found.`);\n      // No handlers provided by client but the server is expecting a response still, so we send an error\n      if (invocationMessage.invocationId) {\n        this._logger.log(LogLevel.Warning, `No result given for '${methodName}' method and invocation ID '${invocationMessage.invocationId}'.`);\n        await this._sendWithProtocol(this._createCompletionMessage(invocationMessage.invocationId, \"Client didn't provide a result.\", null));\n      }\n      return;\n    }\n    // Avoid issues with handlers removing themselves thus modifying the list while iterating through it\n    const methodsCopy = methods.slice();\n    // Server expects a response\n    const expectsResponse = invocationMessage.invocationId ? true : false;\n    // We preserve the last result or exception but still call all handlers\n    let res;\n    let exception;\n    let completionMessage;\n    for (const m of methodsCopy) {\n      try {\n        const prevRes = res;\n        res = await m.apply(this, invocationMessage.arguments);\n        if (expectsResponse && res && prevRes) {\n          this._logger.log(LogLevel.Error, `Multiple results provided for '${methodName}'. Sending error to server.`);\n          completionMessage = this._createCompletionMessage(invocationMessage.invocationId, `Client provided multiple results.`, null);\n        }\n        // Ignore exception if we got a result after, the exception will be logged\n        exception = undefined;\n      } catch (e) {\n        exception = e;\n        this._logger.log(LogLevel.Error, `A callback for the method '${methodName}' threw error '${e}'.`);\n      }\n    }\n    if (completionMessage) {\n      await this._sendWithProtocol(completionMessage);\n    } else if (expectsResponse) {\n      // If there is an exception that means either no result was given or a handler after a result threw\n      if (exception) {\n        completionMessage = this._createCompletionMessage(invocationMessage.invocationId, `${exception}`, null);\n      } else if (res !== undefined) {\n        completionMessage = this._createCompletionMessage(invocationMessage.invocationId, null, res);\n      } else {\n        this._logger.log(LogLevel.Warning, `No result given for '${methodName}' method and invocation ID '${invocationMessage.invocationId}'.`);\n        // Client didn't provide a result or throw from a handler, server expects a response so we send an error\n        completionMessage = this._createCompletionMessage(invocationMessage.invocationId, \"Client didn't provide a result.\", null);\n      }\n      await this._sendWithProtocol(completionMessage);\n    } else {\n      if (res) {\n        this._logger.log(LogLevel.Error, `Result given for '${methodName}' method but server is not expecting a result.`);\n      }\n    }\n  }\n  _connectionClosed(error) {\n    this._logger.log(LogLevel.Debug, `HubConnection.connectionClosed(${error}) called while in state ${this._connectionState}.`);\n    // Triggering this.handshakeRejecter is insufficient because it could already be resolved without the continuation having run yet.\n    this._stopDuringStartError = this._stopDuringStartError || error || new AbortError(\"The underlying connection was closed before the hub handshake could complete.\");\n    // If the handshake is in progress, start will be waiting for the handshake promise, so we complete it.\n    // If it has already completed, this should just noop.\n    if (this._handshakeResolver) {\n      this._handshakeResolver();\n    }\n    this._cancelCallbacksWithError(error || new Error(\"Invocation canceled due to the underlying connection being closed.\"));\n    this._cleanupTimeout();\n    this._cleanupPingTimer();\n    if (this._connectionState === HubConnectionState.Disconnecting) {\n      this._completeClose(error);\n    } else if (this._connectionState === HubConnectionState.Connected && this._reconnectPolicy) {\n      // eslint-disable-next-line @typescript-eslint/no-floating-promises\n      this._reconnect(error);\n    } else if (this._connectionState === HubConnectionState.Connected) {\n      this._completeClose(error);\n    }\n    // If none of the above if conditions were true were called the HubConnection must be in either:\n    // 1. The Connecting state in which case the handshakeResolver will complete it and stopDuringStartError will fail it.\n    // 2. The Reconnecting state in which case the handshakeResolver will complete it and stopDuringStartError will fail the current reconnect attempt\n    //    and potentially continue the reconnect() loop.\n    // 3. The Disconnected state in which case we're already done.\n  }\n  _completeClose(error) {\n    if (this._connectionStarted) {\n      this._connectionState = HubConnectionState.Disconnected;\n      this._connectionStarted = false;\n      if (Platform.isBrowser) {\n        window.document.removeEventListener(\"freeze\", this._freezeEventListener);\n      }\n      try {\n        this._closedCallbacks.forEach(c => c.apply(this, [error]));\n      } catch (e) {\n        this._logger.log(LogLevel.Error, `An onclose callback called with error '${error}' threw error '${e}'.`);\n      }\n    }\n  }\n  async _reconnect(error) {\n    const reconnectStartTime = Date.now();\n    let previousReconnectAttempts = 0;\n    let retryError = error !== undefined ? error : new Error(\"Attempting to reconnect due to a unknown error.\");\n    let nextRetryDelay = this._getNextRetryDelay(previousReconnectAttempts++, 0, retryError);\n    if (nextRetryDelay === null) {\n      this._logger.log(LogLevel.Debug, \"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt.\");\n      this._completeClose(error);\n      return;\n    }\n    this._connectionState = HubConnectionState.Reconnecting;\n    if (error) {\n      this._logger.log(LogLevel.Information, `Connection reconnecting because of error '${error}'.`);\n    } else {\n      this._logger.log(LogLevel.Information, \"Connection reconnecting.\");\n    }\n    if (this._reconnectingCallbacks.length !== 0) {\n      try {\n        this._reconnectingCallbacks.forEach(c => c.apply(this, [error]));\n      } catch (e) {\n        this._logger.log(LogLevel.Error, `An onreconnecting callback called with error '${error}' threw error '${e}'.`);\n      }\n      // Exit early if an onreconnecting callback called connection.stop().\n      if (this._connectionState !== HubConnectionState.Reconnecting) {\n        this._logger.log(LogLevel.Debug, \"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.\");\n        return;\n      }\n    }\n    while (nextRetryDelay !== null) {\n      this._logger.log(LogLevel.Information, `Reconnect attempt number ${previousReconnectAttempts} will start in ${nextRetryDelay} ms.`);\n      await new Promise(resolve => {\n        this._reconnectDelayHandle = setTimeout(resolve, nextRetryDelay);\n      });\n      this._reconnectDelayHandle = undefined;\n      if (this._connectionState !== HubConnectionState.Reconnecting) {\n        this._logger.log(LogLevel.Debug, \"Connection left the reconnecting state during reconnect delay. Done reconnecting.\");\n        return;\n      }\n      try {\n        await this._startInternal();\n        this._connectionState = HubConnectionState.Connected;\n        this._logger.log(LogLevel.Information, \"HubConnection reconnected successfully.\");\n        if (this._reconnectedCallbacks.length !== 0) {\n          try {\n            this._reconnectedCallbacks.forEach(c => c.apply(this, [this.connection.connectionId]));\n          } catch (e) {\n            this._logger.log(LogLevel.Error, `An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${e}'.`);\n          }\n        }\n        return;\n      } catch (e) {\n        this._logger.log(LogLevel.Information, `Reconnect attempt failed because of error '${e}'.`);\n        if (this._connectionState !== HubConnectionState.Reconnecting) {\n          this._logger.log(LogLevel.Debug, `Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`);\n          // The TypeScript compiler thinks that connectionState must be Connected here. The TypeScript compiler is wrong.\n          if (this._connectionState === HubConnectionState.Disconnecting) {\n            this._completeClose();\n          }\n          return;\n        }\n        retryError = e instanceof Error ? e : new Error(e.toString());\n        nextRetryDelay = this._getNextRetryDelay(previousReconnectAttempts++, Date.now() - reconnectStartTime, retryError);\n      }\n    }\n    this._logger.log(LogLevel.Information, `Reconnect retries have been exhausted after ${Date.now() - reconnectStartTime} ms and ${previousReconnectAttempts} failed attempts. Connection disconnecting.`);\n    this._completeClose();\n  }\n  _getNextRetryDelay(previousRetryCount, elapsedMilliseconds, retryReason) {\n    try {\n      return this._reconnectPolicy.nextRetryDelayInMilliseconds({\n        elapsedMilliseconds,\n        previousRetryCount,\n        retryReason\n      });\n    } catch (e) {\n      this._logger.log(LogLevel.Error, `IRetryPolicy.nextRetryDelayInMilliseconds(${previousRetryCount}, ${elapsedMilliseconds}) threw error '${e}'.`);\n      return null;\n    }\n  }\n  _cancelCallbacksWithError(error) {\n    const callbacks = this._callbacks;\n    this._callbacks = {};\n    Object.keys(callbacks).forEach(key => {\n      const callback = callbacks[key];\n      try {\n        callback(null, error);\n      } catch (e) {\n        this._logger.log(LogLevel.Error, `Stream 'error' callback called with '${error}' threw error: ${getErrorString(e)}`);\n      }\n    });\n  }\n  _cleanupPingTimer() {\n    if (this._pingServerHandle) {\n      clearTimeout(this._pingServerHandle);\n      this._pingServerHandle = undefined;\n    }\n  }\n  _cleanupTimeout() {\n    if (this._timeoutHandle) {\n      clearTimeout(this._timeoutHandle);\n    }\n  }\n  _createInvocation(methodName, args, nonblocking, streamIds) {\n    if (nonblocking) {\n      if (streamIds.length !== 0) {\n        return {\n          arguments: args,\n          streamIds,\n          target: methodName,\n          type: MessageType.Invocation\n        };\n      } else {\n        return {\n          arguments: args,\n          target: methodName,\n          type: MessageType.Invocation\n        };\n      }\n    } else {\n      const invocationId = this._invocationId;\n      this._invocationId++;\n      if (streamIds.length !== 0) {\n        return {\n          arguments: args,\n          invocationId: invocationId.toString(),\n          streamIds,\n          target: methodName,\n          type: MessageType.Invocation\n        };\n      } else {\n        return {\n          arguments: args,\n          invocationId: invocationId.toString(),\n          target: methodName,\n          type: MessageType.Invocation\n        };\n      }\n    }\n  }\n  _launchStreams(streams, promiseQueue) {\n    if (streams.length === 0) {\n      return;\n    }\n    // Synchronize stream data so they arrive in-order on the server\n    if (!promiseQueue) {\n      promiseQueue = Promise.resolve();\n    }\n    // We want to iterate over the keys, since the keys are the stream ids\n    // eslint-disable-next-line guard-for-in\n    for (const streamId in streams) {\n      streams[streamId].subscribe({\n        complete: () => {\n          promiseQueue = promiseQueue.then(() => this._sendWithProtocol(this._createCompletionMessage(streamId)));\n        },\n        error: err => {\n          let message;\n          if (err instanceof Error) {\n            message = err.message;\n          } else if (err && err.toString) {\n            message = err.toString();\n          } else {\n            message = \"Unknown error\";\n          }\n          promiseQueue = promiseQueue.then(() => this._sendWithProtocol(this._createCompletionMessage(streamId, message)));\n        },\n        next: item => {\n          promiseQueue = promiseQueue.then(() => this._sendWithProtocol(this._createStreamItemMessage(streamId, item)));\n        }\n      });\n    }\n  }\n  _replaceStreamingParams(args) {\n    const streams = [];\n    const streamIds = [];\n    for (let i = 0; i < args.length; i++) {\n      const argument = args[i];\n      if (this._isObservable(argument)) {\n        const streamId = this._invocationId;\n        this._invocationId++;\n        // Store the stream for later use\n        streams[streamId] = argument;\n        streamIds.push(streamId.toString());\n        // remove stream from args\n        args.splice(i, 1);\n      }\n    }\n    return [streams, streamIds];\n  }\n  _isObservable(arg) {\n    // This allows other stream implementations to just work (like rxjs)\n    return arg && arg.subscribe && typeof arg.subscribe === \"function\";\n  }\n  _createStreamInvocation(methodName, args, streamIds) {\n    const invocationId = this._invocationId;\n    this._invocationId++;\n    if (streamIds.length !== 0) {\n      return {\n        arguments: args,\n        invocationId: invocationId.toString(),\n        streamIds,\n        target: methodName,\n        type: MessageType.StreamInvocation\n      };\n    } else {\n      return {\n        arguments: args,\n        invocationId: invocationId.toString(),\n        target: methodName,\n        type: MessageType.StreamInvocation\n      };\n    }\n  }\n  _createCancelInvocation(id) {\n    return {\n      invocationId: id,\n      type: MessageType.CancelInvocation\n    };\n  }\n  _createStreamItemMessage(id, item) {\n    return {\n      invocationId: id,\n      item,\n      type: MessageType.StreamItem\n    };\n  }\n  _createCompletionMessage(id, error, result) {\n    if (error) {\n      return {\n        error,\n        invocationId: id,\n        type: MessageType.Completion\n      };\n    }\n    return {\n      invocationId: id,\n      result,\n      type: MessageType.Completion\n    };\n  }\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\n// 0, 2, 10, 30 second delays before reconnect attempts.\nconst DEFAULT_RETRY_DELAYS_IN_MILLISECONDS = [0, 2000, 10000, 30000, null];\n/** @private */\nexport class DefaultReconnectPolicy {\n  constructor(retryDelays) {\n    this._retryDelays = retryDelays !== undefined ? [...retryDelays, null] : DEFAULT_RETRY_DELAYS_IN_MILLISECONDS;\n  }\n  nextRetryDelayInMilliseconds(retryContext) {\n    return this._retryDelays[retryContext.previousRetryCount];\n  }\n}\n","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n\r\nexport abstract class HeaderNames {\r\n    static readonly Authorization = \"Authorization\";\r\n    static readonly Cookie = \"Cookie\";\r\n}\r\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\nimport { HeaderNames } from \"./HeaderNames\";\nimport { HttpClient } from \"./HttpClient\";\n/** @private */\nexport class AccessTokenHttpClient extends HttpClient {\n  constructor(innerClient, accessTokenFactory) {\n    super();\n    this._innerClient = innerClient;\n    this._accessTokenFactory = accessTokenFactory;\n  }\n  async send(request) {\n    let allowRetry = true;\n    if (this._accessTokenFactory && (!this._accessToken || request.url && request.url.indexOf(\"/negotiate?\") > 0)) {\n      // don't retry if the request is a negotiate or if we just got a potentially new token from the access token factory\n      allowRetry = false;\n      this._accessToken = await this._accessTokenFactory();\n    }\n    this._setAuthorizationHeader(request);\n    const response = await this._innerClient.send(request);\n    if (allowRetry && response.statusCode === 401 && this._accessTokenFactory) {\n      this._accessToken = await this._accessTokenFactory();\n      this._setAuthorizationHeader(request);\n      return await this._innerClient.send(request);\n    }\n    return response;\n  }\n  _setAuthorizationHeader(request) {\n    if (!request.headers) {\n      request.headers = {};\n    }\n    if (this._accessToken) {\n      request.headers[HeaderNames.Authorization] = `Bearer ${this._accessToken}`;\n    }\n    // don't remove the header if there isn't an access token factory, the user manually added the header in this case\n    else if (this._accessTokenFactory) {\n      if (request.headers[HeaderNames.Authorization]) {\n        delete request.headers[HeaderNames.Authorization];\n      }\n    }\n  }\n  getCookieString(url) {\n    return this._innerClient.getCookieString(url);\n  }\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\n// This will be treated as a bit flag in the future, so we keep it using power-of-two values.\n/** Specifies a specific HTTP transport type. */\nexport var HttpTransportType = /*#__PURE__*/function (HttpTransportType) {\n  /** Specifies no transport preference. */\n  HttpTransportType[HttpTransportType[\"None\"] = 0] = \"None\";\n  /** Specifies the WebSockets transport. */\n  HttpTransportType[HttpTransportType[\"WebSockets\"] = 1] = \"WebSockets\";\n  /** Specifies the Server-Sent Events transport. */\n  HttpTransportType[HttpTransportType[\"ServerSentEvents\"] = 2] = \"ServerSentEvents\";\n  /** Specifies the Long Polling transport. */\n  HttpTransportType[HttpTransportType[\"LongPolling\"] = 4] = \"LongPolling\";\n  return HttpTransportType;\n}(HttpTransportType || {});\n/** Specifies the transfer format for a connection. */\nexport var TransferFormat = /*#__PURE__*/function (TransferFormat) {\n  /** Specifies that only text data will be transmitted over the connection. */\n  TransferFormat[TransferFormat[\"Text\"] = 1] = \"Text\";\n  /** Specifies that binary data will be transmitted over the connection. */\n  TransferFormat[TransferFormat[\"Binary\"] = 2] = \"Binary\";\n  return TransferFormat;\n}(TransferFormat || {});\n\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\n// Rough polyfill of https://developer.mozilla.org/en-US/docs/Web/API/AbortController\n// We don't actually ever use the API being polyfilled, we always use the polyfill because\n// it's a very new API right now.\n// Not exported from index.\n/** @private */\nexport class AbortController {\n  constructor() {\n    this._isAborted = false;\n    this.onabort = null;\n  }\n  abort() {\n    if (!this._isAborted) {\n      this._isAborted = true;\n      if (this.onabort) {\n        this.onabort();\n      }\n    }\n  }\n  get signal() {\n    return this;\n  }\n  get aborted() {\n    return this._isAborted;\n  }\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\nimport { AbortController } from \"./AbortController\";\nimport { HttpError, TimeoutError } from \"./Errors\";\nimport { LogLevel } from \"./ILogger\";\nimport { TransferFormat } from \"./ITransport\";\nimport { Arg, getDataDetail, getUserAgentHeader, sendMessage } from \"./Utils\";\n// Not exported from 'index', this type is internal.\n/** @private */\nexport class LongPollingTransport {\n  constructor(httpClient, logger, options) {\n    this._httpClient = httpClient;\n    this._logger = logger;\n    this._pollAbort = new AbortController();\n    this._options = options;\n    this._running = false;\n    this.onreceive = null;\n    this.onclose = null;\n  }\n  // This is an internal type, not exported from 'index' so this is really just internal.\n  get pollAborted() {\n    return this._pollAbort.aborted;\n  }\n  async connect(url, transferFormat) {\n    Arg.isRequired(url, \"url\");\n    Arg.isRequired(transferFormat, \"transferFormat\");\n    Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\n    this._url = url;\n    this._logger.log(LogLevel.Trace, \"(LongPolling transport) Connecting.\");\n    // Allow binary format on Node and Browsers that support binary content (indicated by the presence of responseType property)\n    if (transferFormat === TransferFormat.Binary && typeof XMLHttpRequest !== \"undefined\" && typeof new XMLHttpRequest().responseType !== \"string\") {\n      throw new Error(\"Binary protocols over XmlHttpRequest not implementing advanced features are not supported.\");\n    }\n    const [name, value] = getUserAgentHeader();\n    const headers = {\n      [name]: value,\n      ...this._options.headers\n    };\n    const pollOptions = {\n      abortSignal: this._pollAbort.signal,\n      headers,\n      timeout: 100000,\n      withCredentials: this._options.withCredentials\n    };\n    if (transferFormat === TransferFormat.Binary) {\n      pollOptions.responseType = \"arraybuffer\";\n    }\n    // Make initial long polling request\n    // Server uses first long polling request to finish initializing connection and it returns without data\n    const pollUrl = `${url}&_=${Date.now()}`;\n    this._logger.log(LogLevel.Trace, `(LongPolling transport) polling: ${pollUrl}.`);\n    const response = await this._httpClient.get(pollUrl, pollOptions);\n    if (response.statusCode !== 200) {\n      this._logger.log(LogLevel.Error, `(LongPolling transport) Unexpected response code: ${response.statusCode}.`);\n      // Mark running as false so that the poll immediately ends and runs the close logic\n      this._closeError = new HttpError(response.statusText || \"\", response.statusCode);\n      this._running = false;\n    } else {\n      this._running = true;\n    }\n    this._receiving = this._poll(this._url, pollOptions);\n  }\n  async _poll(url, pollOptions) {\n    try {\n      while (this._running) {\n        try {\n          const pollUrl = `${url}&_=${Date.now()}`;\n          this._logger.log(LogLevel.Trace, `(LongPolling transport) polling: ${pollUrl}.`);\n          const response = await this._httpClient.get(pollUrl, pollOptions);\n          if (response.statusCode === 204) {\n            this._logger.log(LogLevel.Information, \"(LongPolling transport) Poll terminated by server.\");\n            this._running = false;\n          } else if (response.statusCode !== 200) {\n            this._logger.log(LogLevel.Error, `(LongPolling transport) Unexpected response code: ${response.statusCode}.`);\n            // Unexpected status code\n            this._closeError = new HttpError(response.statusText || \"\", response.statusCode);\n            this._running = false;\n          } else {\n            // Process the response\n            if (response.content) {\n              this._logger.log(LogLevel.Trace, `(LongPolling transport) data received. ${getDataDetail(response.content, this._options.logMessageContent)}.`);\n              if (this.onreceive) {\n                this.onreceive(response.content);\n              }\n            } else {\n              // This is another way timeout manifest.\n              this._logger.log(LogLevel.Trace, \"(LongPolling transport) Poll timed out, reissuing.\");\n            }\n          }\n        } catch (e) {\n          if (!this._running) {\n            // Log but disregard errors that occur after stopping\n            this._logger.log(LogLevel.Trace, `(LongPolling transport) Poll errored after shutdown: ${e.message}`);\n          } else {\n            if (e instanceof TimeoutError) {\n              // Ignore timeouts and reissue the poll.\n              this._logger.log(LogLevel.Trace, \"(LongPolling transport) Poll timed out, reissuing.\");\n            } else {\n              // Close the connection with the error as the result.\n              this._closeError = e;\n              this._running = false;\n            }\n          }\n        }\n      }\n    } finally {\n      this._logger.log(LogLevel.Trace, \"(LongPolling transport) Polling complete.\");\n      // We will reach here with pollAborted==false when the server returned a response causing the transport to stop.\n      // If pollAborted==true then client initiated the stop and the stop method will raise the close event after DELETE is sent.\n      if (!this.pollAborted) {\n        this._raiseOnClose();\n      }\n    }\n  }\n  async send(data) {\n    if (!this._running) {\n      return Promise.reject(new Error(\"Cannot send until the transport is connected\"));\n    }\n    return sendMessage(this._logger, \"LongPolling\", this._httpClient, this._url, data, this._options);\n  }\n  async stop() {\n    this._logger.log(LogLevel.Trace, \"(LongPolling transport) Stopping polling.\");\n    // Tell receiving loop to stop, abort any current request, and then wait for it to finish\n    this._running = false;\n    this._pollAbort.abort();\n    try {\n      await this._receiving;\n      // Send DELETE to clean up long polling on the server\n      this._logger.log(LogLevel.Trace, `(LongPolling transport) sending DELETE request to ${this._url}.`);\n      const headers = {};\n      const [name, value] = getUserAgentHeader();\n      headers[name] = value;\n      const deleteOptions = {\n        headers: {\n          ...headers,\n          ...this._options.headers\n        },\n        timeout: this._options.timeout,\n        withCredentials: this._options.withCredentials\n      };\n      await this._httpClient.delete(this._url, deleteOptions);\n      this._logger.log(LogLevel.Trace, \"(LongPolling transport) DELETE request sent.\");\n    } finally {\n      this._logger.log(LogLevel.Trace, \"(LongPolling transport) Stop finished.\");\n      // Raise close event here instead of in polling\n      // It needs to happen after the DELETE request is sent\n      this._raiseOnClose();\n    }\n  }\n  _raiseOnClose() {\n    if (this.onclose) {\n      let logMessage = \"(LongPolling transport) Firing onclose event.\";\n      if (this._closeError) {\n        logMessage += \" Error: \" + this._closeError;\n      }\n      this._logger.log(LogLevel.Trace, logMessage);\n      this.onclose(this._closeError);\n    }\n  }\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\nimport { LogLevel } from \"./ILogger\";\nimport { TransferFormat } from \"./ITransport\";\nimport { Arg, getDataDetail, getUserAgentHeader, Platform, sendMessage } from \"./Utils\";\n/** @private */\nexport class ServerSentEventsTransport {\n  constructor(httpClient, accessToken, logger, options) {\n    this._httpClient = httpClient;\n    this._accessToken = accessToken;\n    this._logger = logger;\n    this._options = options;\n    this.onreceive = null;\n    this.onclose = null;\n  }\n  async connect(url, transferFormat) {\n    Arg.isRequired(url, \"url\");\n    Arg.isRequired(transferFormat, \"transferFormat\");\n    Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\n    this._logger.log(LogLevel.Trace, \"(SSE transport) Connecting.\");\n    // set url before accessTokenFactory because this._url is only for send and we set the auth header instead of the query string for send\n    this._url = url;\n    if (this._accessToken) {\n      url += (url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + `access_token=${encodeURIComponent(this._accessToken)}`;\n    }\n    return new Promise((resolve, reject) => {\n      let opened = false;\n      if (transferFormat !== TransferFormat.Text) {\n        reject(new Error(\"The Server-Sent Events transport only supports the 'Text' transfer format\"));\n        return;\n      }\n      let eventSource;\n      if (Platform.isBrowser || Platform.isWebWorker) {\n        eventSource = new this._options.EventSource(url, {\n          withCredentials: this._options.withCredentials\n        });\n      } else {\n        // Non-browser passes cookies via the dictionary\n        const cookies = this._httpClient.getCookieString(url);\n        const headers = {};\n        headers.Cookie = cookies;\n        const [name, value] = getUserAgentHeader();\n        headers[name] = value;\n        eventSource = new this._options.EventSource(url, {\n          withCredentials: this._options.withCredentials,\n          headers: {\n            ...headers,\n            ...this._options.headers\n          }\n        });\n      }\n      try {\n        eventSource.onmessage = e => {\n          if (this.onreceive) {\n            try {\n              this._logger.log(LogLevel.Trace, `(SSE transport) data received. ${getDataDetail(e.data, this._options.logMessageContent)}.`);\n              this.onreceive(e.data);\n            } catch (error) {\n              this._close(error);\n              return;\n            }\n          }\n        };\n        // @ts-ignore: not using event on purpose\n        eventSource.onerror = e => {\n          // EventSource doesn't give any useful information about server side closes.\n          if (opened) {\n            this._close();\n          } else {\n            reject(new Error(\"EventSource failed to connect. The connection could not be found on the server,\" + \" either the connection ID is not present on the server, or a proxy is refusing/buffering the connection.\" + \" If you have multiple servers check that sticky sessions are enabled.\"));\n          }\n        };\n        eventSource.onopen = () => {\n          this._logger.log(LogLevel.Information, `SSE connected to ${this._url}`);\n          this._eventSource = eventSource;\n          opened = true;\n          resolve();\n        };\n      } catch (e) {\n        reject(e);\n        return;\n      }\n    });\n  }\n  async send(data) {\n    if (!this._eventSource) {\n      return Promise.reject(new Error(\"Cannot send until the transport is connected\"));\n    }\n    return sendMessage(this._logger, \"SSE\", this._httpClient, this._url, data, this._options);\n  }\n  stop() {\n    this._close();\n    return Promise.resolve();\n  }\n  _close(e) {\n    if (this._eventSource) {\n      this._eventSource.close();\n      this._eventSource = undefined;\n      if (this.onclose) {\n        this.onclose(e);\n      }\n    }\n  }\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\nimport { HeaderNames } from \"./HeaderNames\";\nimport { LogLevel } from \"./ILogger\";\nimport { TransferFormat } from \"./ITransport\";\nimport { Arg, getDataDetail, getUserAgentHeader, Platform } from \"./Utils\";\n/** @private */\nexport class WebSocketTransport {\n  constructor(httpClient, accessTokenFactory, logger, logMessageContent, webSocketConstructor, headers) {\n    this._logger = logger;\n    this._accessTokenFactory = accessTokenFactory;\n    this._logMessageContent = logMessageContent;\n    this._webSocketConstructor = webSocketConstructor;\n    this._httpClient = httpClient;\n    this.onreceive = null;\n    this.onclose = null;\n    this._headers = headers;\n  }\n  async connect(url, transferFormat) {\n    Arg.isRequired(url, \"url\");\n    Arg.isRequired(transferFormat, \"transferFormat\");\n    Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\n    this._logger.log(LogLevel.Trace, \"(WebSockets transport) Connecting.\");\n    let token;\n    if (this._accessTokenFactory) {\n      token = await this._accessTokenFactory();\n    }\n    return new Promise((resolve, reject) => {\n      url = url.replace(/^http/, \"ws\");\n      let webSocket;\n      const cookies = this._httpClient.getCookieString(url);\n      let opened = false;\n      if (Platform.isNode || Platform.isReactNative) {\n        const headers = {};\n        const [name, value] = getUserAgentHeader();\n        headers[name] = value;\n        if (token) {\n          headers[HeaderNames.Authorization] = `Bearer ${token}`;\n        }\n        if (cookies) {\n          headers[HeaderNames.Cookie] = cookies;\n        }\n        // Only pass headers when in non-browser environments\n        webSocket = new this._webSocketConstructor(url, undefined, {\n          headers: {\n            ...headers,\n            ...this._headers\n          }\n        });\n      } else {\n        if (token) {\n          url += (url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + `access_token=${encodeURIComponent(token)}`;\n        }\n      }\n      if (!webSocket) {\n        // Chrome is not happy with passing 'undefined' as protocol\n        webSocket = new this._webSocketConstructor(url);\n      }\n      if (transferFormat === TransferFormat.Binary) {\n        webSocket.binaryType = \"arraybuffer\";\n      }\n      webSocket.onopen = _event => {\n        this._logger.log(LogLevel.Information, `WebSocket connected to ${url}.`);\n        this._webSocket = webSocket;\n        opened = true;\n        resolve();\n      };\n      webSocket.onerror = event => {\n        let error = null;\n        // ErrorEvent is a browser only type we need to check if the type exists before using it\n        if (typeof ErrorEvent !== \"undefined\" && event instanceof ErrorEvent) {\n          error = event.error;\n        } else {\n          error = \"There was an error with the transport\";\n        }\n        this._logger.log(LogLevel.Information, `(WebSockets transport) ${error}.`);\n      };\n      webSocket.onmessage = message => {\n        this._logger.log(LogLevel.Trace, `(WebSockets transport) data received. ${getDataDetail(message.data, this._logMessageContent)}.`);\n        if (this.onreceive) {\n          try {\n            this.onreceive(message.data);\n          } catch (error) {\n            this._close(error);\n            return;\n          }\n        }\n      };\n      webSocket.onclose = event => {\n        // Don't call close handler if connection was never established\n        // We'll reject the connect call instead\n        if (opened) {\n          this._close(event);\n        } else {\n          let error = null;\n          // ErrorEvent is a browser only type we need to check if the type exists before using it\n          if (typeof ErrorEvent !== \"undefined\" && event instanceof ErrorEvent) {\n            error = event.error;\n          } else {\n            error = \"WebSocket failed to connect. The connection could not be found on the server,\" + \" either the endpoint may not be a SignalR endpoint,\" + \" the connection ID is not present on the server, or there is a proxy blocking WebSockets.\" + \" If you have multiple servers check that sticky sessions are enabled.\";\n          }\n          reject(new Error(error));\n        }\n      };\n    });\n  }\n  send(data) {\n    if (this._webSocket && this._webSocket.readyState === this._webSocketConstructor.OPEN) {\n      this._logger.log(LogLevel.Trace, `(WebSockets transport) sending data. ${getDataDetail(data, this._logMessageContent)}.`);\n      this._webSocket.send(data);\n      return Promise.resolve();\n    }\n    return Promise.reject(\"WebSocket is not in the OPEN state\");\n  }\n  stop() {\n    if (this._webSocket) {\n      // Manually invoke onclose callback inline so we know the HttpConnection was closed properly before returning\n      // This also solves an issue where websocket.onclose could take 18+ seconds to trigger during network disconnects\n      this._close(undefined);\n    }\n    return Promise.resolve();\n  }\n  _close(event) {\n    // webSocket will be null if the transport did not start successfully\n    if (this._webSocket) {\n      // Clear websocket handlers because we are considering the socket closed now\n      this._webSocket.onclose = () => {};\n      this._webSocket.onmessage = () => {};\n      this._webSocket.onerror = () => {};\n      this._webSocket.close();\n      this._webSocket = undefined;\n    }\n    this._logger.log(LogLevel.Trace, \"(WebSockets transport) socket closed.\");\n    if (this.onclose) {\n      if (this._isCloseEvent(event) && (event.wasClean === false || event.code !== 1000)) {\n        this.onclose(new Error(`WebSocket closed with status code: ${event.code} (${event.reason || \"no reason given\"}).`));\n      } else if (event instanceof Error) {\n        this.onclose(event);\n      } else {\n        this.onclose();\n      }\n    }\n  }\n  _isCloseEvent(event) {\n    return event && typeof event.wasClean === \"boolean\" && typeof event.code === \"number\";\n  }\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\nimport { AccessTokenHttpClient } from \"./AccessTokenHttpClient\";\nimport { DefaultHttpClient } from \"./DefaultHttpClient\";\nimport { AggregateErrors, DisabledTransportError, FailedToNegotiateWithServerError, FailedToStartTransportError, HttpError, UnsupportedTransportError, AbortError } from \"./Errors\";\nimport { LogLevel } from \"./ILogger\";\nimport { HttpTransportType, TransferFormat } from \"./ITransport\";\nimport { LongPollingTransport } from \"./LongPollingTransport\";\nimport { ServerSentEventsTransport } from \"./ServerSentEventsTransport\";\nimport { Arg, createLogger, getUserAgentHeader, Platform } from \"./Utils\";\nimport { WebSocketTransport } from \"./WebSocketTransport\";\nconst MAX_REDIRECTS = 100;\n/** @private */\nexport class HttpConnection {\n  constructor(url, options = {}) {\n    this._stopPromiseResolver = () => {};\n    this.features = {};\n    this._negotiateVersion = 1;\n    Arg.isRequired(url, \"url\");\n    this._logger = createLogger(options.logger);\n    this.baseUrl = this._resolveUrl(url);\n    options = options || {};\n    options.logMessageContent = options.logMessageContent === undefined ? false : options.logMessageContent;\n    if (typeof options.withCredentials === \"boolean\" || options.withCredentials === undefined) {\n      options.withCredentials = options.withCredentials === undefined ? true : options.withCredentials;\n    } else {\n      throw new Error(\"withCredentials option was not a 'boolean' or 'undefined' value\");\n    }\n    options.timeout = options.timeout === undefined ? 100 * 1000 : options.timeout;\n    let webSocketModule = null;\n    let eventSourceModule = null;\n    if (Platform.isNode && typeof require !== \"undefined\") {\n      // In order to ignore the dynamic require in webpack builds we need to do this magic\n      // @ts-ignore: TS doesn't know about these names\n      const requireFunc = typeof __webpack_require__ === \"function\" ? __non_webpack_require__ : require;\n      webSocketModule = requireFunc(\"ws\");\n      eventSourceModule = requireFunc(\"eventsource\");\n    }\n    if (!Platform.isNode && typeof WebSocket !== \"undefined\" && !options.WebSocket) {\n      options.WebSocket = WebSocket;\n    } else if (Platform.isNode && !options.WebSocket) {\n      if (webSocketModule) {\n        options.WebSocket = webSocketModule;\n      }\n    }\n    if (!Platform.isNode && typeof EventSource !== \"undefined\" && !options.EventSource) {\n      options.EventSource = EventSource;\n    } else if (Platform.isNode && !options.EventSource) {\n      if (typeof eventSourceModule !== \"undefined\") {\n        options.EventSource = eventSourceModule;\n      }\n    }\n    this._httpClient = new AccessTokenHttpClient(options.httpClient || new DefaultHttpClient(this._logger), options.accessTokenFactory);\n    this._connectionState = \"Disconnected\" /* Disconnected */;\n    this._connectionStarted = false;\n    this._options = options;\n    this.onreceive = null;\n    this.onclose = null;\n  }\n  async start(transferFormat) {\n    transferFormat = transferFormat || TransferFormat.Binary;\n    Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\n    this._logger.log(LogLevel.Debug, `Starting connection with transfer format '${TransferFormat[transferFormat]}'.`);\n    if (this._connectionState !== \"Disconnected\" /* Disconnected */) {\n      return Promise.reject(new Error(\"Cannot start an HttpConnection that is not in the 'Disconnected' state.\"));\n    }\n    this._connectionState = \"Connecting\" /* Connecting */;\n    this._startInternalPromise = this._startInternal(transferFormat);\n    await this._startInternalPromise;\n    // The TypeScript compiler thinks that connectionState must be Connecting here. The TypeScript compiler is wrong.\n    if (this._connectionState === \"Disconnecting\" /* Disconnecting */) {\n      // stop() was called and transitioned the client into the Disconnecting state.\n      const message = \"Failed to start the HttpConnection before stop() was called.\";\n      this._logger.log(LogLevel.Error, message);\n      // We cannot await stopPromise inside startInternal since stopInternal awaits the startInternalPromise.\n      await this._stopPromise;\n      return Promise.reject(new AbortError(message));\n    } else if (this._connectionState !== \"Connected\" /* Connected */) {\n      // stop() was called and transitioned the client into the Disconnecting state.\n      const message = \"HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!\";\n      this._logger.log(LogLevel.Error, message);\n      return Promise.reject(new AbortError(message));\n    }\n    this._connectionStarted = true;\n  }\n  send(data) {\n    if (this._connectionState !== \"Connected\" /* Connected */) {\n      return Promise.reject(new Error(\"Cannot send data if the connection is not in the 'Connected' State.\"));\n    }\n    if (!this._sendQueue) {\n      this._sendQueue = new TransportSendQueue(this.transport);\n    }\n    // Transport will not be null if state is connected\n    return this._sendQueue.send(data);\n  }\n  async stop(error) {\n    if (this._connectionState === \"Disconnected\" /* Disconnected */) {\n      this._logger.log(LogLevel.Debug, `Call to HttpConnection.stop(${error}) ignored because the connection is already in the disconnected state.`);\n      return Promise.resolve();\n    }\n    if (this._connectionState === \"Disconnecting\" /* Disconnecting */) {\n      this._logger.log(LogLevel.Debug, `Call to HttpConnection.stop(${error}) ignored because the connection is already in the disconnecting state.`);\n      return this._stopPromise;\n    }\n    this._connectionState = \"Disconnecting\" /* Disconnecting */;\n    this._stopPromise = new Promise(resolve => {\n      // Don't complete stop() until stopConnection() completes.\n      this._stopPromiseResolver = resolve;\n    });\n    // stopInternal should never throw so just observe it.\n    await this._stopInternal(error);\n    await this._stopPromise;\n  }\n  async _stopInternal(error) {\n    // Set error as soon as possible otherwise there is a race between\n    // the transport closing and providing an error and the error from a close message\n    // We would prefer the close message error.\n    this._stopError = error;\n    try {\n      await this._startInternalPromise;\n    } catch (e) {\n      // This exception is returned to the user as a rejected Promise from the start method.\n    }\n    // The transport's onclose will trigger stopConnection which will run our onclose event.\n    // The transport should always be set if currently connected. If it wasn't set, it's likely because\n    // stop was called during start() and start() failed.\n    if (this.transport) {\n      try {\n        await this.transport.stop();\n      } catch (e) {\n        this._logger.log(LogLevel.Error, `HttpConnection.transport.stop() threw error '${e}'.`);\n        this._stopConnection();\n      }\n      this.transport = undefined;\n    } else {\n      this._logger.log(LogLevel.Debug, \"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.\");\n    }\n  }\n  async _startInternal(transferFormat) {\n    // Store the original base url and the access token factory since they may change\n    // as part of negotiating\n    let url = this.baseUrl;\n    this._accessTokenFactory = this._options.accessTokenFactory;\n    this._httpClient._accessTokenFactory = this._accessTokenFactory;\n    try {\n      if (this._options.skipNegotiation) {\n        if (this._options.transport === HttpTransportType.WebSockets) {\n          // No need to add a connection ID in this case\n          this.transport = this._constructTransport(HttpTransportType.WebSockets);\n          // We should just call connect directly in this case.\n          // No fallback or negotiate in this case.\n          await this._startTransport(url, transferFormat);\n        } else {\n          throw new Error(\"Negotiation can only be skipped when using the WebSocket transport directly.\");\n        }\n      } else {\n        let negotiateResponse = null;\n        let redirects = 0;\n        do {\n          negotiateResponse = await this._getNegotiationResponse(url);\n          // the user tries to stop the connection when it is being started\n          if (this._connectionState === \"Disconnecting\" /* Disconnecting */ || this._connectionState === \"Disconnected\" /* Disconnected */) {\n            throw new AbortError(\"The connection was stopped during negotiation.\");\n          }\n          if (negotiateResponse.error) {\n            throw new Error(negotiateResponse.error);\n          }\n          if (negotiateResponse.ProtocolVersion) {\n            throw new Error(\"Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.\");\n          }\n          if (negotiateResponse.url) {\n            url = negotiateResponse.url;\n          }\n          if (negotiateResponse.accessToken) {\n            // Replace the current access token factory with one that uses\n            // the returned access token\n            const accessToken = negotiateResponse.accessToken;\n            this._accessTokenFactory = () => accessToken;\n            // set the factory to undefined so the AccessTokenHttpClient won't retry with the same token, since we know it won't change until a connection restart\n            this._httpClient._accessToken = accessToken;\n            this._httpClient._accessTokenFactory = undefined;\n          }\n          redirects++;\n        } while (negotiateResponse.url && redirects < MAX_REDIRECTS);\n        if (redirects === MAX_REDIRECTS && negotiateResponse.url) {\n          throw new Error(\"Negotiate redirection limit exceeded.\");\n        }\n        await this._createTransport(url, this._options.transport, negotiateResponse, transferFormat);\n      }\n      if (this.transport instanceof LongPollingTransport) {\n        this.features.inherentKeepAlive = true;\n      }\n      if (this._connectionState === \"Connecting\" /* Connecting */) {\n        // Ensure the connection transitions to the connected state prior to completing this.startInternalPromise.\n        // start() will handle the case when stop was called and startInternal exits still in the disconnecting state.\n        this._logger.log(LogLevel.Debug, \"The HttpConnection connected successfully.\");\n        this._connectionState = \"Connected\" /* Connected */;\n      }\n      // stop() is waiting on us via this.startInternalPromise so keep this.transport around so it can clean up.\n      // This is the only case startInternal can exit in neither the connected nor disconnected state because stopConnection()\n      // will transition to the disconnected state. start() will wait for the transition using the stopPromise.\n    } catch (e) {\n      this._logger.log(LogLevel.Error, \"Failed to start the connection: \" + e);\n      this._connectionState = \"Disconnected\" /* Disconnected */;\n      this.transport = undefined;\n      // if start fails, any active calls to stop assume that start will complete the stop promise\n      this._stopPromiseResolver();\n      return Promise.reject(e);\n    }\n  }\n  async _getNegotiationResponse(url) {\n    const headers = {};\n    const [name, value] = getUserAgentHeader();\n    headers[name] = value;\n    const negotiateUrl = this._resolveNegotiateUrl(url);\n    this._logger.log(LogLevel.Debug, `Sending negotiation request: ${negotiateUrl}.`);\n    try {\n      const response = await this._httpClient.post(negotiateUrl, {\n        content: \"\",\n        headers: {\n          ...headers,\n          ...this._options.headers\n        },\n        timeout: this._options.timeout,\n        withCredentials: this._options.withCredentials\n      });\n      if (response.statusCode !== 200) {\n        return Promise.reject(new Error(`Unexpected status code returned from negotiate '${response.statusCode}'`));\n      }\n      const negotiateResponse = JSON.parse(response.content);\n      if (!negotiateResponse.negotiateVersion || negotiateResponse.negotiateVersion < 1) {\n        // Negotiate version 0 doesn't use connectionToken\n        // So we set it equal to connectionId so all our logic can use connectionToken without being aware of the negotiate version\n        negotiateResponse.connectionToken = negotiateResponse.connectionId;\n      }\n      return negotiateResponse;\n    } catch (e) {\n      let errorMessage = \"Failed to complete negotiation with the server: \" + e;\n      if (e instanceof HttpError) {\n        if (e.statusCode === 404) {\n          errorMessage = errorMessage + \" Either this is not a SignalR endpoint or there is a proxy blocking the connection.\";\n        }\n      }\n      this._logger.log(LogLevel.Error, errorMessage);\n      return Promise.reject(new FailedToNegotiateWithServerError(errorMessage));\n    }\n  }\n  _createConnectUrl(url, connectionToken) {\n    if (!connectionToken) {\n      return url;\n    }\n    return url + (url.indexOf(\"?\") === -1 ? \"?\" : \"&\") + `id=${connectionToken}`;\n  }\n  async _createTransport(url, requestedTransport, negotiateResponse, requestedTransferFormat) {\n    let connectUrl = this._createConnectUrl(url, negotiateResponse.connectionToken);\n    if (this._isITransport(requestedTransport)) {\n      this._logger.log(LogLevel.Debug, \"Connection was provided an instance of ITransport, using that directly.\");\n      this.transport = requestedTransport;\n      await this._startTransport(connectUrl, requestedTransferFormat);\n      this.connectionId = negotiateResponse.connectionId;\n      return;\n    }\n    const transportExceptions = [];\n    const transports = negotiateResponse.availableTransports || [];\n    let negotiate = negotiateResponse;\n    for (const endpoint of transports) {\n      const transportOrError = this._resolveTransportOrError(endpoint, requestedTransport, requestedTransferFormat);\n      if (transportOrError instanceof Error) {\n        // Store the error and continue, we don't want to cause a re-negotiate in these cases\n        transportExceptions.push(`${endpoint.transport} failed:`);\n        transportExceptions.push(transportOrError);\n      } else if (this._isITransport(transportOrError)) {\n        this.transport = transportOrError;\n        if (!negotiate) {\n          try {\n            negotiate = await this._getNegotiationResponse(url);\n          } catch (ex) {\n            return Promise.reject(ex);\n          }\n          connectUrl = this._createConnectUrl(url, negotiate.connectionToken);\n        }\n        try {\n          await this._startTransport(connectUrl, requestedTransferFormat);\n          this.connectionId = negotiate.connectionId;\n          return;\n        } catch (ex) {\n          this._logger.log(LogLevel.Error, `Failed to start the transport '${endpoint.transport}': ${ex}`);\n          negotiate = undefined;\n          transportExceptions.push(new FailedToStartTransportError(`${endpoint.transport} failed: ${ex}`, HttpTransportType[endpoint.transport]));\n          if (this._connectionState !== \"Connecting\" /* Connecting */) {\n            const message = \"Failed to select transport before stop() was called.\";\n            this._logger.log(LogLevel.Debug, message);\n            return Promise.reject(new AbortError(message));\n          }\n        }\n      }\n    }\n    if (transportExceptions.length > 0) {\n      return Promise.reject(new AggregateErrors(`Unable to connect to the server with any of the available transports. ${transportExceptions.join(\" \")}`, transportExceptions));\n    }\n    return Promise.reject(new Error(\"None of the transports supported by the client are supported by the server.\"));\n  }\n  _constructTransport(transport) {\n    switch (transport) {\n      case HttpTransportType.WebSockets:\n        if (!this._options.WebSocket) {\n          throw new Error(\"'WebSocket' is not supported in your environment.\");\n        }\n        return new WebSocketTransport(this._httpClient, this._accessTokenFactory, this._logger, this._options.logMessageContent, this._options.WebSocket, this._options.headers || {});\n      case HttpTransportType.ServerSentEvents:\n        if (!this._options.EventSource) {\n          throw new Error(\"'EventSource' is not supported in your environment.\");\n        }\n        return new ServerSentEventsTransport(this._httpClient, this._httpClient._accessToken, this._logger, this._options);\n      case HttpTransportType.LongPolling:\n        return new LongPollingTransport(this._httpClient, this._logger, this._options);\n      default:\n        throw new Error(`Unknown transport: ${transport}.`);\n    }\n  }\n  _startTransport(url, transferFormat) {\n    this.transport.onreceive = this.onreceive;\n    this.transport.onclose = e => this._stopConnection(e);\n    return this.transport.connect(url, transferFormat);\n  }\n  _resolveTransportOrError(endpoint, requestedTransport, requestedTransferFormat) {\n    const transport = HttpTransportType[endpoint.transport];\n    if (transport === null || transport === undefined) {\n      this._logger.log(LogLevel.Debug, `Skipping transport '${endpoint.transport}' because it is not supported by this client.`);\n      return new Error(`Skipping transport '${endpoint.transport}' because it is not supported by this client.`);\n    } else {\n      if (transportMatches(requestedTransport, transport)) {\n        const transferFormats = endpoint.transferFormats.map(s => TransferFormat[s]);\n        if (transferFormats.indexOf(requestedTransferFormat) >= 0) {\n          if (transport === HttpTransportType.WebSockets && !this._options.WebSocket || transport === HttpTransportType.ServerSentEvents && !this._options.EventSource) {\n            this._logger.log(LogLevel.Debug, `Skipping transport '${HttpTransportType[transport]}' because it is not supported in your environment.'`);\n            return new UnsupportedTransportError(`'${HttpTransportType[transport]}' is not supported in your environment.`, transport);\n          } else {\n            this._logger.log(LogLevel.Debug, `Selecting transport '${HttpTransportType[transport]}'.`);\n            try {\n              return this._constructTransport(transport);\n            } catch (ex) {\n              return ex;\n            }\n          }\n        } else {\n          this._logger.log(LogLevel.Debug, `Skipping transport '${HttpTransportType[transport]}' because it does not support the requested transfer format '${TransferFormat[requestedTransferFormat]}'.`);\n          return new Error(`'${HttpTransportType[transport]}' does not support ${TransferFormat[requestedTransferFormat]}.`);\n        }\n      } else {\n        this._logger.log(LogLevel.Debug, `Skipping transport '${HttpTransportType[transport]}' because it was disabled by the client.`);\n        return new DisabledTransportError(`'${HttpTransportType[transport]}' is disabled by the client.`, transport);\n      }\n    }\n  }\n  _isITransport(transport) {\n    return transport && typeof transport === \"object\" && \"connect\" in transport;\n  }\n  _stopConnection(error) {\n    this._logger.log(LogLevel.Debug, `HttpConnection.stopConnection(${error}) called while in state ${this._connectionState}.`);\n    this.transport = undefined;\n    // If we have a stopError, it takes precedence over the error from the transport\n    error = this._stopError || error;\n    this._stopError = undefined;\n    if (this._connectionState === \"Disconnected\" /* Disconnected */) {\n      this._logger.log(LogLevel.Debug, `Call to HttpConnection.stopConnection(${error}) was ignored because the connection is already in the disconnected state.`);\n      return;\n    }\n    if (this._connectionState === \"Connecting\" /* Connecting */) {\n      this._logger.log(LogLevel.Warning, `Call to HttpConnection.stopConnection(${error}) was ignored because the connection is still in the connecting state.`);\n      throw new Error(`HttpConnection.stopConnection(${error}) was called while the connection is still in the connecting state.`);\n    }\n    if (this._connectionState === \"Disconnecting\" /* Disconnecting */) {\n      // A call to stop() induced this call to stopConnection and needs to be completed.\n      // Any stop() awaiters will be scheduled to continue after the onclose callback fires.\n      this._stopPromiseResolver();\n    }\n    if (error) {\n      this._logger.log(LogLevel.Error, `Connection disconnected with error '${error}'.`);\n    } else {\n      this._logger.log(LogLevel.Information, \"Connection disconnected.\");\n    }\n    if (this._sendQueue) {\n      this._sendQueue.stop().catch(e => {\n        this._logger.log(LogLevel.Error, `TransportSendQueue.stop() threw error '${e}'.`);\n      });\n      this._sendQueue = undefined;\n    }\n    this.connectionId = undefined;\n    this._connectionState = \"Disconnected\" /* Disconnected */;\n    if (this._connectionStarted) {\n      this._connectionStarted = false;\n      try {\n        if (this.onclose) {\n          this.onclose(error);\n        }\n      } catch (e) {\n        this._logger.log(LogLevel.Error, `HttpConnection.onclose(${error}) threw error '${e}'.`);\n      }\n    }\n  }\n  _resolveUrl(url) {\n    // startsWith is not supported in IE\n    if (url.lastIndexOf(\"https://\", 0) === 0 || url.lastIndexOf(\"http://\", 0) === 0) {\n      return url;\n    }\n    if (!Platform.isBrowser) {\n      throw new Error(`Cannot resolve '${url}'.`);\n    }\n    // Setting the url to the href propery of an anchor tag handles normalization\n    // for us. There are 3 main cases.\n    // 1. Relative path normalization e.g \"b\" -> \"http://localhost:5000/a/b\"\n    // 2. Absolute path normalization e.g \"/a/b\" -> \"http://localhost:5000/a/b\"\n    // 3. Networkpath reference normalization e.g \"//localhost:5000/a/b\" -> \"http://localhost:5000/a/b\"\n    const aTag = window.document.createElement(\"a\");\n    aTag.href = url;\n    this._logger.log(LogLevel.Information, `Normalizing '${url}' to '${aTag.href}'.`);\n    return aTag.href;\n  }\n  _resolveNegotiateUrl(url) {\n    const index = url.indexOf(\"?\");\n    let negotiateUrl = url.substring(0, index === -1 ? url.length : index);\n    if (negotiateUrl[negotiateUrl.length - 1] !== \"/\") {\n      negotiateUrl += \"/\";\n    }\n    negotiateUrl += \"negotiate\";\n    negotiateUrl += index === -1 ? \"\" : url.substring(index);\n    if (negotiateUrl.indexOf(\"negotiateVersion\") === -1) {\n      negotiateUrl += index === -1 ? \"?\" : \"&\";\n      negotiateUrl += \"negotiateVersion=\" + this._negotiateVersion;\n    }\n    return negotiateUrl;\n  }\n}\nfunction transportMatches(requestedTransport, actualTransport) {\n  return !requestedTransport || (actualTransport & requestedTransport) !== 0;\n}\n/** @private */\nexport class TransportSendQueue {\n  constructor(_transport) {\n    this._transport = _transport;\n    this._buffer = [];\n    this._executing = true;\n    this._sendBufferedData = new PromiseSource();\n    this._transportResult = new PromiseSource();\n    this._sendLoopPromise = this._sendLoop();\n  }\n  send(data) {\n    this._bufferData(data);\n    if (!this._transportResult) {\n      this._transportResult = new PromiseSource();\n    }\n    return this._transportResult.promise;\n  }\n  stop() {\n    this._executing = false;\n    this._sendBufferedData.resolve();\n    return this._sendLoopPromise;\n  }\n  _bufferData(data) {\n    if (this._buffer.length && typeof this._buffer[0] !== typeof data) {\n      throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof data}`);\n    }\n    this._buffer.push(data);\n    this._sendBufferedData.resolve();\n  }\n  async _sendLoop() {\n    while (true) {\n      await this._sendBufferedData.promise;\n      if (!this._executing) {\n        if (this._transportResult) {\n          this._transportResult.reject(\"Connection stopped.\");\n        }\n        break;\n      }\n      this._sendBufferedData = new PromiseSource();\n      const transportResult = this._transportResult;\n      this._transportResult = undefined;\n      const data = typeof this._buffer[0] === \"string\" ? this._buffer.join(\"\") : TransportSendQueue._concatBuffers(this._buffer);\n      this._buffer.length = 0;\n      try {\n        await this._transport.send(data);\n        transportResult.resolve();\n      } catch (error) {\n        transportResult.reject(error);\n      }\n    }\n  }\n  static _concatBuffers(arrayBuffers) {\n    const totalLength = arrayBuffers.map(b => b.byteLength).reduce((a, b) => a + b);\n    const result = new Uint8Array(totalLength);\n    let offset = 0;\n    for (const item of arrayBuffers) {\n      result.set(new Uint8Array(item), offset);\n      offset += item.byteLength;\n    }\n    return result.buffer;\n  }\n}\nclass PromiseSource {\n  constructor() {\n    this.promise = new Promise((resolve, reject) => [this._resolver, this._rejecter] = [resolve, reject]);\n  }\n  resolve() {\n    this._resolver();\n  }\n  reject(reason) {\n    this._rejecter(reason);\n  }\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\nimport { MessageType } from \"./IHubProtocol\";\nimport { LogLevel } from \"./ILogger\";\nimport { TransferFormat } from \"./ITransport\";\nimport { NullLogger } from \"./Loggers\";\nimport { TextMessageFormat } from \"./TextMessageFormat\";\nconst JSON_HUB_PROTOCOL_NAME = \"json\";\n/** Implements the JSON Hub Protocol. */\nexport class JsonHubProtocol {\n  constructor() {\n    /** @inheritDoc */\n    this.name = JSON_HUB_PROTOCOL_NAME;\n    /** @inheritDoc */\n    this.version = 1;\n    /** @inheritDoc */\n    this.transferFormat = TransferFormat.Text;\n  }\n  /** Creates an array of {@link @microsoft/signalr.HubMessage} objects from the specified serialized representation.\r\n   *\r\n   * @param {string} input A string containing the serialized representation.\r\n   * @param {ILogger} logger A logger that will be used to log messages that occur during parsing.\r\n   */\n  parseMessages(input, logger) {\n    // The interface does allow \"ArrayBuffer\" to be passed in, but this implementation does not. So let's throw a useful error.\n    if (typeof input !== \"string\") {\n      throw new Error(\"Invalid input for JSON hub protocol. Expected a string.\");\n    }\n    if (!input) {\n      return [];\n    }\n    if (logger === null) {\n      logger = NullLogger.instance;\n    }\n    // Parse the messages\n    const messages = TextMessageFormat.parse(input);\n    const hubMessages = [];\n    for (const message of messages) {\n      const parsedMessage = JSON.parse(message);\n      if (typeof parsedMessage.type !== \"number\") {\n        throw new Error(\"Invalid payload.\");\n      }\n      switch (parsedMessage.type) {\n        case MessageType.Invocation:\n          this._isInvocationMessage(parsedMessage);\n          break;\n        case MessageType.StreamItem:\n          this._isStreamItemMessage(parsedMessage);\n          break;\n        case MessageType.Completion:\n          this._isCompletionMessage(parsedMessage);\n          break;\n        case MessageType.Ping:\n          // Single value, no need to validate\n          break;\n        case MessageType.Close:\n          // All optional values, no need to validate\n          break;\n        default:\n          // Future protocol changes can add message types, old clients can ignore them\n          logger.log(LogLevel.Information, \"Unknown message type '\" + parsedMessage.type + \"' ignored.\");\n          continue;\n      }\n      hubMessages.push(parsedMessage);\n    }\n    return hubMessages;\n  }\n  /** Writes the specified {@link @microsoft/signalr.HubMessage} to a string and returns it.\r\n   *\r\n   * @param {HubMessage} message The message to write.\r\n   * @returns {string} A string containing the serialized representation of the message.\r\n   */\n  writeMessage(message) {\n    return TextMessageFormat.write(JSON.stringify(message));\n  }\n  _isInvocationMessage(message) {\n    this._assertNotEmptyString(message.target, \"Invalid payload for Invocation message.\");\n    if (message.invocationId !== undefined) {\n      this._assertNotEmptyString(message.invocationId, \"Invalid payload for Invocation message.\");\n    }\n  }\n  _isStreamItemMessage(message) {\n    this._assertNotEmptyString(message.invocationId, \"Invalid payload for StreamItem message.\");\n    if (message.item === undefined) {\n      throw new Error(\"Invalid payload for StreamItem message.\");\n    }\n  }\n  _isCompletionMessage(message) {\n    if (message.result && message.error) {\n      throw new Error(\"Invalid payload for Completion message.\");\n    }\n    if (!message.result && message.error) {\n      this._assertNotEmptyString(message.error, \"Invalid payload for Completion message.\");\n    }\n    this._assertNotEmptyString(message.invocationId, \"Invalid payload for Completion message.\");\n  }\n  _assertNotEmptyString(value, errorMessage) {\n    if (typeof value !== \"string\" || value === \"\") {\n      throw new Error(errorMessage);\n    }\n  }\n}\n","// Licensed to the .NET Foundation under one or more agreements.\n// The .NET Foundation licenses this file to you under the MIT license.\nimport { DefaultReconnectPolicy } from \"./DefaultReconnectPolicy\";\nimport { HttpConnection } from \"./HttpConnection\";\nimport { HubConnection } from \"./HubConnection\";\nimport { LogLevel } from \"./ILogger\";\nimport { JsonHubProtocol } from \"./JsonHubProtocol\";\nimport { NullLogger } from \"./Loggers\";\nimport { Arg, ConsoleLogger } from \"./Utils\";\nconst LogLevelNameMapping = {\n  trace: LogLevel.Trace,\n  debug: LogLevel.Debug,\n  info: LogLevel.Information,\n  information: LogLevel.Information,\n  warn: LogLevel.Warning,\n  warning: LogLevel.Warning,\n  error: LogLevel.Error,\n  critical: LogLevel.Critical,\n  none: LogLevel.None\n};\nfunction parseLogLevel(name) {\n  // Case-insensitive matching via lower-casing\n  // Yes, I know case-folding is a complicated problem in Unicode, but we only support\n  // the ASCII strings defined in LogLevelNameMapping anyway, so it's fine -anurse.\n  const mapping = LogLevelNameMapping[name.toLowerCase()];\n  if (typeof mapping !== \"undefined\") {\n    return mapping;\n  } else {\n    throw new Error(`Unknown log level: ${name}`);\n  }\n}\n/** A builder for configuring {@link @microsoft/signalr.HubConnection} instances. */\nexport class HubConnectionBuilder {\n  configureLogging(logging) {\n    Arg.isRequired(logging, \"logging\");\n    if (isLogger(logging)) {\n      this.logger = logging;\n    } else if (typeof logging === \"string\") {\n      const logLevel = parseLogLevel(logging);\n      this.logger = new ConsoleLogger(logLevel);\n    } else {\n      this.logger = new ConsoleLogger(logging);\n    }\n    return this;\n  }\n  withUrl(url, transportTypeOrOptions) {\n    Arg.isRequired(url, \"url\");\n    Arg.isNotEmpty(url, \"url\");\n    this.url = url;\n    // Flow-typing knows where it's at. Since HttpTransportType is a number and IHttpConnectionOptions is guaranteed\n    // to be an object, we know (as does TypeScript) this comparison is all we need to figure out which overload was called.\n    if (typeof transportTypeOrOptions === \"object\") {\n      this.httpConnectionOptions = {\n        ...this.httpConnectionOptions,\n        ...transportTypeOrOptions\n      };\n    } else {\n      this.httpConnectionOptions = {\n        ...this.httpConnectionOptions,\n        transport: transportTypeOrOptions\n      };\n    }\n    return this;\n  }\n  /** Configures the {@link @microsoft/signalr.HubConnection} to use the specified Hub Protocol.\r\n   *\r\n   * @param {IHubProtocol} protocol The {@link @microsoft/signalr.IHubProtocol} implementation to use.\r\n   */\n  withHubProtocol(protocol) {\n    Arg.isRequired(protocol, \"protocol\");\n    this.protocol = protocol;\n    return this;\n  }\n  withAutomaticReconnect(retryDelaysOrReconnectPolicy) {\n    if (this.reconnectPolicy) {\n      throw new Error(\"A reconnectPolicy has already been set.\");\n    }\n    if (!retryDelaysOrReconnectPolicy) {\n      this.reconnectPolicy = new DefaultReconnectPolicy();\n    } else if (Array.isArray(retryDelaysOrReconnectPolicy)) {\n      this.reconnectPolicy = new DefaultReconnectPolicy(retryDelaysOrReconnectPolicy);\n    } else {\n      this.reconnectPolicy = retryDelaysOrReconnectPolicy;\n    }\n    return this;\n  }\n  /** Creates a {@link @microsoft/signalr.HubConnection} from the configuration options specified in this builder.\r\n   *\r\n   * @returns {HubConnection} The configured {@link @microsoft/signalr.HubConnection}.\r\n   */\n  build() {\n    // If httpConnectionOptions has a logger, use it. Otherwise, override it with the one\n    // provided to configureLogger\n    const httpConnectionOptions = this.httpConnectionOptions || {};\n    // If it's 'null', the user **explicitly** asked for null, don't mess with it.\n    if (httpConnectionOptions.logger === undefined) {\n      // If our logger is undefined or null, that's OK, the HttpConnection constructor will handle it.\n      httpConnectionOptions.logger = this.logger;\n    }\n    // Now create the connection\n    if (!this.url) {\n      throw new Error(\"The 'HubConnectionBuilder.withUrl' method must be called before building the connection.\");\n    }\n    const connection = new HttpConnection(this.url, httpConnectionOptions);\n    return HubConnection.create(connection, this.logger || NullLogger.instance, this.protocol || new JsonHubProtocol(), this.reconnectPolicy);\n  }\n}\nfunction isLogger(logger) {\n  return logger.log !== undefined;\n}\n","import { Injectable } from '@angular/core';\nimport { HubConnection, HubConnectionBuilder } from '@microsoft/signalr';\nimport { BehaviorSubject, ReplaySubject } from 'rxjs';\nimport { environment } from 'src/environments/environment';\nimport { LibraryModifiedEvent } from '../_models/events/library-modified-event';\nimport { NotificationProgressEvent } from '../_models/events/notification-progress-event';\nimport { ThemeProgressEvent } from '../_models/events/theme-progress-event';\nimport { UserUpdateEvent } from '../_models/events/user-update-event';\nimport { User } from '../_models/user';\nimport {DashboardUpdateEvent} from \"../_models/events/dashboard-update-event\";\nimport {SideNavUpdateEvent} from \"../_models/events/sidenav-update-event\";\n\nexport enum EVENTS {\n  UpdateAvailable = 'UpdateAvailable',\n  ScanSeries = 'ScanSeries',\n  SeriesAdded = 'SeriesAdded',\n  SeriesRemoved = 'SeriesRemoved',\n  ScanLibraryProgress = 'ScanLibraryProgress',\n  OnlineUsers = 'OnlineUsers',\n  SeriesAddedToCollection = 'SeriesAddedToCollection',\n  /**\n   * A generic error that occurs during operations on the server\n   */\n  Error = 'Error',\n  BackupDatabaseProgress = 'BackupDatabaseProgress',\n  /**\n   * A subtype of NotificationProgress that represents maintenance cleanup on server-owned resources\n   */\n  CleanupProgress = 'CleanupProgress',\n  /**\n   * A subtype of NotificationProgress that represnts a user downloading a file or group of files.\n   * Note: In v0.5.5, this is being replaced by an inbrowser experience. The message is changed and this will be moved to dashboard view once built\n   */\n  DownloadProgress = 'DownloadProgress',\n  /**\n   * A generic progress event\n   */\n  NotificationProgress = 'NotificationProgress',\n  /**\n   * A subtype of NotificationProgress that represents the underlying file being processed during a scan\n   */\n  FileScanProgress = 'FileScanProgress',\n  /**\n   * A custom user site theme is added or removed during a scan\n   */\n  SiteThemeProgress = 'SiteThemeProgress',\n  /**\n   * A cover is updated\n   */\n  CoverUpdate = 'CoverUpdate',\n  /**\n   * A subtype of NotificationProgress that represents a file being processed for cover image extraction\n   */\n  CoverUpdateProgress = 'CoverUpdateProgress',\n   /**\n    * A library is created or removed from the instance\n    */\n  LibraryModified = 'LibraryModified',\n   /**\n    * A user updates an entities read progress\n    */\n  UserProgressUpdate = 'UserProgressUpdate',\n   /**\n    * A user updates account or preferences\n    */\n  UserUpdate = 'UserUpdate',\n   /**\n    * When bulk bookmarks are being converted\n    */\n  ConvertBookmarksProgress = 'ConvertBookmarksProgress',\n   /**\n    * When files are being scanned to calculate word count\n    */\n  WordCountAnalyzerProgress = 'WordCountAnalyzerProgress',\n   /**\n    * When the user needs to be informed, but it's not a big deal\n    */\n  Info = 'Info',\n   /**\n    * A user is sending files to their device\n    */\n  SendingToDevice = 'SendingToDevice',\n  /**\n   * A scrobbling token has expired\n   */\n  ScrobblingKeyExpired = 'ScrobblingKeyExpired',\n  /**\n   * User's dashboard needs to be re-rendered\n   */\n  DashboardUpdate = 'DashboardUpdate',\n  /**\n   * User's sidenav needs to be re-rendered\n   */\n  SideNavUpdate = 'SideNavUpdate'\n}\n\nexport interface Message<T> {\n  event: EVENTS;\n  payload: T;\n}\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MessageHubService {\n  hubUrl = environment.hubUrl;\n  private hubConnection!: HubConnection;\n\n  private messagesSource = new ReplaySubject<Message<any>>(1);\n  private onlineUsersSource = new BehaviorSubject<string[]>([]); // UserNames\n\n  /**\n   * Any events that come from the backend\n   */\n  public messages$ = this.messagesSource.asObservable();\n  /**\n   * Users that are online\n   */\n  public onlineUsers$ = this.onlineUsersSource.asObservable();\n\n  constructor() {}\n\n  /**\n   * Tests that an event is of the type passed\n   * @param event\n   * @param eventType\n   * @returns\n   */\n  public isEventType(event: Message<any>, eventType: EVENTS) {\n    if (event.event == EVENTS.NotificationProgress) {\n      const notification = event.payload as NotificationProgressEvent;\n      return notification.eventType.toLowerCase() == eventType.toLowerCase();\n    }\n    return event.event === eventType;\n  }\n\n  createHubConnection(user: User) {\n    this.hubConnection = new HubConnectionBuilder()\n      .withUrl(this.hubUrl + 'messages', {\n        accessTokenFactory: () => user.token\n      })\n      .withAutomaticReconnect()\n      //.withStatefulReconnect() // Needs @microsoft/signalr@8\n      .build();\n\n    this.hubConnection\n    .start()\n    .catch(err => console.error(err));\n\n    this.hubConnection.on(EVENTS.OnlineUsers, (usernames: string[]) => {\n      this.onlineUsersSource.next(usernames);\n    });\n\n    this.hubConnection.on(EVENTS.ScanSeries, resp => {\n      this.messagesSource.next({\n        event: EVENTS.ScanSeries,\n        payload: resp.body\n      });\n    });\n\n    this.hubConnection.on(EVENTS.ScanLibraryProgress, resp => {\n      this.messagesSource.next({\n        event: EVENTS.ScanLibraryProgress,\n        payload: resp.body\n      });\n    });\n\n    this.hubConnection.on(EVENTS.ConvertBookmarksProgress, resp => {\n      this.messagesSource.next({\n        event: EVENTS.ConvertBookmarksProgress,\n        payload: resp.body\n      });\n    });\n\n    this.hubConnection.on(EVENTS.WordCountAnalyzerProgress, resp => {\n      this.messagesSource.next({\n        event: EVENTS.WordCountAnalyzerProgress,\n        payload: resp.body\n      });\n    });\n\n    this.hubConnection.on(EVENTS.LibraryModified, resp => {\n      this.messagesSource.next({\n        event: EVENTS.LibraryModified,\n        payload: resp.body as LibraryModifiedEvent\n      });\n    });\n\n    this.hubConnection.on(EVENTS.DashboardUpdate, resp => {\n      this.messagesSource.next({\n        event: EVENTS.DashboardUpdate,\n        payload: resp.body as DashboardUpdateEvent\n      });\n    });\n    this.hubConnection.on(EVENTS.SideNavUpdate, resp => {\n      this.messagesSource.next({\n        event: EVENTS.SideNavUpdate,\n        payload: resp.body as SideNavUpdateEvent\n      });\n    });\n\n    this.hubConnection.on(EVENTS.NotificationProgress, (resp: NotificationProgressEvent) => {\n      this.messagesSource.next({\n        event: EVENTS.NotificationProgress,\n        payload: resp\n      });\n    });\n\n    this.hubConnection.on(EVENTS.SiteThemeProgress, resp => {\n      this.messagesSource.next({\n        event: EVENTS.SiteThemeProgress,\n        payload: resp.body as ThemeProgressEvent\n      });\n    });\n\n    this.hubConnection.on(EVENTS.SeriesAddedToCollection, resp => {\n      this.messagesSource.next({\n        event: EVENTS.SeriesAddedToCollection,\n        payload: resp.body\n      });\n    });\n\n    this.hubConnection.on(EVENTS.UserProgressUpdate, resp => {\n      this.messagesSource.next({\n        event: EVENTS.UserProgressUpdate,\n        payload: resp.body\n      });\n    });\n\n    this.hubConnection.on(EVENTS.UserUpdate, resp => {\n      this.messagesSource.next({\n        event: EVENTS.UserUpdate,\n        payload: resp.body as UserUpdateEvent\n      });\n    });\n\n    this.hubConnection.on(EVENTS.Error, resp => {\n      this.messagesSource.next({\n        event: EVENTS.Error,\n        payload: resp.body\n      });\n    });\n\n    this.hubConnection.on(EVENTS.Info, resp => {\n      this.messagesSource.next({\n        event: EVENTS.Info,\n        payload: resp.body\n      });\n    });\n\n    this.hubConnection.on(EVENTS.SeriesAdded, resp => {\n      this.messagesSource.next({\n        event: EVENTS.SeriesAdded,\n        payload: resp.body\n      });\n    });\n\n    this.hubConnection.on(EVENTS.SeriesRemoved, resp => {\n      this.messagesSource.next({\n        event: EVENTS.SeriesRemoved,\n        payload: resp.body\n      });\n    });\n\n    this.hubConnection.on(EVENTS.CoverUpdate, resp => {\n      this.messagesSource.next({\n        event: EVENTS.CoverUpdate,\n        payload: resp.body\n      });\n    });\n\n    this.hubConnection.on(EVENTS.UpdateAvailable, resp => {\n      this.messagesSource.next({\n        event: EVENTS.UpdateAvailable,\n        payload: resp.body\n      });\n    });\n\n    this.hubConnection.on(EVENTS.SendingToDevice, resp => {\n      this.messagesSource.next({\n        event: EVENTS.SendingToDevice,\n        payload: resp.body\n      });\n    });\n\n    this.hubConnection.on(EVENTS.ScrobblingKeyExpired, resp => {\n      this.messagesSource.next({\n        event: EVENTS.ScrobblingKeyExpired,\n        payload: resp.body\n      });\n    });\n  }\n\n  stopHubConnection() {\n    if (this.hubConnection) {\n      this.hubConnection.stop().catch(err => console.error(err));\n    }\n  }\n\n  sendMessage(methodName: string, body?: any) {\n    return this.hubConnection.invoke(methodName, body);\n  }\n\n}\n","import { inject } from '@angular/core';\nimport { Pipe, PipeTransform, SecurityContext } from '@angular/core';\nimport { DomSanitizer } from '@angular/platform-browser';\n\n@Pipe({\n  name: 'safeHtml',\n  pure: true,\n  standalone: true\n})\nexport class SafeHtmlPipe implements PipeTransform {\n  private readonly dom: DomSanitizer = inject(DomSanitizer);\n  constructor() {}\n\n  transform(value: string): string | null {\n    return this.dom.sanitize(SecurityContext.HTML, value);\n  }\n\n}\n","import { Component, OnInit } from '@angular/core';\nimport { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';\nimport { ConfirmButton } from './_models/confirm-button';\nimport { ConfirmConfig } from './_models/confirm-config';\nimport {CommonModule} from \"@angular/common\";\nimport {SafeHtmlPipe} from \"../../_pipes/safe-html.pipe\";\nimport {TranslocoDirective} from \"@ngneat/transloco\";\n\n@Component({\n  selector: 'app-confirm-dialog',\n  standalone: true,\n  imports: [CommonModule, SafeHtmlPipe, TranslocoDirective],\n  templateUrl: './confirm-dialog.component.html',\n  styleUrls: ['./confirm-dialog.component.scss']\n})\nexport class ConfirmDialogComponent implements OnInit {\n\n  config!: ConfirmConfig;\n\n  constructor(public modal: NgbActiveModal) {}\n\n  ngOnInit(): void {\n    if (this.config) {\n      this.config.buttons.sort(this._button_sort);\n    }\n  }\n\n  private _button_sort(x: ConfirmButton, y: ConfirmButton) {\n    const xIsSecondary = x.type === 'secondary';\n    const yIsSecondary = y.type === 'secondary';\n    if (xIsSecondary && !yIsSecondary) {\n      return -1;\n    } else if (!xIsSecondary && yIsSecondary) {\n      return 1;\n    }\n    return 0;\n  }\n\n  clickButton(button: ConfirmButton) {\n    this.modal.close(button.type === 'primary');\n  }\n\n  close() {\n    this.modal.close(false);\n  }\n\n}\n","<ng-container *transloco=\"let t\">\n  <div class=\"modal-header\">\n    <h4 class=\"modal-title\" id=\"modal-basic-title\">{{config.header}}</h4>\n    <button type=\"button\" class=\"btn-close\" [attr.aria-label]=\"t('common.close')\" (click)=\"close()\" *ngIf=\"!config.disableEscape\"></button>\n  </div>\n  <div class=\"modal-body\" style=\"overflow-x: auto\" [innerHtml]=\"config.content | safeHtml\">\n  </div>\n  <div class=\"modal-footer\">\n    <div *ngFor=\"let btn of config.buttons\">\n      <button type=\"button\" class=\"btn btn-{{btn.type}}\" (click)=\"clickButton(btn)\">{{btn.text}}</button>\n    </div>\n  </div>\n\n</ng-container>\n","import { ConfirmButton } from './confirm-button';\n\nexport class ConfirmConfig {\n    _type: string = 'confirm'; // internal only: confirm or alert (todo: use enum)\n    header: string = 'Confirm';\n    content: string = '';\n    buttons: Array<ConfirmButton> = [];\n    /**\n     * If the close button shouldn't be rendered\n     */\n    disableEscape: boolean = false;\n}\n","import { Injectable } from '@angular/core';\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\nimport { take } from 'rxjs/operators';\nimport { ConfirmDialogComponent } from './confirm-dialog/confirm-dialog.component';\nimport { ConfirmConfig } from './confirm-dialog/_models/confirm-config';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ConfirmService {\n\n  defaultConfirm = new ConfirmConfig();\n  defaultAlert = new ConfirmConfig();\n\n  constructor(private modalService: NgbModal) {\n    this.defaultConfirm.buttons.push({text: 'Cancel', type: 'secondary'});\n    this.defaultConfirm.buttons.push({text: 'Confirm', type: 'primary'});\n\n    this.defaultAlert._type = 'alert';\n    this.defaultAlert.header = 'Alert';\n    this.defaultAlert.buttons.push({text: 'Ok', type: 'primary'});\n\n  }\n\n  public async confirm(content?: string, config?: ConfirmConfig): Promise<boolean> {\n\n    return new Promise((resolve, reject) => {\n      if (content === undefined && config === undefined) {\n        console.error('Confirm must have either text or a config object passed');\n        return reject(false);\n      }\n\n      if (content !== undefined && config === undefined) {\n        config = this.defaultConfirm;\n        config.content = content;\n      }\n      if (content !== undefined && content !== '' && config!.content === '') {\n        config!.content = content;\n      }\n\n      const modalRef = this.modalService.open(ConfirmDialogComponent);\n      modalRef.componentInstance.config = config;\n      modalRef.closed.pipe(take(1)).subscribe(result => {\n        return resolve(result);\n      });\n      modalRef.dismissed.pipe(take(1)).subscribe(() => {\n        return resolve(false);\n      });\n    });\n\n  }\n\n  public async alert(content?: string, config?: ConfirmConfig): Promise<boolean> {\n    return new Promise((resolve, reject) => {\n      if (content === undefined && config === undefined) {\n        console.error('Alert must have either text or a config object passed');\n        return reject(false);\n      }\n\n      if (content !== undefined && config === undefined) {\n        config = this.defaultConfirm;\n        config.content = content;\n      }\n\n      const modalRef = this.modalService.open(ConfirmDialogComponent, {size: \"lg\", fullscreen: \"md\"});\n      modalRef.componentInstance.config = config;\n      modalRef.closed.pipe(take(1)).subscribe(result => {\n        return resolve(result);\n      });\n      modalRef.dismissed.pipe(take(1)).subscribe(() => {\n        return resolve(false);\n      });\n    })\n  }\n}\n","/**\n * Where does the theme come from\n */\n export enum ThemeProvider {\n    System = 1,\n    User = 2\n  }\n  \n  /**\n   * Theme for the whole instance\n   */\n  export interface SiteTheme {\n    id: number;\n    name: string;\n    normalizedName: string;\n    filePath: string;\n    isDefault: boolean;\n    provider: ThemeProvider;\n    /**\n     * The actual class the root is defined against. It is generated at the backend.\n     */\n    selector: string;\n  }","import { DOCUMENT } from '@angular/common';\nimport { HttpClient } from '@angular/common/http';\nimport {\n  DestroyRef,\n  inject,\n  Inject,\n  Injectable,\n  Renderer2,\n  RendererFactory2,\n  SecurityContext\n} from '@angular/core';\nimport { DomSanitizer } from '@angular/platform-browser';\nimport { ToastrService } from 'ngx-toastr';\nimport { map, ReplaySubject, take } from 'rxjs';\nimport { environment } from 'src/environments/environment';\nimport { ConfirmService } from '../shared/confirm.service';\nimport { NotificationProgressEvent } from '../_models/events/notification-progress-event';\nimport { SiteTheme, ThemeProvider } from '../_models/preferences/site-theme';\nimport { TextResonse } from '../_types/text-response';\nimport { EVENTS, MessageHubService } from './message-hub.service';\nimport {takeUntilDestroyed} from \"@angular/core/rxjs-interop\";\nimport {translate} from \"@ngneat/transloco\";\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ThemeService {\n\n  private readonly destroyRef = inject(DestroyRef);\n  public defaultTheme: string = 'dark';\n  public defaultBookTheme: string = 'Dark';\n\n  private currentThemeSource = new ReplaySubject<SiteTheme>(1);\n  public currentTheme$ = this.currentThemeSource.asObservable();\n\n  private themesSource = new ReplaySubject<SiteTheme[]>(1);\n  public themes$ = this.themesSource.asObservable();\n\n  /**\n   * Maintain a cache of themes. SignalR will inform us if we need to refresh cache\n   */\n  private themeCache: Array<SiteTheme> = [];\n\n  private renderer: Renderer2;\n  private baseUrl = environment.apiUrl;\n\n\n  constructor(rendererFactory: RendererFactory2, @Inject(DOCUMENT) private document: Document, private httpClient: HttpClient,\n  messageHub: MessageHubService, private domSanitizer: DomSanitizer, private confirmService: ConfirmService, private toastr: ToastrService) {\n    this.renderer = rendererFactory.createRenderer(null, null);\n\n    messageHub.messages$.pipe(takeUntilDestroyed(this.destroyRef)).subscribe(message => {\n\n      if (message.event !== EVENTS.NotificationProgress) return;\n      const notificationEvent = (message.payload as NotificationProgressEvent);\n      if (notificationEvent.name !== EVENTS.SiteThemeProgress) return;\n\n      if (notificationEvent.eventType === 'ended') {\n        if (notificationEvent.name === EVENTS.SiteThemeProgress) this.getThemes().subscribe(() => {\n\n        });\n      }\n    });\n  }\n\n  getColorScheme() {\n    return getComputedStyle(this.document.body).getPropertyValue('--color-scheme').trim();\n  }\n\n    /**\n     * --theme-color from theme. Updates the meta tag\n     * @returns\n     */\n    getThemeColor() {\n      return getComputedStyle(this.document.body).getPropertyValue('--theme-color').trim();\n    }\n\n    /**\n     * --msapplication-TileColor from theme. Updates the meta tag\n     * @returns\n     */\n    getTileColor() {\n      return getComputedStyle(this.document.body).getPropertyValue('--title-color').trim();\n    }\n\n  getCssVariable(variable: string) {\n    return getComputedStyle(this.document.body).getPropertyValue(variable).trim();\n  }\n\n  isDarkTheme() {\n    return this.getColorScheme().toLowerCase() === 'dark';\n  }\n\n  getThemes() {\n    return this.httpClient.get<SiteTheme[]>(this.baseUrl + 'theme').pipe(map(themes => {\n      this.themeCache = themes;\n      this.themesSource.next(themes);\n      this.currentTheme$.pipe(take(1)).subscribe(theme => {\n        if (themes.filter(t => t.id === theme.id).length === 0) {\n          this.setTheme(this.defaultTheme);\n          this.toastr.info(translate('toasts.theme-missing'));\n        }\n      });\n      return themes;\n    }));\n  }\n\n  /**\n   * Used in book reader to remove all themes so book reader can provide custom theming options\n   */\n  clearThemes() {\n    this.unsetThemes();\n  }\n\n  setDefault(themeId: number) {\n    return this.httpClient.post(this.baseUrl + 'theme/update-default', {themeId: themeId}).pipe(map(() => {\n      // Refresh the cache when a default state is changed\n      this.getThemes().subscribe(() => {});\n    }));\n  }\n\n  scan() {\n    return this.httpClient.post(this.baseUrl + 'theme/scan', {});\n  }\n\n  /**\n   * Sets the book theme on the body tag so css variable overrides can take place\n   * @param selector brtheme- prefixed string\n   */\n  setBookTheme(selector: string) {\n    this.unsetBookThemes();\n    this.renderer.addClass(this.document.querySelector('body'), selector);\n  }\n\n  clearBookTheme() {\n    this.unsetBookThemes();\n  }\n\n\n  /**\n   * Sets the theme as active. Will inject a style tag into document to load a custom theme and apply the selector to the body\n   * @param themeName\n   */\n   setTheme(themeName: string) {\n    const theme = this.themeCache.find(t => t.name.toLowerCase() === themeName.toLowerCase());\n    if (theme) {\n      this.unsetThemes();\n      this.renderer.addClass(this.document.querySelector('body'), theme.selector);\n\n      if (theme.provider === ThemeProvider.User && !this.hasThemeInHead(theme.name)) {\n        // We need to load the styles into the browser\n        this.fetchThemeContent(theme.id).subscribe(async (content) => {\n          if (content === null) {\n            await this.confirmService.alert(translate('toasts.alert-bad-theme'));\n            this.setTheme('dark');\n            return;\n          }\n          const styleElem = this.document.createElement('style');\n          styleElem.id = 'theme-' + theme.name;\n          styleElem.appendChild(this.document.createTextNode(content));\n\n          this.renderer.appendChild(this.document.head, styleElem);\n\n          // Check if the theme has --theme-color and apply it to meta tag\n          const themeColor = this.getThemeColor();\n          if (themeColor) {\n            this.document.querySelector('meta[name=\"theme-color\"]')?.setAttribute('content', themeColor);\n            this.document.querySelector('meta[name=\"apple-mobile-web-app-status-bar-style\"]')?.setAttribute('content', themeColor);\n          }\n\n          const tileColor = this.getTileColor();\n          if (tileColor) {\n            this.document.querySelector('meta[name=\"msapplication-TileColor\"]')?.setAttribute('content', themeColor);\n          }\n\n          const colorScheme = this.getColorScheme();\n          if (colorScheme) {\n            this.document.querySelector('body')?.setAttribute('theme', colorScheme);\n          }\n\n          this.currentThemeSource.next(theme);\n        });\n      } else {\n        this.currentThemeSource.next(theme);\n      }\n    } else {\n      // Only time themes isn't already loaded is on first load\n      this.getThemes().subscribe(themes => {\n        this.setTheme(themeName);\n      });\n    }\n  }\n\n  private hasThemeInHead(themeName: string) {\n    const id = 'theme-' + themeName.toLowerCase();\n    return Array.from(this.document.head.children).filter(el => el.tagName === 'STYLE' && el.id.toLowerCase() === id).length > 0;\n  }\n\n  private fetchThemeContent(themeId: number) {\n    return this.httpClient.get<string>(this.baseUrl + 'theme/download-content?themeId=' + themeId, TextResonse).pipe(map(encodedCss => {\n      return this.domSanitizer.sanitize(SecurityContext.STYLE, encodedCss);\n    }));\n  }\n\n  private unsetThemes() {\n    this.themeCache.forEach(theme => this.document.body.classList.remove(theme.selector));\n  }\n\n  private unsetBookThemes() {\n    Array.from(this.document.body.classList).filter(cls => cls.startsWith('brtheme-')).forEach(c => this.document.body.classList.remove(c));\n  }\n\n\n}\n","import { HttpClient } from '@angular/common/http';\nimport {DestroyRef, inject, Injectable } from '@angular/core';\nimport {catchError, of, ReplaySubject, throwError} from 'rxjs';\nimport {filter, map, switchMap, tap} from 'rxjs/operators';\nimport { environment } from 'src/environments/environment';\nimport { Preferences } from '../_models/preferences/preferences';\nimport { User } from '../_models/user';\nimport { Router } from '@angular/router';\nimport { EVENTS, MessageHubService } from './message-hub.service';\nimport { ThemeService } from './theme.service';\nimport { InviteUserResponse } from '../_models/auth/invite-user-response';\nimport { UserUpdateEvent } from '../_models/events/user-update-event';\nimport { AgeRating } from '../_models/metadata/age-rating';\nimport { AgeRestriction } from '../_models/metadata/age-restriction';\nimport { TextResonse } from '../_types/text-response';\nimport {takeUntilDestroyed} from \"@angular/core/rxjs-interop\";\n\nexport enum Role {\n  Admin = 'Admin',\n  ChangePassword = 'Change Password',\n  Bookmark = 'Bookmark',\n  Download = 'Download',\n  ChangeRestriction = 'Change Restriction',\n  ReadOnly = 'Read Only',\n  Login = 'Login',\n  Promote = 'Promote',\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AccountService {\n\n  private readonly destroyRef = inject(DestroyRef);\n\n  baseUrl = environment.apiUrl;\n  userKey = 'kavita-user';\n  public static lastLoginKey = 'kavita-lastlogin';\n  public static localeKey = 'kavita-locale';\n  private currentUser: User | undefined;\n\n  // Stores values, when someone subscribes gives (1) of last values seen.\n  private currentUserSource = new ReplaySubject<User | undefined>(1);\n  public currentUser$ = this.currentUserSource.asObservable();\n\n  private hasValidLicenseSource = new ReplaySubject<boolean>(1);\n  /**\n   * Does the user have an active license\n   */\n  public hasValidLicense$ = this.hasValidLicenseSource.asObservable();\n\n  /**\n   * SetTimeout handler for keeping track of refresh token call\n   */\n  private refreshTokenTimeout: ReturnType<typeof setTimeout> | undefined;\n\n  private isOnline: boolean = true;\n\n  constructor(private httpClient: HttpClient, private router: Router,\n    private messageHub: MessageHubService, private themeService: ThemeService) {\n      messageHub.messages$.pipe(filter(evt => evt.event === EVENTS.UserUpdate),\n        map(evt => evt.payload as UserUpdateEvent),\n        filter(userUpdateEvent => userUpdateEvent.userName === this.currentUser?.username),\n        switchMap(() => this.refreshAccount()))\n        .subscribe(() => {});\n\n    window.addEventListener(\"offline\", (e) => {\n      this.isOnline = false;\n    });\n\n    window.addEventListener(\"online\", (e) => {\n      this.isOnline = true;\n      this.refreshToken().subscribe();\n    });\n  }\n\n  hasAdminRole(user: User) {\n    return user && user.roles.includes(Role.Admin);\n  }\n\n  hasChangePasswordRole(user: User) {\n    return user && user.roles.includes(Role.ChangePassword);\n  }\n\n  hasChangeAgeRestrictionRole(user: User) {\n    return user && user.roles.includes(Role.ChangeRestriction);\n  }\n\n  hasDownloadRole(user: User) {\n    return user && user.roles.includes(Role.Download);\n  }\n\n  hasBookmarkRole(user: User) {\n    return user && user.roles.includes(Role.Bookmark);\n  }\n\n  hasReadOnlyRole(user: User) {\n    return user && user.roles.includes(Role.ReadOnly);\n  }\n\n  hasPromoteRole(user: User) {\n    return user && user.roles.includes(Role.Promote) || user.roles.includes(Role.Admin);\n  }\n\n  getRoles() {\n    return this.httpClient.get<string[]>(this.baseUrl + 'account/roles');\n  }\n\n  deleteLicense() {\n    return this.httpClient.delete<string>(this.baseUrl + 'license', TextResonse);\n  }\n\n  resetLicense(license: string, email: string) {\n    return this.httpClient.post<string>(this.baseUrl + 'license/reset', {license, email}, TextResonse);\n  }\n\n  hasValidLicense(forceCheck: boolean = false) {\n    console.log('hasValidLicense being called: ', forceCheck);\n    return this.httpClient.get<string>(this.baseUrl + 'license/valid-license?forceCheck=' + forceCheck, TextResonse)\n      .pipe(\n        map(res => res === \"true\"),\n        tap(res => {\n          this.hasValidLicenseSource.next(res)\n        }),\n        catchError(error => {\n          this.hasValidLicenseSource.next(false);\n          return throwError(error); // Rethrow the error to propagate it further\n        })\n      );\n  }\n\n  hasAnyLicense() {\n    return this.httpClient.get<string>(this.baseUrl + 'license/has-license', TextResonse)\n      .pipe(\n        map(res => res === \"true\"),\n      );\n  }\n\n  updateUserLicense(license: string, email: string, discordId?: string) {\n  return this.httpClient.post<string>(this.baseUrl + 'license', {license, email, discordId}, TextResonse)\n    .pipe(map(res => res === \"true\"));\n  }\n\n  login(model: {username: string, password: string, apiKey?: string}) {\n    return this.httpClient.post<User>(this.baseUrl + 'account/login', model).pipe(\n      tap((response: User) => {\n        const user = response;\n        if (user) {\n          this.setCurrentUser(user);\n        }\n      }),\n      takeUntilDestroyed(this.destroyRef)\n    );\n  }\n\n  setCurrentUser(user?: User) {\n    if (user) {\n      user.roles = [];\n      const roles = this.getDecodedToken(user.token).role;\n      Array.isArray(roles) ? user.roles = roles : user.roles.push(roles);\n\n      localStorage.setItem(this.userKey, JSON.stringify(user));\n      localStorage.setItem(AccountService.lastLoginKey, user.username);\n\n      if (user.preferences && user.preferences.theme) {\n        this.themeService.setTheme(user.preferences.theme.name);\n      } else {\n        this.themeService.setTheme(this.themeService.defaultTheme);\n      }\n    } else {\n      this.themeService.setTheme(this.themeService.defaultTheme);\n    }\n\n    this.currentUser = user;\n    this.currentUserSource.next(user);\n\n    this.stopRefreshTokenTimer();\n\n    if (this.currentUser) {\n      // BUG: StopHubConnection has a promise in it, this needs to be async\n      // But that really messes everything up\n      this.messageHub.stopHubConnection();\n      this.messageHub.createHubConnection(this.currentUser);\n      this.hasValidLicense().subscribe();\n      this.startRefreshTokenTimer();\n    }\n  }\n\n  logout() {\n    localStorage.removeItem(this.userKey);\n    this.currentUserSource.next(undefined);\n    this.currentUser = undefined;\n    this.stopRefreshTokenTimer();\n    this.messageHub.stopHubConnection();\n    // Upon logout, perform redirection\n    this.router.navigateByUrl('/login');\n  }\n\n\n  /**\n   * Registers the first admin on the account. Only used for that. All other registrations must occur through invite\n   * @param model\n   * @returns\n   */\n  register(model: {username: string, password: string, email: string}) {\n    return this.httpClient.post<User>(this.baseUrl + 'account/register', model).pipe(\n      map((user: User) => {\n        return user;\n      }),\n      takeUntilDestroyed(this.destroyRef)\n    );\n  }\n\n  isEmailConfirmed() {\n    return this.httpClient.get<boolean>(this.baseUrl + 'account/email-confirmed');\n  }\n\n  isEmailValid() {\n    return this.httpClient.get<string>(this.baseUrl + 'account/is-email-valid', TextResonse)\n      .pipe(map(res => res == \"true\"));\n  }\n\n  confirmMigrationEmail(model: {email: string, token: string}) {\n    return this.httpClient.post<User>(this.baseUrl + 'account/confirm-migration-email', model);\n  }\n\n  resendConfirmationEmail(userId: number) {\n    return this.httpClient.post<InviteUserResponse>(this.baseUrl + 'account/resend-confirmation-email?userId=' + userId, {});\n  }\n\n  inviteUser(model: {email: string, roles: Array<string>, libraries: Array<number>, ageRestriction: AgeRestriction}) {\n    return this.httpClient.post<InviteUserResponse>(this.baseUrl + 'account/invite', model);\n  }\n\n  confirmEmail(model: {email: string, username: string, password: string, token: string}) {\n    return this.httpClient.post<User>(this.baseUrl + 'account/confirm-email', model);\n  }\n\n  confirmEmailUpdate(model: {email: string, token: string}) {\n    return this.httpClient.post<User>(this.baseUrl + 'account/confirm-email-update', model);\n  }\n\n  /**\n   * Given a user id, returns a full url for setting up the user account\n   * @param userId\n   * @param withBaseUrl Should base url be included in invite url\n   * @returns\n   */\n  getInviteUrl(userId: number, withBaseUrl: boolean = true) {\n    return this.httpClient.get<string>(this.baseUrl + 'account/invite-url?userId=' + userId + '&withBaseUrl=' + withBaseUrl, TextResonse);\n  }\n\n  getDecodedToken(token: string) {\n    return JSON.parse(atob(token.split('.')[1]));\n  }\n\n  requestResetPasswordEmail(email: string) {\n    return this.httpClient.post<string>(this.baseUrl + 'account/forgot-password?email=' + encodeURIComponent(email), {}, TextResonse);\n  }\n\n  confirmResetPasswordEmail(model: {email: string, token: string, password: string}) {\n    return this.httpClient.post<string>(this.baseUrl + 'account/confirm-password-reset', model, TextResonse);\n  }\n\n  resetPassword(username: string, password: string, oldPassword: string) {\n    return this.httpClient.post(this.baseUrl + 'account/reset-password', {username, password, oldPassword}, TextResonse);\n  }\n\n  update(model: {email: string, roles: Array<string>, libraries: Array<number>, userId: number, ageRestriction: AgeRestriction}) {\n    return this.httpClient.post(this.baseUrl + 'account/update', model);\n  }\n\n  updateEmail(email: string, password: string) {\n    return this.httpClient.post<InviteUserResponse>(this.baseUrl + 'account/update/email', {email, password});\n  }\n\n  updateAgeRestriction(ageRating: AgeRating, includeUnknowns: boolean) {\n    return this.httpClient.post(this.baseUrl + 'account/update/age-restriction', {ageRating, includeUnknowns});\n  }\n\n  /**\n   * This will get latest preferences for a user and cache them into user store\n   * @returns\n   */\n  getPreferences() {\n    return this.httpClient.get<Preferences>(this.baseUrl + 'users/get-preferences').pipe(map(pref => {\n      if (this.currentUser !== undefined && this.currentUser !== null) {\n        this.currentUser.preferences = pref;\n        this.setCurrentUser(this.currentUser);\n      }\n      return pref;\n    }), takeUntilDestroyed(this.destroyRef));\n  }\n\n  updatePreferences(userPreferences: Preferences) {\n    return this.httpClient.post<Preferences>(this.baseUrl + 'users/update-preferences', userPreferences).pipe(map(settings => {\n      if (this.currentUser !== undefined && this.currentUser !== null) {\n        this.currentUser.preferences = settings;\n        this.setCurrentUser(this.currentUser);\n\n        // Update the locale on disk (for logout and compact-number pipe)\n        localStorage.setItem(AccountService.localeKey, this.currentUser.preferences.locale);\n      }\n      return settings;\n    }), takeUntilDestroyed(this.destroyRef));\n  }\n\n  getUserFromLocalStorage(): User | undefined {\n\n    const userString = localStorage.getItem(this.userKey);\n\n    if (userString) {\n      return JSON.parse(userString)\n    }\n\n    return undefined;\n  }\n\n  resetApiKey() {\n    return this.httpClient.post<string>(this.baseUrl + 'account/reset-api-key', {}, TextResonse).pipe(map(key => {\n      const user = this.getUserFromLocalStorage();\n      if (user) {\n        user.apiKey = key;\n\n        localStorage.setItem(this.userKey, JSON.stringify(user));\n\n        this.currentUserSource.next(user);\n        this.currentUser = user;\n      }\n      return key;\n    }));\n  }\n\n  getOpdsUrl() {\n    return this.httpClient.get<string>(this.baseUrl + 'account/opds-url', TextResonse);\n  }\n\n\n  refreshAccount() {\n    if (this.currentUser === null || this.currentUser === undefined) return of();\n    return this.httpClient.get<User>(this.baseUrl + 'account/refresh-account').pipe(map((user: User) => {\n      if (user) {\n        this.currentUser = {...user};\n      }\n\n      this.setCurrentUser(this.currentUser);\n      return user;\n    }));\n  }\n\n\n  private refreshToken() {\n    if (this.currentUser === null || this.currentUser === undefined || !this.isOnline) return of();\n    return this.httpClient.post<{token: string, refreshToken: string}>(this.baseUrl + 'account/refresh-token',\n     {token: this.currentUser.token, refreshToken: this.currentUser.refreshToken}).pipe(map(user => {\n      if (this.currentUser) {\n        this.currentUser.token = user.token;\n        this.currentUser.refreshToken = user.refreshToken;\n      }\n\n      this.setCurrentUser(this.currentUser);\n      return user;\n    }));\n  }\n\n  /**\n   * Every 10 mins refresh the token\n   */\n  private startRefreshTokenTimer() {\n    if (this.currentUser === null || this.currentUser === undefined) {\n      this.stopRefreshTokenTimer();\n      return;\n    }\n\n    this.stopRefreshTokenTimer();\n\n    this.refreshTokenTimeout = setInterval(() => this.refreshToken().subscribe(() => {}), (60 * 10_000));\n  }\n\n  private stopRefreshTokenTimer() {\n    if (this.refreshTokenTimeout !== undefined) {\n      clearInterval(this.refreshTokenTimeout);\n    }\n  }\n\n}\n"],"mappings":"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","names":["PRIMARY_OUTLET","RouteTitleKey","ParamsAsMap","params","name","v","convertToParamMap","defaultUrlMatcher","segments","segmentGroup","route","parts","posParams","index","part","segment","shallowEqualArrays","a","b","shallowEqual","k1","getDataKeys","k2","key","i","equalArraysOrString","obj","aSorted","bSorted","val","last","wrapIntoObservable","value","isObservable","isPromise","from","of","pathCompareMap","equalSegmentGroups","containsSegmentGroup","paramCompareMap","equalParams","containsParams","containsTree","container","containee","options","matrixParams","equalPath","matrixParamsMatch","c","containsSegmentGroupHelper","containeePaths","current","next","containerPaths","containeeSegment","UrlTree","root","UrlSegmentGroup","queryParams","fragment","DEFAULT_SERIALIZER","children","serializePaths","UrlSegment","path","parameters","serializePath","equalSegments","as","bs","mapChildrenIntoArray","fn","res","childOutlet","child","UrlSerializer","_UrlSerializer","t","ɵɵdefineInjectable","DefaultUrlSerializer","url","p","UrlParser","tree","serializeSegment","query","serializeQueryParams","encodeUriFragment","primary","k","encodeUriString","s","encodeUriQuery","encodeUriSegment","decode","decodeQuery","serializeMatrixParams","strParams","SEGMENT_RE","matchSegments","str","match","MATRIX_PARAM_SEGMENT_RE","matchMatrixKeySegments","QUERY_PARAM_RE","matchQueryParams","QUERY_PARAM_VALUE_RE","matchUrlQueryParamValue","RuntimeError","valueMatch","decodedKey","decodedVal","currentVal","allowPrimary","outletName","createRoot","rootCandidate","squashSegmentGroup","newChildren","childCandidate","grandChildOutlet","grandChild","mergeTrivialChildren","isUrlTree","createUrlTreeFromSnapshot","relativeTo","commands","relativeToUrlSegmentGroup","createSegmentGroupFromRoute","createUrlTreeFromSegmentGroup","targetGroup","createSegmentGroupFromRouteRecursive","currentRoute","childOutlets","childSnapshot","rootSegmentGroup","nav","computeNavigation","position","findStartingPositionForTargetGroup","newSegmentGroup","updateSegmentGroupChildren","updateSegmentGroup","isMatrixParams","command","isCommandWithOutlets","oldRoot","oldSegmentGroup","qp","replaceSegment","newRoot","oldSegment","newSegment","Navigation","isAbsolute","numberOfDoubleDots","cmdWithOutlet","cmd","cmdIdx","outlets","urlPart","partIndex","Position","processChildren","target","modifier","createPositionApplyingDoubleDots","group","g","ci","dd","getOutlets","startIndex","m","prefixedWith","slicedCommands","createNewSegmentGroup","childrenOfEmptyChild","outlet","currentCommandIndex","currentPathIndex","noMatch","curr","compare","paths","createNewSegmentChildren","stringify","IMPERATIVE_NAVIGATION","EventType","RouterEvent","id","NavigationStart","navigationTrigger","restoredState","NavigationEnd","urlAfterRedirects","NavigationCancellationCode","NavigationSkippedCode","NavigationCancel","reason","code","NavigationSkipped","NavigationError","error","RoutesRecognized","state","GuardsCheckStart","GuardsCheckEnd","shouldActivate","ResolveStart","ResolveEnd","RouteConfigLoadStart","RouteConfigLoadEnd","ChildActivationStart","snapshot","ChildActivationEnd","ActivationStart","ActivationEnd","Scroll","routerEvent","anchor","pos","BeforeActivateRoutes","RedirectRequest","OutletContext","ChildrenOutletContexts","_ChildrenOutletContexts","childName","outlet","context","contexts","t","ɵɵdefineInjectable","Tree","root","p","n","findNode","findPath","c","cc","s","value","node","child","path","TreeNode","children","nodeChildrenAsMap","map","RouterState","snapshot","setRouterState","createEmptyState","rootComponent","createEmptyStateSnapshot","emptyUrl","BehaviorSubject","UrlSegment","emptyParams","emptyData","emptyQueryParams","fragment","activated","ActivatedRoute","PRIMARY_OUTLET","ActivatedRouteSnapshot","RouterStateSnapshot","urlSubject","paramsSubject","queryParamsSubject","fragmentSubject","dataSubject","component","futureSnapshot","d","RouteTitleKey","of","convertToParamMap","getInherited","route","parent","paramsInheritanceStrategy","inherited","routeConfig","__spreadValues","hasStaticTitle","url","params","queryParams","data","resolve","segment","matched","serializeNode","state","advanceActivatedRoute","currentSnapshot","nextSnapshot","shallowEqual","shallowEqualArrays","equalParamsAndUrlSegments","a","b","equalUrlParams","equalSegments","parentsMismatch","config","RouterOutlet","_RouterOutlet","EventEmitter","inject","ViewContainerRef","ChangeDetectorRef","EnvironmentInjector","INPUT_BINDER","changes","firstChange","previousValue","outletName","RuntimeError","cmp","ref","activatedRoute","environmentInjector","location","childContexts","injector","OutletInjector","ɵɵdefineDirective","ɵɵNgOnChangesFeature","token","notFoundValue","InjectionToken","RoutedComponentInputBinder","_RoutedComponentInputBinder","dataSubscription","combineLatest","switchMap","index","mirror","reflectComponentType","templateName","createRouterState","routeReuseStrategy","curr","prevState","createNode","createOrReuseChildren","detachedRouteHandle","tree","createActivatedRoute","NAVIGATION_CANCELING_ERROR","redirectingNavigationError","urlSerializer","redirect","redirectTo","navigationBehaviorOptions","isUrlTree","error","navigationCancelingError","NavigationCancellationCode","message","code","isRedirectingNavigationCancelingError","isNavigationCancelingError","ɵEmptyOutletComponent","_ɵEmptyOutletComponent","ɵɵdefineComponent","ɵɵStandaloneFeature","rf","ctx","ɵɵelement","getOrCreateRouteInjectorIfNeeded","currentInjector","createEnvironmentInjector","standardizeConfig","children","c","__spreadProps","__spreadValues","PRIMARY_OUTLET","ɵEmptyOutletComponent","getOutlet","route","sortByMatchingOutlets","routes","outletName","sortedConfig","r","getClosestRouteInjector","snapshot","s","activateRoutes","rootContexts","routeReuseStrategy","forwardEvent","inputBindingEnabled","map","t","ActivateRoutes","futureState","currState","parentContexts","futureRoot","currRoot","advanceActivatedRoute","futureNode","currNode","contexts","children","nodeChildrenAsMap","futureChild","childOutletName","v","parentContext","future","curr","context","route","treeNode","componentRef","c","ActivationEnd","ChildActivationEnd","stored","injector","getClosestRouteInjector","CanActivate","path","CanDeactivate","component","getAllRouteGuards","getChildRouteGuards","getCanActivateChild","p","canActivateChild","getTokenOrFunctionIdentity","tokenOrFunction","NOT_FOUND","result","isInjectable","futurePath","checks","prevChildren","getRouteGuards","k","deactivateRouteAndItsChildren","shouldRun","shouldRunGuardsAndResolvers","mode","equalPath","shallowEqual","equalParamsAndUrlSegments","r","childName","node","isFunction","isBoolean","isCanLoad","guard","isCanActivate","isCanActivateChild","isCanDeactivate","isCanMatch","isEmptyError","e","EmptyError","INITIAL_VALUE","prioritizedGuardValue","switchMap","obs","combineLatest","o","take","startWith","results","UrlTree","filter","item","checkGuards","mergeMap","targetSnapshot","currentSnapshot","canActivateChecks","canDeactivateChecks","of","__spreadProps","__spreadValues","runCanDeactivateChecks","canDeactivate","runCanActivateChecks","guardsResult","futureRSS","currRSS","from","check","runCanDeactivate","first","futureSnapshot","concatMap","concat","fireChildActivationStart","fireActivationStart","runCanActivateChild","runCanActivate","snapshot","ActivationStart","ChildActivationStart","futureARS","canActivate","canActivateObservables","defer","closestInjector","guardVal","runInInjectionContext","wrapIntoObservable","canActivateChildGuardsMapped","_","d","guardsMapped","currARS","canDeactivateObservables","runCanLoadGuards","segments","urlSerializer","canLoad","canLoadObservables","injectionToken","redirectIfUrlTree","pipe","tap","isUrlTree","redirectingNavigationError","runCanMatchGuards","canMatch","canMatchObservables","NoMatch","segmentGroup","AbsoluteRedirect","urlTree","noMatch$1","throwError","namedOutletsRedirect","redirectTo","throwError","RuntimeError","canLoadFails","route","navigationCancelingError","NavigationCancellationCode","ApplyRedirects","urlSerializer","urlTree","res","c","of","PRIMARY_OUTLET","segments","posParams","newTree","AbsoluteRedirect","newRoot","UrlTree","redirectToParams","actualParams","k","v","sourceName","group","updatedSegments","children","name","child","UrlSegmentGroup","redirectToSegments","actualSegments","s","redirectToUrlSegment","pos","idx","noMatch","matchWithChecks","segmentGroup","injector","result","match","getOrCreateRouteInjectorIfNeeded","runCanMatchGuards","map","__spreadValues","createWildcardMatchResult","defaultUrlMatcher","parameters","last","split","consumedSegments","slicedSegments","config","containsEmptyPathMatchesWithNamedOutlets","createChildrenForEmptyPaths","containsEmptyPathMatches","addEmptyPathsToChildrenIfNeeded","routes","r","emptyPathMatch","getOutlet","primarySegment","isImmediateMatch","rawSegment","outlet","noLeftoversInUrl","NoLeftoversInUrl","recognize$1","configLoader","rootComponentType","paramsInheritanceStrategy","Recognizer","MAX_ALLOWED_REDIRECTS","rootSegmentGroup","root","ActivatedRouteSnapshot","rootNode","TreeNode","routeState","RouterStateSnapshot","tree","createUrlTreeFromSnapshot","catchError","e","NoMatch","routeNode","parent","i","getInherited","n","childOutlets","from","concatMap","childOutlet","sortedConfig","sortByMatchingOutlets","scan","outletChildren","defaultIfEmpty","mergeMap","noMatch$1","mergedChildren","mergeEmptyPathMatches","sortActivatedRouteSnapshots","allowRedirects","first","x","isEmptyError","matched","positionalParamSegments","remainingSegments","newSegments","matchResult","switchMap","childConfig","childInjector","snapshot","getData","getResolve","matchedOnOutlet","runCanLoadGuards","shouldLoadResult","tap","cfg","nodes","a","b","hasEmptyPathConfig","node","mergedNodes","duplicateEmptyPathNode","resultNode","mergedNode","getData","route","getResolve","recognize","injector","configLoader","rootComponentType","config","serializer","paramsInheritanceStrategy","mergeMap","t","recognize$1","map","targetSnapshot","urlAfterRedirects","__spreadProps","__spreadValues","resolveData","canActivateChecks","of","routesWithResolversToRun","check","routesNeedingDataUpdates","newRoute","flattenRouteTree","routesProcessed","from","concatMap","runResolve","getInherited","tap","takeLast","_","EMPTY","descendants","child","futureARS","futureRSS","resolve","hasStaticTitle","RouteTitleKey","resolveNode","resolvedData","keys","getDataKeys","data","key","getResolver","first","value","mapTo","catchError","e","isEmptyError","throwError","injectionToken","closestInjector","getClosestRouteInjector","resolver","getTokenOrFunctionIdentity","resolverValue","runInInjectionContext","wrapIntoObservable","switchTap","next","switchMap","v","nextResult","TitleStrategy","_TitleStrategy","snapshot","pageTitle","PRIMARY_OUTLET","ɵɵdefineInjectable","inject","DefaultTitleStrategy","_DefaultTitleStrategy","title","ɵɵinject","Title","ROUTER_CONFIGURATION","InjectionToken","ROUTES","RouterConfigLoader","_RouterConfigLoader","Compiler","loadRunner","maybeUnwrapDefaultExport","component","finalize","loader","ConnectableObservable","Subject","refCount","parentInjector","loadChildren","compiler","onLoadEndListener","NgModuleFactory$1","factoryOrRoutes","rawRoutes","requireStandaloneComponents","standardizeConfig","isWrappedDefaultExport","input","UrlHandlingStrategy","_UrlHandlingStrategy","DefaultUrlHandlingStrategy","_DefaultUrlHandlingStrategy","url","newUrlPart","wholeUrl","CREATE_VIEW_TRANSITION","VIEW_TRANSITION_OPTIONS","createViewTransition","to","transitionOptions","document","DOCUMENT","NgZone","resolveViewTransitionStarted","viewTransitionStarted","transition","createRenderPromise","onViewTransitionCreated","afterNextRender","NavigationTransitions","_NavigationTransitions","EnvironmentInjector","UrlSerializer","ChildrenOutletContexts","Location","INPUT_BINDER","onLoadStart","r","RouteConfigLoadStart","onLoadEnd","RouteConfigLoadEnd","request","id","router","initialUrlTree","initialRouterState","BehaviorSubject","IMPERATIVE_NAVIGATION","filter","overallTransitionState","completed","errored","NavigationCancellationCode","urlTransition","onSameUrlNavigation","reason","NavigationSkipped","NavigationSkippedCode","NavigationStart","routesRecognized","RoutesRecognized","extractedUrl","source","restoredState","extras","navStart","createEmptyState","guardsStart","GuardsCheckStart","getAllRouteGuards","checkGuards","evt","isUrlTree","redirectingNavigationError","guardsEnd","GuardsCheckEnd","resolveStart","ResolveStart","dataResolved","resolveEnd","ResolveEnd","loadComponents","loaders","loadedComponent","combineLatest","defaultIfEmpty","take","currentSnapshot","targetRouterState","createRouterState","BeforeActivateRoutes","activateRoutes","NavigationEnd","takeUntil","err","isNavigationCancelingError","NavigationCancel","isRedirectingNavigationCancelingError","RedirectRequest","NavigationError","ee","code","navCancel","isBrowserTriggeredNavigation","RouteReuseStrategy","_RouteReuseStrategy","DefaultRouteReuseStrategy","BaseRouteReuseStrategy","detachedTree","future","curr","_DefaultRouteReuseStrategy","ɵDefaultRouteReuseStrategy_BaseFactory","ɵɵgetInheritedFactory","StateManager","_StateManager","HistoryStateManager","_HistoryStateManager","UrlTree","listener","event","currentTransition","rawUrl","path","currentBrowserPageId","state","navigation","restoringFromCaughtError","targetPagePosition","navigationId","routerPageId","ɵHistoryStateManager_BaseFactory","NavigationResult","afterNextNavigation","action","result","defaultErrorHandler","error","exactMatchOptions","subsetMatchOptions","Router","_Router","Console","PendingTasks","Subscription","subscription","currentNavigation","mergedTree","isPublicRouterEvent","stateCopy","urlTree","commands","navigationExtras","relativeTo","queryParams","fragment","queryParamsHandling","preserveFragment","f","q","relativeToUrlSegmentGroup","relativeToSnapshot","createSegmentGroupFromRoute","createUrlTreeFromSegmentGroup","validateCommands","matchOptions","options","containsTree","params","priorPromise","reject","promise","res","rej","taskId","i","RuntimeError","RouterLink","_RouterLink","tabIndexAttribute","renderer","el","locationStrategy","tagName","s","newTabIndex","changes","button","ctrlKey","shiftKey","altKey","metaKey","sanitizedValue","ɵɵsanitizeUrlOrResourceUrl","attrName","attrValue","nativeElement","ɵɵdirectiveInject","ActivatedRoute","ɵɵinjectAttribute","Renderer2","ElementRef","LocationStrategy","ɵɵdefineDirective","rf","ctx","ɵɵlistener","$event","ɵɵattribute","InputFlags","booleanAttribute","ɵɵInputTransformsFeature","ɵɵNgOnChangesFeature","RouterLinkActive","_RouterLinkActive","element","cdr","link","EventEmitter","mergeAll","allLinkChanges","classes","c","hasActiveLinks","isActiveMatchOptions","isActiveCheckFn","ChangeDetectorRef","dirIndex","ɵɵcontentQuery","_t","ɵɵqueryRefresh","ɵɵloadQuery","PreloadingStrategy","PreloadAllModules","_PreloadAllModules","fn","RouterPreloader","_RouterPreloader","router","compiler","injector","preloadingStrategy","loader","filter","e","NavigationEnd","concatMap","routes","res","route","createEnvironmentInjector","injectorForCurrentRoute","injectorForChildren","from","mergeAll","loadedChildren$","of","recursiveLoadChildren$","mergeMap","config","loadComponent$","t","ɵɵinject","Router","Compiler","EnvironmentInjector","PreloadingStrategy","RouterConfigLoader","ɵɵdefineInjectable","ROUTER_SCROLLER","InjectionToken","RouterScroller","_RouterScroller","urlSerializer","transitions","viewportScroller","zone","options","NavigationStart","NavigationSkipped","NavigationSkippedCode","Scroll","routerEvent","anchor","ɵɵinvalidFactory","rootRoute","router","routerFeature","kind","providers","getBootstrapListener","injector","inject","Injector","bootstrappedComponentRef","ref","ApplicationRef","router","Router","bootstrapDone","BOOTSTRAP_DONE","INITIAL_NAVIGATION","ROUTER_PRELOADER","InjectFlags","ROUTER_SCROLLER","InjectionToken","Subject","withEnabledBlockingInitialNavigation","routerFeature","APP_INITIALIZER","locationInitialized","LOCATION_INITIALIZED","resolve","afterNextNavigation","NavigationTransitions","of","withDisabledInitialNavigation","ROUTER_PRELOADER","InjectionToken","withPreloading","preloadingStrategy","routerFeature","RouterPreloader","PreloadingStrategy","withComponentInputBinding","routerFeature","RoutedComponentInputBinder","INPUT_BINDER","withViewTransitions","options","providers","CREATE_VIEW_TRANSITION","createViewTransition","VIEW_TRANSITION_OPTIONS","__spreadValues","ROUTER_FORROOT_GUARD","InjectionToken","ROUTER_PROVIDERS","Location","UrlSerializer","DefaultUrlSerializer","Router","ChildrenOutletContexts","ActivatedRoute","rootRoute","RouterConfigLoader","RouterModule","_RouterModule","guard","routes","config","ROUTES","provideForRootGuard","Optional","SkipSelf","ROUTER_CONFIGURATION","provideHashLocationStrategy","providePathLocationStrategy","provideRouterScroller","withPreloading","provideInitialNavigation","withComponentInputBinding","withViewTransitions","provideRouterInitializer","t","ɵɵinject","ɵɵdefineNgModule","ɵɵdefineInjector","ROUTER_SCROLLER","viewportScroller","inject","ViewportScroller","zone","NgZone","transitions","NavigationTransitions","urlSerializer","RouterScroller","LocationStrategy","HashLocationStrategy","PathLocationStrategy","router","withDisabledInitialNavigation","withEnabledBlockingInitialNavigation","ROUTER_INITIALIZER","getBootstrapListener","APP_BOOTSTRAP_LISTENER","HttpError","errorMessage","statusCode","trueProto","TimeoutError","AbortError","UnsupportedTransportError","message","transport","DisabledTransportError","FailedToStartTransportError","FailedToNegotiateWithServerError","AggregateErrors","innerErrors","HttpResponse","statusCode","statusText","content","HttpClient","url","options","__spreadProps","__spreadValues","LogLevel","NullLogger","_logLevel","_message","VERSION","Arg","val","name","values","Platform","getDataDetail","data","includeContent","detail","isArrayBuffer","formatArrayBuffer","view","str","num","pad","sendMessage","logger","transportName","httpClient","url","content","options","__async","headers","value","getUserAgentHeader","LogLevel","responseType","response","__spreadValues","createLogger","ConsoleLogger","NullLogger","SubjectSubscription","subject","observer","index","_","minimumLogLevel","logLevel","message","msg","userAgentHeaderName","constructUserAgent","getOsName","getRuntime","getRuntimeVersion","version","os","runtime","runtimeVersion","userAgent","majorAndMinor","getErrorString","e","getGlobalThis","FetchHttpClient","HttpClient","logger","requireFunc","__require","getGlobalThis","request","__async","AbortError","abortController","error","timeoutId","msTimeout","LogLevel","TimeoutError","isArrayBuffer","response","__spreadValues","e","errorMessage","deserializeContent","HttpError","payload","HttpResponse","url","cookies","Platform","c","responseType","content","XhrHttpClient","HttpClient","logger","request","AbortError","resolve","reject","xhr","isArrayBuffer","headers","header","HttpResponse","HttpError","LogLevel","TimeoutError","DefaultHttpClient","HttpClient","logger","Platform","FetchHttpClient","XhrHttpClient","request","AbortError","url","TextMessageFormat","_TextMessageFormat","output","input","messages","HandshakeProtocol","handshakeRequest","TextMessageFormat","data","messageData","remainingData","isArrayBuffer","binaryData","separatorIndex","responseLength","textData","messages","response","MessageType","Subject","item","observer","err","SubjectSubscription","DEFAULT_TIMEOUT_IN_MS","DEFAULT_PING_INTERVAL_IN_MS","HubConnectionState","HubConnection","_HubConnection","connection","logger","protocol","reconnectPolicy","LogLevel","Arg","HandshakeProtocol","data","error","MessageType","url","__async","Platform","handshakePromise","resolve","reject","handshakeRequest","e","startPromise","AbortError","methodName","args","streams","streamIds","invocationDescriptor","promiseQueue","subject","Subject","cancelInvocation","invocationEvent","message","sendPromise","newMethod","method","handlers","removeIdx","callback","messages","getErrorString","responseMessage","remainingData","nextPing","invocationMessage","methods","methodsCopy","expectsResponse","res","exception","completionMessage","m","prevRes","c","reconnectStartTime","previousReconnectAttempts","retryError","nextRetryDelay","previousRetryCount","elapsedMilliseconds","retryReason","callbacks","key","nonblocking","invocationId","streamId","err","item","i","argument","arg","id","result","DEFAULT_RETRY_DELAYS_IN_MILLISECONDS","DefaultReconnectPolicy","retryDelays","retryContext","HeaderNames","AccessTokenHttpClient","HttpClient","innerClient","accessTokenFactory","request","__async","allowRetry","response","HeaderNames","url","HttpTransportType","TransferFormat","AbortController","LongPollingTransport","httpClient","logger","options","AbortController","url","transferFormat","__async","Arg","TransferFormat","LogLevel","name","value","getUserAgentHeader","headers","__spreadValues","pollOptions","pollUrl","response","HttpError","getDataDetail","e","TimeoutError","data","sendMessage","deleteOptions","logMessage","ServerSentEventsTransport","httpClient","accessToken","logger","options","url","transferFormat","__async","Arg","TransferFormat","LogLevel","resolve","reject","opened","eventSource","Platform","cookies","headers","name","value","getUserAgentHeader","__spreadValues","e","getDataDetail","error","data","sendMessage","WebSocketTransport","httpClient","accessTokenFactory","logger","logMessageContent","webSocketConstructor","headers","url","transferFormat","__async","Arg","TransferFormat","LogLevel","token","resolve","reject","webSocket","cookies","opened","Platform","name","value","getUserAgentHeader","HeaderNames","__spreadValues","_event","event","error","message","getDataDetail","data","MAX_REDIRECTS","HttpConnection","url","options","Arg","createLogger","webSocketModule","eventSourceModule","Platform","__require","requireFunc","AccessTokenHttpClient","DefaultHttpClient","transferFormat","__async","TransferFormat","LogLevel","message","AbortError","data","TransportSendQueue","error","resolve","e","HttpTransportType","negotiateResponse","redirects","accessToken","LongPollingTransport","headers","name","value","getUserAgentHeader","negotiateUrl","response","__spreadValues","errorMessage","HttpError","FailedToNegotiateWithServerError","connectionToken","requestedTransport","requestedTransferFormat","connectUrl","transportExceptions","transports","negotiate","endpoint","transportOrError","ex","FailedToStartTransportError","AggregateErrors","transport","WebSocketTransport","ServerSentEventsTransport","transportMatches","UnsupportedTransportError","DisabledTransportError","aTag","index","actualTransport","_TransportSendQueue","_transport","PromiseSource","transportResult","arrayBuffers","totalLength","b","a","result","offset","item","reject","reason","JSON_HUB_PROTOCOL_NAME","JsonHubProtocol","TransferFormat","input","logger","NullLogger","messages","TextMessageFormat","hubMessages","message","parsedMessage","MessageType","LogLevel","value","errorMessage","LogLevelNameMapping","LogLevel","parseLogLevel","name","mapping","HubConnectionBuilder","logging","Arg","isLogger","logLevel","ConsoleLogger","url","transportTypeOrOptions","__spreadValues","__spreadProps","protocol","retryDelaysOrReconnectPolicy","DefaultReconnectPolicy","httpConnectionOptions","connection","HttpConnection","HubConnection","NullLogger","JsonHubProtocol","logger","EVENTS","MessageHubService","constructor","hubUrl","environment","messagesSource","ReplaySubject","onlineUsersSource","BehaviorSubject","messages$","asObservable","onlineUsers$","isEventType","event","eventType","NotificationProgress","payload","toLowerCase","createHubConnection","user","hubConnection","HubConnectionBuilder","withUrl","accessTokenFactory","token","withAutomaticReconnect","build","start","catch","err","console","error","on","OnlineUsers","usernames","next","ScanSeries","resp","body","ScanLibraryProgress","ConvertBookmarksProgress","WordCountAnalyzerProgress","LibraryModified","DashboardUpdate","SideNavUpdate","SiteThemeProgress","SeriesAddedToCollection","UserProgressUpdate","UserUpdate","Error","Info","SeriesAdded","SeriesRemoved","CoverUpdate","UpdateAvailable","SendingToDevice","ScrobblingKeyExpired","stopHubConnection","stop","sendMessage","methodName","invoke","factory","ɵfac","providedIn","_MessageHubService","SafeHtmlPipe","constructor","dom","inject","DomSanitizer","transform","value","sanitize","SecurityContext","HTML","pure","standalone","_SafeHtmlPipe","ɵɵelementStart","ɵɵlistener","ɵɵrestoreView","_r1","ctx_r1","ɵɵnextContext","ɵɵresetView","close","ɵɵelementEnd","btn_r5","_r4","$implicit","clickButton","ɵɵtext","ɵɵadvance","ɵɵclassMapInterpolate1","type","ɵɵtextInterpolate","text","ɵɵelementContainerStart","ɵɵtemplate","ConfirmDialogComponent_ng_container_0_button_4_Template","ɵɵelement","ConfirmDialogComponent_ng_container_0_div_8_Template","config","header","ɵɵproperty","disableEscape","ɵɵpipeBind1","content","ɵɵsanitizeHtml","buttons","ConfirmDialogComponent","constructor","modal","ngOnInit","sort","_button_sort","x","y","xIsSecondary","yIsSecondary","button","ɵɵdirectiveInject","NgbActiveModal","selectors","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","rf","ctx","ConfirmDialogComponent_ng_container_0_Template","CommonModule","NgForOf","NgIf","SafeHtmlPipe","TranslocoDirective","styles","_ConfirmDialogComponent","ConfirmConfig","constructor","_type","header","content","buttons","disableEscape","ConfirmService","constructor","modalService","defaultConfirm","ConfirmConfig","defaultAlert","buttons","push","text","type","_type","header","confirm","content","config","__async","Promise","resolve","reject","undefined","console","error","modalRef","open","ConfirmDialogComponent","componentInstance","closed","pipe","take","subscribe","result","dismissed","alert","size","fullscreen","ɵɵinject","NgbModal","factory","ɵfac","providedIn","_ConfirmService","ThemeProvider","ThemeService","constructor","rendererFactory","document","httpClient","messageHub","domSanitizer","confirmService","toastr","destroyRef","inject","DestroyRef","defaultTheme","defaultBookTheme","currentThemeSource","ReplaySubject","currentTheme$","asObservable","themesSource","themes$","themeCache","baseUrl","environment","apiUrl","renderer","createRenderer","messages$","pipe","takeUntilDestroyed","subscribe","message","event","EVENTS","NotificationProgress","notificationEvent","payload","name","SiteThemeProgress","eventType","getThemes","getColorScheme","getComputedStyle","body","getPropertyValue","trim","getThemeColor","getTileColor","getCssVariable","variable","isDarkTheme","toLowerCase","get","map","themes","next","take","theme","filter","t","id","length","setTheme","info","translate","clearThemes","unsetThemes","setDefault","themeId","post","scan","setBookTheme","selector","unsetBookThemes","addClass","querySelector","clearBookTheme","themeName","find","provider","ThemeProvider","User","hasThemeInHead","fetchThemeContent","content","__async","alert","styleElem","createElement","appendChild","createTextNode","head","themeColor","setAttribute","colorScheme","Array","from","children","el","tagName","TextResonse","encodedCss","sanitize","SecurityContext","STYLE","forEach","classList","remove","cls","startsWith","c","ɵɵinject","RendererFactory2","DOCUMENT","HttpClient","MessageHubService","DomSanitizer","ConfirmService","ToastrService","factory","ɵfac","providedIn","_ThemeService","Role","AccountService","constructor","httpClient","router","messageHub","themeService","destroyRef","inject","DestroyRef","baseUrl","environment","apiUrl","userKey","currentUserSource","ReplaySubject","currentUser$","asObservable","hasValidLicenseSource","hasValidLicense$","isOnline","messages$","pipe","filter","evt","event","EVENTS","UserUpdate","map","payload","userUpdateEvent","userName","currentUser","username","switchMap","refreshAccount","subscribe","window","addEventListener","e","refreshToken","hasAdminRole","user","roles","includes","Admin","hasChangePasswordRole","ChangePassword","hasChangeAgeRestrictionRole","ChangeRestriction","hasDownloadRole","Download","hasBookmarkRole","Bookmark","hasReadOnlyRole","ReadOnly","hasPromoteRole","Promote","getRoles","get","deleteLicense","delete","TextResonse","resetLicense","license","email","post","hasValidLicense","forceCheck","console","log","res","tap","next","catchError","error","throwError","hasAnyLicense","updateUserLicense","discordId","login","model","response","setCurrentUser","takeUntilDestroyed","getDecodedToken","token","role","Array","isArray","push","localStorage","setItem","JSON","stringify","lastLoginKey","preferences","theme","setTheme","name","defaultTheme","stopRefreshTokenTimer","stopHubConnection","createHubConnection","startRefreshTokenTimer","logout","removeItem","undefined","navigateByUrl","register","isEmailConfirmed","isEmailValid","confirmMigrationEmail","resendConfirmationEmail","userId","inviteUser","confirmEmail","confirmEmailUpdate","getInviteUrl","withBaseUrl","parse","atob","split","requestResetPasswordEmail","encodeURIComponent","confirmResetPasswordEmail","resetPassword","password","oldPassword","update","updateEmail","updateAgeRestriction","ageRating","includeUnknowns","getPreferences","pref","updatePreferences","userPreferences","settings","localeKey","locale","getUserFromLocalStorage","userString","getItem","resetApiKey","key","apiKey","getOpdsUrl","of","__spreadValues","refreshTokenTimeout","setInterval","clearInterval","_AccountService","ɵɵinject","HttpClient","Router","MessageHubService","ThemeService","factory","ɵfac","providedIn"],"x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]}