import{i as Re}from"./chunk-GGQU56QW.js";import{g as J,k as ke,l as Ee}from"./chunk-CIDLU7ZZ.js";import{a as K}from"./chunk-FVF23ION.js";import{a as _,b as be,e as Ie,f as X,m as Me}from"./chunk-ZTKUYOP3.js";import{c as Te}from"./chunk-63UKDQJP.js";import{b as G}from"./chunk-COKVODYN.js";import{a as Y}from"./chunk-SEAKSSGD.js";import{a as Fe}from"./chunk-YK7KIY5R.js";import{a as we,b as ee}from"./chunk-LAUBKCQL.js";import{a as W}from"./chunk-RLL2TM5C.js";import{a as De}from"./chunk-CNATNHH2.js";import{e as Se,f as ye}from"./chunk-5CMEBAZF.js";import{e as fe}from"./chunk-SPNNO5LP.js";import{s as Ce}from"./chunk-E6ZKMAWP.js";import{$b as T,Ac as P,Ad as ge,Bb as p,Dc as N,Ea as re,Ec as j,Fa as b,Fb as q,Ga as w,Gc as v,Ib as s,Nb as le,Oa as oe,Pa as U,Qe as he,Rb as ce,Rc as F,Rd as _e,Td as H,Vb as c,Wb as m,Xb as C,Yb as u,Zb as x,_b as A,bf as ue,cc as y,dc as l,ef as xe,fb as se,ff as ve,g as z,gc as me,hd as de,id as R,jc as B,lb as r,lc as V,mb as I,mc as $,nc as O,nd as Q,oc as d,pc as M,qa as h,qc as S,ua as ie,ud as D,va as k,xa as ne,xc as E,ya as ae,zc as pe}from"./chunk-2LHIXASS.js";var Oe=(()=>{let a=class a{transform(t){switch(t){case W.AniList:return"assets/images/ExternalServices/AniList.png";case W.Mal:return"assets/images/ExternalServices/MAL.png";case W.GoogleBooks:return"assets/images/ExternalServices/GoogleBooks.png";case W.Kavita:return"assets/images/logo-32.png"}}};a.\u0275fac=function(n){return new(n||a)},a.\u0275pipe=ae({name:"providerImage",type:a,pure:!0,standalone:!0});let e=a;return e})();var Pe=(()=>{let a=class a{constructor(t){this.element=t}ngOnInit(){this.keyCodes&&(this.keyCodeArray=this.keyCodes.split(","))}onEvent(t){var n=function(g){var f=!1;return t.keyCode||(t.which?t.keyCode=t.which:t.charCode&&(t.keyCode=t.charCode)),t.keyCode&&g.keyCodeArray.indexOf(t.keyCode.toString())>-1&&(f=!0),f};let o=this;this.keyCodeArray.length>0&&n(o)&&(this.element.nativeElement.click(),t.preventDefault())}};a.\u0275fac=function(n){return new(n||a)(I(oe))},a.\u0275dir=ne({type:a,selectors:[["","a11y-click",""]],hostBindings:function(n,o){n&1&&y("keydown",function(f){return o.onEvent(f)})},inputs:{keyCodes:[ie.None,"a11y-click","keyCodes"]},standalone:!0});let e=a;return e})();var je=["badgeExpanderItem"],We=(e,a)=>({$implicit:e,idx:a}),ze=e=>({count:e});function qe(e,a){if(e&1&&A(0,5),e&2){let i=a.$implicit,t=a.index,n=l(2);s("ngTemplateOutlet",n.itemTemplate)("ngTemplateOutletContext",P(2,We,i,t))}}function Qe(e,a){if(e&1){let i=T();c(0,"button",6),y("click",function(){b(i);let n=l(2);return w(n.toggleVisible())}),d(1),m()}if(e&2){let i=l().$implicit,t=l();q("aria-expanded",!t.isCollapsed),r(),S(" ",i("more-items",pe(2,ze,t.itemsLeft))," ")}}function He(e,a){if(e&1&&(u(0),c(1,"div",1)(2,"div",2),p(3,qe,1,5,"ng-container",3)(4,Qe,2,4,"button",4),m()(),x()),e&2){let i=l();r(3),s("ngForOf",i.visibleItems),r(),s("ngIf",!i.isCollapsed&&i.itemsLeft!==0)}}var Le=(()=>{let a=class a{constructor(){this.cdRef=h(F),this.items=[],this.itemsTillExpander=4,this.visibleItems=[],this.isCollapsed=!1}get itemsLeft(){return Math.max(this.items.length-this.itemsTillExpander,0)}ngOnInit(){this.visibleItems=this.items.slice(0,this.itemsTillExpander),this.cdRef.markForCheck()}toggleVisible(){this.isCollapsed=!this.isCollapsed,this.visibleItems=this.items,this.cdRef.markForCheck()}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=k({type:a,selectors:[["app-badge-expander"]],contentQueries:function(n,o,g){if(n&1&&B(g,je,5),n&2){let f;V(f=$())&&(o.itemTemplate=f.first)}},inputs:{items:"items",itemsTillExpander:"itemsTillExpander"},standalone:!0,features:[E],decls:1,vars:1,consts:[[4,"transloco","translocoRead"],[1,"badge-expander"],[1,"content"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngFor","ngForOf"],["type","button","class","btn btn-sm btn-outline-primary",3,"click",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click"]],template:function(n,o){n&1&&p(0,He,5,2,"ng-container",0),n&2&&s("translocoRead","badge-expander")},dependencies:[D,de,R,Q,H],styles:[`.content[_ngcontent-%COMP%]{width:100%}.collapsed[_ngcontent-%COMP%]{height:35px;overflow:hidden}
/*# sourceMappingURL=badge-expander.component-2SB6CCY4.css.map */`],changeDetection:0});let e=a;return e})();var Ye=["titleTemplate"],Ge=["itemTemplate"],Ue=(e,a)=>({$implicit:e,idx:a});function Ke(e,a){if(e&1){let i=T();u(0),c(1,"span",8),y("click",function(){b(i);let n=l().$implicit,o=l(2);return w(o.goTo(o.queryParam,n.id))}),A(2,9),m(),x()}if(e&2){let i=l(),t=i.$implicit,n=i.idx,o=l(2);r(2),s("ngTemplateOutlet",o.itemTemplate)("ngTemplateOutletContext",P(2,Ue,t,n))}}function Je(e,a){if(e&1){let i=T();c(0,"app-tag-badge",10),y("click",function(){b(i);let n=l().$implicit,o=l(2);return w(o.goTo(o.queryParam,n.id))}),A(1,9),m()}if(e&2){let i=l(),t=i.$implicit,n=i.idx,o=l(2);s("selectionMode",o.TagBadgeCursor.Clickable),r(),s("ngTemplateOutlet",o.titleTemplate)("ngTemplateOutletContext",P(3,Ue,t,n))}}function Xe(e,a){if(e&1&&p(0,Ke,3,5,"ng-container",7)(1,Je,2,6,"ng-template",null,1,v),e&2){let i=O(2),t=l(2);s("ngIf",t.itemTemplate)("ngIfElse",i)}}function Ze(e,a){if(e&1&&(c(0,"div",3)(1,"div",4)(2,"h5"),d(3),m()(),c(4,"div",5)(5,"app-badge-expander",6),p(6,Xe,3,2,"ng-template",null,0,v),m()()()),e&2){let i=l();r(3),M(i.heading),r(2),s("items",i.tags)("itemsTillExpander",i.utilityService.getActiveBreakpoint()>=i.Breakpoint.Desktop?30:4)}}var Ae=(()=>{let a=class a{constructor(){this.filterUtilityService=h(Me),this.utilityService=h(ye),this.TagBadgeCursor=Ie,this.Breakpoint=Se,this.tags=[],this.queryParam=ee.None}goTo(t,n){t!==ee.None&&this.filterUtilityService.applyFilter(["library",this.libraryId],t,we.Equal,n).subscribe()}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=k({type:a,selectors:[["app-metadata-detail"]],contentQueries:function(n,o,g){if(n&1&&(B(g,Ye,5),B(g,Ge,5)),n&2){let f;V(f=$())&&(o.titleTemplate=f.first),V(f=$())&&(o.itemTemplate=f.first)}},inputs:{tags:"tags",libraryId:"libraryId",heading:"heading",queryParam:"queryParam"},standalone:!0,features:[E],decls:1,vars:1,consts:[["badgeExpanderItem",""],["useTitle",""],["class","row g-0 mb-1",4,"ngIf"],[1,"row","g-0","mb-1"],[1,"col-lg-3","col-md-4","col-sm-12"],[1,"col-lg-9","col-md-8","col-sm-12"],[3,"items","itemsTillExpander"],[4,"ngIf","ngIfElse"],[3,"click"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["a11y-click","13,32",1,"col-auto",3,"click","selectionMode"]],template:function(n,o){n&1&&p(0,Ze,8,3,"div",2),n&2&&s("ngIf",o.tags&&o.tags.length>0)},dependencies:[D,R,Q,Pe,Le,X],styles:["/*# sourceMappingURL=metadata-detail.component-YSOJAAI4.css.map */"],changeDetection:0});let e=a;return e})();function et(e,a){if(e&1&&(u(0),C(1,"app-image",7),x()),e&2){let i=l(2);r(),s("imageUrl",i.staff.imageUrl)}}function tt(e,a){e&1&&C(0,"i",8)}function it(e,a){if(e&1&&(c(0,"div",2)(1,"div",3),p(2,et,2,1,"ng-container",4)(3,tt,1,0,"ng-template",null,0,v),c(5,"div",5)(6,"span",6),d(7),m()()()()),e&2){let i=O(4),t=l();r(2),s("ngIf",t.isStaff&&t.staff.imageUrl&&!t.staff.imageUrl.endsWith("default.jpg"))("ngIfElse",i),r(5),S(" ",t.person.name," ")}}var ai=(()=>{let a=class a{constructor(){this.isStaff=!1,this.cdRef=h(F)}ngOnInit(){this.staff=this.person,this.cdRef.markForCheck()}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=k({type:a,selectors:[["app-person-badge"]],inputs:{person:"person",isStaff:"isStaff"},standalone:!0,features:[E],decls:1,vars:1,consts:[["localPerson",""],["class","tagbadge cursor clickable",4,"ngIf"],[1,"tagbadge","cursor","clickable"],[1,"d-flex"],[4,"ngIf","ngIfElse"],[1,"flex-grow-1"],[1,"mt-0","mb-0"],["height","24px","width","24px","objectFit","contain",3,"imageUrl"],["aria-hidden","true",1,"fa","fa-user-circle","align-self-center","me-2"]],template:function(n,o){n&1&&p(0,it,8,3,"div",1),n&2&&s("ngIf",o.person!==void 0)},dependencies:[D,R,G],styles:[`.tagbadge[_ngcontent-%COMP%]{background-color:var(--tagbadge-bg-color);transition:all .3s ease-out;margin:3px 5px 3px 0;padding:2px 10px;border-radius:6px;font-size:14px;border:1px solid var(--tagbadge-border-color);display:inline-block;cursor:pointer;width:auto}.tagbadge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px;font-weight:700;margin-right:0;cursor:pointer}
/*# sourceMappingURL=person-badge.component-LYCDRKP6.css.map */`],changeDetection:0});let e=a;return e})();var nt=(e,a)=>({volCount:e,chpCount:a});function at(e,a){if(e&1&&C(0,"app-image",14),e&2){let i=l().ngIf;s("imageUrl",i)}}function rt(e,a){if(e&1&&(u(0),c(1,"div",12),p(2,at,1,1,"app-image",13),m(),x()),e&2){let i=a.ngIf;r(2),s("ngIf",i)}}function ot(e,a){if(e&1&&(c(0,"div",16),d(1),m()),e&2){let i=l(2).$implicit,t=l();r(),S(" ",i("series-preview-drawer.vols-and-chapters",P(1,nt,t.externalSeries.volumeCount,t.externalSeries.chapterCount))," ")}}function st(e,a){if(e&1&&(c(0,"div",16),d(1),C(2,"img",20),N(3,"providerImage"),m()),e&2){let i=l(2).$implicit,t=l();r(),S(" ",i("series-preview-drawer.provided-by-label")," "),r(),s("ngSrc",j(3,2,t.externalSeries.provider))}}function lt(e,a){if(e&1&&C(0,"app-read-more",21),e&2){let i=l(3);s("maxLength",300)("text",i.externalSeries.summary)}}function ct(e,a){if(e&1&&(c(0,"app-tag-badge"),d(1),m()),e&2){let i=a.$implicit;r(),S(" ",i," ")}}function mt(e,a){if(e&1&&(c(0,"app-tag-badge"),d(1),m()),e&2){let i=a.$implicit;r(),S(" ",i.name," ")}}function pt(e,a){if(e&1&&(u(0),C(1,"app-image",30),x()),e&2){let i=l().$implicit;r(),s("imageUrl",i.imageUrl)}}function dt(e,a){e&1&&C(0,"i",31)}function gt(e,a){if(e&1&&(c(0,"div",22)(1,"div",23)(2,"div",24),p(3,pt,2,1,"ng-container",9)(4,dt,1,0,"ng-template",null,2,v),m(),c(6,"div",25)(7,"div",26)(8,"h6",27),d(9),m(),c(10,"p",28)(11,"small",29),d(12),m()()()()()()),e&2){let i=a.$implicit,t=O(5);r(3),s("ngIf",i.imageUrl&&!i.imageUrl.endsWith("default.jpg"))("ngIfElse",t),r(6),M(i.name),r(3),M(i.role)}}function ft(e,a){if(e&1&&(u(0),p(1,ot,2,4,"div",15)(2,st,4,4,"div",16)(3,lt,1,2,"app-read-more",17),c(4,"div",18)(5,"app-metadata-detail",19),p(6,ct,2,1,"ng-template",null,1,v),m()(),c(8,"div",18)(9,"app-metadata-detail",19),p(10,mt,2,1,"ng-template",null,1,v),m()(),c(12,"div",18)(13,"app-metadata-detail",19),p(14,gt,13,4,"ng-template",null,1,v),m()(),x()),e&2){let i=l().$implicit,t=l();r(),s("ngIf",(t.externalSeries.volumeCount||0)>0||(t.externalSeries.chapterCount||0)>0),r(),ce(2,t.isExternalSeries&&t.externalSeries?2:-1),r(),s("ngIf",t.externalSeries.summary),r(2),s("tags",t.externalSeries.genres)("libraryId",0)("heading",i("series-preview-drawer.genres-label")),r(4),s("tags",t.externalSeries.tags)("libraryId",0)("heading",i("series-preview-drawer.tags-label")),r(4),s("tags",t.externalSeries.staff)("libraryId",0)("heading",i("series-preview-drawer.staff-label"))}}function _t(e,a){if(e&1&&(c(0,"app-tag-badge"),d(1),m()),e&2){let i=a.$implicit;r(),S(" ",i.title," ")}}function ht(e,a){if(e&1&&(c(0,"app-tag-badge"),d(1),m()),e&2){let i=a.$implicit;r(),S(" ",i.title," ")}}function ut(e,a){if(e&1&&(c(0,"div",22)(1,"div",23)(2,"div",24),C(3,"i",36),m(),c(4,"div",25)(5,"div",26)(6,"h6",27),d(7),m(),c(8,"p",28)(9,"small",29),d(10),m()()()()()()),e&2){let i=a.$implicit;r(7),M(i.name),r(3),M(i.role)}}function xt(e,a){if(e&1){let i=T();u(0),c(1,"div",32)(2,"span",33),d(3),N(4,"publicationStatus"),m(),c(5,"button",34),y("click",function(){b(i);let n=l(3);return w(n.toggleWantToRead())}),C(6,"i",35),m()(),C(7,"app-read-more",21),c(8,"div",18)(9,"app-metadata-detail",19),p(10,_t,2,1,"ng-template",null,1,v),m()(),c(12,"div",18)(13,"app-metadata-detail",19),p(14,ht,2,1,"ng-template",null,1,v),m()(),c(16,"div",18)(17,"app-metadata-detail",19),p(18,ut,11,2,"ng-template",null,1,v),m()(),x()}if(e&2){let i=l(2).$implicit,t=l();r(3),M(j(4,16,t.localSeries.publicationStatus)),r(2),me("ngbTooltip",t.wantToRead?i("series-preview-drawer.remove-from-want-to-read"):i("series-preview-drawer.add-to-want-to-read")),r(),le("",t.wantToRead?"fa-solid":"fa-regular"," fa-star"),r(),s("maxLength",300)("text",t.localSeries.summary),r(2),s("tags",t.localSeries.genres)("libraryId",0)("heading",i("series-preview-drawer.genres-label")),r(4),s("tags",t.localSeries.tags)("libraryId",0)("heading",i("series-preview-drawer.tags-label")),r(4),s("tags",t.localStaff)("libraryId",0)("heading",i("series-preview-drawer.staff-label"))}}function vt(e,a){if(e&1&&p(0,xt,20,18,"ng-container",8),e&2){let i=l(2);s("ngIf",i.localSeries)}}function Ct(e,a){if(e&1){let i=T();u(0),c(1,"div",4)(2,"h5",5),d(3),m(),c(4,"button",6),y("click",function(){b(i);let n=l();return w(n.close())}),m()(),c(5,"div",7),p(6,rt,3,1,"ng-container",8)(7,ft,16,12,"ng-container",9)(8,vt,1,1,"ng-template",null,0,v),C(10,"app-loading",10),c(11,"a",11),d(12),m()(),x()}if(e&2){let i=a.$implicit,t=O(9),n=l();r(3),S(" ",n.name," "),r(),q("aria-label",i("common.close")),r(2),s("ngIf",n.CoverUrl),r(),s("ngIf",n.externalSeries)("ngIfElse",t),r(3),s("loading",n.isLoading),r(),s("href",n.url,se),r(),S(" ",i("series-preview-drawer.view-series")," ")}}var Be=(()=>{let a=class a{constructor(){this.libraryId=0,this.isExternalSeries=!0,this.isLoading=!0,this.localStaff=[],this.url="",this.wantToRead=!1,this.activeOffcanvas=h(xe),this.seriesService=h(K),this.imageService=h(Y),this.actionService=h(J),this.cdRef=h(F)}get CoverUrl(){return this.isExternalSeries?this.externalSeries?this.externalSeries.coverUrl:this.imageService.placeholderImage:this.imageService.getSeriesCoverImage(this.seriesId)}ngOnInit(){this.isExternalSeries?this.seriesService.getExternalSeriesDetails(this.aniListId,this.malId).subscribe(t=>{this.externalSeries=t,this.isLoading=!1,this.externalSeries.siteUrl&&(this.url=this.externalSeries.siteUrl),this.cdRef.markForCheck()}):this.seriesService.getMetadata(this.seriesId).subscribe(t=>{this.localSeries=t,this.localSeries.summary===""&&this.localSeries.genres.length===0&&this.seriesService.getExternalSeriesDetails(0,0,this.seriesId).subscribe(n=>{this.isExternalSeries=!0,this.externalSeries=n,this.cdRef.markForCheck()}),this.seriesService.isWantToRead(this.seriesId).subscribe(n=>{this.wantToRead=n,this.cdRef.markForCheck()}),this.isLoading=!1,this.url="library/"+this.libraryId+"/series/"+this.seriesId,this.localStaff=t.writers.map(n=>({name:n.name,role:"Story & Art"})),this.cdRef.markForCheck()})}toggleWantToRead(){this.wantToRead?this.actionService.removeMultipleSeriesFromWantToReadList([this.seriesId]):this.actionService.addMultipleSeriesToWantToReadList([this.seriesId]),this.wantToRead=!this.wantToRead,this.cdRef.markForCheck()}close(){this.activeOffcanvas.close()}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=k({type:a,selectors:[["app-series-preview-drawer"]],inputs:{name:"name",aniListId:"aniListId",malId:"malId",seriesId:"seriesId",libraryId:"libraryId",isExternalSeries:"isExternalSeries"},standalone:!0,features:[E],decls:1,vars:0,consts:[["localSeriesBody",""],["itemTemplate",""],["localPerson",""],[4,"transloco"],[1,"offcanvas-header"],[1,"offcanvas-title"],["type","button",1,"btn-close","text-reset",3,"click"],[1,"offcanvas-body"],[4,"ngIf"],[4,"ngIf","ngIfElse"],[3,"loading"],["target","_blank","rel","noopener noreferrer",1,"btn","btn-primary","col-12","mt-2",3,"href"],[1,"mx-auto","mb-3",2,"width","160px"],["height","230px","width","160px","maxHeight","230px","objectFit","contain",3,"imageUrl",4,"ngIf"],["height","230px","width","160px","maxHeight","230px","objectFit","contain",3,"imageUrl"],["class","text-muted muted mb-2",4,"ngIf"],[1,"text-muted","muted","mb-2"],[3,"maxLength","text",4,"ngIf"],[1,"mt-3"],[3,"tags","libraryId","heading"],["width","20","height","20","alt","",1,"ms-1",3,"ngSrc"],[3,"maxLength","text"],[1,"card","mb-3",2,"max-width","180px"],[1,"row","g-0"],[1,"col-md-4"],[1,"col-md-8"],[1,"card-body"],[1,"card-title"],[1,"card-text",2,"font-size","14px"],[1,"text-muted"],["height","24px","width","24px","objectFit","contain","classes","person-img",3,"imageUrl"],["aria-hidden","true",1,"fa","fa-user-circle","align-self-center","person-img",2,"font-size","28px"],[1,"d-inline-block","mb-2",2,"width","100%"],[1,"text-muted","muted"],[1,"btn","btn-secondary","btn-sm","float-end","me-3",3,"click","ngbTooltip"],["aria-hidden","true"],["aria-hidden","true",1,"fa","fa-user-circle","align-self-center",2,"font-size","28px","margin-top","24px","margin-left","24px"]],template:function(n,o){n&1&&p(0,Ct,13,8,"ng-container",3)},dependencies:[D,R,H,G,De,Ae,X,Te,Fe,ue,ge,Oe],styles:[`[_nghost-%COMP%]{height:100%;display:flex;flex-direction:column}  .person-img{margin-top:24px;margin-left:24px}.muted[_ngcontent-%COMP%]{font-size:14px}a.read-more-link[_ngcontent-%COMP%]{white-space:nowrap}
/*# sourceMappingURL=series-preview-drawer.component-4AMRYLM7.css.map */`],changeDetection:0});let e=a;return e})();function St(e,a){if(e&1){let i=T();u(0),c(1,"app-card-item",1),N(2,"relationship"),y("clicked",function(){b(i);let n=l();return w(n.handleClick())})("selection",function(){b(i);let n=l();return w(n.selection.emit(n.selected))}),m(),x()}if(e&2){let i=l();r(),s("title",i.data.name)("actions",i.actions)("suppressLibraryLink",i.suppressLibraryLink)("imageUrl",i.imageUrl)("entity",i.data)("total",i.data.pages)("read",i.data.pagesRead)("allowSelection",i.allowSelection)("selected",i.selected)("overlayInformation",j(2,10,i.relation))}}function te(e){if(e===null||typeof e!="object")return e;if(e instanceof Array)return e.map(i=>te(i));let a={};for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&(typeof e[i]=="object"&&e[i]!==null?a[i]=te(e[i]):a[i]=e[i]);return a}var Ki=(()=>{let a=class a{constructor(t,n,o,g,f,Ve,$e,Ne){this.router=t,this.cdRef=n,this.seriesService=o,this.toastr=g,this.modalService=f,this.imageService=Ve,this.actionFactoryService=$e,this.actionService=Ne,this.libraryId=0,this.suppressLibraryLink=!1,this.selected=!1,this.allowSelection=!1,this.relation=void 0,this.isOnDeck=!1,this.previewOnClick=!1,this.clicked=new U,this.reload=new U,this.dataChanged=new U,this.selection=new U,this.actions=[],this.imageUrl="",this.offcanvasService=h(ve)}ngOnInit(){this.data&&(this.imageUrl=this.imageService.getSeriesCoverImage(this.data.id),this.cdRef.markForCheck())}ngOnChanges(t){if(this.data){if(this.actions=[...this.actionFactoryService.getSeriesActions((n,o)=>this.handleSeriesActionCallback(n,o))],this.isOnDeck){let n=this.actions.findIndex(g=>g.title==="others"),o=te(this.actions[n]);o.children.findIndex(g=>g.action===_.RemoveFromOnDeck)<0&&(o.children.push({action:_.RemoveFromOnDeck,title:"remove-from-on-deck",callback:(g,f)=>this.handleSeriesActionCallback(g,f),class:"danger",requiresAdmin:!1,children:[]}),this.actions[n]=o)}this.cdRef.markForCheck()}}handleSeriesActionCallback(t,n){switch(t.action){case _.MarkAsRead:this.markAsRead(n);break;case _.MarkAsUnread:this.markAsUnread(n);break;case _.Scan:this.scanLibrary(n);break;case _.RefreshMetadata:this.refreshMetadata(n);break;case _.Delete:this.deleteSeries(n);break;case _.Edit:this.openEditModal(n);break;case _.AddToReadingList:this.actionService.addSeriesToReadingList(n);break;case _.AddToWantToReadList:this.actionService.addMultipleSeriesToWantToReadList([n.id]);break;case _.RemoveFromWantToReadList:this.actionService.removeMultipleSeriesFromWantToReadList([n.id]),this.router.url.startsWith("/want-to-read")&&this.reload.emit(n.id);break;case _.AddToCollection:this.actionService.addMultipleSeriesToCollectionTag([n]);break;case _.AnalyzeFiles:this.actionService.analyzeFilesForSeries(n);break;case _.SendTo:let o=t._extra.data;this.actionService.sendSeriesToDevice(n.id,o);break;case _.RemoveFromOnDeck:this.seriesService.removeFromOnDeck(n.id).subscribe(()=>this.reload.emit(n.id));break;default:break}}openEditModal(t){let n=this.modalService.open(Ee,{size:"lg"});n.componentInstance.series=t,n.closed.subscribe(o=>{o.success&&this.seriesService.getSeries(t.id).subscribe(g=>{this.data=g,this.cdRef.markForCheck(),this.reload.emit(g.id),this.dataChanged.emit(g)})})}refreshMetadata(t){return z(this,null,function*(){yield this.actionService.refreshMetdata(t)})}scanLibrary(t){return z(this,null,function*(){this.seriesService.scan(t.libraryId,t.id).subscribe(n=>{this.toastr.success(_e("toasts.scan-queued",{name:t.name}))})})}deleteSeries(t){return z(this,null,function*(){yield this.actionService.deleteSeries(t,n=>{n&&this.reload.emit(t.id)})})}markAsUnread(t){this.actionService.markSeriesAsUnread(t,()=>{this.data&&(this.data.pagesRead=0,this.cdRef.markForCheck()),this.dataChanged.emit(t)})}markAsRead(t){this.actionService.markSeriesAsRead(t,()=>{this.data&&(this.data.pagesRead=t.pages,this.cdRef.markForCheck()),this.dataChanged.emit(t)})}handleClick(){if(this.previewOnClick){let t=this.offcanvasService.open(Be,{position:"end",panelClass:"navbar-offset"});t.componentInstance.isExternalSeries=!1,t.componentInstance.seriesId=this.data.id,t.componentInstance.libraryId=this.data.libraryId,t.componentInstance.name=this.data.name;return}this.clicked.emit(this.data),this.router.navigate(["library",this.libraryId,"series",this.data?.id])}};a.\u0275fac=function(n){return new(n||a)(I(fe),I(F),I(K),I(Ce),I(he),I(Y),I(be),I(J))},a.\u0275cmp=k({type:a,selectors:[["app-series-card"]],inputs:{data:"data",libraryId:"libraryId",suppressLibraryLink:"suppressLibraryLink",selected:"selected",allowSelection:"allowSelection",relation:"relation",isOnDeck:"isOnDeck",previewOnClick:"previewOnClick"},outputs:{clicked:"clicked",reload:"reload",dataChanged:"dataChanged",selection:"selection"},standalone:!0,features:[re,E],decls:1,vars:1,consts:[[4,"ngIf"],[3,"clicked","selection","title","actions","suppressLibraryLink","imageUrl","entity","total","read","allowSelection","selected","overlayInformation"]],template:function(n,o){n&1&&p(0,St,3,12,"ng-container",0),n&2&&s("ngIf",o.data!==void 0)},dependencies:[D,R,Re,ke],styles:["/*# sourceMappingURL=series-card.component-CHSPYNO6.css.map */"],changeDetection:0});let e=a;return e})();export{Pe as a,Le as b,Ae as c,ai as d,Oe as e,Be as f,Ki as g};
//# sourceMappingURL=chunk-CASH644A.js.map
