import{a as ce,b as pe,c as de}from"./chunk-7RIKHQP6.js";import"./chunk-G6W3CHAT.js";import{a as ae}from"./chunk-5JNCF2FD.js";import"./chunk-DATLIK2Y.js";import"./chunk-C2T36BOI.js";import{g as le}from"./chunk-CASH644A.js";import{b as ne}from"./chunk-GGQU56QW.js";import"./chunk-V7YNUPX5.js";import{b as oe}from"./chunk-U42B4V5B.js";import{g as re}from"./chunk-CIDLU7ZZ.js";import{a as ie}from"./chunk-FVF23ION.js";import{a as p,m as se}from"./chunk-ZTKUYOP3.js";import"./chunk-2JQ3KAM5.js";import"./chunk-5TIUG6K2.js";import"./chunk-IYLIANWB.js";import"./chunk-63UKDQJP.js";import"./chunk-COKVODYN.js";import"./chunk-K6JLHPZK.js";import"./chunk-SEAKSSGD.js";import"./chunk-KWNQHRPC.js";import"./chunk-STVWBYRJ.js";import"./chunk-SBPQBTA5.js";import"./chunk-23B3ZJIN.js";import"./chunk-YK7KIY5R.js";import"./chunk-WBO5KV4A.js";import"./chunk-LAUBKCQL.js";import"./chunk-46CIW37K.js";import"./chunk-76TOP2FJ.js";import"./chunk-4XR5JJUF.js";import"./chunk-DBXQZVFZ.js";import"./chunk-5XQ66AVT.js";import"./chunk-RLL2TM5C.js";import"./chunk-CNATNHH2.js";import{a as ee,d as F,f as te}from"./chunk-5CMEBAZF.js";import"./chunk-ZRHV3LXB.js";import"./chunk-SBTJKJNK.js";import{c as z,e as Y,j as G,k as Q}from"./chunk-SPNNO5LP.js";import{d as J}from"./chunk-E6ZKMAWP.js";import{$b as C,Bb as g,Dc as O,Ec as H,Fa as _,Ga as v,Gc as $,Ib as c,Jd as X,Na as V,Pa as D,Q as R,Rc as N,Rd as I,S as T,Td as Z,Vb as f,Wb as h,Xb as M,Yb as B,Zb as U,cc as y,dc as o,ib as A,id as q,lb as m,mb as l,oc as x,pc as E,qa as w,qc as P,sd as W,va as j,xc as K,zc as L}from"./chunk-2LHIXASS.js";var ke=r=>({num:r});function be(r,s){if(r&1&&(f(0,"h6",7),x(1),O(2,"number"),h()),r&2){let t=o().$implicit,e=o();m(),E(t("series-count",L(3,ke,H(2,1,e.pagination.totalItems))))}}function Ce(r,s){if(r&1){let t=C();f(0,"app-series-card",9),y("reload",function(){_(t);let i=o(3);return v(i.loadPage())})("selection",function(i){let n=_(t).idx,u=o(3);return v(u.bulkSelectionService.handleCardSelection("series",n,u.series.length,i))}),h()}if(r&2){let t=s.$implicit,e=s.idx,i=o(3);c("data",t)("libraryId",t.libraryId)("selected",i.bulkSelectionService.isCardSelected("series",e))("allowSelection",!0)}}function Ae(r,s){if(r&1){let t=C();f(0,"app-card-detail-layout",8),y("applyFilter",function(i){_(t);let n=o(2);return v(n.updateFilter(i))}),g(1,Ce,1,4,"ng-template",null,0,$),h()}if(r&2){let t=o(2);c("isLoading",t.loadingSeries)("items",t.series)("trackByIdentity",t.trackByIdentity)("filterSettings",t.filterSettings)("filterOpen",t.filterOpen)("jumpBarKeys",t.jumpbarKeys)}}function xe(r,s){if(r&1){let t=C();B(0),f(1,"app-side-nav-companion-bar",2),y("filterOpen",function(i){_(t);let n=o();return v(n.filterOpen.emit(i))}),f(2,"h2",3),x(3),h(),g(4,be,3,5,"h6",4),h(),M(5,"app-bulk-operations",5),g(6,Ae,3,6,"app-card-detail-layout",6),U()}if(r&2){let t=o();m(),c("hasFilter",!0)("filterActive",t.filterActive),m(2),P(" ",t.title," "),m(),c("ngIf",t.pagination),m(),c("actionCallback",t.bulkActionCallback),m(),c("ngIf",t.filter)}}var me=(()=>{let s=class s{constructor(e,i,n,u,S,ue,fe,he,Se,_e,ve){this.router=e,this.seriesService=i,this.titleService=n,this.actionService=u,this.bulkSelectionService=S,this.hubService=ue,this.utilityService=fe,this.route=he,this.filterUtilityService=Se,this.jumpbarService=_e,this.cdRef=ve,this.title=I("side-nav.all-series"),this.series=[],this.loadingSeries=!1,this.pagination=new ee,this.filter=void 0,this.filterSettings=new pe,this.filterOpen=new D,this.filterActive=!1,this.jumpbarKeys=[],this.destroyRef=w(V),this.bulkActionCallback=(k,b)=>{let ge=this.bulkSelectionService.getSelectedCardsForSource("series"),d=this.series.filter((a,ye)=>ge.includes(ye+""));switch(k.action){case p.AddToReadingList:this.actionService.addMultipleSeriesToReadingList(d,a=>{a&&this.bulkSelectionService.deselectAll()});break;case p.AddToWantToReadList:this.actionService.addMultipleSeriesToWantToReadList(d.map(a=>a.id),()=>{this.bulkSelectionService.deselectAll()});break;case p.RemoveFromWantToReadList:this.actionService.removeMultipleSeriesFromWantToReadList(d.map(a=>a.id),()=>{this.bulkSelectionService.deselectAll()});break;case p.AddToCollection:this.actionService.addMultipleSeriesToCollectionTag(d,a=>{a&&this.bulkSelectionService.deselectAll()});break;case p.MarkAsRead:this.actionService.markMultipleSeriesAsRead(d,()=>{this.loadPage(),this.bulkSelectionService.deselectAll()});break;case p.MarkAsUnread:this.actionService.markMultipleSeriesAsUnread(d,()=>{this.loadPage(),this.bulkSelectionService.deselectAll()});break;case p.Delete:this.actionService.deleteMultipleSeries(d,a=>{a&&(this.loadPage(),this.bulkSelectionService.deselectAll())});break}},this.trackByIdentity=(k,b)=>`${b.name}_${b.localizedName}_${b.pagesRead}`,this.router.routeReuseStrategy.shouldReuseRoute=()=>!1,this.filterUtilityService.filterPresetsFromUrl(this.route.snapshot).subscribe(k=>{this.filter=k,this.title=this.route.snapshot.queryParamMap.get("title")||this.filter.name||this.title,this.titleService.setTitle("Kavita - "+this.title),this.filterActiveCheck=this.filterUtilityService.createSeriesV2Filter(),this.filterActiveCheck.statements.push(this.filterUtilityService.createSeriesV2DefaultStatement()),this.filterSettings.presetsV2=this.filter,this.cdRef.markForCheck()})}ngOnInit(){this.hubService.messages$.pipe(R(6e3),X(this.destroyRef)).subscribe(e=>{e.event===G.SeriesAdded&&this.loadPage()})}handleKeypress(e){e.key===F.SHIFT&&(this.bulkSelectionService.isShiftDown=!0)}handleKeyUp(e){e.key===F.SHIFT&&(this.bulkSelectionService.isShiftDown=!1)}updateFilter(e){if(e.filterV2!==void 0){if(this.filter=e.filterV2,e.isFirst){this.loadPage();return}this.filterUtilityService.updateUrlFromFilter(this.filter).subscribe(i=>{this.loadPage()})}}loadPage(){this.filterActive=!this.utilityService.deepEqual(this.filter,this.filterActiveCheck),this.loadingSeries=!0;let e=this.route.snapshot.queryParamMap.get("name");e=e?e.split("\uFFFD")[0]:null,this.title=this.route.snapshot.queryParamMap.get("title")||e||this.filter?.name||I("all-series.title"),this.cdRef.markForCheck(),this.seriesService.getAllSeriesV2(void 0,void 0,this.filter).pipe(T(1)).subscribe(i=>{this.series=i.result,this.jumpbarKeys=this.jumpbarService.getJumpKeys(this.series,n=>n.name),this.pagination=i.pagination,this.loadingSeries=!1,this.cdRef.markForCheck()})}};s.\u0275fac=function(i){return new(i||s)(l(Y),l(ie),l(J),l(re),l(ne),l(Q),l(te),l(z),l(se),l(ce),l(N))},s.\u0275cmp=j({type:s,selectors:[["app-all-series"]],hostBindings:function(i,n){i&1&&y("keydown.shift",function(S){return n.handleKeypress(S)},!1,A)("keyup.shift",function(S){return n.handleKeyUp(S)},!1,A)},standalone:!0,features:[K],decls:1,vars:1,consts:[["cardItem",""],[4,"transloco","translocoRead"],[3,"filterOpen","hasFilter","filterActive"],["title",""],["subtitle","",4,"ngIf"],[3,"actionCallback"],[3,"isLoading","items","trackByIdentity","filterSettings","filterOpen","jumpBarKeys","applyFilter",4,"ngIf"],["subtitle",""],[3,"applyFilter","isLoading","items","trackByIdentity","filterSettings","filterOpen","jumpBarKeys"],[3,"reload","selection","data","libraryId","selected","allowSelection"]],template:function(i,n){i&1&&g(0,xe,7,6,"ng-container",1),i&2&&c("translocoRead","all-series")},dependencies:[oe,q,ae,de,le,W,Z],styles:["/*# sourceMappingURL=all-series.component-UFJSE4A4.css.map */"],changeDetection:0});let r=s;return r})();var tt=[{path:"",component:me,pathMatch:"full"}];export{tt as routes};
//# sourceMappingURL=chunk-OYN3AID3.js.map
