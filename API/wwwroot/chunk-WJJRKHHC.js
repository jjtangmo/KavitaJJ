import{a as ue,b as ve,c as ge}from"./chunk-7RIKHQP6.js";import"./chunk-G6W3CHAT.js";import{a as _e}from"./chunk-5JNCF2FD.js";import"./chunk-DATLIK2Y.js";import"./chunk-C2T36BOI.js";import{g as fe}from"./chunk-CASH644A.js";import{b as pe}from"./chunk-GGQU56QW.js";import{a as de}from"./chunk-V7YNUPX5.js";import{b as he}from"./chunk-U42B4V5B.js";import{g as ce}from"./chunk-CIDLU7ZZ.js";import{a as le}from"./chunk-FVF23ION.js";import{a as se,m as me}from"./chunk-ZTKUYOP3.js";import"./chunk-2JQ3KAM5.js";import"./chunk-5TIUG6K2.js";import"./chunk-IYLIANWB.js";import"./chunk-63UKDQJP.js";import"./chunk-COKVODYN.js";import"./chunk-K6JLHPZK.js";import{a as ae}from"./chunk-SEAKSSGD.js";import"./chunk-KWNQHRPC.js";import"./chunk-STVWBYRJ.js";import"./chunk-SBPQBTA5.js";import"./chunk-23B3ZJIN.js";import"./chunk-YK7KIY5R.js";import"./chunk-WBO5KV4A.js";import"./chunk-LAUBKCQL.js";import"./chunk-46CIW37K.js";import"./chunk-76TOP2FJ.js";import"./chunk-4XR5JJUF.js";import"./chunk-DBXQZVFZ.js";import"./chunk-5XQ66AVT.js";import"./chunk-RLL2TM5C.js";import"./chunk-CNATNHH2.js";import{a as re,d as D,f as oe}from"./chunk-5CMEBAZF.js";import"./chunk-ZRHV3LXB.js";import"./chunk-SBTJKJNK.js";import{c as ee,e as te,j as H,k as A}from"./chunk-SPNNO5LP.js";import{d as Z}from"./chunk-E6ZKMAWP.js";import{$b as C,Bb as h,Dc as Q,Ec as q,Fa as v,Ga as g,Gc as b,Ib as l,Jd as W,Na as M,Pa as x,Q as O,Rc as J,Rd as ie,S as U,Td as ne,Vb as d,Wb as m,Xb as P,Yb as T,Zb as w,_c as Y,cc as S,dc as c,ib as I,id as z,kc as F,lb as p,lc as B,mb as a,mc as j,md as G,oc as y,pc as $,qa as K,qc as k,sd as X,va as L,xc as N,zc as E}from"./chunk-2LHIXASS.js";var Ee=["scrollingBlock"],He=["companionBar"],Ae=n=>({num:n}),We=n=>({height:n});function De(n,o){if(n&1){let t=C();d(0,"app-series-card",13),S("reload",function(i){v(t);let r=c(3);return g(r.removeSeries(i))})("selection",function(i){let r=v(t).idx,s=c(3);return g(s.bulkSelectionService.handleCardSelection("series",r,s.series.length,i))}),m()}if(n&2){let t=o.$implicit,e=o.idx,i=c(3);l("data",t)("libraryId",t.libraryId)("selected",i.bulkSelectionService.isCardSelected("series",e))("allowSelection",!0)}}function Ve(n,o){if(n&1&&y(0),n&2){let t=c(3).$implicit;k(" ",t("no-items")," ")}}function Oe(n,o){n&1&&(d(0,"div"),h(1,Ve,1,1,"ng-template",null,3,b),m())}function Ue(n,o){if(n&1&&y(0),n&2){let t=c(3).$implicit;k(" ",t("no-items-filtered")," ")}}function Ke(n,o){n&1&&(d(0,"div"),h(1,Ue,1,1,"ng-template",null,3,b),m())}function Le(n,o){if(n&1){let t=C();d(0,"app-card-detail-layout",11),S("applyFilter",function(i){v(t);let r=c(2);return g(r.updateFilter(i))}),h(1,De,1,4,"ng-template",null,2,b)(3,Oe,3,0,"div",12)(4,Ke,3,0,"div",12),m()}if(n&2){let t=c(2);l("isLoading",t.isLoading)("items",t.series)("pagination",t.pagination)("filterSettings",t.filterSettings)("filterOpen",t.filterOpen)("jumpBarKeys",t.jumpbarKeys)("trackByIdentity",t.trackByIdentity)("refresh",t.refresh),p(3),l("ngIf",!t.filterActive&&t.series.length===0),p(),l("ngIf",t.filterActive&&t.series.length===0)}}function Me(n,o){if(n&1){let t=C();T(0),d(1,"div",null,0)(3,"app-side-nav-companion-bar",5),S("filterOpen",function(i){v(t);let r=c();return g(r.filterOpen.emit(i))}),T(4,6),d(5,"h2"),y(6),m(),w(),d(7,"h6",7),y(8),Q(9,"number"),m()()(),d(10,"div",8,1),P(12,"app-bulk-operations",9),h(13,Le,5,10,"app-card-detail-layout",10),m(),w()}if(n&2){let t=o.$implicit,e=c();p(3),l("hasFilter",!0)("filterActive",e.filterActive),p(3),k(" ",t("title")," "),p(2),$(t("series-count",E(9,Ae,q(9,7,e.pagination.totalItems)))),p(2),l("ngStyle",E(11,We,e.ScrollingBlockHeight)),p(2),l("actionCallback",e.bulkActionCallback),p(),l("ngIf",e.filter)}}var Se=(()=>{let o=class o{get ScrollingBlockHeight(){if(this.scrollingBlock===void 0)return"calc(var(--vh)*100)";let e=this.document.querySelector(".navbar");if(e===null)return"calc(var(--vh)*100)";let i=this.companionBar.nativeElement.offsetHeight,r=e.offsetHeight;return"calc(var(--vh)*100 - "+(i+r+21)+"px)"}constructor(e,i,r,s,u,ye,Ce,ke,be,Re,xe,Ie,Te,we,Fe){this.imageService=e,this.router=i,this.route=r,this.seriesService=s,this.titleService=u,this.bulkSelectionService=ye,this.actionService=Ce,this.messageHub=ke,this.filterUtilityService=be,this.utilityService=Re,this.document=xe,this.cdRef=Ie,this.scrollService=Te,this.hubService=we,this.jumpbarService=Fe,this.destroyRef=K(M),this.isLoading=!0,this.series=[],this.pagination=new re,this.filter=void 0,this.filterSettings=new ve,this.refresh=new x,this.filterActive=!1,this.jumpbarKeys=[],this.filterOpen=new x,this.trackByIdentity=(f,_)=>`${_.name}_${_.localizedName}_${_.pagesRead}`,this.bulkActionCallback=(f,_)=>{let R=this.bulkSelectionService.getSelectedCardsForSource("series"),Be=this.series.filter((V,je)=>R.includes(je+""));switch(f.action){case se.RemoveFromWantToReadList:this.actionService.removeMultipleSeriesFromWantToReadList(Be.map(V=>V.id),()=>{this.bulkSelectionService.deselectAll(),this.loadPage()});break}},this.router.routeReuseStrategy.shouldReuseRoute=()=>!1,this.titleService.setTitle("Kavita - "+ie("want-to-read.title")),this.filterUtilityService.filterPresetsFromUrl(this.route.snapshot).subscribe(f=>{this.filter=f,this.filterActiveCheck=this.filterUtilityService.createSeriesV2Filter(),this.filterActiveCheck.statements.push(this.filterUtilityService.createSeriesV2DefaultStatement()),this.filterSettings.presetsV2=this.filter,this.cdRef.markForCheck()}),this.hubService.messages$.pipe(W(this.destroyRef)).subscribe(f=>{if(f.event===H.SeriesRemoved){let _=f.payload;if(!this.utilityService.deepEqual(this.filter,this.filterActiveCheck)){this.loadPage();return}this.series=this.series.filter(R=>R.id!=_.seriesId),this.pagination.totalItems--,this.cdRef.markForCheck(),this.refresh.emit()}})}ngOnInit(){this.messageHub.messages$.pipe(W(this.destroyRef),O(2e3)).subscribe(e=>{e.event===H.SeriesRemoved&&this.loadPage()})}ngAfterContentChecked(){this.scrollService.setScrollContainer(this.scrollingBlock)}handleKeypress(e){e.key===D.SHIFT&&(this.bulkSelectionService.isShiftDown=!0)}handleKeyUp(e){e.key===D.SHIFT&&(this.bulkSelectionService.isShiftDown=!1)}removeSeries(e){this.series=this.series.filter(i=>i.id!=e),this.pagination.totalItems--,this.cdRef.markForCheck(),this.refresh.emit()}loadPage(){this.filterActive=!this.utilityService.deepEqual(this.filter,this.filterActiveCheck),this.isLoading=!0,this.cdRef.markForCheck(),this.seriesService.getWantToRead(void 0,void 0,this.filter).pipe(U(1)).subscribe(e=>{this.series=e.result,this.pagination=e.pagination,this.jumpbarKeys=this.jumpbarService.getJumpKeys(this.series,i=>i.name),this.isLoading=!1,this.cdRef.markForCheck()})}updateFilter(e){if(e.filterV2!==void 0){if(this.filter=e.filterV2,e.isFirst){this.loadPage();return}this.filterUtilityService.updateUrlFromFilter(this.filter).subscribe(i=>{this.loadPage()})}}};o.\u0275fac=function(i){return new(i||o)(a(ae),a(te),a(ee),a(le),a(Z),a(pe),a(ce),a(A),a(me),a(oe),a(Y),a(J),a(de),a(A),a(ue))},o.\u0275cmp=L({type:o,selectors:[["app-want-to-read"]],viewQuery:function(i,r){if(i&1&&(F(Ee,5),F(He,5)),i&2){let s;B(s=j())&&(r.scrollingBlock=s.first),B(s=j())&&(r.companionBar=s.first)}},hostBindings:function(i,r){i&1&&S("keydown.shift",function(u){return r.handleKeypress(u)},!1,I)("keyup.shift",function(u){return r.handleKeyUp(u)},!1,I)},standalone:!0,features:[N],decls:1,vars:1,consts:[["companionBar",""],["scrollingBlock",""],["cardItem",""],["noData",""],[4,"transloco","translocoRead"],[3,"filterOpen","hasFilter","filterActive"],["title",""],["subtitle",""],[1,"main-container","container-fluid","pt-2",3,"ngStyle"],[3,"actionCallback"],[3,"isLoading","items","pagination","filterSettings","filterOpen","jumpBarKeys","trackByIdentity","refresh","applyFilter",4,"ngIf"],[3,"applyFilter","isLoading","items","pagination","filterSettings","filterOpen","jumpBarKeys","trackByIdentity","refresh"],[4,"ngIf"],[3,"reload","selection","data","libraryId","selected","allowSelection"]],template:function(i,r){i&1&&h(0,Me,14,13,"ng-container",4),i&2&&l("translocoRead","want-to-read")},dependencies:[he,G,_e,ge,fe,z,X,ne],styles:[`.virtual-scroller[_ngcontent-%COMP%], virtual-scroller[_ngcontent-%COMP%]{width:100%;height:calc(100vh - 85px);max-height:calc(var(--vh) * 100 - 170px)}.main-container[_ngcontent-%COMP%]{overflow-y:auto;position:relative;overscroll-behavior-y:none}
/*# sourceMappingURL=want-to-read.component-4ASRY2ML.css.map */`],changeDetection:0});let n=o;return n})();var kt=[{path:"",component:Se,pathMatch:"full"}];export{kt as routes};
//# sourceMappingURL=chunk-WJJRKHHC.js.map
